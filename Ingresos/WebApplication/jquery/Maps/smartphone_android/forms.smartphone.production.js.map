{"version":3,"sources":["jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.searchForm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.list.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.combo.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.offline.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.search.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.combo.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.container.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.render.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.form.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.panel.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.contentPanel.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.nestedForm.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.tab.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.tabItem.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.horizontal.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.layout.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.accordion.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.accordionItem.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.group.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.section.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.searchForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.startForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.adhocForm.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.form.js","jquery/rendering/js/smartphone/container/slide/bizagi.rendering.smartphone.slide.ecm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.text.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.readonly.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.extendedText.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.label.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.number.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.money.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.date.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.actionLauncher.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.entityTemplate.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.polymorphicLauncher.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.yesno.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.check.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.checkList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.multiSelect.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.handSignature.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.radio.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.cascadingCombo.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.collectionnavigator.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.hidden.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.upload.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.upload.offline.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.ecm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.grid.grouped.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.letter.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.button.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.fileprint.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.link.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.image.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.formLink.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.geolocation.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.association.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.searchList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.userfield.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.activityCheckList.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.numberScientificNotation.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.range.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeDate.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeMoney.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.rangeNumber.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.render.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.image.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.placeholder.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.boolean.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.link.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.label.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.text.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.dateTime.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.number.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.money.js","jquery/rendering/js/smartphone/render/layout/bizagi.rendering.smartphone.layout.upload.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.column.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.document.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.date.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.text.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.number.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.image.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.upload.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.link.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.search.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.uploadecm.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.button.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.radio.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.list.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.exclusiveCheck.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.readonly.js","jquery/rendering/js/smartphone/render/column/bizagi.rendering.smartphone.columns.hidden.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.document.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.queryForm.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.formTemplate.js","jquery/rendering/js/smartphone/container/bizagi.rendering.smartphone.usersForm.js","jquery/rendering/js/smartphone/render/bizagi.rendering.smartphone.specific_text.js","jquery/rendering/js/smartphone/bizagi.rendering.smartphone.factory.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_bizagi$rendering$sma","_defineProperty","key","value","Object","defineProperty","enumerable","configurable","writable","bizagi","rendering","container","extend","startLoading","endLoading","render","base","smartphone","initializeData","data","this","_super","formContainer","getFormContainer","formParams","getParams","internalPostRender","element","changeDisplayOption","postRender","getLabel","label","$","observableElement","getContainerRender","getAlignClass","alignType","getControl","control","length","getControlFiller","controlFiller","getContainerMessage","containerMessage","getColumnContainerMessage","changeLabelAlign","changeValueAlign","customizeRenderWidth","submitOnChange","bRefreshForm","noCollect","self","defer","Deferred","util","when","isReadyToSave","done","internalSubmitOnChange","resolve","fail","reject","always","stopLoading","promise","setValidationMessage","message","dataType","normalizeType","properties","type","isGridControl","$message","column","test","replace","attr","text","addClass","removeClass","setDisplayValue","setValue","editable","display","displayValue","getDisplayValue","html","actionSave","inputEdition","val","configureLabel","displayName","getElementsToStylize","context","getDisplayOptionClass","displayType","getFormattingLabel","clearDisplayValue","input","find","filter","index","ele","getValue","getFormParams","getRTLDisplayType","changeVisibility","argument","visible","parseBoolean","show","css","hide","changeRequired","required","triggerRenderValidate","changeRequiredLabel","changeEditabilityCellControl","xpath","form","init","params","warnings","errors","syncError","isOfflineErrorMode","syncMessage","undefined","isEmpty","makeArray","forEach","currentMessage","e","console","error","showToastOnSuccessSync","removeSyncErrorOnSubmit","postRenderContainer","buttons","getButtons","isiOSTabletDevice","isObjectEmpty","warningContainer","append","appendTo","prependTo","click","detach","ekey","setTimeout","addValidationMessage","document","unbind","bind","deferredSave","allowOnlineActions","autoSaveEvents","window","newData","collectRenderValues","isEmptyObject","localization","getResource","selectedSections","selectedSection","setParam","id","section","getRenderById","expand","saveBox","isStartForm","formtype","confirmation","showConfirmationBox","action","showSaveBox","loading","start","saveForm","isOfflineForm","offlineType","online","syncDeferred","syncParams","deferred","trigger","then","log","arguments","stop","handler","processButtons","saveButton","nextButton","i","navigation","getNavigation","view_container","getViewContainer","setNavigationButtons","bindTouchEvents","refreshForm","focus","getFocus","options","idCase","idWorkitem","idTask","selectedTabs","getSelectedTabs","getSelectedSection","xpathContext","idPageCache","isRefresh","getEndPointAction","idStartScope","isOfflineRefreshWithEdition","isEdited","postRenderEdit","originalParams","triggerHandler","delay","configureHandlers","configureComplexGateway","$canvas","getValidationsContainer","validationController","command","controllers","validation","validations","actionController","actions","readyDeferred","modalViewDidAppear","clearValidationMessages","modalViewDidDisappear","configureNetworkHandlers","internalSubmitForm","buttonProperties","submitDataAction","executeButtonAction","performAction","checkpointAction","commitAction","submitData","executeRule","createnewcase","collectRenderValuesForSubmit","animate","scrollTop","dataService","prepare","tag","prepareCheckpointAction","executeButton","idRender","prepareCommitAction","next","back","save","nextWithoutValidations","transitions","each","activeTransitions","push","countProps","messageComplexGateway","errorComplexGateway","showMessageBox","forcePlanCompletion","contexttype","contextType","surrogatekey","surrogateKey","flowControlDeferred","deferreds","apply","response","multiaction","execute","responses","isNativePluginSupported","isiOSSmartphoneDevice","bHasValidations","result","messages","join","sendRollbackAction","postProcessButton","refresh","routing","IdCase","caseNumber","CaseNumber","nonSupportedMethods","res","res2","messageError","indexOf","errorType","_params","failHandler","validateFeatureSupport","isFloatingButtonsEnabled","isFormButtonsEnabled","dispose","triggerGlobalHandler","eventType","parent","error_obj","JSON","parse","code","refreshAfterSessionIdle","showMessageSessionIdle","routingToProcess","notifier","add","title","sticky","time","processParams","idProcess","webpart","publish","showProcess","hasStartForm","fromNewCase","mapping","renderContainer","template","renderFactory","getTemplate","fasttmpl","uniqueId","helptext","helpText","mode","getMode","queryForm","getFormType","summaryForm","globalForm","displayAsReadOnly","processPath","breadCrumb","orientation","replaceChildrenHtml","renderChildrenHtml","touchMoveStart","event","preventDefault","currentPossitionY","originalEvent","targetTouches","pageY","blur","currentPositionY","changedTouches","ordinal","processButton","complexGatewayContainer","children","hasClass","on","$selected","transitionId","is","mainForm","$currentView","view","footer","panel","contentPanel","tab","material_bizagi_tabs","direction","active_index_tab","activeTab","ev","info","stopPropagation","setActiveTab","rippleEffect","tabItem","setAsActiveContainer","ready","tabs","activate","counter","afterToRefresh","horizontal","layout","accordion","accordionItem","group","toggleClass","collapse","isOpen","toogleContainer","expandedClassIcon","expandedIcon","isDesign","messageValidation","guid","displayAs","dir","getSectionOrientationRTL","mobileModal","anchor","onBeforeShow","m","addToHistoryNavigation","p","getSectionParent","bizagiapp","sectionDidAppear","isFirstLevel","onClose","close","removeFromHistoryNavigation","sectionDidDisappear","selected","pop","searchForm","renderResult","skipInitialLoad","rowsPerPage","sortBy","sortOrder","overrideGetRemoteData","getRemoteData","elements","columns","caption","parseAdditionalProperties","columnVisible","allowDecimals","showTime","grid","getRender","allowAdd","allowEdit","allowDelete","resultsGrid","results","postRenderElement","configureDesignView","configureLayoutView","criteriaContainer","resultsContainer","ui","searchParams","hasOwnProperty","refreshResults","records","rows","Class","searchForms","searchFormParams","searchFormDeferred","searchContainer","createRenderContainer","renderEdition","renderSearchForm","getSearchContainerData","getContainer","keys","map","firstChild","tabContainer","loadSearchTab","currentSearchForm","navigate","containerGridResults","containerSearchCriteria","applyButtons","hasSessionFormException","goToStartPage","errorTemplate","getCommonTemplate","renderAddForm","addContainer","guidEntity","entity","requestedForm","getFormData","addFormParams","style","callback","saveDataAddForm","destroy","maxRows","performSearch","innerHTML","indicator","currentAddForm","handleSearchFormZindex","_","refreshParams","getErrorFormatted","validateForm","forceCollectData","formData","isMapEmpty","dataHasXpath","found","setDisplayValueToControl","renderControlSearchForm","addForm","displayBottomButtons","getSearchFormData","pipe","searchFormContainer","searchFormToLoad","otherElements","isDefault","searchFormData","Math","idSearchForm","url","containerButtons","empty","templateBtn","btnSearch","tmpl","name","btnSelect","btnAdd","btnCancel","setSearchState","toggle","allowNew","virtual","option","modalViewDisplayed","grep","n","slideFormParams","slideContainer","configureViewHandlers","goBack","renderSlideForm","getStartForm","formClass","submitForm","getPageCache","onSave","renders","getRenders","updateOriginalValue","addErrorMessage","containerParams","saveButtonLabel","onCancel","cancelButtonLabel","remove","delegate","xhr","error_message","slideFormDeferred","transformData","allowEdition","shift","row","elementsWithDefaultValue","item","defaultValue","isArray","buttonContainer","isAddForm","pageCacheId","sessionId","transformActions","transformValidations","columnProperties","mapRenderType","defaultvalue","mapValue","recalculate","isColumn","concat","additionallabel","isDisabledControl","includes","isExclusiveCheck","isExclusive","replaceAll","toLowerCase","gridActions","bDependencyFound","dependencies","newAction","encode","j","transformConditions","conditions","transformCommands","commands","elseCommands","gridValidations","newValidation","condition","expressions","simple","complex","argumentType","renderId","refreshIndex","splice","parameters","getMetadataForm","$renderEdition","onSaveDataMetadataForm","fileData","metadata","renderType","getRenderType","metadataType","newRender","assign","metadataId","description","readOnly","toUpperCase","thousands","maxLength","autoExtend","update","metadataValues","idMetadata","idFileUpload","fileName","xPath","idAttrib","metaValues","updateECMMetadata","fileProperties","renderReadOnly","sanitizeHTML","decodedValue","decodeURI","validateValue","attachRetypeDouble","retypeDouble","currentValue","tooltip","createTooltip","$context","currentTitle","cloneRender","readonly","extendedText","minLines","maxLines","maxCharactersToShow","textarea","resize","showChar","startString","substr","endString","toString","encodedText","encodeHtmlText","actualMaxLength","which","prop","updateTextareaSize","configureHandlersReadOnly","$control","delegateTarget","currentRows","scrollHeight","offsetHeight","previousValue","newValue","number","numericInput","executeFormatCurrencyPlugin","money","date","MAX_YEARS_DISPLAY","dateFormat","ud","dateFormatter","format","substring","search","formatDate","getDateFromFormat","i18n","fullFormat","postRenderReadOnly","getDateControl","dateControl","inputDate","configureMobiscollCalendar","calendarInstance","mobiscroll","isCordovaSupported","isAndroidDevice","cordova","plugins","Keyboard","disableScroll","controlElements","getOrientation","calendar","touchUi","controls","min","getNormalizeDate","Date","minValue","max","maxValue","timeFormat","timePickerFormat","getTimeFormat","datePickerFormat","dateWheels","select","selectType","rtl","lang","languages","BIZAGI_LANGUAGE","language","setValueFromCalendarButtons","v","getCalendarInstance","setVal","inst","clear","onSet","onChangeHandler","onDayChange","onClear","getDateFromInvariant","isiOSDevice","onShow","isNow","currentDate","getVal","currentDateString","formatInvariant","getFullFormatedDate","currentTime","fullDate","formatISO","dateFromFormat","preprocessDateValue","isValid","invalidElements","bValid","checkMinAndMaxValue","hasValue","showMandatoryMessage","isMinValue","vValue","resultValue","getTime","formatedDate","setHour","timeS","isValidMinMaxValue","validateMinAndMaxValue","formattedDate","isNumeric","ci","callBack","actionLauncher","getActions","processPropertyValueArgs","getPropertiesActionLaucher","deferredActions","isHorizontal","templatetype","getPropertyData","processPropertyValueDataTmplArgs","templateData","engine","isDefaultTemplate","wrap","configureActionsHandlers","configureTemplateHandlers","parseInt","guidProcess","guidAction","actionType","readOnlyForm","xpathActions","processAction","actionSheet","actionClicked","expr","FilterAction","array","RegExp","keyup","not","subscribe","filters","multipleSelection","countSameActions","actionManager","act","executeAction","showConfirmationDialog","notifyExecution","class_name","processActionForm","additionalXpaths","additionalXpath","def","slideForm","slide","detailLabel","showSaveButton","isActionStartForm","savedData","editMode","IdScope","renderParams","idForm","caseId","typeForm","surrogatedKey","recordXpath","rewriteContextType","processActionFormCollection","xpathContextWithKey","printf","idEntity","xpathContextWithoutKey","addGridRecordData","IdEntity","addActionToQueue","processStartForm","args","startForm","guidprocess","mappingstakeholders","executeActionImmediately","actionsToExecuteContainer","configureQueueVisibility","listOfActions","getMappingAction","removeActionSelector","openActionSelector","removeActionToQueue","target","extraParams","dataAction","actionsToExecuteTitle","allowactions","len","calculateFilters","polymorphicLauncher","getPolymorphicActions","serializePolymorphicActions","totalActions","clone","lessActions","templateArguments","allowSearch","treeActionsList","getTreeItems","bindHandlers","level","templateTreeItem","$targetData","guidObject","guidConstructor","onActionClicked","status","pageCache","maximized","$target","yesno","radio","parsedValue","change","cleanData","check","removeAttr","evt","isCheck","checkList","unique","ceil","random","itemId","onCheckListGroupChange","checked","items","combo","list","renderControl","mobileView","customHeader","contentTemplate","open","configureActions","isDependant","getParentCombo","parentValue","BA_ACTION_PARAMETER_PREFIX","renderCombo","content","configureModalViewHandlers","processComboData","comboValue","findDataValueById","formatItem","selectedValue","valueObjet","$elementsList","$clearButton","header","$searchInput","filterList","$li","stringContainer","stringToSearch","renderComboTemplate","selectedId","hasItems","validateItem","multiSelect","MORE_OPTION_WIDTH","SEARCH_MIN_LENGTH","dataList","getDataValue","isExecutionMode","getData","openModalView","dataMapped","el","template_content","values","isChecked","template_footer","hideSearch","enableTyping","footerTemplate","transition","afterOpenAnimation","scrollIntoView","modalView","$listContainer","$suggestInput","newList","call","querySelector","getAttribute","findItemById","getOfflineData","normalizeData","services","service","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","handSignature","isNative","$actions","$container","getSignatureContainer","autoSave","debounce2","changed","Array","slice","dataImage","saveDeferred","saveSignature","DELAY_TO_SAVE","BzjSignature","saveTimestamp","toDataURL","fire","setData","setState","STATE_TYPE","cancel","onSignatureClear","onSignatureEdit","edit","onSignatureSave","EMPTY_VALUE","deleteSignature","executeFormFailHandler","draw","renderSignature","sizeRatio","cssclass","color","pluginInitialized","setSignature","renderSignatureValue","height","round","width","sleepUntil","getFileService","isLoading","buildItemUrl","dataUrl","isDisposed","BASE_IMAGE","EMPTY_IMAGE","postSignature","signature","postSignatureOffline","postSignatureOnline","saveImageOffline","isChanged","deleteImage","buildItemUrlOffline","trim","siblings","getSelectedValue","cascadingCombo","parentCombo","initializingCascadingCombo","isInitialValue","isRendered","deferredVisible","configureCombo","changeCombo","valueItem","getTemplateName","itemSelected","collectionnavigator","hidden","upload","QUALITY_PICTURE","LIMIT","EXTENSIONSIMG","EXTENSIONSFILE","EXTENSIONSVIDEO","EXTENSIONSAUDIO","renderItem","noFiles","filesCount","file","files","renderUploadItem","replaceFilesHtml","$contentFile","$inputFile","$nativeFile","checkFileExtensions","attachEvents","media","downloadFile","counterChoseFiles","off","chooseFile","removeFile","getUploadChoices","handlerUploadFile","appear","cancelClicked","getImageResolutionSizes","withoutCancel","handlerResolutionUpload","addFile","navigator","camera","getPicture","extensions","checkMaxSize","getFileDataInfo","checkFileTypes","version","getAndroidVersion","saveImage","isAndroid","modalResolutionUpload","buttonIndex","getImageResolutionItems","onFail","quality","correctOrientation","sourceType","Camera","PictureSourceType","PHOTOLIBRARY","CAMERA","mediaType","MediaType","PICTURE","destinationType","DestinationType","FILE_URI","targetWidth","targetHeight","device","capture","captureVideo","dataVideo","checkMaxSizeVideo","saveVideo","limit","actionSelected","ResolutionType","ORIGINAL","resolution","getImageResolution","transformImageSize","editedImageURL","localUrl","base64Image","dataItem","dataFile","getImagePath","mimeType","uploadFile","fullPath","addParams","buildAddParams","queueID","encodeXpath","getUploadXpath","FileUploadOptions","fileKey","uploadKey","addUrl","decodeURIComponent","onUploadFileCompleted","processFailMessage","isValidResource","$wrapper","newItem","checkMaxFiles","isMaxFilesReached","maxFiles","maxfiles","actualFiles","validExtensions","validOptions","video","image","split","fileAPISupported","buildAddFileParams","prefix","FormData","BIZAGI_SESSION_NAME","processUploadFile","promises","itemsUpload","errorResponse","responseText","checkMaxSizeFile","deleteUploadItem","triggerRenderChange","getTemplateItemName","maxFileSizeOfProperty","Number","maxSize","maxFileSizeOfUser","BIZAGI_SETTINGS","UploadMaxFileSize","updateFilesCount","openOfflineFile","handlerWebUploadFile","removeOfflineFile","fileId","randomNumber","getBlobFromPath","blob","saveOfflineFile","saveResponse","onUploadOfflineFileCompleted","addInteractions","collectData","renderValues","originalValue","method","fileUploaded","itemTemplate","filename","canBeSent","failReadFile","fileIndex","fileValue","triggerEvents","dataIndex","getFileParams","getOfflineFile","binaryFile","handleBinaryFile","path","blobPromise","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","reader","FileReader","onloadend","Blob","readAsArrayBuffer","blobFile","operationType","ecm","ERROR_ECM_NO_AVAILABLE","ACTION_DETAILS","ACTION_EDIT","getXpathContext","originalData","getFileProperties","renderFileLayout","metadataECMMultiaction","getECMMetadata","metaData","showMetadata","Filename","attackMenuEvents","addMenuEvents","$fileItem","viewMore","fn","processActionByType","allowUpdateMetadata","allowCheckOut","lockECMFile","allowCancelCheckOut","unlockECMFile","deleteECMFile","overflowMenu","lockUploadItem","replaceWith","unlockUploadItem","performValidationMessage","isFailResponse","lastIndexOf","singleInstance","cellMetadata","setDisplayValueEdit","updateAffectedCellManually","getRowIndexByKey","showMore","buildColumnModel","columnsTotalizers","jQuery","a","summarizeBy","bizagi_grid_smartphone","waiting","table","emptyTable","specialColumn","rowButtons","cell","specialCell","pager","withEditForm","details","allowDetail","inlineAdd","allowMore","totalizer","showSummary","hasTotalizer","pageRequested","submitGridData","onPageRequested","sortRequested","fetchData","page","sortType","isValidGrid","drawCell","isNewRow","cellReady","onCellReady","rowSelected","totalData","onTotalData","gridControlReady","processLayout","isLabelFormat","textFormat","valueFormat","addRow","grantPerformAction","subType","addVirtualRow","editRow","editVirtualRow","deleteRow","showFormDetails","showDetailForm","updateData","changeBackgroundColor","setHeaderStyles","label_style","headerFormat","bold","background","italic","underline","strikethru","size","fetchTotalData","operationState","showTotal","columnIndex","bizAgiProperties","totalize","operation","sum","return_value","count","avg","toFixed","formatTotalizedResult","total","showTotals","sort","searchFilter","getGridData","isRTL","changeOrderData","controlType","formatMonetaryCell","cssClass","showBorder","columnModel","align","columnLabel","gridColumn","dataReady","dataReadyDeferred","setCellOverrides","triggerGridPluginHandler","omitKeys","changes","cellOverride","getCellOverride","renderColumn","newRecords","labelAlign","columntitlealign","valueAlign","columnAlign","drawEditableCell","drawReadonlyCell","cellOverrides","bindRenderChange","newFontSize","outerHTML","originalEditable","getDecorated","submitOnChangexpathContext","dataservice","submitAddRequest","newid","propertiesGridForm","recordXPath","addPage","addLabel","idAsigned","enableEditSubmitRequest","hideLabel","disableProcessButons","hasExclusiveCheck","argumentsfl","formlink","formLink","contextEdit","actionSaveNewRow","actionCancel","actionCancelRow","_sendRelation","_getData","addExclusiveChange","_InternalRenderLinkForm","currentRow","adhocForm","saveAddedRow","containerForm","editPage","editLabel","submitEditRequest","collectGridChange","dataToSend","submitDeleteRequest","rowDeleted","submitRollbackRequest","submitSaveRequest","resp","applyActionUpdateGrid","originalMethod","decorated","selfIntern","child","getElementType","ELEMENT_TYPE_CONTAINER","ELEMENT_TYPE_RENDER","parentPromise","inlineAddPromise","inlineAddDeferred","setError","changeCellValue","getControlCell","_value","compositeValue","getCompositeValue","changeCellBackgroundColor","background-color","background-image","changeCellColor","changeCellVisibility","findIndex","isCurrentGridCell","getColumn","changeCellEditability","changeEditability","changeCellRequired","changeMinValue","changeMaxValue","emptyValue","rowLength","errorsMessage","showValidationMessage","isBinding","setMilliseconds","merge","getDataNewRows","reduce","acum","current","success","stringify","exclusiveChanges","simpleXpath","originalRows","completeRows","isTaskForm","newRowKeys","k","createdOffline","groupBy","groupSummary","addWarning","initialLoadDone","applyGridPlugin","pendingActions","enableXlsExport","enablePdfExport","processChanges","internalRedersValues","internalNewRenderValues","temporalNew","sortArray","currentChanges","columnXpath","canColumnBeSent","columnNumber","match","buildCellXpathFilter","columnValue","addRowData","idRow","creationTimestamp","isNew","b","processOldRows","newRows","tempRows","col","leng","temp","processRow","setSurrogateKey","overrideProperties","now","onCellChange","originalFormat","renderSummary","setHours","newRow","createAddRowData","editInline","saveInlineAddedRows","bRefresh","removeNewRecords","delInfo","deleteUrl","ADVANCED_SEARCH_ID","ADVANCED_ADDITION_ID","CLEAR_SEARCH_ID","NO_RESULTS_SEARCH_ID","DEFAULT_SEARCH_ID","SEARCH_DELAY","SEARCH_MAX_RECORDS","deferredReference","searchInput","advancedSearch","_simplySearchView","_advanceSearchView","readyActionExecution","modalViewList","suggestFilter","debounce","autoCompleteSearchResults","selectItem","formSearchParams","helpers","allowFullSearch","maxRecords","refreshControl","getContentTemplate","processRequest","term","renderSearchItem","searchItem","req","suggestions","allowSuggest","searchLength","getSuggestData","state","hideStatus","parseValue","performTermMatches","inputText","allowClear","startsWith","letter","button","needsUserConfirmation","userConfirmationMessage","runButtonAction","pressed","changeFontBold","$label","fileprint","link","preventDefaultForAnchorTag","isValidValue","getFullyDecodedURI","linkEncode","encodeURI","linkSolver","linktarget","linkTarget","isDesignMode","showAsyncImage","choosePhoto","configureNativeHandlers","configureHybridHandlers","imageAdd","resolutionButtonHandler","imagePreview","useCamera","imageAddNative","imageAddHybrid","performUploadFile","coordinates","getBoundingClientRect","popoverOptions","CameraPopoverOptions","left","top","imageAddNativeFromCamera","imageDelete","uploadFileCompleted","msg","uploadFileNativeOnline","uploadFileHybridOnline","fileService","changeOfflineImageName","htmlImage","configureMenu","baseParams","zoom","useNativeScrolling","imageData","img","getFullImage","compatibilityVersion","buildFullItemUrl","$preview","originalImageWidth","$viewMore","buildItemUrlOnline","isOfflineFormsV2Supported","offlineId","buildOfflineImageId","getOfflineImageName","paramsRender","proxyPrefix","serviceLocator","originalElement","orgiginalDisplayType","_isRefreshForm","getFormLinkXpathContext","getFormLinkXpath","hasentryrule","openLink","resolveCheckpointRequest","openLinkRule","paintFormLink","rollbackForm","property","getPropertyValue","dataRuleResp","showErrorMessage","propertyName","extra","jqXHR","textStatus","errorThrown","withAddForm","hideSaveButton","saveRecord","error_code","executeSubmitOnChange","hasexitrule","closeExitRule","resolveSubmitCommitRequest","ex","err","saveGridRecord","saveUrl","submitCommitRequest","submitCheckpointRequest","parentXpathContext","geolocation","ALLOW_UPDATE","coordinate","updateDisplayValue","performPrecision","onSuccess","position","coords","latitude","longitude","getCurrentPosition","association","getFlipAssociation","flip","makeJsonBase","flipped","columnData","getColumnData","getRightAssociation","formatJson","dataAssociation","rightData","leftData","isExecution","addEventControl","showDefaultGroupList","$groups","slideDown","$input","parentId","addElement","removeElement","flipstate","$element","$groupList","parents","closeAccordionSection","active","slideUp","searchList","SEARCH_ELEMENTS","searchListInput","_searchListViewModal","getHeaderTemplate","getFooterTemplate","cssClassHeader","adjustResize","finalValue","deleteItem","templateItem","getTagTemplate","modalViewTagList","modalFooter","modalHeader","getListItems","initialScreenSize","innerHeight","emptyItems","userfieldWrapper","getUserfieldControl","sControl","userfieldName","exists","eval","createUserfieldInstance","userfield","userfieldGuid","getUserfieldDefinition","loadUserfield","dynamicFunction","initialParams","getUserFieldInstance","isUserField","userfieldInstance","replicateUserfieldMethods","styleContent","styleGuid","str","loadStyle","defaultUserField","designUserField","startUserfieldLoading","endUserfieldLoading","userfieldDefinition","basicUserField","renderSingle","renderUserfieldControl","getEditableControl","isSupported","getReadonlyControl","controlName","goal","activityDescription","newItemName","addEditButton","cancelEditButton","additionalElements","notifyLoadItems","resolvedItems","resolved","setItemLocalStorage","hasChanges","idActivity","itemsResolved","progress","activityWork","prepareNewItem","that","contentHolder","closest","itemPosition","repaintControl","itemSelectedName","itemContent","setSelectionRange","addSelectedHandlers","keypress","addItem","guidItem","checkListHtml","refreshValue","completed","floor","controlValueIsChanged","numberScientificNotation","range","rangeDate","defineRangeControl","rangeMoney","rangeNumber","layoutRender","layoutImage","templateUri","getImageUri","ajax","processData","contentType","getResponseHeader","byteArrayToBlob","stringToByteArray","urlCreator","URL","webkitURL","imageUrl","createObjectURL","hash","getUrl","replaceMultiple","layoutPlaceholder","layoutBoolean","layoutLink","proxy","onClickElement","navigateFromRender","reference","referenceType","kendoMobileApplication","layoutLabel","layoutText","layoutDateTime","layoutNumber","formatCurrency","symbol","positiveFormat","negativeFormat","decimalSymbol","digitGroupSymbol","groupDigits","roundToDecimalPlace","numDecimals","colorize","layoutMoney","layoutUpload","getValueFilesByData","valueResult","getHTMLFiles","getUploadFileEntityUrl","isContextContainerWidgetRender","guidentity","applyOverrides","originalGetControl","isValueValid","propertyOverrides","applyColumnStyles","cellIcon","getXpath","getDocumentXpath","getContextXpath","documentTemplateGenerate","preRenderControl","deleteDocumentTemplate","xpathcontext","generateDocumentTemplate","autoOpenDocuments","xpathPath","tableCell","deleteUploadFile","columnXpathSplit","nameFile","getUploadFileUrl","calculateInitialLayoutProperties","refreshCell","getECMXpathContext","idSession","gridChanges","mapEnabledOfflineChecks","mapEnabledCheck","overrideDecoratedRenderProperties","enabledChecks","tmpDecorated","handleOfflineChange","simpleXpathArray","newChange","updateGridData","r","allRows","rowId","rowValue","ACTION_SHOW","ACTION_DOWNLOAD","ACTION_DELETE","documents","downloadalldocuments","allowgenerate","allowGenerate","renderDocumentsHtml","renderActionsHtml","replaceActionsHtml","$inputDocument","$listDocuments","$listActions","getTemplateReadonly","buttonExecuted","validate","validateContainer","documentFile","renderAllDocumentDownload","getTemplateDownload","buildAllDocumentsUrl","joined","redrawDocuments","downloadAllDocuments","$documentContainer","$actionContainer","showDocumentPreview","resolveDocumentTemplateGenerate","resolveDeleteDocumentTemplate","formTemplate","regularExpressionExpression","regularExpression","expression","regularExpressionMessage","isEmptyField","retype","mask","validationMessages","keyUnicode","charCode","keyCode","decodedDisplayValue","valueToDisplay","isNull","performDesignModeMethods","internalSetInitialValue","factory","loadTemplates","loadTemplate","getFileTemplate","tmplIcons","src","onDemand","detectDevice","usersForm","nestedForm","mobileform","mobilegroup","columnParams","isExtended","exclusiveCheck","uploadecm","offline","enableQuerySuggestBehavior","entityTemplate","getSearchRender","activityCheckList","getLayoutRender","getRangeRender","specific_text"],"mappings":"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","sourcesContent":["function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Search Slide Implementation\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: UI Forms Team\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will shows a search form\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n$.Class.extend(\"bizagi.rendering.smartphone.helpers.searchForm\", {}, {\n\n  /**\r\n                                                                        * Constructor\r\n                                                                        */\n  init: function init(dataService, renderFactory, searchForms, searchParams, searchFormParams) {\n    this.dataService = dataService;\n    this.renderFactory = renderFactory;\n    this.searchForms = searchForms;\n    this.searchParams = searchParams;\n    this.searchFormParams = searchFormParams;\n\n    this.searchFormDeferred = new $.Deferred();\n\n    // Creates a container, be careful you must destroy it later\n    this.searchContainer = this.searchFormParams.navigation.createRenderContainer({ title: this.searchFormParams.displayName });\n  },\n\n  /**\r\n      * Render the edition form,... if is an addform, then show the currentAddForm view\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  renderEdition: function renderEdition(params) {\n    this.properties = params;\n\n    // Render the search form\n    this.renderSearchForm(params);\n\n    // Return promise\n    return this.searchFormDeferred.promise();\n  },\n\n  /**\r\n      * Get the searchform and render it!\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  renderSearchForm: function renderSearchForm(params) {\n    var self = this;\n\n    var container = self.searchContainer;\n\n    $.when(self.getSearchContainerData(params)).then(function (data) {\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      if (data.form.properties) {\n        data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\n      }\n\n      var form = self.renderFactory.getContainer($.extend({}, self.searchFormParams, {\n        type: \"form\",\n        data: data.form,\n        navigation: self.searchFormParams.navigation,\n        view_container: container }));\n\n\n      self.form = form;\n\n      (Object.keys(form.children) || []).\n      map(function (key) {\n        form.children[key].params = $.extend({}, form.children[key].params, self.searchFormParams);\n      });\n\n      return form.render();\n\n    }).done(function (element) {\n      var firstChild = self.form.firstChild();\n      var tabContainer = firstChild.properties.type === \"tab\" ? firstChild : null;\n\n      if (tabContainer) {\n        // Bind select tab event\n        tabContainer.bind(\"selected\", function (e, ui) {\n          var searchForm = self.searchForms[ui.index];\n          $.when(self.loadSearchTab(params, ui.tab, searchForm)).\n          done(function () {\n            // Set currents search form\n            self.currentSearchForm = ui.tab.firstChild();\n            self.currentSearchForm.triggerHandler(\"ondomincluded\");\n          });\n        });\n\n        tabContainer.container.tabs(\"select\", 0);\n        self.currentSearchForm = tabContainer.firstChild().firstChild();\n\n        if (!self.currentSearchForm.readyDeferred)\n        self.currentSearchForm.readyDeferred = new $.Deferred();\n\n        self.currentSearchForm.triggerHandler(\"ondomincluded\");\n      } else {\n        // Set currents search form\n        self.currentSearchForm = self.form.firstChild();\n\n        if (!self.currentSearchForm.readyDeferred)\n        self.currentSearchForm.readyDeferred = new $.Deferred();\n\n        self.currentSearchForm.triggerHandler(\"ondomincluded\");\n      }\n\n      container.element.html(element);\n      self.searchFormParams.navigation.navigate(container.id);\n\n      self.containerGridResults = self.currentSearchForm.container.find(\".bz-container__search-results\");\n      self.containerSearchCriteria = self.currentSearchForm.container.find(\".bz-container__search-criteria\");\n\n      self.applyButtons(container);\n    }).fail(function (error_obj) {\n      if (self.hasSessionFormException(error_obj)) {\n        self.goToStartPage(error_obj);\n      } else {\n        var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\n        var message = error_obj && error_obj.message ? error_obj.message : error_obj;\n\n        $($.fasttmpl(errorTemplate, { message: message })).\n        appendTo(container.element);\n\n        self.searchFormParams.navigation.navigate(container.id);\n      }\n    });\n  },\n\n  /**\r\n      * Get the addform and show it\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  renderAddForm: function renderAddForm(params) {\n    var self = this;\n    params = params || {};\n    var properties = self.properties;\n\n    if (typeof self.addContainer === \"undefined\") {\n      var message = bizagi.localization.getResource(\"render-dialog-entity\");\n      self.addContainer = self.searchFormParams.navigation.createRenderContainer({ title: message });\n\n      // Binds the view close event, and send the RollBack\n      self.addContainer.element.bind(\"close\", function () {\n        delete self.addContainer;\n      });\n    }\n\n    var isRefresh = params.isRefresh || false;\n\n    var getFormParams = {\n      idPageCache: params.idPageCache,\n      guidEntity: properties.entity,\n      contextType: \"entity\" };\n\n\n    if (isRefresh) {\n      getFormParams.isRefresh = true;\n      getFormParams.idStartScope = params.idStartScope;\n    } else {\n      getFormParams.idRender = properties.idRender;\n      getFormParams.requestedForm = \"addForm\";\n    }\n\n    // Get the addform\n    $.when(self.dataService.getFormData(getFormParams)).then(function (data) {\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      if (typeof data.form.properties !== \"undefined\") {\n        data.form.properties.orientation = self.searchParams.orientation || \"ltr\";\n      }\n\n      data.form.contextType = \"entity\";\n\n      var form = self.renderFactory.getContainer($.extend({}, self.addFormParams, {\n        type: \"form\",\n        data: data.form,\n        focus: params.focus || false,\n        selectedTabs: params.selectedTabs,\n        isRefresh: isRefresh,\n        requestedForm: params.requestedForm,\n        navigation: self.searchFormParams.navigation,\n        view_container: self.addContainer }));\n\n\n      form.buttons = [\n      $.extend(\n      form.buttons[0] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          return self.saveDataAddForm(form).done(function () {\n\n            self.addContainer.destroy();\n            delete self.addContainer;\n\n            // TIMER: Prevent the Form is locked if not destroy the addForm\n            setTimeout(function () {\n              // Force a search after a new item is created!\n              self.searchParams.maxRows = 1;\n              self.currentSearchForm.performSearch(self.searchParams);\n            }, 350);\n\n          });\n        } }),\n\n      $.extend(\n      form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        // This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          self.addContainer.destroy();\n          delete self.addContainer;\n        } })];\n\n\n\n      $.extend(form, {\n        processButtons: function processButtons() {\n          // Not send information set in memory and save\n          $.each(form.buttons, function (index, element) {\n            switch (element[\"ordinal\"]) {\n              case 1: //next button will behave as a cancel button\n                $(form.getButtons()[index]).click(function () {\n                  self.addContainer.destroy();\n                  delete self.addContainer;\n                });\n\n                form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n                form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n                form.buttons[index].action = \"back\";\n                break;\n\n              default:\n                $(form.getButtons()[index]).click(function () {\n                  self.saveDataAddForm(form);\n\n                  self.addContainer.destroy();\n                  delete self.addContainer;\n                });\n                break;}\n\n          });\n        } });\n\n\n      (Object.keys(form.children) || []).\n      map(function (indicator) {\n        form.children[indicator].params = $.extend({}, form.children[indicator].params, self.addFormParams);\n      });\n\n      return $.when(form.render()).done(function (element) {\n        // Set currents search form\n        self.currentAddForm = form.firstChild();\n        self.addContainer.element.html(element);\n\n        if (!isRefresh) {\n          self.searchFormParams.navigation.navigate(self.addContainer.id);\n        }\n\n        self.addContainer.setNavigationButtons(form);\n\n        form.triggerHandler(\"ondomincluded\");\n\n        // if is any modal view displayed, hide it to allow this search form been displayed\n        self.handleSearchFormZindex(\"show\");\n\n        form.bind(\"refresh\", function (_, refreshParams) {\n          refreshParams.scrollTop = self.form.container.parent().scrollTop();\n          refreshParams = $.extend({\n            focus: focus,\n            selectedTabs: self.form.getSelectedTabs(),\n            isRefresh: true,\n            contextType: self.properties.contextType || \"\",\n            navigation: self.searchFormParams.navigation,\n            view_container: self.addContainer },\n          refreshParams);\n\n          return self.renderAddForm(refreshParams);\n        });\n\n      });\n    }).fail(function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n\n      if (self.hasSessionFormException(error_obj)) {\n        self.goToStartPage(error_obj);\n      } else {\n        self.addContainer.destroy();\n        delete self.addContainer;\n      }\n    });\n  },\n\n  /**\r\n      * Save data to add form\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  saveDataAddForm: function saveDataAddForm(form) {\n    var self = this;\n    var defer = $.Deferred();\n\n    if (form.validateForm()) {\n      var data = {};\n      $.forceCollectData = true;\n\n      form.collectRenderValues(data);\n      data.idPageCache = form.idPageCache;\n\n      var params = {\n        action: \"SAVE\",\n        data: data,\n        idPageCache: data.idPageCache,\n        guidEntity: form.properties.entity,\n        contexttype: \"entity\" };\n\n\n      // Check if the add form has data\n      var formData = {};\n\n      form.collectRenderValuesForSubmit(formData);\n\n      // Turn off flag\n      $.forceCollectData = false;\n\n      if (!bizagi.util.isMapEmpty(formData)) {\n        $.when(self.dataService.submitData(params)).\n        done(function (response) {\n          function dataHasXpath(xpath) {\n            var render = self.currentSearchForm.getRender(xpath);\n\n            if (_typeof(render) === \"object\" && render !== null)\n            return { \"found\": true, \"obj\": render };\n            return { \"found\": false, \"obj\": {} };\n          }\n\n          if (response && response.type === \"validationMessages\") {\n            form.addValidationMessage(response.messages);\n            defer.reject();\n          } else {\n\n            for (var i in formData) {\n              var mapping = dataHasXpath(i);\n              if (mapping.found) {\n                mapping.obj.setValue(formData[i]);\n                self.setDisplayValueToControl(mapping.obj, form, i, formData);\n              }\n            }\n\n            defer.resolve();\n          }\n        }).fail(function (error) {\n          var error_obj = bizagi.util.getErrorFormatted(error);\n\n          if (self.hasSessionFormException(error_obj)) {\n            self.goToStartPage(error_obj);\n          } else {\n            var message = error_obj.message || bizagi.localization.getResource(\"workportal-general-error\");\n\n            form.addValidationMessage(message);\n          }\n\n          defer.reject();\n        });\n      } else {\n        // Form has not data\n        bizagi.showMessageBox(bizagi.localization.getResource(\"render-search-advanced-no-filters\"));\n        defer.reject();\n      }\n    } else {\n      defer.reject();\n    }\n\n    return defer;\n  },\n\n  /***\r\n      * Set display value by control type, when add new record\r\n      * @param renderControlSearchForm\r\n      * @param addForm\r\n      * @param xpath\r\n      * @param formData\r\n      */\n  setDisplayValueToControl: function setDisplayValueToControl(renderControlSearchForm, addForm, xpath, formData) {\n    if (renderControlSearchForm.properties.type === \"searchSuggest\") {\n      renderControlSearchForm.setDisplayValue(addForm.getRender(xpath).getDisplayValue());\n    } else {\n      renderControlSearchForm.setDisplayValue(formData[xpath]);\n    }\n  },\n\n  /**\r\n      * configure searchform buttons\r\n      * */\n  applyButtons: function applyButtons(container) {\n    var self = this;\n\n    self.displayBottomButtons(container);\n\n    container.element.bind(\"close\", function () {\n      self.searchFormDeferred.reject();\n    });\n  },\n\n  loadSearchTab: function loadSearchTab(params, tab, searchForm) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // If the tab has children it is loaded already\n    if (tab.children.length > 0) return null;\n\n    // Load search form data\n    $.when(self.getSearchFormData(params, searchForm)).\n    pipe(function (data) {\n      // Render data inside selected tab\n      var searchFormContainer = self.renderFactory.getContainer({\n        type: \"searchForm\",\n        data: data.form });\n\n\n      tab.children.push(searchFormContainer);\n      return searchFormContainer.render();\n    }).\n    done(function (element) {\n      // Remove button container\n      $(\".ui-bizagi-button-container\", element).detach();\n      tab.container.append(element);\n      defer.resolve();\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * Creates the search dialog sub-containers\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  getSearchContainerData: function getSearchContainerData(params) {\n    var self = this;\n    var deferred = new $.Deferred();\n    var data = {\n      form: {\n        properties: {},\n        elements: [] } };\n\n\n\n    var container = data.form;\n    var searchFormToLoad = self.searchForms[0];\n\n    // When there are more than one search form, render a tab container\n    if (self.searchForms.length > 1) {\n      var tabContainer = {\n        properties: {\n          type: \"tab\" },\n\n        elements: [] };\n\n\n      var otherElements = [];\n\n      $.each(self.searchForms, function (i, searchForm) {\n        var isDefault = searchForm[\"default\"] || false;\n        // Create tab item\n        var tab = {\n          properties: {\n            id: i,\n            type: \"tabItem\",\n            displayName: searchForm.caption },\n\n          elements: [] };\n\n\n        // Append children\n        if (isDefault) {\n          tabContainer.elements.push({ container: tab });\n          // Set properties to load default container\n          container = tab;\n          searchFormToLoad = self.searchForms[0];\n        } else {\n          otherElements.push({ container: tab });\n        }\n      });\n\n      // Append no defaults elements\n      $.each(otherElements, function (i, element) {\n        tabContainer.elements.push(element);\n      });\n\n      data.form.elements.push({ container: tabContainer });\n    }\n\n    // Loads default form\n    $.when(self.getSearchFormData(params, searchFormToLoad)).\n    done(function (searchFormData) {\n      container.elements.push(searchFormData);\n      container.properties.id = Math.guid();\n\n      // Resolve deferred\n      deferred.resolve(data);\n    }).fail(function (error) {\n      var message = bizagi.util.getErrorFormatted(error);\n      deferred.reject(message);\n    });\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Loads a search form\r\n      * @param {} params\r\n      * @param {} searchForm\r\n      * @returns {}\r\n      */\n  getSearchFormData: function getSearchFormData(params, searchForm) {\n    var self = this;\n\n    return self.dataService.getSearchFormData($.extend(params, {\n      idSearchForm: searchForm.id,\n      url: searchForm.url })).\n    pipe(function (data) {\n      // Append search render properties\n      data.form.properties.idRender = params.idRender;\n      return data;\n    });\n  },\n\n  displayBottomButtons: function displayBottomButtons(container) {\n    var self = this;\n    var containerButtons = self.currentSearchForm.container.find(\".bz-container__button-edit\").empty().show();\n    var templateBtn = \"<button class='ui-bizagi-form-button ${name}'>${text}</button>\";\n\n    var btnSearch = $.tmpl(templateBtn, {\n      name: \"bz-btn-search\",\n      text: bizagi.localization.getResource(\"render-form-dialog-box-search\") }).\n    appendTo(containerButtons);\n\n    var btnSelect = $.tmpl(templateBtn, {\n      name: \"bz-btn-select\",\n      text: bizagi.localization.getResource(\"render-search-advanced-results-button\") }).\n    appendTo(containerButtons);\n\n    var btnAdd = $.tmpl(templateBtn, {\n      name: \"bz-btn-add\",\n      text: bizagi.localization.getResource(\"render-form-dialog-box-add\") }).\n    appendTo(containerButtons);\n    var btnCancel = $.tmpl(templateBtn, {\n      name: \"bz-btn-cancel\",\n      text: bizagi.localization.getResource(\"render-form-dialog-box-cancel\") }).\n    appendTo(containerButtons);\n\n    container.element.bind(\"close\", function (e) {\n      //If the view results is in front, shouldn't go back, but change the showed panel\n      if (self.containerSearchCriteria.css(\"display\") === \"none\") {\n        e.preventDefault();\n        setSearchState();\n      }\n    });\n\n    var setSearchState = function setSearchButtons() {\n      // List possible buttons for search\n      var buttons = [\n      {\n        \"ordinal\": 1,\n        \"action\": \"search\",\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-search\"),\n        \"callback\": function callback() {\n          // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\n          self.searchParams.maxRows = 1;\n          return self.currentSearchForm.performSearch(self.searchParams);\n        } },\n\n      {\n        \"ordinal\": 2,\n        \"action\": \"cancel\",\n        \"caption\": \"cancel\",\n        \"callback\": function callback() {\n          self.searchFormDeferred.reject();\n          container.destroy();\n        } },\n\n      {\n        \"ordinal\": 3,\n        \"action\": \"add\",\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\n        \"callback\": function callback() {\n          var params = {\n            \"idCase\": self.searchFormParams.idCase,\n            \"idRender\": self.properties.idRender,\n            \"displayName\": self.properties.displayName,\n            \"idPageCache\": self.properties.idPageCache };\n\n\n          self.renderAddForm(params);\n        } }];\n\n\n\n      self.containerSearchCriteria.show();\n      self.containerGridResults.hide();\n\n      // Add only seen when allowed\n      $(btnAdd).toggle(self.searchParams.allowNew);\n      btnSearch.show();\n      btnSelect.hide();\n\n      if (!self.searchParams.allowNew) {\n        buttons.pop();\n      }\n\n      self.form.buttons = buttons;\n      delete self.form.properties.virtual;\n      container.setNavigationButtons(self.form);\n    };\n\n    var setResultState = function setSearchButtons() {\n\n      // List posible buttons for result\n      var buttons = [\n      {\n        \"ordinal\": 4,\n        \"action\": \"select\",\n        \"caption\": bizagi.localization.getResource(\"render-search-advanced-results-button\"),\n        \"callback\": function callback() {\n          self.searchFormDeferred.resolve(container.element.find(\".bz-container__search-results [data-key]\").data(\"business-key\"));\n          container.destroy();\n        } },\n\n      {\n        \"ordinal\": 5,\n        \"action\": \"cancel\",\n        \"caption\": \"cancel\",\n        \"callback\": function callback() {\n          setSearchState();\n        } },\n\n      {\n        \"ordinal\": 3,\n        \"action\": \"add\",\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-add\"),\n        \"callback\": function callback() {\n          var params = {\n            \"idCase\": self.searchFormParams.idCase,\n            \"idRender\": self.properties.idRender,\n            \"displayName\": self.properties.displayName,\n            \"idPageCache\": self.properties.idPageCache };\n\n\n          self.renderAddForm(params);\n        } }];\n\n\n\n      self.containerSearchCriteria.hide();\n      self.containerGridResults.show();\n\n      // Add only seen when allowed\n      $(btnAdd).toggle(self.searchParams.allowNew);\n      btnSearch.hide();\n      btnSelect.show();\n\n      if (!self.searchParams.allowNew) {\n        buttons.pop();\n      }\n\n      self.form.buttons = buttons;\n      self.form.properties.virtual = true;\n      container.setNavigationButtons(self.form);\n    };\n\n    btnSearch.bind(\"click\", function () {\n      // The Grid only support one row per page in smartphone (DRAGON-41733 / QAF-3916)\n      self.searchParams.maxRows = 1;\n      self.currentSearchForm.performSearch(self.searchParams);\n    });\n\n    btnAdd.bind(\"click\", function () {\n      var params = {\n        \"idCase\": self.searchFormParams.idCase,\n        \"idRender\": self.properties.idRender,\n        \"displayName\": self.properties.displayName,\n        \"idPageCache\": self.properties.idPageCache };\n\n\n      self.renderAddForm(params);\n    });\n\n    btnCancel.bind(\"click\", function () {\n      self.searchFormDeferred.reject();\n      container.destroy();\n    });\n\n    btnSelect.bind(\"click\", function () {\n      self.searchFormDeferred.resolve(container.element.find(\".bz-container__search-results [data-key]\").data(\"business-key\"));\n      container.destroy();\n    });\n\n    self.currentSearchForm.bind(\"instancerefreshdone\", function () {\n      // Show search results container\n      if (self.currentSearchForm.resultsGrid.properties.data !== null &&\n      !$.isEmptyObject(self.currentSearchForm.resultsGrid.properties.data.rows) &&\n      self.currentSearchForm.resultsGrid.properties.data.rows.length > 0)\n      {\n        setResultState();\n      } else {\n        setSearchState();\n      }\n    });\n\n    setSearchState();\n  },\n\n  handleSearchFormZindex: function handleSearchFormZindex(option) {\n    // If there is an open modal, change z-index to make searchForm visible\n    var modalViewDisplayed = $.grep($(\".km-modalview-root\"), function (n, i) {\n      return $(n).css(\"display\") === \"block\";\n    });\n\n    if (modalViewDisplayed.length > 0) {\n      var index = option === \"show\" ? 0 : 10001;\n      $(modalViewDisplayed).css(\"z-index\", index);\n    }\n  },\n\n  /**\r\n      * Idle timer expired exception\r\n      * @param error\r\n      * @returns {boolean}\r\n      */\n  hasSessionFormException: function hasSessionFormException(error) {\n    return typeof error !== \"undefined\" && error.code === \"AUTH_ERROR\";\n  },\n\n  /**\r\n      * Navigate to main page\r\n      * @param error\r\n      */\n  goToStartPage: function goToStartPage(error) {\n    if (this.searchFormParams.navigation) {\n      this.searchFormParams.navigation.goToStartPage(error);\n    }\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi smartphone Render list Extension\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Bizagi UI Forms\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will redefine the list render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.list\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.list.extend(\"bizagi.rendering.smartphone.list\", bizagi.rendering.list.prototype);\n// Extends itself\nbizagi.rendering.smartphone.list.extend(\"bizagi.rendering.smartphone.list\", {}, {\n\n  /*\r\n                                                                                  *   Template method to implement in each children to customize each control\r\n                                                                                  */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"list\");\n\n    return $.fasttmpl(template, {\n      editable: this.properties.editable,\n      value: this.getDisplayValue() });\n\n\n  },\n\n  /**\r\n      * Add event handlers to the combo control\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    if (self.getMode() !== \"execution\") {\n      return;\n    }\n\n    $(\".bz-form-list\", control).bind(\"click\", function () {\n\n      $(this).mobileView({\n        customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\n        displayName: self.properties.displayName || \"\",\n        orientation: self.properties.orientation || \"\",\n        contentTemplate: \"\",\n\n        close: function close() {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        },\n\n        open: function open() {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n\n        configureActions: function configureActions(context) {\n          var params = {};\n          if (self.isDependant && self.properties && /^cascadingcombo$/i.test(self.properties.type) && self.getParentCombo) {\n            var parentValue = self.getParentCombo().getValue();\n            if (parentValue && parentValue.id) {\n              params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue.id;\n            }\n          }\n\n          $.when(self.renderCombo(params)).done(function (list) {\n            $(\".bz-modal-view__content\", context.content).html(list);\n            self.configureModalViewHandlers(context);\n          });\n        } });\n\n    });\n\n  },\n\n  processComboData: function processComboData(data) {\n    var self = this;\n    data.forEach(function (value) {\n      self.validateValue(value);\n    });\n  },\n\n  /**\r\n      * Setting the display value, always you call a setDisplayValue yor are performinng a setValue under the hood.\r\n      * */\n  setDisplayValue: function setDisplayValue(value) {\n    var comboValue;\n    value = this.mapValue(value);\n\n    if (value && _typeof(value) === \"object\" && typeof value.label !== \"undefined\") {\n\n      if (value.label !== \"\" && !bizagi.util.isNumeric(value.label)) {\n        comboValue = value.label;\n      } else {\n        var selected = this.findDataValueById(value.value);\n        comboValue = selected ? selected.value : \"\";\n      }\n\n      if ($.isArray(comboValue)) {\n        comboValue = comboValue.join(\" - \");\n      }\n      value = { \"id\": value.id, \"value\": comboValue };\n    }\n\n    var control = this.getControl();\n    $(\"input\", control).val(this.formatItem(value.value));\n\n    //Set Value\n    this.selectedValue = value;\n    this.setValue(value);\n  },\n\n  /**\r\n      * Set the handlers for the modal elements\r\n      * @param {kendoModalObject} context full modal object\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(context) {\n    var self = this;\n\n    $(\".bz-list__item\", context.content).on(\"click\", function () {\n      var valueObjet = {\n        \"id\": $(this).data(\"value\"),\n        \"value\": $(this).text() };\n\n\n      if (valueObjet.id == \"\") {\n        valueObjet.value = \"\";\n      }\n\n      self.setDisplayValue(valueObjet);\n      self.trigger(\"select\", [valueObjet, false]);\n      context.close();\n    });\n\n    var $elementsList = $(\".bz-list li\", context.content);\n    var $clearButton = $(\".bz-modal-view__clear\", context.header);\n    var $searchInput = $(\".bz-modal-view__search\", context.header);\n\n    $(\"[data-action=close]\", context.header).bind(\"click\", function () {\n      context.close();\n    });\n\n    $clearButton.bind(\"click\", function () {\n      $searchInput.val(\"\").trigger(\"change\");\n    });\n    // Filtering list\n    $searchInput.bind(\"change keyup\", function () {\n      if (this.value == \"\") {\n        $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n      } else {\n        $clearButton.addClass(\"bz-modal-view__clear--visible\");\n      }\n      self.filterList(this.value, $elementsList);\n    }).focus();\n  },\n\n  /**\r\n      * Filtering list of elements\r\n      * @returns {}\r\n      */\n  filterList: function filterList(search, $li) {\n\n    $li.filter(function () {\n      var stringContainer = $(this).text().toUpperCase();\n      var stringToSearch = search.toUpperCase();\n\n      if (stringContainer.indexOf(stringToSearch) >= 0) {\n        return $(this);\n      } else {\n        $(this).hide();\n      }\n    }).show();\n  },\n\n  /**\r\n      * Print the list of elements to show in the modal\r\n      * @param {object} data list of elements to print\r\n      */\n  renderComboTemplate: function renderComboTemplate(data) {\n    var template = this.renderFactory.getTemplate(\"list-items\");\n    var value = this.getValue();\n    value = value !== null && typeof value !== \"undefined\" ? value : { \"id\": \"\", \"value\": \"\" };\n\n    return $.fasttmpl(template, {\n      \"items\": data,\n      \"selectedId\": value.id,\n      \"hasItems\": data.length > 0 },\n    {\n      \"validateItem\": this.validateValue });\n\n  },\n\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Render option select\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: UI Forms Team\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   Renders an option html input with attached handlers\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.combo\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.combo.extend(\"bizagi.rendering.smartphone.combo\", {}, {\n\n  /*\r\n                                                                                    *   Template method to implement in each children to customize each control\r\n                                                                                    */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"combo\");\n\n    return $.fasttmpl(template, {\n      editable: this.properties.editable,\n      value: this.getDisplayValue() });\n\n\n  },\n\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this._super();\n\n    this.combo = $control.find(\"input\");\n    this.itemSelected = undefined;\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.combo = $control.find(\"input\");\n  },\n\n  /**\r\n      * Add event handlers to the combo control\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    if (self.getMode() !== \"execution\") {\n      return;\n    }\n\n    $(\".bz-form-combo\", control).bind(\"click\", function () {\n\n      $(this).mobileView({\n        customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {\n          hideSearch: self.properties.enableTyping === false }),\n\n        displayName: self.properties.displayName || \"\",\n        orientation: self.properties.orientation || \"\",\n        contentTemplate: \"\",\n\n        close: function close() {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        },\n\n        open: function open() {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n\n        configureActions: function configureActions(modalView) {\n          var params = {};\n\n          if (self.isDependant && self.properties && /cascadingcombo/i.test(self.properties.type) && self.getParentCombo) {\n            var parentValue = self.getParentCombo().getValue();\n            if (parentValue && parentValue.id) {\n              params[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parent\"] = parentValue.id;\n            }\n          }\n\n          $.when(self.renderCombo(params)).done(function (list) {\n            $(\".bz-modal-view__content\", modalView.content).html(list);\n            self.configureModalViewHandlers(modalView);\n          });\n        } });\n\n    });\n\n  },\n\n  processComboData: function processComboData(data) {\n    var self = this;\n    data.forEach(function (value) {\n      self.validateValue(value);\n    });\n  },\n\n  /**\r\n      * Setting the display value, always you call a setDisplayValue yor are performing a setValue under the hood.\r\n      * */\n  setDisplayValue: function setDisplayValue(value) {\n    var comboValue = \"\";\n\n    value = this.mapValue(value);\n\n    if (value && _typeof(value) === \"object\" && typeof value.label !== \"undefined\") {\n\n      if (!bizagi.util.isEmpty(value.label)) {\n        comboValue = value.label;\n      } else {\n        var selected = this.findDataValueById(value.id);\n        comboValue = selected ? selected.value : \"\";\n      }\n\n      if ($.isArray(comboValue)) {\n        comboValue = comboValue.join(\" - \");\n      }\n\n      value = { \"id\": value.id, \"value\": comboValue };\n    }\n\n    if (this.properties.editable) {\n      this.combo.val(this.formatItem(value.value));\n    } else {\n      var control = this.getControl();\n      $(control).html(this.formatItem(value.value));\n    }\n\n    //Set Value\n    this.selectedValue = value;\n    this.setValue(value);\n  },\n\n  /**\r\n      * Set the handlers for the modal elements\r\n      * @param modalView full modal object\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n\n    $(\".bz-list__item\", modalView.content).on(\"click\", function () {\n      var valueObjet = {\n        \"id\": $(this).data(\"value\"),\n        \"value\": $(this).text() };\n\n\n      if (valueObjet.id == \"\") {\n        valueObjet.value = \"\";\n      }\n\n      self.itemSelected = true; //must be before the setDisplayValue\n      self.setDisplayValue(valueObjet);\n      self.trigger(\"select\", [valueObjet, false]);\n      modalView.close();\n    });\n\n    $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\n      modalView.close();\n    });\n\n    if (this.properties.enableTyping) {\n\n      var $elementsList = $(\".bz-list li\", modalView.content);\n      var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\n      var $searchInput = $(\".bz-modal-view__search\", modalView.header);\n\n      $clearButton.bind(\"click\", function () {\n        $searchInput.val(\"\").trigger(\"change\");\n      });\n      // Filtering list\n      $searchInput.on(\"change keyup\", function () {\n        if (this.value == \"\") {\n          $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n        } else {\n          $clearButton.addClass(\"bz-modal-view__clear--visible\");\n        }\n        self.filterList(this.value, $elementsList);\n      }).on(\"focus\", function () {\n        modalView.header.addClass(\"bz-modal-view__header--active\");\n      }).on(\"blur\", function () {\n        modalView.header.removeClass(\"bz-modal-view__header--active\");\n      });\n\n    }\n  },\n\n  cleanData: function cleanData() {\n    var value = { id: \"\", value: \"\" };\n    //Set Value\n    this.value = this.properties.value = this.selectedValue = value;\n    var control = this.getControl();\n    $(\"input\", control).val(this.formatItem(value.value));\n  },\n\n  /**\r\n      * Filtering list of elements\r\n      * @returns {}\r\n      */\n  filterList: function filterList(search, $li) {\n\n    $li.filter(function () {\n      var stringContainer = $(this).text().toUpperCase();\n      var stringToSearch = search.toUpperCase();\n\n      if (stringContainer.indexOf(stringToSearch) >= 0) {\n        return $(this);\n      } else {\n        $(this).hide();\n      }\n    }).show();\n  },\n\n  /**\r\n      * Print the list of elements to show in the modal\r\n      * @param {object} data list of elements to print\r\n      */\n  renderComboTemplate: function renderComboTemplate(data) {\n    var template = this.renderFactory.getTemplate(\"combo-list\");\n    var value = this.getValue();\n    value = value !== null && typeof value !== \"undefined\" ? value : { \"id\": \"\", \"value\": \"\" };\n\n    return $.fasttmpl(template, {\n      \"items\": data,\n      \"selectedId\": value.id,\n      \"hasItems\": data.length > 0 },\n    {\n      \"validateItem\": this.validateValue });\n\n  },\n\n  /**\r\n      * Returns the selected value in the template\r\n      * @returns {{id: *, value: *}}\r\n      */\n  getSelectedValue: function getSelectedValue() {\n    return this.selectedValue;\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\n  } });","var _bizagi$rendering$sma;function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;} /**\r\n                                                                                                                                                                                                                                      *   Name: Bizagi Smartphone Render Grid Extension\r\n                                                                                                                                                                                                                                      *   Author: UI Forms Team\r\n                                                                                                                                                                                                                                      *   Comments:\r\n                                                                                                                                                                                                                                      *   -   This script will redefine the grid render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                      */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.grid\", bizagi.rendering.grid.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid\", {}, (_bizagi$rendering$sma = {\n\n  init: function init(params) {\n    var self = this;\n    var data = params.data;\n\n    //support multiples instances of decorates objects   the object in false means \n    //enable the decorated is an array and so can save several renderings\n    data.properties.singleInstance = false;\n\n    data.properties.rowsPerPage = 1;\n    data.properties.displayType = \"vertical\";\n\n    // Call base\n    self._super(params);\n\n    // Create a data-structure to keep track of each cell properties\n    this.cellMetadata = {};\n\n    // Fill default properties\n    var properties = this.properties;\n\n    // Just apply display-type: vertical, align it to the left\n    properties.displayType = \"vertical\";\n    properties.rowsPerPage = 1;\n\n    //revisar base para mejorar comportamiento cuando esta en false los elementos\n    $.each(self.columns, function (index, value) {\n      // Enable to apply edit and next send request\n      if (this.properties && this.properties.editable)\n      this.properties.editable = properties.allowEdit == true ? true : false;\n    });\n\n    // Just for smartphones we need to take only one row if there is data in the json,\n    // because we use just one row per page\n    if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\n      var newData = [];\n      newData.push(properties.data.rows[0]);\n      properties.data.rows = newData;\n    }\n  },\n\n  /* method overrides\r\n     *  from base or virtual\r\n     */\n  setDisplayValue: function setDisplayValue(value) {\n  },\n\n  setDisplayValueEdit: function setDisplayValueEdit(value) {\n  },\n\n  actionSave: function actionSave() {\n  },\n\n  /*\r\n     * Updates manually the affected cell \r\n     */\n  updateAffectedCellManually: function updateAffectedCellManually() {\n  },\n\n  /*\r\n     * Get the row index using the key as a reference\r\n     */\n  getRowIndexByKey: function getRowIndexByKey() {\n  },\n\n  /**\r\n      *  Shows more info about a grid row\r\n      * in smartphones not implemented\r\n      */\n  showMore: function showMore(id) {\n  },\n\n  postRender: function postRender() {\n    var self = this;\n\n    // Call base \n    self._super();\n\n    var properties = self.properties;\n    properties.rowsPerPage = 1;\n\n    self.getLabel().hide();\n    var control = self.getControl();\n    var grid = self.grid = $(\".bz-mobile-grid\", control);\n\n    var mode = self.getMode();\n    var columns = self.buildColumnModel();\n\n    var columnsTotalizers = jQuery.grep(columns, function (a) {\n      return a.summarizeBy;\n    });\n\n    grid.bizagi_grid_smartphone({\n      columns: columns,\n      title: properties.displayName,\n      mode: self.getMode(),\n      template: {\n        grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\n        waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\n        table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\n        emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\n        column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\n        specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\n        row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\n        rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\n        cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\n        specialCell: self.renderFactory.getTemplate(\"bizagi.grid.cell.special\"),\n        pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\n        buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\") },\n\n      actions: {\n        add: properties.allowAdd,\n        edit: properties.allowEdit && properties.withEditForm,\n        details: properties.allowDetail,\n        remove: properties.allowDelete,\n        inlineAdd: properties.inlineAdd,\n        allowMore: false,\n        totalizer: properties.showSummary,\n        hasTotalizer: columnsTotalizers.length > 0 && properties.data.rows.length > 0 ? true : false },\n\n\n      pageRequested: function pageRequested(ui) {\n        if (mode != \"execution\") return;\n\n        self.submitGridData().then(function () {\n          self.onPageRequested(ui);\n        });\n      },\n      sortRequested: function sortRequested(ui) {\n        if (mode != \"execution\") return;\n        self.fetchData(ui.page, ui.sortBy, ui.sortType);\n      },\n      isValid: function isValid(invalidElements) {\n        return self.isValidGrid(invalidElements);\n      },\n      drawCell: function drawCell(ui) {\n        return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\n      },\n      cellReady: function cellReady(ui) {\n        return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\n      },\n      rowSelected: function rowSelected(ui) {\n        //self.triggerHandler(\"rowSelected\", { id: ui.key });\n      },\n      totalData: function totalData(ui) {\n        if (mode != \"execution\") return;\n\n        self.onTotalData();\n      },\n      gridControlReady: function gridControlReady() {\n        self.processLayout(isLabelFormat, self.properties.textFormat || {});\n        self.processLayout(!isLabelFormat, self.properties.valueFormat || {});\n      },\n      addRow: function addRow(ui) {\n        if (mode != \"execution\") return;\n        self.grantPerformAction(\"addRow\", function () {\n          if (self.properties.subType == \"adhocGrid\" || self.properties.inlineAdd) {\n            self.addVirtualRow();\n          } else {\n            self.addRow();\n          }\n        });\n      },\n      editRow: function editRow(ui) {\n        if (mode != \"execution\") return;\n        if (self.properties.subType == \"adhocGrid\") {\n          self.editVirtualRow(ui.key);\n        } else {\n          self.editRow(ui.key);\n        }\n      },\n      deleteRow: function deleteRow(ui) {\n        if (mode != \"execution\") return;\n        self.deleteRow(ui.key);\n      },\n      showFormDetails: function showFormDetails(ui) {\n        self.showDetailForm(ui.key);\n      },\n      showMore: function showMore(ui) {\n        self.showMore(ui.key);\n      } });\n\n\n    // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\n    if (properties.data && properties.data.rows && properties.data.rows.length > 1) {\n      var newData = [];\n      newData.push(properties.data.rows[0]);\n      properties.data.rows = newData;\n    }\n\n    properties.skipInitialLoad = properties.skipInitialLoad || false;\n    // Set initial data\n    if (!properties.skipInitialLoad) {\n      if (properties.data) {\n        if (properties.data === \"\" || properties.data.rows.length === 0 && properties.data.page > 1) {\n          self.fetchData(undefined, properties.sortBy, properties.sortOrder);\n        } else {\n          self.updateData(properties.data);\n\n          // Trigger change in order to start up the actions when the controls is ready\n          $.when(self.ready()).\n          done(function () {\n            self.triggerRenderChange({ changed: false });\n          });\n        }\n\n      } else {\n        self.fetchData(properties.page, properties.sortBy, properties.sortOrder);\n      }\n    }\n\n  },\n\n  /*\r\n     *   Method to render non editable values\r\n     */\n  postRenderReadOnly: function postRenderReadOnly() {\n    // Do the same as the post-render\n    this.postRender();\n  },\n\n  changeBackgroundColor: function changeBackgroundColor(color) {\n    var self = this;\n    var control = self.getControl();\n\n    if (control) {\n      $(\".bz-mobile-grid\", control).css(\"background-color\", color !== 'none' ? color : \"\");\n    }\n\n    return this;\n  },\n\n  setHeaderStyles: function setHeaderStyles(cell) {\n    var self = this;\n    var label_style = \"font-weight: bold; \";\n    var properties = self.properties;\n\n    if (properties.headerFormat) {\n      var format = properties.headerFormat;\n\n      if (typeof format.bold !== \"undefined\") {\n        label_style = \"font-weight: normal; \";\n      }\n\n      if (format.color) {\n        label_style += \"color: \" + format.color + \";\";\n      }\n\n      if (format.background) {\n        label_style += \"background-color: \" + format.background + \";\";\n      }\n\n      if (format.italic) {\n        label_style += \"font-style: italic; \";\n      }\n\n      if (format.underline || format.strikethru) {\n        var strikethru = bizagi.util.parseBoolean(format.strikethru) ? \"line-through \" : \"\";\n        var underline = bizagi.util.parseBoolean(format.underline) ? \"underline \" : \"\";\n\n        label_style += \"text-decoration: \" + strikethru + underline + \";\";\n      }\n\n      if (format.size && format.size != \"0\") {\n        var newFontSize = 100 + Number(format.size) * 10 + \"%\";\n        label_style += \"font-size: \" + newFontSize + \";\";\n      }\n    }\n    return cell.replace(\"%labelStyle%\", label_style);\n  },\n\n  onTotalData: function onTotalData(ui) {\n    var self = this;\n    var containerForm = self.getFormContainer();\n    containerForm.saveForm();\n\n    //defered que retorne la respuesta del servidor\n    bizagi.loading.start();\n    $.when(self.fetchTotalData()).done(function (data) {\n      var rows = data.rows;\n\n      //calcula los totalizadores y crea el html\n      var showTotal = [];\n\n      var columnsModel = self.buildColumnModel();\n      var result;\n\n      var operationState;\n\n      columnsModel.forEach(function callback(column, columnIndex) {\n        if (column.bizAgiProperties) {\n          operationState = column.bizAgiProperties.totalize.operation;\n\n          switch (operationState) {\n            case \"sum\":\n              result = rows.sum(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n              break;\n\n            case \"count\":\n              result = rows.count(function (row) {\n                //Checks if there is a DefaultValue, so assign it to the returnedvalu in case it doesn't have value\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n\n                if (!bizagi.util.isArray(return_value)) {\n                  return return_value;\n                }\n\n                if (bizagi.util.isArray(return_value) && return_value.length > 0) {\n                  return return_value; //If the returned value is not undefined, neither null, it will count +1\n                }\n              }, column, columnIndex);\n\n              break;\n\n            case \"max\":\n              result = rows.max(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n\n              break;\n\n            case \"min\":\n              result = rows.min(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n              break;\n\n            case \"avg\":\n              result = rows.avg(function (row) {\n                var return_value = row[columnIndex] !== null ? row[columnIndex] : column.bizAgiProperties.defaultvalue;\n                return Number(return_value);\n              }, columnIndex);\n\n              result = result.toFixed(2);\n              break;}\n\n\n          if (operationState) {\n            var dataType = bizagi.util.normalizeType(column.bizAgiProperties.type);\n            result = self.formatTotalizedResult(operationState, dataType, result);\n            showTotal.push({ label: column.label, total: result });\n          }\n        }\n      });\n\n      self.showTotals(showTotal);\n    }).fail(function (error) {\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-no-records\"), \"Error\");\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /*\r\n      * Fetch Sum Data\r\n      */\n  fetchTotalData: function fetchTotalData(params) {\n    var self = this;\n    var properties = self.properties;\n\n    params = params || {};\n    $.extend(params, {\n      url: properties.dataUrl,\n      xpath: properties.xpath,\n      idRender: properties.id,\n      xpathContext: properties.xpathContext,\n      contexttype: properties.contextType,\n      idPageCache: properties.idPageCache,\n      sort: properties.sort,\n      page: 1,\n      rows: self.properties.data.records,\n      searchFilter: properties.searchFilter });\n\n\n    // Check if a custom method has been given\n    if (properties.overrideGetRemoteData) {\n      var result = properties.overrideGetRemoteData(params);\n      return result != null ? result.promise() : null;\n    }\n\n    // Default ajax call\n    var defer = new $.Deferred();\n\n    // Resolve with remote data\n    self.dataService.multiaction().getGridData(params).done(function (data) {\n      // Check RTL\n      if (self.isRTL()) {\n        data.rows = self.changeOrderData(data.rows);\n      }\n\n      defer.resolve(data);\n    }).fail(function (fail) {\n\n      defer.reject(fail);\n    });\n\n    return defer.promise();\n  },\n\n  formatTotalizedResult: function formatTotalizedResult(operation, controlType, value) {\n    switch (operation) {\n      case 'sum':\n      case 'avg':\n      case 'min':\n      case 'max':\n        if (/columnMoney/i.test(controlType) || /money/i.test(controlType)) {\n          return bizagi.util.formatMonetaryCell(value);\n        }\n        break;}\n\n\n    return value || 0;\n  },\n\n  showTotals: function showTotals(params) {\n    var self = this;\n    var content = $.fasttmpl(self.renderFactory.getTemplate('bizagi.grid.totalizer'), { items: params });\n\n    self.grid.mobileView({\n      displayName: bizagi.localization.getResource(\"render-grid-totalizer\"),\n      orientation: self.properties.orientation,\n      style: \"width: 90%; height: 70%\",\n      transition: \"fade:in\",\n      cssClass: \"bz-modal-view--totalizer\",\n      showBorder: true,\n      contentTemplate: content });\n\n  },\n\n  buildColumnModel: function buildColumnModel() {\n    var self = this;\n    var columns = self.columns;\n\n    // Create id column first\n    var keyColumn = {\n      name: \"id\",\n      index: 0,\n      label: \"id\",\n      hidden: true,\n      align: \"\",\n      key: true };\n\n\n    // Add to column model\n    var columnModel = [];\n    columnModel.push(keyColumn);\n\n    $.each(columns, function (index, column) {\n      // Set grid column\n      column.columnIndex = index + 1;\n\n      var dataType = bizagi.util.normalizeType(column.properties.type);\n      var columnLabel = !bizagi.util.isEmpty(column.properties.displayName) ? column.properties.displayName : \" \";\n      var gridColumn = {\n        name: column.properties.xpath,\n        index: index + 1,\n        label: columnLabel,\n        key: false,\n        hidden: !column.properties.visible || /columnHidden/i.test(dataType) || column.properties.columnVisible === false,\n        summarizeBy: column.properties.totalize && column.properties.totalize.operation ? column.properties.totalize.operation : undefined,\n        bizAgiProperties: column.properties };\n\n      columnModel.push(gridColumn);\n    });\n\n    return columnModel;\n  },\n\n  /**\r\n      * Makes the grid to refresh\r\n      */\n  refresh: function refresh() {\n    return $.when(this.fetchData());\n  },\n\n  /*\r\n     *   Holds the execution until the grid data is ready after a load operation\r\n     */\n  dataReady: function dataReady() {\n    return this.dataReadyDeferred != null ? this.dataReadyDeferred.promise() : null;\n  },\n\n  /*\r\n     *   Method to set data and update the grid\r\n     */\n  updateData: function updateData(data) {\n    var self = this;\n    var columns = self.columns;\n\n    // Set value in control\n    if (data && self.properties) {\n      self.properties.data = data;\n      self.setCellOverrides(data, columns);\n\n      self.triggerGridPluginHandler(\"setData\", data);\n    }\n  },\n\n  /*\r\n     *   Method to fetch data from the server and then update the data\r\n     */\n  fetchData: function fetchData(page, sortBy, sortType) {\n    var self = this;\n    var properties = self.properties;\n\n    // Define defaults\n    page = page || 1;\n    sortBy = sortBy || \"\";\n    sortType = sortType || \"asc\";\n\n    // Update control properties\n    properties.page = page;\n    properties.sort = sortBy + \" \" + sortType;\n\n    bizagi.loading.start();\n\n    return $.when(self.getRemoteData()).\n    then(function (data) {\n\n      if (data) {\n        $.when(self.updateData(data)).done(function () {\n          self.triggerRenderChange({ changed: false });\n        });\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    var grid = self.grid;\n\n    // Remove changes for inline added rows\n    if (grid && self.properties.inlineAdd) {\n      var omitKeys = grid.bizagi_grid_smartphone.hasOwnProperty(\"getNewRowKeys\") ? grid.bizagi_grid_smartphone(\"getNewRowKeys\") : [];\n      for (var i = 0, length = omitKeys.length; i < length; i++) {\n        if (self.changes[omitKeys[i]]) {\n          delete self.changes[omitKeys[i]];\n        }\n      }\n    }\n\n    self._super(renderValues);\n  },\n\n  onPageRequested: function onPageRequested(ui) {\n    var self = this;\n    var properties = self.properties;\n    var data = {};\n\n    if (!jQuery.isEmptyObject(data)) {\n\n      self.dataService.submitData({\n        action: \"SUBMITDATA\",\n        data: data,\n        idRender: properties.id,\n        xpath: properties.xpath,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache });\n\n\n    }\n\n    self.fetchData(ui.page, ui.sortBy, ui.sortType);\n  },\n\n  /*\r\n     *   Customizes the content drawing inside the cell\r\n     */\n  drawCell: function drawCell(column, key, value, isNewRow) {\n    //revisar ya que en las demas implementacion en desktop y tablet utilizan una validacion para edicion en linea o no\n    var self = this;\n\n    if (column.key) return value;\n\n    // Get render column\n    var columnIndex = column.index - 1;\n    var cellOverride = self.getCellOverride(key, columnIndex);\n    var renderColumn = self.columns[columnIndex];\n\n    // Data with null records\n    self.newRecords = {};\n\n    // Get cell properties\n    if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\n    if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\n\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.properties;\n    properties.editable = bizagi.util.parseBoolean(properties.editable) || false;\n    var visible = properties.visible !== undefined ? properties.visible : true;\n    var editable = properties.editable !== undefined ? properties.editable : true;\n\n    // Apply overrides from cellOverrides\n    visible = cellOverride.visible;\n    editable = properties.editable ? cellOverride.editable : false;\n\n    renderColumn.properties.displayType = 'value';\n\n    // Show editable cell when we are performing inline add operation\n    if (isNewRow) editable = true;\n\n    //TODO: validar despus que sucede si se adiciona a la base para todos los dispositivos\n\n    // Set the value of labelAlign and valueAlign to use the rendering in the base\n    renderColumn.properties.labelAlign = \"default\";\n    if (renderColumn.properties.columntitlealign) {\n      renderColumn.properties.labelAlign = renderColumn.properties.columntitlealign;\n    }\n\n    renderColumn.properties.valueAlign = \"default\";\n    if (renderColumn.properties.columnAlign) {\n      renderColumn.properties.valueAlign = renderColumn.properties.columnAlign;\n    }\n\n    var cell = \"\";\n    if (editable) {\n      cell = self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\n    } else {\n      cell = self.drawReadonlyCell(renderColumn, properties, key, value);\n    }\n    return visible ? cell : \"\";\n\n  },\n\n  /**\r\n      * Draws the editable version for the cell\r\n      * @param renderColumn\r\n      * @param properties\r\n      * @param key\r\n      * @param value\r\n      * @param isNewRow\r\n      */\n  drawEditableCell: function drawEditableCell(renderColumn, properties, key, value, isNewRow) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(renderColumn.render(key, value)).done(function (cell) {\n      // Register array with new records\n      if (isNewRow && !self.newRecords[key]) {\n        self.newRecords[key] = {};\n      }\n\n      (self.columns || []).forEach(function (item, index) {\n        var visible = true;\n        self.cellOverrides[key] = self.cellOverrides[key] || {};\n\n        if (typeof self.getCellOverride(key, index).visible !== \"undefined\") {\n          visible = self.getCellOverride(key, index).visible;\n        }\n\n        self.getCellOverride(key, index).visible = visible;\n      });\n\n      self.bindRenderChange(renderColumn, key, true);\n\n      defer.resolve(cell);\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * Draws the readonly version for the cell\r\n      * @param renderColumn\r\n      * @param properties\r\n      * @param key\r\n      * @param value\r\n      */\n  drawReadonlyCell: function drawReadonlyCell(renderColumn, properties, key, value) {\n    var self = this;\n\n    return $.when(renderColumn.renderReadOnly(key, value)).then(function (cell) {\n\n      if (cell && $(cell).css(\"display\") !== \"none\") {\n        var item = $(cell);\n\n        if (typeof self.properties.textFormat !== \"undefined\") {\n\n          if (typeof self.properties.textFormat.color !== \"undefined\") {\n            $('label', item).css('color', self.properties.textFormat.color);\n          }\n\n          if (typeof self.properties.textFormat.size !== \"undefined\" && self.properties.textFormat.size > 0) {\n            var newFontSize = 100 + Number(self.properties.textFormat.size) * 10 + \"%\";\n            $('label', item).css('font-size', newFontSize);\n          }\n        }\n        // TODO: Review template cell.readonly\n        cell = item && item[0] ? item[0].outerHTML : cell;\n      }\n\n      return cell || \"\";\n    });\n  },\n\n  /*\r\n     *   Executes when the cell is ready and inserted into the DOM\r\n     */\n  onCellReady: function onCellReady(column, key, cell, isNewRow) {\n    var self = this;\n\n    // Get render column\n    var columnIndex = column.index - 1;\n    var cellOverride = self.getCellOverride(key, columnIndex);\n    var renderColumn = self.columns[columnIndex];\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.properties;\n    var visible = properties.visible !== undefined ? properties.visible : true;\n    var editable = properties.editable !== undefined ? properties.editable : true;\n\n    // Apply overrides from cellOverrides\n    visible = cellOverride.visible;\n    editable = properties.editable ? cellOverride.editable : false;\n\n    $(\".bz-rn-messages\", cell).toggleClass(\"bz-rn-messages\", \"bz-rn-messages-grid\");\n\n    // If the cell we are drawing is the summary cell, we need to make it readonly\n    if (key === \"summary\") editable = false;\n\n    // Show editable cell when we are performing inline add operation\n    if (isNewRow) editable = true;\n\n    if (visible) {\n      if (editable) {\n        // Set editable\n        var originalEditable = renderColumn.properties.editable;\n        renderColumn.properties.editable = editable;\n\n        // Set xpath context for submitonchange action\n        if (renderColumn.properties.submitOnChange) {\n          var control = renderColumn.getDecorated(key);\n          if (control) {\n            control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\n          }\n        }\n\n        // Execute cell post render\n        renderColumn.postRender(key, cell);\n\n        // Restore editable\n        renderColumn.properties.editable = originalEditable;\n      } else {\n\n        if (renderColumn.properties.submitOnChange) {\n          var control = renderColumn.getDecorated(key);\n\n          if (control) {\n            control.properties.submitOnChangexpathContext = self.properties.xpath + \"[]\";\n          }\n        }\n\n        renderColumn.postRender(key, cell);\n      }\n    }\n  },\n\n  /**\r\n      *  Adds a row to the grid\r\n      */\n  addRow: function addRow() {\n    var self = this;\n    var properties = self.properties;\n    var container = self.getFormContainer().container;\n    var dataservice = self.dataService;\n\n    bizagi.loading.start();\n\n    $.when(self.submitAddRequest()).\n    done(function (newid) {\n      var recordXpath = properties.xpath + \"[id=\" + newid + \"]\";\n      var propertiesGridForm = {\n        idRender: properties.id,\n        \"recordXPath\": recordXpath,\n        url: properties.addPage,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache,\n        xpath: recordXpath,\n        editable: true,\n        requestedForm: \"addForm\",\n        displayName: properties.addLabel,\n        idAsigned: newid,\n        enableEditSubmitRequest: false,\n        hideLabel: true,\n        disableProcessButons: true,\n        hasExclusiveCheck: properties.hasExclusiveCheck };\n\n\n      var argumentsfl = {\n        \"renderFactory\": self.renderFactory,\n        \"dataService\": dataservice,\n        \"parent\": self,\n        \"data\": {\n          properties: propertiesGridForm } };\n\n\n\n      var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\n      jQuery.extend(formlink, {\n        contextEdit: $(container).find(\".bz-container__item-edit\"),\n        element: self.element,\n        actionSave: self.actionSaveNewRow,\n        actionCancel: self.actionCancelRow,\n        _sendRelation: function _sendRelation() {\n          return true;\n        },\n        _getData: self.dataService.getFormData,\n        _params: propertiesGridForm,\n        addExclusiveChange: self.addExclusiveChange });\n\n\n      self._InternalRenderLinkForm(formlink);\n\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n  addVirtualRow: function addVirtualRow() {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var formParams = self.getFormParams();\n\n    // Create mock row\n    var currentRow = [\"mock_id\"];\n    self.columns.forEach(function () {\n      currentRow.push(null);\n    });\n\n    // Render grid view\n    var slideView = new bizagi.rendering.smartphone.slide.adhocForm(self.renderFactory, {\n      title: self.properties.displayName || \"\",\n      allowEdition: true,\n      navigation: formParams.navigation,\n      container: self.getFormContainer().container });\n\n\n    slideView.render({\n      row: currentRow,\n      columns: self.columns,\n      pageCacheId: properties.idPageCache,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      sessionId: form.properties.sessionId,\n      actions: form.actions }).\n    done(function (data) {\n      $.when(self.saveAddedRow(data)).done(function () {\n        //Update the grid again\n        if (!properties.submitOnChange) {\n          // Reload grid\n          self.fetchData();\n        } else {\n          // Submits the entire form\n          self.submitOnChange();\n        }\n      });\n    });\n  },\n\n  /*\r\n     *   Prepares the add action\r\n     */\n  saveAddedRow: function saveAddedRow(data) {\n    var self = this;\n    var properties = self.properties;\n\n    return self.dataService.multiaction().addGridRecordData({\n      url: properties.addUrl,\n      idRender: properties.id,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      contexttype: properties.contexttype,\n      idPageCache: properties.idPageCache,\n      submitData: data });\n\n  },\n\n  /**\r\n      * Edit form in the grid\r\n      * @param id\r\n      */\n  editRow: function editRow(id) {\n    var self = this;\n    var containerForm = self.getFormContainer();\n    var properties = self.properties;\n    var container = self.getFormContainer().container;\n    var dataservice = self.dataService;\n\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\n\n    bizagi.loading.start();\n    $.when(containerForm.saveForm()).done(function () {\n\n      var propertiesGridForm = {\n        idRender: properties.id,\n        id: properties.id,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache,\n        recordXPath: recordXpath,\n        xpath: recordXpath,\n        editable: true,\n        url: properties.editPage,\n        requestedForm: \"editForm\",\n        displayName: properties.editLabel,\n        idAsigned: id,\n        disableProcessButons: true,\n        hasExclusiveCheck: properties.hasExclusiveCheck };\n\n\n      var argumentsfl = {\n        \"renderFactory\": self.renderFactory,\n        \"dataService\": dataservice,\n        \"parent\": self,\n        \"data\": {\n          properties: propertiesGridForm } };\n\n\n\n      var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\n\n      jQuery.extend(formlink, {\n        contextEdit: $(container).find(\".bz-container__item-edit\"),\n        element: self.element,\n        //disable if you want only save at the end (submit the form)\n        actionSave: self.actionSaveNewRow,\n        actionCancel: self.actionCancelRow,\n        _sendRelation: formlink.submitEditRequest,\n        _getData: self.dataService.getFormData,\n        _params: propertiesGridForm,\n        addExclusiveChange: self.addExclusiveChange });\n\n\n      self._InternalRenderLinkForm(formlink);\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n  editVirtualRow: function editVirtualRow(id) {\n    var self = this;\n    var data = self.properties.data;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var formParams = self.getFormParams();\n\n    // Search row\n    var currentRow = [];\n    for (var i = 0, length = data.rows.length; i < length; i++) {\n      if (data.rows[i][0] == id) {\n        currentRow = data.rows[i];\n        break;\n      }\n    }\n\n    // Render grid view\n    var slideView = new bizagi.rendering.smartphone.slide.adhocForm(self.renderFactory, {\n      title: self.properties.displayName || \"\",\n      allowEdition: true,\n      navigation: formParams.navigation,\n      container: self.getFormContainer().container });\n\n\n    slideView.render({\n      row: currentRow,\n      columns: self.columns,\n      pageCacheId: properties.idPageCache,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      sessionId: form.properties.sessionId,\n      actions: form.actions }).\n    done(function (formData) {\n      // This code is executed when the user press save on the slide\n      // Update internal data\n      for (xpath in formData) {\n        self.collectGridChange({ id: id, xpath: xpath, value: formData[xpath], trigger: false });\n      }\n\n      // Prepare grid data\n      var dataToSend = {};\n      self.collectData(dataToSend);\n\n      // Send the data\n\n      self.dataService.submitData({\n        action: \"SUBMITONCHANGE\",\n        data: dataToSend,\n        idRender: properties.id,\n        xpath: properties.xpath,\n        xpathContext: properties.xpathContext,\n        idPageCache: properties.idPageCache }).\n      done(function () {\n        // After successfully response refresh the grid\n        self.fetchData();\n      });\n    });\n  },\n  _InternalRenderLinkForm: function _InternalRenderLinkForm(formlink) {\n    $.when(formlink.renderEdition()).done(function () {\n      formlink.endLoading();\n    });\n  },\n\n  /**\r\n      * Show details form\r\n      * @param id\r\n      */\n  showDetailForm: function showDetailForm(id) {\n    var self = this;\n    var properties = self.properties;\n    var container = self.getFormContainer().container;\n    var dataservice = self.dataService;\n\n    var recordXpath = properties.xpath + \"[id=\" + id + \"]\";\n\n    var propertiesGridForm = {\n      idRender: properties.id,\n      id: properties.id,\n      xpathContext: properties.xpathContext,\n      idPageCache: properties.idPageCache,\n      recordXPath: recordXpath,\n      xpath: recordXpath,\n      editable: false,\n      url: properties.editPage,\n      requestedForm: \"detailForm\",\n      displayName: properties.editLabel,\n      idAsigned: id,\n      disableProcessButons: true };\n\n\n    var argumentsfl = {\n      \"renderFactory\": self.renderFactory,\n      \"dataService\": dataservice,\n      \"parent\": self,\n      \"data\": {\n        properties: propertiesGridForm } };\n\n\n\n    var formlink = new bizagi.rendering.smartphone.formLink(argumentsfl);\n\n    jQuery.extend(formlink, {\n      contextEdit: $(container).find(\".bz-container__item-edit\"),\n      element: self.element,\n      _getData: self.dataService.getFormData,\n      _params: propertiesGridForm });\n\n\n    self._InternalRenderLinkForm(formlink);\n  },\n\n  /**\r\n      *  Deletes  a row to the grid\r\n      */\n  deleteRow: function deleteRow(id) {\n    var self = this;\n\n    bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).\n    done(function () {\n      // Do a grid record deletion\n      $.when(self.submitDeleteRequest(id)).\n      done(function (data) {\n        // Reload grid\n        self.fetchData();\n\n        if (data.type == \"success\") {\n          // Trigger the event\n          //'key' must be included to trigger a single call to actions and validations\n          //line 310 bizagi.command.controllers.action\n          self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\n        }\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      });\n    });\n  },\n\n  actionCancelRow: function actionCancelRow() {\n    var self = this;\n    var deferred = $.Deferred();\n\n    $.when(self.submitRollbackRequest()).done(function () {\n      deferred.resolve();\n    });\n\n    return deferred.promise();\n  },\n\n  /*\r\n      * Save data in the form link related\r\n      * parameter: data data collected in the related form link\r\n      */\n  actionSaveNewRow: function actionSaveNewRow(data) {\n    var self = this;\n    var deferred = $.Deferred();\n\n    if (self.form.validateForm() === true) {\n      var properties = self.properties;\n\n      if (!data) {\n        self.form.collectRenderValues(data);\n      }\n\n      data.idPageCache = self.form.getPageCache();\n\n      $.when(\n      self.parent.submitSaveRequest(properties.idAsigned, data)).done(function (resp) {\n        if (resp.type == \"validationMessages\") {\n          self.form.addValidationMessage(resp.messages);\n          properties.submitOnChange = false;\n          deferred.reject(resp.messages);\n        } else {\n          self.parent.fetchData();\n          if (!properties.submitOnChange) {\n            properties.submitOnChange = true;\n          }\n          self.submitOnChange({}, true);\n          deferred.resolve();\n        }\n      });\n    } else {\n      deferred.reject();\n    }\n\n    return deferred.promise();\n  },\n\n  applyActionUpdateGrid: function applyActionUpdateGrid(column, context) {\n    var self = context;\n    var properties = self.properties;\n    var originalMethod = column.decorated.actionSave;\n\n    jQuery.extend(column.decorated, {\n      actionSave: function actionSave() {\n        var selfIntern = this;\n        $.when(originalMethod.apply(selfIntern, arguments)).done(function () {\n          var data = {};\n          self.collectRenderValues(data);\n\n          $.when(self.submitSaveRequest(selfIntern.surrogateKey, data)).done(function () {\n            self.fetchData();\n          });\n        });\n      } });\n\n  },\n\n\n  collectRenderValues: function collectRenderValues(renderValues) {\n    var self = this;\n\n    $.each(self.columns, function (i, child) {\n\n      child = child.decorated;\n\n      if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_CONTAINER) {\n        // Go though container\n        child.collectRenderValues(renderValues);\n      } else if (child.getElementType() == bizagi.rendering.element.ELEMENT_TYPE_RENDER) {\n        // Check if the render can be sent to the server\n        if (child.canBeSent()) {\n          child.collectData(renderValues);\n        }\n      }\n    });\n  },\n\n  /*\r\n     *   Returns a promise that will resolve when the element is ready\r\n     */\n  ready: function ready() {\n    var self = this;\n    var parentPromise = self._super();\n    var inlineAddPromise = self.inlineAddDeferred ? self.inlineAddDeferred.promise() : null;\n\n    return $.when(parentPromise, inlineAddPromise);\n  },\n\n  /*   Sets an error on the cell\r\n     */\n  setError: function setError(key, xpath) {\n    var self = this;\n  },\n\n  /*\r\n     *  Changes the required for cell\r\n     */\n  changeCellValue: function changeCellValue(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n\n    if (control) {\n      if (argument != null) control.setDisplayValue(argument);\n\n      var renderColumn = control.column || {};\n      var _value = renderColumn.getValue(key);\n      var dataType = renderColumn.properties && renderColumn.properties.type;\n\n      self.collectGridChange({\n        id: key,\n        xpath: renderColumn.properties.xpath,\n        value: _value,\n        compositeValue: control.column.getCompositeValue(key),\n        columnIndex: control.columnIndex,\n        trigger: false,\n        dataType: dataType });\n\n    }\n  },\n  /*\r\n     *\r\n     */\n  changeCellBackgroundColor: function changeCellBackgroundColor(key, xpath, argument) {\n    var self = this,\n    control = self.getControlCell(key, xpath);\n\n    if (control) {\n      control.changeCellBackgroundColor(argument);\n\n      //Exclusive for complex elements such as checkboxes, and list\n      if (control.element) {\n        control.element.find(\".bz-container-render-cell1, .bz-control\").css({\n          \"background-color\": argument,\n          \"background-image\": argument });\n\n      }\n    }\n  },\n  /*\r\n     *   Changes the background for a cell\r\n     */\n  changeCellColor: function changeCellColor(key, xpath, argument) {\n    var self = this;\n\n    var control = self.getControlCell(key, xpath);\n    if (control)\n    control.changeCellColor(argument);\n\n  },\n  /*\r\n     *   Changes the visibility for a cell\r\n     */\n  changeCellVisibility: function changeCellVisibility(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n\n    if (control) {\n\n      control.changeCellVisibility(argument);\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).visible = argument;\n\n      // Bind/Unbind the render change, so it can works with actions and validations as needed\n      if (control.properties.editable && argument) {\n        self.bindRenderChange(self.getColumn(xpath), key, true);\n      } else {\n        self.bindRenderChange(self.getColumn(xpath), key, false);\n      }\n    }\n\n  },\n\n  /*\r\n     *   Changes the editability for a cell\r\n     */\n  changeCellEditability: function changeCellEditability(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n    if (control) {\n      control.changeEditability(argument);\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).editable = argument;\n\n      // Bind/Unbind the render change, so it can works with actions and validations as neededn\n      if (control.properties.visible && argument) {\n        self.bindRenderChange(self.getColumn(xpath), key, true);\n      } else {\n        self.bindRenderChange(self.getColumn(xpath), key, false);\n      }\n    }\n\n  },\n\n  /**\r\n      * Changes the required  for a cell\r\n      * @param key\r\n      * @param xpath\r\n      * @param argument\r\n      */\n  changeCellRequired: function changeCellRequired(key, xpath, argument) {\n    var self = this;\n    var control = self.getControlCell(key, xpath);\n\n    if (control) {\n      control.changeRequired(argument);\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).required = argument;\n\n      // Bind/Unbind the render change, so it can works with actions and validations as needed\n      if (control.properties.visible && argument) {\n        self.bindRenderChange(self.getColumn(xpath), key, true);\n      } else {\n        self.bindRenderChange(self.getColumn(xpath), key, false);\n      }\n    }\n\n  } }, _defineProperty(_bizagi$rendering$sma, \"changeCellRequired\",\n\n\n\n\nfunction changeCellRequired(key, xpath, argument) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    control.changeRequired(argument);\n    for (var j = 0, length = self.columns.length; j < length; j++) {\n      if (\n      self.columns[j].properties.xpath == xpath ||\n      self.columns[j].properties.id == xpath ||\n      self.columns[j].properties.xpath + \".\" + self.columns[j].properties.id == xpath)\n      {\n        break;\n      }\n    }\n\n    self.cellOverrides[key] = self.cellOverrides[key] || {};\n    self.getCellOverride(key, j).required = argument;\n\n    // Bind/Unbind the render change, so it can works with actions and validations as needed\n    if (control.properties.visible && argument) {\n      self.bindRenderChange(self.getColumn(xpath), key, true);\n    } else {\n      self.bindRenderChange(self.getColumn(xpath), key, false);\n    }\n  }\n\n}), _defineProperty(_bizagi$rendering$sma, \"changeCellMinValue\",\n\n\n\n\nfunction changeCellMinValue(key, xpath, argument) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    control.changeMinValue(argument);\n\n    var index = (self.columns || []).findIndex(function (cell) {\n      return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n    }) || 0;\n\n    self.cellOverrides[key] = self.cellOverrides[key] || {};\n    self.getCellOverride(key, index).minValue = argument;\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"changeCellMaxValue\",\n\n\n\n\nfunction changeCellMaxValue(key, xpath, argument) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    control.changeMaxValue(argument);\n    var index = (self.columns || []).findIndex(function (cell) {\n      return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n    }) || 0;\n\n    self.cellOverrides[key] = self.cellOverrides[key] || {};\n    self.getCellOverride(key, index).maxValue = argument;\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"cleanCellData\",\n\nfunction cleanCellData(key, xpath) {\n  var self = this;\n  var control = self.getControlCell(key, xpath);\n\n  if (control) {\n    return $.when(control.cleanData()).then(function (emptyValue) {\n      //Not all empty values are \"\" or [], the best approach is to get the value from the control\n      emptyValue = emptyValue || [[\"\", \"\"]];\n\n      var index = (self.columns || []).findIndex(function (cell) {\n        return self.isCurrentGridCell(cell.properties.xpath, cell.properties.id, xpath);\n      }) || 0;\n\n      var rows = self.properties.data.rows,i = 0,rowLength = rows.length;\n      for (; i < rowLength; i++) {\n        if (Number(key) === rows[i][0]) {\n          rows[i][index + 1] = emptyValue;\n          break;\n        }\n      }\n      self.cellOverrides[key] = self.cellOverrides[key] || {};\n      self.getCellOverride(key, index).value = null;\n    });\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"isValidGrid\",\n\nfunction isValidGrid(invalidElements) {\n  var self = this;\n  var errorsMessage = [];\n  var form = self.getFormContainer();\n\n  if (typeof form.validationController !== \"undefined\")\n  form.validationController.clearValidationMessages();\n\n  self.isValid(errorsMessage);\n\n  if (errorsMessage.length > 0) {\n    if (typeof form.validationController !== \"undefined\") {\n      for (var i = 0, length = errorsMessage.length; i < length; i++) {\n        // Show validation message\n        form.validationController.showValidationMessage(errorsMessage[i].message, errorsMessage[i].xpath);\n      }\n    }\n\n    return false;\n  } else {\n    return true;\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"triggerGridPluginHandler\",\n\n\n\n\n\nfunction triggerGridPluginHandler() {\n  var self = this;\n  var args = Array.prototype.slice.call(arguments, 0);\n\n  return self.grid.bizagi_grid_smartphone.apply(self.grid, args);\n}), _defineProperty(_bizagi$rendering$sma, \"bindRenderChange\",\n\n\n\n\nfunction bindRenderChange(renderColumn, key, isBinding) {\n  var self = this;\n\n  if (isBinding) {\n\n    renderColumn.getDecorated(key).bind(\"renderchange\", function (render, args) {\n\n      var value = renderColumn.getValue(args.render.surrogateKey);\n      var compositeValue = renderColumn.getCompositeValue(args.render.surrogateKey);\n      var dataType = bizagi.util.normalizeType(renderColumn.properties.type);\n\n      if (/columnDate/i.test(dataType)) {\n        if (!bizagi.util.isEmpty(value)) {\n          var date = bizagi.util.dateFormatter.getDateFromInvariant(value, true);\n          date.setMilliseconds(0);\n\n          value = bizagi.util.dateFormatter.formatInvariant(date, true);\n        } else if (value === \"\") {\n          value = \"\";\n        }\n      }\n      if (renderColumn.properties && !renderColumn.properties.isExclusive) {\n        self.collectGridChange($.extend(args, {\n          id: args.render.surrogateKey,\n          xpath: renderColumn.properties.xpath || renderColumn.properties.id,\n          value: value,\n          compositeValue: compositeValue,\n          columnIndex: renderColumn.columnIndex,\n          dataType: renderColumn.properties.type }));\n\n      }\n\n      // Update change in grid's component data\n      self.grid.bizagi_grid_smartphone(\"changeCellValue\", args.render.surrogateKey, renderColumn.columnIndex, value);\n\n      // If the column has totalizers then we need to refresh the summary\n      if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\n        self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\n      }\n    });\n  } else {\n    renderColumn.getDecorated(key).unbind(\"renderchange\");\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"executeFormFailHandler\",\n\n\n\n\n\n\nfunction executeFormFailHandler(error) {\n  var self = this;\n  var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\n  self.getFormContainer().failHandler(errorResponse);\n}), _defineProperty(_bizagi$rendering$sma, \"getIndexes\",\n\n\n\n\n\nfunction getIndexes() {\n  var self = this;\n  var data = $.merge(self.properties.data.rows, self.getDataNewRows());\n\n  return data.reduce(function (acum, current) {\n    if (typeof acum.find(function (el) {\n      return el[0] == current[0];\n    }) === 'undefined') {\n      acum.push(current);\n    }\n    return acum;\n  }, []).map(function (item) {\n    return item[0];\n  });\n}), _defineProperty(_bizagi$rendering$sma, \"startLoading\",\n\nfunction startLoading() {\n  bizagi.loading.start();\n}), _defineProperty(_bizagi$rendering$sma, \"endLoading\",\n\nfunction endLoading() {\n  bizagi.loading.stop();\n}), _defineProperty(_bizagi$rendering$sma, \"grantPerformAction\",\n\n\n\n\nfunction grantPerformAction(action, success, error) {\n  var self = this;\n  if (action == \"addRow\" || action == \"navigateToPage\") {\n    var data = self.properties.data;\n    var rows = data && data.rows ? data.rows : [];\n    if (rows.length === 0) {\n      success();\n    } else if (self.isValidGrid()) {\n      self.submitGridData().then(function () {\n        if (success)\n        success();\n      }).fail(function () {\n        if (error)\n        error();\n      });\n    } else {\n      if (error)\n      error();\n    }\n  }\n}), _defineProperty(_bizagi$rendering$sma, \"submitGridData\",\n\n\n\nfunction submitGridData() {\n  var data = {},\n  def = new $.Deferred();\n  this.collectData(data);\n  if (JSON.stringify(data) === JSON.stringify({})) {\n    def.resolve();\n  } else {\n    //submit without refresh and not collect\n    this.submitOnChange(data, false, true).then(function () {\n      def.resolve();\n    }).fail(function () {\n      def.reject();\n    });\n  }\n  return def.promise();\n}), _defineProperty(_bizagi$rendering$sma, \"addExclusiveChange\",\n\nfunction addExclusiveChange(id, data, grid) {\n  var self = grid ? grid : this;\n  if (self.properties.hasExclusiveCheck) {\n    for (var xpath in data) {\n      var column = self.columns.find(function (el) {\n        return el.properties.xpath == xpath;\n      });\n      // Check if some of the changes from the edit or add form match with the exclusive controls in the grid\n      var value = data[xpath];\n      if (column && column.properties.isExclusive && value) {\n        self.exclusiveChanges[xpath] = {\n          xpath: xpath,\n          simpleXpath: xpath,\n          value: value,\n          key: id };\n\n      }\n    }\n  }\n}), _bizagi$rendering$sma));","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Render Grid Offline Extension\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Daniel Ordonez\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will redefine the offline grid render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Extends itself\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid.offline\", {}, {\n  /*\r\n                                                                                          *   Constructor\r\n                                                                                          */\n  init: function init(params) {\n    var self = this;\n    var originalRows = bizagi.clone(params.data.properties.data.rows);\n    var completeRows = bizagi.clone(params.data.properties.data.rows);\n    // Call base\n    this._super(params);\n    var properties = this.properties;\n    properties.data.originalRows = originalRows;\n    properties.data.completeRows = completeRows;\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: self });\n\n    // Fill default properties\n    var form = self.getFormContainer();\n\n    properties.isTaskForm = form.properties.isTaskForm;\n    self.newRecords = {};\n    //Preload new lines previously added offline\n    if (properties.editable === true) {\n      if (properties[\"new-records\"]) {\n        var newRowKeys = Object.keys(properties[\"new-records\"]);\n        for (var k = 0; k < newRowKeys.length; k++) {\n          self.newRecords[newRowKeys[k]] = { createdOffline: true };\n          self.changes[newRowKeys[k]] = properties[\"new-records\"][newRowKeys[k]];\n        }\n      }\n      self[\"deleted-records\"] = properties[\"deleted-records\"] ? properties[\"deleted-records\"] : {};\n    }\n\n    if (properties.groupBy || properties.groupSummary) {\n      // Add warning\n      form.addWarning(self.getResource(\"render-tablet-warning-grid\"));\n    }\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\n  postRender: function postRender() {\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n\n    self.initialLoadDone = false;\n\n    // Find component holder\n    self.grid = $(\">div\", control);\n\n    // Hide common label\n    self.getLabel().hide();\n\n    // Grid plugin\n    self.applyGridPlugin();\n\n    // Just for smartphones we need to take only one row if there is data in the json, because we use just one row per page\n    if (properties.data && properties.data.completeRows && properties.data.completeRows.length > 0) {\n      var newData = [];\n      newData.push(properties.data.completeRows[0]);\n      properties.data.rows = newData;\n    }\n\n    // Set initial data\n    if (properties.data) {\n\n      self.updateData(properties.data);\n\n      // Trigger change in order to start up the actions when the controls is ready\n      $.when(self.ready()).done(function () {\n        self.triggerRenderChange({ changed: false });\n      });\n    }\n\n    // Execute pending actions\n    self.initialLoadDone = true;\n\n    for (var i in self.pendingActions) {\n      self.pendingActions[i].method.apply(self, self.pendingActions[i].arguments);\n    }\n  },\n\n  /*\r\n     *   Method to render non editable values\r\n     */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var self = this;\n\n    // Do the same as the post-render            \n    self.postRender();\n  },\n\n  /*\r\n     *   Method to render non editable values\r\n     */\n  applyGridPlugin: function applyGridPlugin() {\n    var self = this;\n    var properties = self.properties;\n    var grid = self.grid;\n    var mode = self.getMode();\n\n    // Build column metadata\n    var columns = self.buildColumnModel();\n\n    // Apply grid plugin\n    grid.bizagi_grid_smartphone({\n      columns: columns,\n      title: properties.displayName,\n      isOfflineForm: this.isOfflineForm || false,\n      mode: self.getMode(),\n      template: {\n        grid: self.renderFactory.getTemplate(\"bizagi.grid.grid\"),\n        waiting: self.renderFactory.getTemplate(\"bizagi.grid.waiting\"),\n        table: self.renderFactory.getTemplate(\"bizagi.grid.table\"),\n        emptyTable: self.renderFactory.getTemplate(\"bizagi.grid.table.empty\"),\n        column: self.renderFactory.getTemplate(\"bizagi.grid.column\"),\n        specialColumn: self.renderFactory.getTemplate(\"bizagi.grid.column.special\"),\n        row: self.renderFactory.getTemplate(\"bizagi.grid.row\"),\n        rowButtons: self.renderFactory.getTemplate(\"bizagi.grid.row.buttons\"),\n        cell: self.renderFactory.getTemplate(\"bizagi.grid.cell\"),\n        pager: self.renderFactory.getTemplate(\"bizagi.grid.pager\"),\n        specialCell: self.renderFactory.getTemplate(\"bizagi.grid.offline.cell.special\"),\n        buttons: self.renderFactory.getTemplate(\"bizagi.grid.buttons\") },\n\n      actions: {\n        add: properties.allowAdd,\n        edit: properties.allowEdit && properties.withEditForm && properties.data != null,\n        remove: properties.allowDelete,\n        inlineAdd: properties.inlineAdd,\n        details: false,\n        allowMore: false,\n        enableXlsExport: false,\n        enablePdfExport: false,\n        hasTotalizer: false },\n\n      isValid: function isValid() {\n        return self.isValidGrid();\n      },\n      pageRequested: function pageRequested(ui) {\n        if (mode !== \"execution\") return;\n        self.onPageRequested(ui);\n      },\n      totalData: function totalData(ui) {\n        if (mode != \"execution\") return;\n        //self.onTotalData();\n      },\n      drawCell: function drawCell(ui) {\n        return self.drawCell(ui.column, ui.key, ui.value, ui.isNewRow);\n      },\n      cellReady: function cellReady(ui) {\n        return self.onCellReady(ui.column, ui.key, ui.cell, ui.isNewRow);\n      },\n      rowSelected: function rowSelected(ui) {\n        //self.triggerHandler(\"rowSelected\", {id: ui.key, data: ui});\n      },\n      addRow: function addRow(ui) {\n        if (mode !== \"execution\") return;\n        self.addRow();\n      },\n      editRow: function editRow(ui) {\n        if (mode !== \"execution\") return;\n        self.editRow(ui.key);\n      },\n      deleteRow: function deleteRow(ui) {\n        if (mode !== \"execution\") return;\n        self.deleteRow(ui.key);\n      },\n      showMore: function showMore(ui) {\n        self.showMore(ui.key);\n      } });\n\n  },\n\n  /*\r\n     *   Method to fetch data from the server and then update the data\r\n     */\n  fetchData: function fetchData(page, sortBy, sortType) {\n    var self = this;\n    var properties = self.properties;\n\n    // Define defaults\n    page = page || 1;\n    sortBy = sortBy || \"\";\n    sortType = sortType || \"asc\";\n\n    // Update control properties\n    properties.page = page;\n    properties.sort = sortBy + \" \" + sortType;\n\n    self.dataReadyDeferred = new $.Deferred();\n\n    // Start loading to avoid multiple calls to the server\n    self.startLoading();\n\n    $.when(self.getRemoteData()).then(function (data) {\n      self.endLoading();\n      if (data) {\n        self.updateData(data);\n        self.triggerRenderChange();\n        self.dataReadyDeferred.resolve();\n      }\n    });\n  },\n\n  /*\r\n     * Method not required in smartphone implementation\r\n     */\n  processChanges: function processChanges() {\n    var self = this;\n    var rowsList = [];\n    return rowsList;\n  },\n\n  /*\r\n     *   Add the render data to the given collection in order to send data to the server\r\n     */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    var errorsMessage = [];\n    var internalRedersValues = [];\n    var internalNewRenderValues = [];\n    var properties = self.properties;\n    var data = self.properties.data;\n    var temporalNew = {};\n    // Save pending inline add rows\n    if (self.isValid(errorsMessage)) {\n      for (var id in self.changes) {\n        var sortArray = [];\n        var currentChanges = {};\n        for (var columnXpath in self.changes[id]) {\n\n          // Check if the render can submit data\n          if (self.canColumnBeSent(id, columnXpath)) {\n            var columnNumber = self.getColumn(columnXpath).columnIndex - 1;\n            var value = self.changes[id][columnXpath];\n\n            if (typeof value === \"string\") {\n              if (value.match(/\\n/gm) !== null) {\n                value = value.replaceAll(\"\\n\", \"\\\\n\");\n              }\n            }\n\n            sortArray[columnNumber] = value;\n            var xpath = properties.xpath + self.buildCellXpathFilter(id) + \".\" + columnXpath;\n            var columnValue = self.changes[id][columnXpath];\n            var value = columnValue && columnValue.value ? columnValue.value : columnValue;\n            renderValues[xpath] = value;\n            //Changes are store to delete them if the row is new, the rest of changes can be saved by xpath\n            currentChanges[xpath] = value;\n          }\n        }\n        //If new record store action data\n        if (self.newRecords[id]) {\n          //Use - to avoid issues with possible xpaths in renderValues used both in new and deleted records\n          var addRowData = {\n            url: properties.addUrl,\n            idRender: properties.id,\n            xpath: properties.xpath,\n            xpathContext: properties.xpathContext,\n            contexttype: properties.contexttype,\n            idPageCache: properties.idPageCache,\n            submitData: self.changes[id],\n            prepare: true,\n            idRow: parseInt(id + ''),\n            creationTimestamp: self.newRecords[id].creationTimestamp };\n\n          temporalNew[id] = addRowData;\n          for (change in currentChanges) {\n            delete renderValues[change];\n          }\n          var details = {};\n          details.idRow = parseInt(id + '');\n          details.isNew = true;\n          details.changes = self.changes[id];\n          sortArray.push(details);\n          if (!self.newRecords[id].createdOffline) {\n            sortArray.creationTimestamp = self.newRecords[id].creationTimestamp;\n            internalNewRenderValues.push(sortArray);\n          }\n        }\n      }\n    }\n\n    internalNewRenderValues = internalNewRenderValues.sort(function (a, b) {\n      return a.creationTimestamp - b.creationTimestamp;\n    });\n    internalNewRenderValues = internalNewRenderValues.map(function (row) {\n      if (row.creationTimestamp) {\n        delete row.creationTimestamp;\n      }\n      return row;\n    });\n    internalRedersValues = internalRedersValues.concat(internalNewRenderValues);\n    // Get data\n    if (JSON.stringify(data.completeRows) !== JSON.stringify(data.originalRows) || internalRedersValues.length > 0) {\n      renderValues[properties.xpath] = renderValues[properties.xpath] ? renderValues[properties.xpath] : {};\n      if (typeof data.completeRows !== \"undefined\" && data.completeRows.length > 0) {\n        renderValues[properties.xpath].rows = self.processOldRows(data.completeRows);\n      } else {\n        renderValues[properties.xpath].rows = internalRedersValues;\n      }\n      if (self[\"deleted-records\"] && Object.keys(self[\"deleted-records\"]).length > 0)\n      renderValues[properties.xpath][\"deleted-records\"] = self[\"deleted-records\"];\n      if (temporalNew && Object.keys(temporalNew).length > 0)\n      renderValues[properties.xpath][\"new-records\"] = temporalNew;\n    }\n\n\n  },\n\n  /*\r\n     *   Delete field id array objects\r\n     */\n  processOldRows: function processOldRows(rows) {\n    var newRows = [];\n    var tempRows = rows;\n    var self = this;\n\n    for (var col = 0, leng = tempRows.length; col < leng; col++) {\n      var temp = tempRows[col];\n      newRows[col] = $.grep(temp, function (n, i) {\n        return i > 0;\n      });\n      var details = {};\n      details.idRow = parseInt(temp[0] + '');\n      details.isNew = self.newRecords[temp[0]] ? true : false;\n      details.changes = self.changes[temp[0]] ? self.changes[temp[0]] : {};\n      newRows[col].push(details);\n    }\n\n    return newRows;\n  },\n  /*\r\n     *   Delete field id array\r\n     */\n  processRow: function processRow(row) {\n    return $.grep(row, function (n, i) {\n      return i > 0;\n    });\n  },\n\n  onPageRequested: function onPageRequested(ui) {\n    var self = this;\n    self.fetchData(ui.page, ui.sortBy, ui.sortType);\n  },\n\n  /*\r\n     *   Customizes the content drawing inside the cell\r\n     */\n  drawCell: function drawCell(column, key, value, isNewRow) {\n    var self = this;\n\n    if (column.key) return value;\n\n    if (_typeof(value) === \"object\" && value !== null && !isNewRow) {\n      value = value.hasOwnProperty(\"value\") ? value.value : value;\n    }\n\n    // Get render column                \n    var columnIndex = column.index - 1;\n    var renderColumn = self.columns[columnIndex];\n    var cellOverride = self.getCellOverride(key, column.index - 1);\n\n    self.newRecords = self.newRecords || {};\n\n    // Get cell properties\n    if (!self.cellMetadata[key]) self.cellMetadata[key] = {};\n    if (!self.cellMetadata[key][columnIndex]) self.cellMetadata[key][columnIndex] = {};\n    var properties = self.cellMetadata[key][columnIndex].properties || renderColumn.properties;\n\n    var visible = properties.visible !== undefined ? properties.visible : true;\n    var editable = properties.editable !== undefined ? properties.editable : true;\n\n    // Apply overrides from cellOverrides\n    visible = cellOverride.visible;\n    editable = properties.editable ? cellOverride.editable : false;\n\n    // Show editable cell when we are performing inline add operation\n    if (isNewRow) editable = true;\n\n    // If the cell we are drawing is the summary cell, we need to make it readonly\n    if (key === \"summary\") editable = false;\n\n    renderColumn.properties.displayType = 'value';\n    renderColumn.setValue(key, value);\n    renderColumn.setSurrogateKey(key);\n    renderColumn.properties.data = renderColumn.properties.data || [];\n\n    // Column search\n    if (renderColumn.properties.type === \"columnSearch\" && value != null) {\n      for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\n        if (renderColumn.properties.data[i].id == value) {\n          value = { id: renderColumn.properties.data[i].id, label: renderColumn.properties.data[i].value };\n        }\n      }\n    }\n\n    if ((renderColumn.properties.type === \"columnCombo\" || renderColumn.properties.type === \"columnList\") && value != null) {//|| renderColumn.properties.type == \"columnRadio\"\n      for (var i = 0, len = renderColumn.properties.data.length; i < len; i++) {\n        if (renderColumn.properties.data[i].id == value) {\n          value = [[renderColumn.properties.data[i].id, renderColumn.properties.data[i].value]];\n        }\n      }\n    }\n\n    // Column text\n    if (renderColumn.properties.type === \"columnText\" && bizagi.util.isEmpty(value) && value != null) {\n      value = \"\";\n    }\n\n    if (renderColumn.properties.type === \"columnUpload\") {\n      renderColumn.getDecorated(key).properties.xpathContext = self.properties.xpath + self.buildCellXpathFilter(key);\n    }\n\n    // Do the render\n    if (visible) {\n      if (editable) {\n        return self.drawEditableCell(renderColumn, properties, key, value, isNewRow);\n      } else {\n        return self.drawReadonlyCell(renderColumn, properties, key, value);\n      }\n    } else {\n      return \"\";\n    }\n  },\n\n  /*\r\n     *   Draws the editable version for the cell\r\n     */\n  drawEditableCell: function drawEditableCell(renderColumn, properties, key, value, isNewRow) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Set editable\n    var originalEditable = renderColumn.properties.editable;\n    renderColumn.properties.editable = true;\n\n    // Fix problem when required property lose\n    renderColumn.overrideProperties({ required: properties.required });\n\n    // Render cell\n    $.when(renderColumn.render(key, value)).done(function (cell) {\n      // Register array with new records, just when this is a new-record\n      if (isNewRow && !self.newRecords[key]) {\n        self.newRecords[key] = { creationTimestamp: Date.now() };\n      }\n\n      // convert all row visible\n      for (var j = 0; j < self.columns.length; j++) {\n        self.cellOverrides[key] = self.cellOverrides[key] || {};\n        self.getCellOverride(key, j).visible = self.getCellOverride(key, j).visible != undefined ? self.getCellOverride(key, j).visible : true;\n      }\n\n      // Add change handler  \n      renderColumn.getDecorated(key).bind(\"renderchange\", function (render) {\n        self.onCellChange(renderColumn, cell, key);\n      });\n\n      // Resolve cell\n      defer.resolve(cell);\n    });\n\n    // Restore editable\n    renderColumn.properties.editable = originalEditable;\n\n    // Return promise\n    return defer.promise();\n  },\n\n  /*\r\n     *   Draws the readonly version for the cell\r\n     */\n  drawReadonlyCell: function drawReadonlyCell(renderColumn, properties, key, value) {\n    var result = \"\";\n\n    // Use totalizer format when printing summary row\n    if (key === \"summary\") {\n      var originalFormat = renderColumn.properties.textFormat;\n      if (renderColumn.properties.totalize) {\n        renderColumn.properties.textFormat = renderColumn.properties.totalize.format;\n      }\n\n      result = renderColumn.renderSummary(key, value);\n\n      // Restore column format\n      renderColumn.properties.textFormat = originalFormat;\n    } else {\n      result = renderColumn.renderReadOnly(key, value);\n    }\n    return result;\n  },\n\n  /*\r\n     *   Defines the handler when a cell changes its value\r\n     */\n  onCellChange: function onCellChange(renderColumn, cell, key) {\n\n    var self = this;\n    var _value = renderColumn.getValue(key);\n    var compositeValue = renderColumn.getCompositeValue(key);\n\n    if (renderColumn.properties.type === \"columnDate\" && renderColumn.data.properties.showTime == true) {\n\n      if (!bizagi.util.isEmpty(_value)) {\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, true);\n        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\n      } else if (_value === \"\") {\n        _value = \"\";\n      }\n    } else if (renderColumn.properties.type === \"columnDate\") {\n\n      if (!bizagi.util.isEmpty(_value)) {\n        var date = bizagi.util.dateFormatter.getDateFromInvariant(_value, false);\n        date.setHours(0, 0, 0, 0);\n        _value = bizagi.util.dateFormatter.formatInvariant(date, true);\n      } else if (_value === \"\") {\n        _value = \"\";\n      }\n    }\n\n    if (self.properties.allowEdit || self.grid.bizagi_grid_smartphone(\"isNewRecord\", key)) {\n      var trigger = self.grid.bizagi_grid_smartphone(\"isNewRecord\", key) ? false : true;\n      self.collectGridChange({\n        id: key,\n        xpath: renderColumn.properties.xpath,\n        value: _value,\n        compositeValue: compositeValue,\n        columnIndex: renderColumn.columnIndex,\n        trigger: trigger,\n        dataType: renderColumn.properties && renderColumn.properties.type });\n\n    }\n\n    // Update change in grid's component data\n    self.grid.bizagi_grid_smartphone(\"changeCellValue\", key, renderColumn.columnIndex, _value);\n\n    // If the column has totalizers then we need to refresh the summary\n    if (renderColumn.properties.totalize && renderColumn.properties.totalize.operation) {\n      self.grid.bizagi_grid_smartphone(\"refreshSummary\", renderColumn.columnIndex);\n    }\n  },\n  /*\r\n     *   Collect a single cell change made in the grid to send the data when the user saves the form\r\n     */\n  collectGridChange: function collectGridChange(params) {\n    var self = this;\n    params = params || {};\n    var id = params.id;\n    var xpath = params.xpath;\n    var value = params.value;\n    var trigger = typeof params.trigger !== \"undefined\" ? params.trigger : true;\n\n    self.changes[id] = self.changes[id] || {};\n    self.changes[id][xpath] = value;\n\n    if (trigger)\n    self.triggerRenderChange({ key: id, column: xpath });\n  },\n\n  /**\r\n      *  Adds a row to the grid\r\n      */\n  addRow: function addRow() {\n\n    var self = this;\n    var properties = self.properties;\n    var data = properties.data;\n    // Handle information stored offline based on data        \n    var newData = [];\n    var newRow = self.createAddRowData();\n    newData.push(newRow);\n\n    //Support for deletion and new rows\n    self.newRecords[newRow[0]] = {\n      createdOffline: true,\n      creationTimestamp: Date.now() };\n\n\n    data.rows = newData;\n    data.completeRows.push(newRow);\n    data.records++;\n    data.page = data.records;\n\n    self.updateData(data);\n    self.triggerRenderChange();\n  },\n\n  /**\r\n      * Creates a dummy data for the new row\r\n      * @returns {}\r\n      */\n  createAddRowData: function createAddRowData() {\n    var self = this;\n\n    var row = [];\n    var key = Math.ceil(Math.random() * 100000);\n    row.push(key);\n    $.each(self.columns, function (i) {\n      row.push(null);\n    });\n\n    return row;\n  },\n\n  /**\r\n      *  Edits a row in the grid\r\n      */\n  editRow: function editRow(id) {\n  },\n\n  /**\r\n      *  Deletes a row to the grid\r\n      */\n  deleteRow: function deleteRow(id) {\n    var self = this;\n\n    if (!id || id == 0) {\n      bizagi.showMessageBox(bizagi.localization.getResource(\"render-grid-message-no-selected-row\"), bizagi.localization.getResource(\"render-grid-header-no-selected-row\"));\n      return;\n    }\n\n    bizagi.showConfirmationBox(this.getResource(\"render-grid-delete-confirmation\")).done(function () {\n      // Do a grid record deletion\n      $.when(self.submitDeleteRequest(id)).\n      done(function () {\n        // Reload grid\n        self.fetchData();\n\n        // Trigger the event\n        //'key' must be included to trigger a single call to actions and validations\n        //line 310 bizagi.command.controllers.action\n        self.triggerRenderChange({ rowDeleted: true, changed: false, key: id });\n      });\n    });\n  },\n\n  /**\r\n      *  Edits the entire row (inline) in another slide\r\n      */\n  editInline: function editInline(id) {\n  },\n  /*\r\n     *   Retrieve the data for the new rows and push them into the server\r\n     */\n  saveInlineAddedRows: function saveInlineAddedRows(keys, bRefresh) {\n    var self = this;\n    var rows = self.processChanges();\n\n    if (!bizagi.util.isEmpty(rows)) {\n      self.properties.data.rows = $.merge(self.properties.data.rows, rows);\n    }\n  },\n\n  /*\r\n     * Removes invalid records \r\n     */\n  removeNewRecords: function removeNewRecords(ui) {\n    var self = this;\n\n    if (ui && ui.keys) {\n      $.each(ui.keys, function (_, key) {\n        if (self.newRecords[key]) {\n          delete self.newRecords[key];\n        }\n      });\n    }\n  },\n\n  /*\r\n     *   Fetch the data into a deferred\r\n     */\n  getRemoteData: function getRemoteData(params) {\n    var self = this;\n    var properties = self.properties;\n\n    // Set params\n    params = params || {};\n\n    // Check if a custom method has been given\n    if (properties.overrideGetRemoteData) {\n      var result = properties.overrideGetRemoteData(params);\n      return result != null ? result.promise() : null;\n    }\n\n    // Default ajax call\n    var defer = new $.Deferred();\n\n\n    // Resolve with remote data\n    var data = properties.data;\n    // Handle information stored offline based on data\n    if (properties.data && properties.data.completeRows && properties.data.completeRows.length > 0) {\n      var newData = [];\n      newData.push(properties.data.completeRows[properties.page - 1]);\n      properties.data.rows = newData;\n      properties.data.page = properties.page;\n    } else\n    if (properties.data.completeRows && properties.data.completeRows.length == 0) {\n      properties.data.rows = [];\n    }\n\n    // Check RTL\n    if (self.isRTL()) {\n      data.rows = self.changeOrderData(data.rows);\n    }\n\n    defer.resolve(data);\n\n    return defer.promise();\n  },\n  /*\r\n     *   Submits a grid delete record request for the given id \r\n     *   Returns a deferred\r\n     */\n  submitDeleteRequest: function submitDeleteRequest(id) {\n    var self = this;\n    var properties = self.properties;\n    var data = self.properties.data;\n    for (var i = 0, length = data.completeRows.length; i < length; i++) {\n      if (data.completeRows[i][0] == id) {\n\n        data.completeRows.splice(i, 1);\n        i--;\n\n        data.records--;\n        //Enters if it was created online\n        if (!self.newRecords[id])\n        {\n          var xpath = properties.xpath + self.buildCellXpathFilter(id);\n\n          var delInfo = {\n            url: properties.deleteUrl,\n            idRender: properties.id,\n            xpath: xpath,\n            xpathContext: properties.xpathContext,\n            idPageCache: properties.idPageCache,\n            contexttype: properties.contextType,\n            prepare: true };\n\n          self[\"deleted-records\"][id] = delInfo;\n        } else {\n          delete self.newRecords[id];\n          delete self.changes[id];\n        }\n        break;\n      }\n    }\n\n    return data.completeRows;\n  },\n\n  isValidGrid: function isValidGrid() {\n    var self = this;\n    var errorsMessage = [];\n    var form = self.getFormContainer();\n\n    if (typeof form.validationController !== \"undefined\")\n    form.validationController.clearValidationMessages();\n\n    //self.isValid(errorsMessage);\n\n    if (errorsMessage.length > 0) {\n      if (typeof form.validationController !== \"undefined\") {\n        for (var index = 0; index < errorsMessage.length; index++) {\n          form.validationController.showValidationMessage(errorsMessage[index].message, errorsMessage[index].xpath);\n        }\n      }\n\n      return false;\n    } else {\n      return true;\n    }\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: Bizagi Smartphone Render Search Extension\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Bizagi UI Forms\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will redefine the search render class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.search\", bizagi.rendering.search.prototype);\n// Extends itself\nbizagi.rendering.smartphone.search.extend(\"bizagi.rendering.smartphone.search\", {\n  ADVANCED_SEARCH_ID: -1,\n  ADVANCED_ADDITION_ID: -2,\n  CLEAR_SEARCH_ID: -3,\n  NO_RESULTS_SEARCH_ID: -4,\n  DEFAULT_SEARCH_ID: \"\",\n  SEARCH_MIN_LENGTH: 3,\n  SEARCH_DELAY: 250,\n  SEARCH_MAX_RECORDS: 50 },\n{\n\n  /**\r\n   * Update or init the element data\r\n   * @param {} data submitData\r\n   * @returns {}\r\n   */\n  initializeData: function initializeData(data) {\n    var self = this;\n\n    // Call base\n    self._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.properties.submitOnChange = this.isOfflineForm ? false : this.properties.submitOnChange;\n\n    // Store reference of all ajax request in order to run only one instance of them\n    this.deferredReference = null;\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n    var value = this.getDisplayValue();\n    var label = value.label || value.value;\n\n    if (typeof label != \"undefined\") {\n      if (_typeof(label) == \"object\")\n      label = label.join(\" - \");\n    } else {\n      label = \"\";\n    }\n\n    if (typeof label == \"string\") {\n      if (value.additionallabel) {\n        label += \" - \" + value.additionallabel;\n      }\n\n      label = bizagi.util.sanitizeHTML(label);\n    }\n\n    return $.fasttmpl(template, {\n      value: label,\n      editable: this.properties.editable });\n\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      * @returns {}\r\n      */\n  postRender: function postRender() {\n    this.searchInput = $(\".bz-input-icon\", this.getControl());\n  },\n\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.searchInput = $(\".bz-input-icon\", this.getControl());\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    // Select new item\n    $(\".bz-input-icon\", control).on(\"click\", function () {\n      if (!self.properties.advancedSearch || self.isOfflineForm) {\n        self._simplySearchView();\n      } else {\n        self._advanceSearchView();\n      }\n    });\n\n    $(\".bz-icn--clear\", control).bind(\"click\", function (event) {\n      // Change display icon\n      $(\".bz-input-icon\", control).addClass(\"bz-input-icon--empty\");\n\n      // Call clean data\n      self.cleanData();\n\n      // Submit info to server\n      self.readyActionExecution().done(function () {\n        if (self.properties.submitOnChange) {\n          self.submitData();\n        }\n      });\n\n      event.stopPropagation();\n    });\n\n  },\n\n  /**\r\n      * Configure the modalView Handlers for the new suggest control\r\n      * @param {} inputContainer\r\n      * @returns {}\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n\n    // Configuring list as a selectable element\n    self.modalViewList = $(\".bz-list\", modalView.content);\n\n    // Suggest\n    var suggestFilter = bizagi.util.debounce(function (value) {\n      self.autoCompleteSearchResults($.trim(value));\n    }, self.Class.SEARCH_DELAY);\n\n    $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\n      modalView.close();\n    });\n\n    var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\n    var $searchInput = $(\".bz-modal-view__search\", modalView.header);\n\n    $clearButton.bind(\"click\", function () {\n      $searchInput.val(\"\").trigger(\"clean\");\n    });\n\n    // Setting the initial selected display value\n    $(\".bz-list\", modalView.content).on(\"click\", \"li\", function () {\n      var item = $.data(this).item;\n      if (!item || item && item.id == self.Class.NO_RESULTS_SEARCH_ID)\n      return;\n\n      self.selectItem(item);\n      modalView.close();\n    });\n\n    // Filtering list\n    $searchInput.bind(\"clean keyup\", function () {\n      if (this.value == \"\") {\n        $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n      } else {\n        $clearButton.addClass(\"bz-modal-view__clear--visible\");\n      }\n      suggestFilter(this.value);\n    }).on(\"focus\", function () {\n      modalView.header.addClass(\"bz-modal-view__header--active\");\n    }).on(\"blur\", function () {\n      modalView.header.removeClass(\"bz-modal-view__header--active\");\n    });\n\n\n  },\n\n  /**\r\n      * Opens the search slide\r\n      * @private\r\n      */\n  _advanceSearchView: function _advanceSearchView() {\n    var self = this;\n    var properties = self.properties;\n    var formSearchParams = $.extend({}, self.getParams(), {\n      navigation: self.getFormContainer().getNavigation() });\n\n\n\n    var searchForm = new bizagi.rendering.smartphone.helpers.searchForm(\n    self.dataService, self.renderFactory,\n    properties.searchForms, {\n      allowFullSearch: properties.allowFullSearch,\n      maxRecords: properties.maxRecords,\n      allowNew: properties.allowNew || false,\n      orientation: properties.orientation || \"ltr\",\n      editable: properties.editable },\n\n    formSearchParams);\n\n\n    searchForm.renderEdition({\n      idRender: properties.id,\n      xpath: properties.xpath,\n      xpathContext: properties.xpathContext,\n      displayName: properties.displayName,\n      idPageCache: properties.idPageCache }).\n    done(function (itemId) {\n      self.setValue({ id: itemId });\n\n      self.readyActionExecution().done(function () {\n        var form = self.getFormContainer();\n        if (!self.properties.submitOnChange) {\n          $.when(form.submitData()).done(function () {\n            self.refreshControl();\n          });\n        }\n      });\n    });\n  },\n\n  /**\r\n      * Simply search autocomplete\r\n      * @private\r\n      */\n  _simplySearchView: function _simplySearchView() {\n    var self = this;\n    var content = self.getContentTemplate();\n\n    self.searchInput.mobileView({\n      customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {}),\n      orientation: self.properties.orientation || \"\",\n      contentTemplate: content,\n      transition: \"slideIn:up\",\n      close: function close() {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      },\n      afterOpenAnimation: function afterOpenAnimation(event) {\n        var $context = $(\".bz-modal-view__search\", event.view.header);\n\n        // Fix the moving content to top\n        if ($context && $context[0]) {\n          $context[0].scrollIntoView(true);\n          $context.focus();\n        }\n      },\n      open: function open() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      configureActions: function configureActions(context) {\n        self.configureModalViewHandlers(context);\n      } });\n\n  },\n\n  autoCompleteSearchResults: function autoCompleteSearchResults(currentValue) {\n    var self = this;\n\n    $.when(self.processRequest({ term: currentValue })).\n    done(function (response) {\n\n      self.modalViewList.find(\"li\").remove();\n\n      for (var i = 0, length = response.length; i < length; i++) {\n        var searchItem = self.renderSearchItem(response[i]);\n\n        searchItem.appendTo(self.modalViewList);\n      }\n    });\n  },\n\n  renderSearchItem: function renderSearchItem(item) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"search.item\");\n\n    var searchItem = $.tmpl(template, {\n      id: item.id,\n      label: item.label,\n      value: item.value });\n\n\n    searchItem.data(\"item\", item);\n\n    return searchItem;\n  },\n\n  processRequest: function processRequest(req) {\n    var self = this;\n    var properties = self.properties;\n    var deferred = new $.Deferred();\n\n    // Create array for response objects\n    var suggestions = [];\n\n    if (self.properties.allowSuggest && req.term.length >= self.properties.searchLength) {\n\n      // Update term property to reflect the search\n      properties.term = req.term;\n\n      var getSuggestData = self.isOfflineForm ? self.getOfflineData() : self.getData();\n\n      // Cancel previous request in order to improve the performance\n      if (self.deferredReference && typeof self.deferredReference.reject === \"function\" && self.deferredReference.state() !== \"resolved\") {\n        self.deferredReference.reject({ hideStatus: true });\n      }\n\n      self.deferredReference = getSuggestData.done(function (data) {\n        if (data && data.length > 0) {\n          data = data.slice(0, properties.maxRecords);\n\n          if (data.length > self.Class.SEARCH_MAX_RECORDS) {\n            data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\n\n            suggestions.push({\n              id: self.Class.NO_RESULTS_SEARCH_ID,\n              label: self.getResource(\"render-search-maximum-records-allowed\"),\n              value: \"\" });\n\n\n\n          } else {\n            data = data.slice(0, properties.maxRecords);\n          }\n\n          // Default value\n          suggestions.push({\n            id: self.Class.DEFAULT_SEARCH_ID,\n            label: self.getResource(\"render-combo-empty-value\"),\n            value: \"\" });\n\n\n          $.each(data, function (i, val) {\n            if (properties.maxRecords === 0 || i < properties.maxRecords) {\n              var parseValue = bizagi.util.performTermMatches(val.value, req.term);\n\n              suggestions.push({ id: val.id, label: parseValue, value: val.value });\n            }\n          });\n\n        } else {\n          suggestions.push({\n            id: self.Class.NO_RESULTS_SEARCH_ID,\n            label: self.getResource(\"render-grid-no-records\"),\n            value: \"\" });\n\n        }\n\n        deferred.resolve(suggestions);\n\n      }).fail(function () {\n        deferred.reject();\n      });\n\n    } else {\n      deferred.resolve(suggestions);\n    }\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Sets the value to show and calls the method to sets the control value\r\n      * @param {object} value\r\n      * @param {int} value.id\r\n      * @param {string} value.label\r\n      * @param {string=} value.additionallabel\r\n      * @example\r\n      *   value = {\r\n      *     id: 123,\r\n      *     label: \"xx\",\r\n      *     additionallabel: \"yyyy\"\r\n      *   }\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var label = \"\";\n\n    value = self.mapValue(value);\n\n    if (value !== null && typeof value !== \"undefined\" && typeof value.id !== \"undefined\") {\n      if (value.additionallabel && value.label) {\n        label = value.label + \" - \" + value.additionallabel;\n      } else if (value.label) {\n        label = value.label;\n      } else {\n        label = \"\";\n      }\n\n      var inputText = self.searchInput.find(\"input\");\n      inputText.val(label);\n      inputText.attr(\"id\", value.id);\n\n      if (value.id !== \"\" && self.properties.allowClear) {\n        $(\".bz-input-icon\", self.getControl()).removeClass(\"bz-input-icon--empty\");\n      }\n\n      if (self.properties.editable) {\n        self.setValue(value, true);\n      }\n    }\n  },\n\n  /**\r\n      * on the smartphone only sends the id to submit in the smartphone it send the id and the value\r\n      * @returns {}\r\n      */\n  submitData: function submitData() {\n    var self = this;\n    var data = {};\n\n    // Add current data\n    data[self.properties.xpath] = self.getValue();\n\n    // Executes submit on change\n    if (self.properties.submitOnChange && data[self.properties.xpath].id != undefined)\n    self.submitOnChange(data, true);\n  },\n\n  /**\r\n      * Cleans the control's data\r\n      * @returns {}\r\n      */\n  cleanData: function cleanData() {\n    var value = { id: \"\", value: \"\" };\n\n    if (bizagi.util.isEmpty(this.value)) {\n      value = {};\n    }\n\n    this.setValue(value);\n    this.setDisplayValue(value);\n  },\n\n  getContentTemplate: function getContentTemplate() {\n    var template = this.renderFactory.getTemplate(\"search.items\");\n    var content = $.fasttmpl(template, {});\n\n    return $.trim(content);\n  },\n\n  selectItem: function selectItem(item) {\n    var self = this;\n    var previousValue = self.hasValue();\n    var label = Array.isArray(item.value) ? item.value.join(\" - \") : item.value;\n\n    self.setDisplayValue({ id: item.id, label: label });\n\n    if (self.properties.allowClear) {\n\n      if (item.id === self.Class.DEFAULT_SEARCH_ID) {\n        self.searchInput.find(\".bz-search__clear\").addClass(\"bz-search--hidden\");\n        self.searchInput.find(\".bz-search__icon\").removeClass(\"bz-search--hidden\");\n      } else {\n        if (!previousValue && item.id !== self.Class.DEFAULT_SEARCH_ID) {\n          self.searchInput.find(\".bz-search__clear\").removeClass(\"bz-search--hidden\");\n          self.searchInput.find(\".bz-search__icon\").addClass(\"bz-search--hidden\");\n        }\n      }\n    }\n  },\n\n  /**\r\n      * Get offline data for request\r\n      * @param request\r\n      */\n  getOfflineData: function getOfflineData() {\n    var self = this;\n    var dataList = self.properties.data || [];\n    var filter = (self.properties.term || \"\").toLowerCase();\n\n    return $.when(filter.startsWith(\"%%\") ? dataList : dataList.filter(function (item) {\n      var value = item && item.value ? item.value : \"\";\n      if (_typeof(value) === \"object\") {\n        value = value.toString();\n      }\n\n      return value.toLowerCase().indexOf(filter) > -1;\n    }));\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Smartphone Column Decorator Extension\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Bizagi UI Forms\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.combo\", {}, bizagi.rendering.columns.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.combo\", {}, {\n  applyOverrides: function applyOverrides(decorated) {\n    // Hacks the getControl method in the decorated render to add features\n    var self = this;\n    self._super(decorated);\n\n    if (decorated && decorated.getControl) {\n      self.originalGetControl = decorated.getControl;\n      decorated.getControl = self.getControl;\n      decorated.properties.displayType = \"normal\";\n    }\n  },\n\n  /*\r\n     *   Template method to get the control element\r\n     *   This code runs under the decorated element context\r\n     */\n  getControl: function getControl() {\n    var self = this;\n    var result = self._super();\n\n    if (!result || result.length == 0) {\n      result = $(\".ui-bizagi-cell-readonly\", self.element || self.observableElement);\n    }\n\n    return result;\n  },\n  /*\r\n     *   Sets the internal value\r\n     */\n  setValue: function setValue(surrogateKey, value) {\n    var self = this;\n\n    // Check is offline form\n    var isOfflineForm = bizagi.util.isOfflineForm({ context: self });\n    if (isOfflineForm && (typeof value == \"number\" || typeof value == \"string\")) {\n      var newValue = _typeof(self.properties.data) == \"object\" ? self.properties.data.find(function (item) {\n        return item.id == value;\n      }) : value;\n      var decorated = self.getDecorated(surrogateKey);\n      if (decorated !== null) {\n        decorated.selectedValue = value;\n      }\n      return self._super(surrogateKey, newValue);\n    } else {\n      return self._super(surrogateKey, value);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Container Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends itself\nbizagi.rendering.container.extend(\"bizagi.rendering.smartphone.container\", {}, {\n  /**\r\n                                                                                  * Starts waiting signal for async stuff\r\n                                                                                  */\n  startLoading: function startLoading() {\n  },\n\n  /**\r\n      * Ends waiting for async stuff\r\n      */\n  endLoading: function endLoading() {\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the render class to adjust to smartphone devices\r\n */\n\n// Extends from render base\nbizagi.rendering.render.extend(\"bizagi.rendering.smartphone.render\", bizagi.rendering.render.base.prototype);\n// Extends itself\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.render\", {}, {\n\n  /**\r\n                                                                                       * Update or init the element data\r\n                                                                                       * @param data\r\n                                                                                       */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    var formContainer = this.getFormContainer();\n    this.formParams = formContainer.getParams();\n  },\n\n  /**\r\n      * Override internal rendering in order to apply new smartphone layout\r\n      */\n  internalPostRender: function internalPostRender(element) {\n    this._super(element);\n\n    this.changeDisplayOption();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Returns the label element usually to apply styles\r\n      */\n  getLabel: function getLabel() {\n    if (!this.label)\n    this.label = $(\".bz-form-label label\", this.element || this.observableElement);\n\n    return this.label;\n  },\n\n  getContainerRender: function getContainerRender() {\n    return $(this.element);\n  },\n\n  /**\r\n      * Return the right align class\r\n      */\n  getAlignClass: function getAlignClass(alignType) {\n    return alignType;\n  },\n\n  /**\r\n      * Template method to get the control element\r\n      */\n  getControl: function getControl() {\n    if (!this.control || this.control.length === 0)\n    this.control = $(\".bz-control\", this.element || this.observableElement);\n\n    if (!this.control || this.control.length === 0) return null;\n\n    return this.control;\n  },\n\n  /**\r\n      * Template method to get the control filler element\r\n      */\n  getControlFiller: function getControlFiller() {\n    if (!this.controlFiller)\n    this.controlFiller = $(\".bz-form-item__control\", this.element || this.observableElement);\n\n    return this.controlFiller;\n  },\n\n  getContainerMessage: function getContainerMessage() {\n    if (!this.containerMessage)\n    this.containerMessage = $(\".bz-form-message__text\", this.element || this.observableElement);\n\n    return this.containerMessage;\n  },\n\n  getColumnContainerMessage: function getColumnContainerMessage() {\n    if (!this.containerMessage)\n    this.containerMessage = $(\".bz-form-cell-message__text\", this.element || this.observableElement);\n\n    return this.containerMessage;\n  },\n\n  /**\r\n      * Customizes render label align\r\n      */\n  changeLabelAlign: function changeLabelAlign(alignType) {\n  },\n\n  /**\r\n      * Customizes render value align\r\n      */\n  changeValueAlign: function changeValueAlign(alignType) {\n  },\n\n  /**\r\n      * Customizes render label and value width\r\n      * @returns {}\r\n      */\n  customizeRenderWidth: function customizeRenderWidth() {\n  },\n\n  /**\r\n      * Sends all the info to the server then refreshes the form. Returns a deferred\r\n      */\n  submitOnChange: function submitOnChange(data, bRefreshForm, noCollect) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // TODO: Review loader for smartphone\n    bizagi.util.smartphone.startLoading();\n\n    $.when(self.isReadyToSave()).done(function () {\n      $.when(self.internalSubmitOnChange(data, bRefreshForm, noCollect)).\n      done(function () {\n        defer.resolve();\n      }).fail(function () {\n        defer.reject();\n      }).always(function () {\n        bizagi.util.smartphone.stopLoading();\n      });\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * Adds a validation message to the render\r\n      */\n  setValidationMessage: function setValidationMessage(message) {\n    // Call base\n    this._super(message);\n    var dataType = bizagi.util.normalizeType(this.properties.type);\n    var isGridControl = dataType === \"grid\" || dataType === \"groupedgrid\";\n    var isColumn = this.column && /column/.test(dataType);\n    var $message = isColumn ? this.getColumnContainerMessage() : this.getContainerMessage();\n\n    if (message && message.length > 0) {\n      message = message.replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\n\n      $message.attr(\"data-error\", message);\n      $message.text(message);\n\n      if (this.element) {\n        isGridControl ? this.element.addClass(\"bz-form-item-grid--error\") : this.element.addClass(\"bz-form-item--error\");\n      }\n    } else {\n      $message.text(\"\");\n\n      if (this.element) {\n        isGridControl ? this.element.removeClass(\"bz-form-item-grid--error\") : this.element.removeClass(\"bz-form-item--error\");\n      }\n    }\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var control = self.getControl();\n\n    // Set internal value\n    self.setValue(value, false);\n\n    if (!self.properties.editable && self.properties.display !== \"check\") {\n      // Render as simple value\n      var displayValue = self.getDisplayValue(value);\n\n      if (typeof displayValue == \"string\" || typeof displayValue == \"number\") {\n        $(control).html(\"<label class='bz-form-label'>\" + displayValue + \"</label>\");\n      }\n    }\n  },\n\n  actionSave: function actionSave() {\n    this.setValue(this.inputEdition.val(), false);\n  },\n\n  configureLabel: function configureLabel() {\n    return this.properties.displayName;\n  },\n\n  /**\r\n      * Starts waiting signal for async stuff\r\n      */\n  startLoading: function startLoading() {\n  },\n\n  /**\r\n      * Ends waiting for async stuff\r\n      */\n  endLoading: function endLoading() {\n  },\n\n  /**\r\n      * In mobiles, don't apply styles to icon's elements\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\".bz-input\", context);\n  },\n\n  /**\r\n      * Return the right display option class\r\n      * @param displayType\r\n      * @returns {string}\r\n      */\n  getDisplayOptionClass: function getDisplayOptionClass(displayType) {\n    if (displayType === \"reversed\") {\n      return \"bz-form-item--display-reversed\";\n    } else if (displayType === \"label\") {\n      return \"bz-form-item--display-label\";\n    } else if (displayType === \"value\") {\n      return \"bz-form-item--display-value\";\n    }\n  },\n\n  /**\r\n      * Return the label\r\n      */\n  getFormattingLabel: function getFormattingLabel() {\n    // TODO: Despues de cambiar a genome desktop, validar se solo se deja este metodo en la base\n    return this.getLabel();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    var self = this;\n    var control = self.getControl();\n\n    var input = control.find(\"input\").filter(function (index, ele) {\n      return ele.type !== \"file\" && ele.type !== \"radio\" && ele.type !== \"checkbox\";\n    });\n\n    if (input.length > 0) {\n      input.val(self.getValue());\n    } else {\n      self.setDisplayValue(\"\");\n    }\n  },\n\n  getFormParams: function getFormParams() {\n    return this.formParams || {};\n  },\n\n  /**\r\n      * Transform the display type when using RTL orientation\r\n      */\n  getRTLDisplayType: function getRTLDisplayType(displayType) {\n    return displayType;\n  },\n\n  /**\r\n      * Changes the render visibility\r\n      * @param argument\r\n      */\n  changeVisibility: function changeVisibility(argument) {\n    // Update properties\n    this.properties.visible = argument;\n\n    // Hide - show the render\n    if (bizagi.util.parseBoolean(argument)) {\n      if (this.properties.type !== \"hidden\") {\n        this.element.show();\n        this.element.css(\"display\", \"\");\n      }\n    } else if (this.element) {\n      this.element.hide();\n    }\n  },\n\n  /**\r\n      *  Changes the render required\r\n      * @param argument\r\n      */\n  changeRequired: function changeRequired(argument) {\n    // Update properties\n    this.properties.required = argument;\n\n    if (bizagi.util.parseBoolean(argument) && this.properties.editable) {\n      this.element.addClass(\"bz-form-item--required\");\n    } else {\n      this.element.removeClass(\"bz-form-item--required\");\n    }\n\n    // Perform validations again to check if the form is valid after this change\n    this.triggerRenderValidate();\n  },\n\n  /**\r\n      * This method just make a toggle of red label indicator\r\n      * @argument {boolean} argument\r\n      */\n  changeRequiredLabel: function changeRequiredLabel(argument) {\n    // Prevent take the base\n  },\n\n  /**\r\n      * Change cell editability and attach bindings\r\n      * @param argument\r\n      * @param key\r\n      * @param xpath\r\n      */\n  changeEditabilityCellControl: function changeEditabilityCellControl(argument, key, xpath) {\n    this._super(argument, key, xpath);\n  } });","/*\r\n*   Name: Bizagi Smartphone Form Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the form class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.form\", bizagi.rendering.form.prototype);\n// Auto extend\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.form\", {}, {\n\n  init: function init(params) {\n    var self = this;\n    params = params || {};\n    // Define variables\n    self.warnings = {};\n    self.errors = {};\n    if (params.syncError) {\n      params.data.properties.editable = params.isOfflineErrorMode !== true;\n      var syncMessage = params.syncError.type == \"business\" ? params.syncError.message : undefined;\n      if (!bizagi.util.isEmpty(syncMessage)) {\n        try {\n          syncMessage = $.makeArray(syncMessage);\n          syncMessage.forEach(function (currentMessage) {\n            self.errors[currentMessage] = currentMessage;\n          });\n        } catch (e) {\n          console.error(\"syncErrorMessage could not be parsed as array\", syncMessage);\n          self.errors[syncMessage] = syncMessage;\n        }\n      }\n      delete params.syncError;\n    }\n    self.isOfflineErrorMode = params.isOfflineErrorMode === true;\n    self.showToastOnSuccessSync = params.showToastOnSuccessSync === true;\n    self.removeSyncErrorOnSubmit = params.removeSyncErrorOnSubmit === true;\n    // Call base\n    this._super(params);\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each container after processed\r\n      */\n  postRenderContainer: function postRenderContainer(container) {\n    var self = this;\n\n    self._super(container);\n    var buttons = self.getButtons();\n\n    //disable overflow-scrolling touch untill the form is loaded QA-2178\n    if (bizagi.util.isiOSTabletDevice()) {\n      $(\".km-native-scroller\").css(\"-webkit-overflow-scrolling\", \"inherit\");\n    }\n\n    // Show warnings\n    if (!bizagi.util.isObjectEmpty(self.warnings)) {\n      var warningContainer = $('<ul class=\"ui-bizagi-form-warnings\"></ul>');\n      for (var key in self.warnings) {\n        warningContainer.append($('<li>' + key + '</li>'));\n      }\n\n      // Add button\n      $(\"<button>\" + \"X\" + \"</button>\").appendTo(warningContainer);\n\n      // Append to body \n      warningContainer.prependTo(self.container);\n      warningContainer.click(function () {\n        warningContainer.detach();\n      });\n    }\n\n    // Show errors\n    if (!bizagi.util.isEmpty(self.errors)) {\n      for (var ekey in self.errors) {\n        setTimeout(function () {\n          self.addValidationMessage(ekey);\n        }, 1);\n      }\n    }\n\n    //Set button length\n    var lengthButtons = buttons ? buttons.length : 0;\n\n    if (lengthButtons) {\n\n      $(document).data(\"auto-save\", \"auto-save\");\n\n      //bind event auto-save\n      $(document).unbind(\"save-form\").bind(\"save-form\", function (e, deferredSave) {\n        if (self.allowOnlineActions()) {\n          self.autoSaveEvents(deferredSave);\n        } else {\n          deferredSave.resolve();\n        }\n      });\n\n      //bind event beforeunload\n      $(window).unbind('beforeunload').bind('beforeunload', function (e) {\n        var newData = {};\n        self.collectRenderValues(newData);\n\n        //if there are changes in the form show a message\n        if (!$.isEmptyObject(newData) && $(document).data('auto-save'))\n        return bizagi.localization.getResource(\"confirmation-savebox-message2\");\n\n        return;\n      });\n    }\n\n    // Process Sections opened\n    var formParams = this.getParams() || {};\n    var selectedSections = $.extend([], formParams.selectedSection);\n    this.setParam(\"selectedSection\", []);\n    if (selectedSections.length > 0) {\n      selectedSections.forEach(function (id) {\n        var section = self.getRenderById(id);\n        if (typeof section !== \"undefined\") {\n          section.expand();\n        }\n      });\n    }\n  },\n\n  /**\r\n      * Auto Save Events\r\n      *\r\n      * @param {} deferredSave\r\n      * @param {} saveBox\r\n      * @returns {}\r\n      */\n  autoSaveEvents: function autoSaveEvents(deferredSave, saveBox) {\n    var self = this;\n    var data = {};\n\n    if (self.isOfflineErrorMode) {\n      deferredSave.resolve();\n      return;\n    }\n\n    self.collectRenderValues(data);\n\n    if (!$.isEmptyObject(data)) {\n      var isStartForm = self.properties.formtype === \"startform\";\n      var message = isStartForm ? bizagi.localization.getResource(\"confirmation-savebox-message4\") : bizagi.localization.getResource(\"confirmation-savebox-message1\");\n\n      var confirmation = isStartForm ? bizagi.showConfirmationBox(message, \"Bizagi\", \"warning\", [{ label: bizagi.localization.getResource(\"confirmation-box-ok\"), action: \"resolve\" }, { label: bizagi.localization.getResource(\"confirmation-box-cancel\"), action: \"reject\" }]) :\n      bizagi.showSaveBox(message, \"Bizagi\", \"warning\");\n      $.when(confirmation).\n      done(function () {\n        if (!isStartForm) {\n          bizagi.loading.start();\n          $.when(self.saveForm()).\n          always(function () {\n            if (self.params.isOfflineForm && self.params.offlineType === \"task\" && self.online) {\n              var syncDeferred = new $.Deferred();\n              var syncParams = $.extend({ deferred: syncDeferred }, self.params);\n              $(document).trigger(\"tryPushCase.offline\", syncParams);\n              $.when(syncDeferred).\n              then(function () {\n                deferredSave.resolve();\n              }).\n              fail(function () {\n                console.log(\"Auto-Save Sync Error\", arguments);\n                //Resolve the save to allow back to the inbox\n                deferredSave.resolve();\n              }).always(function () {\n                bizagi.loading.stop();\n              });\n            } else\n            {\n              bizagi.loading.stop();\n              deferredSave.resolve();\n            }\n          });\n        } else {\n          deferredSave.resolve();\n        }\n      }).fail(function () {\n        if (isStartForm) {\n          deferredSave.reject();\n        } else {\n          deferredSave.resolve();\n        }\n      });\n    } else {\n      deferredSave.resolve();\n    }\n  },\n\n  /**\r\n      * TEMPLATE METHOD TO GET THE BUTTONS OBJECTS\r\n      */\n  getButtons: function getButtons() {\n    var self = this;\n\n    if (self.getParams() && (handler = self.getParams().getButtons))\n    handler(self);\n\n    return $(\".ui-bizagi-button-container :button\", self.container);\n  },\n\n  processButtons: function processButtons() {\n    var self = this;\n    var params = self.getParams();\n\n    if (params && params.processButtons) {\n      var handler = params.processButtons;\n      handler(self);\n    }\n\n    var properties = self.properties;\n    properties.buttons = self.buttons;\n\n    // To cache a submit Data Buttom if exist\n    self.saveButton = null;\n    self.nextButton = null;\n\n    // Set saveButton and nextButton if exist\n    for (var i = 0, length = properties.buttons.length; i < length; i++) {\n      if (properties.buttons[i].action === \"save\") {\n        self.saveButton = properties.buttons[i];\n      } else if (properties.buttons[i].action === \"next\") {\n        self.nextButton = properties.buttons[i];\n      }\n    }\n\n    var navigation = self.getNavigation();\n\n    if (typeof navigation !== \"undefined\") {\n      //si tiene un viewConteiner sera porque es una forma dentro de container de edicion\n      var view_container = self.getViewContainer();\n      if (typeof view_container !== \"undefined\") {\n        view_container.setNavigationButtons(self);\n      } else {\n        navigation.setNavigationButtons(self);\n      }\n    }\n\n    // bind de touch events\n    self.bindTouchEvents(self.getButtons());\n  },\n\n  refreshForm: function refreshForm(focus) {\n    var self = this;\n    var params = self.getParams();\n    var defer = new $.Deferred();\n\n    focus = focus || self.getFocus();\n\n    var options = {\n      idCase: self.params.idCase || \"\",\n      idWorkitem: self.params.idWorkitem || \"\",\n      idTask: self.params.idTask || \"\",\n      focus: focus,\n      selectedTabs: self.getSelectedTabs(),\n      selectedSection: self.getSelectedSection(),\n      xpathContext: self.properties.xpathContext,\n      idPageCache: self.properties.idPageCache,\n      isRefresh: true,\n      action: self.getEndPointAction(),\n      idStartScope: self.properties.idStartScope || \"\",\n      navigation: params.navigation,\n      view_container: params.view_container };\n\n\n    if (self.isOfflineRefreshWithEdition) {\n      options.isEdited = true;\n      self.isOfflineRefreshWithEdition = false;\n    }\n\n    if (params.postRenderEdit || params.processButtons) {\n      options.postRenderEdit = params.postRenderEdit;\n      options.processButtons = params.processButtons;\n      options.originalParams = params.originalParams || {};\n      options.getButtons = params.getButtons;\n    }\n\n    // Notify the refresh event so the consumer takes the decision about what to do\n    self.startLoading();\n\n    $.when(self.triggerHandler(\"refresh\", options)).done(function () {\n      defer.resolve();\n    }).fail(function () {\n      defer.reject();\n    }).always(function () {\n      self.endLoading();\n    });\n\n    return defer.promise();\n  },\n\n  startLoading: function startLoading(delay) {\n    bizagi.util.smartphone.startLoading();\n  },\n\n  endLoading: function endLoading() {\n    bizagi.util.smartphone.stopLoading();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the container's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var form = self.container;\n\n    // Process complex-gateway\n    self.configureComplexGateway();\n\n    // Process buttons\n    self.processButtons(form);\n\n    // Check for dom included event\n    self.bind(\"ondomincluded\", function () {\n      var $canvas = self.getValidationsContainer();\n\n      // Creates validation controller after the form is ready\n      self.validationController = new bizagi.command.controllers.validation(self, self.validations, $canvas);\n\n      // Creates action controller after the form is ready\n      self.actionController = new bizagi.command.controllers.action(self, self.actions);\n\n      // Resolve this deferred to start executing DOM dependant plugins\n      self.readyDeferred.resolve();\n    });\n\n    //Event to notify the native code the form will be showing a modal view\n    self.bind(\"modalViewDidAppear\", function () {\n      self.params.navigation.modalViewDidAppear();\n    });\n\n    self.bind(\"closeModalValidationMessage\", function () {\n      if (self.validationController) {\n        self.validationController.clearValidationMessages();\n      }\n    });\n\n    //Event to notify the native code the form will be hiding a modal view\n    self.bind(\"modalViewDidDisappear\", function () {\n      self.params.navigation.modalViewDidDisappear();\n    });\n\n    // Add network listener\n    self.configureNetworkHandlers();\n  },\n\n  internalSubmitForm: function internalSubmitForm(buttonProperties) {\n    var self = this;\n    var actions = [];\n    var defer = $.Deferred();\n    var submitDataAction = null;\n    var executeButtonAction = null;\n    var performAction = null;\n    var checkpointAction = null;\n    var commitAction = null;\n    var data = {};\n\n    // Fill data hash | Collect data\n    if (buttonProperties.submitData || buttonProperties.executeRule || buttonProperties.createnewcase)\n    data = self.collectRenderValuesForSubmit();\n\n    // Start asynchronous operation\n    $.when(self.startLoading()).done(function () {\n      $('html, body').animate({ scrollTop: $('.ui-bizagi-loading-icon') }, 'slow');\n    });\n\n    // Prepare actions\n    // When the button has to execute any rule (MUST SUBMIT DATA BEFORE ALWAYS)\n    if (buttonProperties.executeRule) {\n      submitDataAction = self.dataService.submitData({\n        action: \"SUBMITDATA\",\n        data: data,\n        xpathContext: self.properties.xpathContext,\n        idPageCache: self.properties.idPageCache,\n        prepare: true });\n\n\n      submitDataAction.tag = \"submitData\";\n      checkpointAction = self.prepareCheckpointAction(buttonProperties.id);\n\n      // Reset data because when an execute rule operation has been performed, it saved already all the data\n      data = {};\n      executeButtonAction = self.dataService.executeButton({\n        idRender: buttonProperties.id,\n        xpathContext: self.properties.xpathContext || \"\",\n        idPageCache: self.properties.idPageCache,\n        prepare: true });\n\n\n      executeButtonAction.tag = \"executeRule\";\n      commitAction = self.prepareCommitAction(buttonProperties.id);\n    }\n\n    if (buttonProperties.next || buttonProperties.back || buttonProperties.save || buttonProperties.createnewcase || buttonProperties.nextWithoutValidations) {\n      // Verify transitions\n      if (self.transitions) {\n        var transitions = [];\n        $.each(this.activeTransitions, function (key, value) {\n          value ? transitions.push(key) : \"\";\n        });\n\n        if (bizagi.util.countProps(transitions) == 0) {\n          var messageComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-path\");\n          var errorComplexGateway = bizagi.localization.getResource(\"render-widget-complexgateway-error\");\n\n          bizagi.showMessageBox(messageComplexGateway, errorComplexGateway, \"info\", false);\n          self.endLoading();\n          defer.reject();\n          return defer.promise();\n        }\n      }\n\n      performAction = self.dataService.submitData({\n        action: buttonProperties.action,\n        forcePlanCompletion: buttonProperties.forcePlanCompletion,\n        data: data,\n        xpathContext: self.properties.xpathContext,\n        idPageCache: self.properties.idPageCache,\n        prepare: true,\n        transitions: transitions || \"\",\n        contexttype: self.properties.contextType,\n        surrogatekey: self.properties.surrogateKey });\n\n\n      performAction.tag = \"performAction\";\n    }\n\n    if (executeButtonAction) {\n      actions.push(submitDataAction);\n\n      //Validates if the method CHECKPOINT is supported\n      if (checkpointAction) {\n        actions.push(checkpointAction);\n      }\n\n      actions.push(executeButtonAction);\n\n      //Validates if the method COMMIT is supported\n      if (commitAction) {\n        actions.push(commitAction);\n      }\n    }\n\n    if (performAction)\n    actions.push(performAction);\n\n    //Evaluate if there are deferreds to evaluate, like inline add in grid, that must send a ADDRELATIONWITHDATA before to savedata\n    var flowControlDeferred = new $.Deferred();\n\n    if (data && data.deferreds) {\n      $.when.apply(this, data.deferreds).\n      done(function (response) {\n        flowControlDeferred.resolve(response);\n      }).fail(function () {\n        console.log(\"Error: It was not possible resolve async actions on form \");\n        flowControlDeferred.reject();\n      });\n    } else {\n      flowControlDeferred.resolve();\n    }\n\n    $.when(flowControlDeferred).done(function () {\n      bizagi.util.smartphone.startLoading();\n      $.when(self.dataService.multiaction().execute({ actions: actions })).done(function (responses) {\n        //Hard refresh buttons\n        if (bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()) {\n          var navigation = self.getNavigation();\n          if (typeof navigation !== \"undefined\") {\n            navigation.setNavigationButtons(self);\n          }\n        }\n        // End asynchronous operation\n        self.endLoading();\n        // Find validations\n        var bHasValidations;\n        $.each(responses, function (i, response) {\n          // Something went wrong, we gotta display messages in notifications grid\n          if (response.result.type == \"validationMessages\") {\n            self.addValidationMessage(response.result.messages);\n            bHasValidations = true;\n          }\n          if (response.result.type == \"alertMessages\") {\n            // Something went wrong, we are gonna display messages in an alert\n            bizagi.showMessageBox(response.result.messages.join(','), bizagi.localization.getResource(\"workportal-general-word-information\", \"Information\"));\n            bHasValidations = true;\n          }\n        });\n\n        if (!bHasValidations) {\n          // Everything went ok .. succesfully response from the server\n          if (!self.postProcessButton(responses, buttonProperties))\n          return;\n\n          // After successfully response refresh the form\n          if (buttonProperties.refresh)\n          self.refreshForm();\n\n          // If needs routing publish an event\n          if (buttonProperties.routing) {\n            self.triggerHandler(\"routing\", { idCase: self.params.idCase });\n          }\n\n          // Create case\n          if (buttonProperties.createnewcase) {\n            if (responses.length > 0) {\n              self.triggerHandler(\"routing\", {\n                idCase: responses[0].result.IdCase,\n                caseNumber: responses[0].result.CaseNumber });\n\n            }\n          }\n        } else {\n          if (buttonProperties.executeRule)\n          self.sendRollbackAction(buttonProperties.id);\n        }\n\n        //Removes the nonSupportedMethods to prevent further iterations\n        delete self.nonSupportedMethods;\n\n        defer.resolve();\n      }).fail(function (res, res2, response) {\n        var messageError = \"\";\n        var errorTypeList = [\"WaitForCompletionPlanException\", \"InvalidPlanStateException\", \"CustomMessageException\"];\n\n        if (buttonProperties.executeRule) self.sendRollbackAction(buttonProperties.id);\n\n        if (response && response.error && errorTypeList.indexOf(response.error.errorType) !== -1) {\n          messageError = bizagi.localization.getResource(response.error.message);\n          self.endLoading();\n\n          $.when(bizagi.showConfirmationBox(messageError, null, false)).then(function () {\n            var _params = $.extend({}, buttonProperties, { forcePlanCompletion: true });\n\n            return $.when(self.internalSubmitForm(_params));\n          }).done(function () {\n            defer.resolve();\n          }).fail(function () {\n            defer.reject();\n          });\n        } else {\n          messageError = typeof response === \"undefined\" ? bizagi.localization.getResource(\"workportal-general-error\") : response;\n          self.failHandler({ \"error\": messageError });\n          defer.reject(response);\n        }\n      }).always(function () {\n        bizagi.util.smartphone.stopLoading();\n      });\n    }).always(function () {\n      bizagi.util.smartphone.stopLoading();\n    });\n\n    return defer.promise();\n  },\n\n  prepareCheckpointAction: function prepareCheckpointAction(id) {\n    return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\n  },\n\n  prepareCommitAction: function prepareCommitAction(id) {\n    return bizagi.util.validateFeatureSupport(\"commitRollbackActions\") ? this._super(id) : null;\n  },\n\n  getNavigation: function getNavigation() {\n    var params = this.getFormContainer().getParams();\n    return params.navigation;\n  },\n\n  getViewContainer: function getViewContainer() {\n    var params = this.getFormContainer().getParams();\n    return params.view_container;\n  },\n\n  isFloatingButtonsEnabled: function isFloatingButtonsEnabled() {\n    var navigation = this.getNavigation();\n    return navigation && navigation.isFloatingButtonsEnabled();\n  },\n\n  isFormButtonsEnabled: function isFormButtonsEnabled() {\n    var navigation = this.getNavigation();\n    return navigation && navigation.isFormButtonsEnabled();\n  },\n\n  dispose: function dispose(params) {\n    // Active refresh on smartphone\n    if (typeof params === \"undefined\" || typeof params.isRefresh === \"undefined\" || params.isRefresh == false) {\n      this._super();\n    }\n  },\n\n  /**\r\n      * Publish a global event that the facade will replicate, also will be triggered in the form\r\n      */\n  triggerGlobalHandler: function triggerGlobalHandler(eventType, data) {\n    var self = this;\n\n    if (!self.parent) {\n      if (self.observableElement) {\n        self.observableElement.trigger(eventType, data);\n      }\n    } else {\n      self.parent.triggerGlobalHandler(eventType, data);\n    }\n\n    return self._super(eventType, data);\n  },\n\n  // TODO: REVIEW, ADD NOTIFIER PLUGIN!!!\n  failHandler: function failHandler(error) {\n    var self = this;\n    self._super(error);\n\n    var error_obj = {};\n\n    try {\n      error_obj = JSON.parse(error) || {};\n    } catch (e) {\n      error_obj = error.length && error.length > 1 ? error[0] : error;\n    } finally {\n      //This double validation has the purpose to get the real error object from two different levels ( error.error or error.error.error )\n      if (error_obj.error) error_obj = error_obj.error;\n      if (error_obj.error) error_obj = error_obj.error;\n\n      // trigger the routing event in order to refresh the case\n      if (typeof error_obj.code !== \"undefined\" && error_obj.code === \"AUTH_ERROR\") {\n        self.refreshAfterSessionIdle();\n      }\n    }\n  },\n\n  /**\r\n      * Display session IDLE message error and routing to process\r\n      */\n  refreshAfterSessionIdle: function refreshAfterSessionIdle() {\n    // Show notification message\n    this.showMessageSessionIdle();\n\n    // Refresh the process\n    this.routingToProcess();\n  },\n\n  /**\r\n      * Show message for session idle error\r\n      * @constructor\r\n      */\n  showMessageSessionIdle: function showMessageSessionIdle() {\n    $.notifier.add({\n      title: bizagi.localization.getResource(\"workportal-sessiontimeout-expired-title\", \"Your session has expired\"),\n      text: bizagi.localization.getResource(\"render-idle-expired-error\", \"Idle timer expired. For safety reasons this view will be refreshed automatically in 5 seconds. Note that any unsaved data is lost.\").replace(\"%s\", \"5\"),\n      sticky: false,\n      time: 5000 });\n\n  },\n\n  /**\r\n      * Refresh the process\r\n      */\n  routingToProcess: function routingToProcess() {\n    var self = this;\n    var params = self.params || {};\n    var form = self.getFormContainer();\n    var isStartForm = form && form.isStartForm();\n\n    setTimeout(function () {\n      if (isStartForm) {\n        var processParams = params && params.originalParams || {};\n        if (processParams && processParams.idProcess) {\n          bizagi.webpart.publish(\"render-start-form\", {\n            params: {\n              showProcess: true,\n              hasStartForm: true,\n              fromNewCase: true,\n              idProcess: processParams.idProcess,\n              displayName: processParams.displayName || \"\",\n              mapping: {},\n              type: \"Process\" } });\n\n\n        }\n      } else {\n        self.triggerHandler(\"routing\", {\n          idCase: params.idCase,\n          idWorkitem: params.idWorkitem });\n\n      }\n    }, 5000);\n  },\n\n  /**\r\n      * Build the container html\r\n      */\n  renderContainer: function renderContainer() {\n    var self = this;\n    var properties = this.properties;\n    var template = self.renderFactory.getTemplate(\"form\");\n    var idCase = \"\";\n\n    // Render the form\n    var html = $.fasttmpl(template, {\n      buttons: self.buttons,\n      transitions: self.transitions,\n      uniqueId: properties.uniqueId,\n      helptext: properties.helpText,\n      mode: self.getMode(),\n      queryForm: self.getFormType() == \"queryForm\",\n      summaryForm: self.params.summaryForm || false,\n      globalForm: self.properties.displayAsReadOnly || false,\n      idCase: idCase,\n      displayName: self.params.displayName || idCase,\n      processPath: properties.processPath,\n      breadCrumb: properties.breadCrumb,\n      orientation: properties.orientation });\n\n\n    // Render children\n    return self.replaceChildrenHtml(html, self.renderChildrenHtml());\n  },\n\n  bindTouchEvents: function bindTouchEvents(buttons) {\n    var self = this;\n    var touchMoveStart = 0;\n\n    // Don't process buttons if they are undefined in the template\n    if (!buttons || buttons.length === 0) return;\n\n    buttons.bind(\"touchstart\", function (event) {\n      event.preventDefault();\n\n      var pointer = event.originalEvent.targetTouches ? event.originalEvent.targetTouches[0] : event;\n      var currentPossitionY = pointer.pageY;\n\n      touchMoveStart = currentPossitionY;\n    });\n\n    buttons.bind(\"touchend\", function (event) {\n      event.preventDefault();\n\n      // Trigger the blur of the focused element in order to catch the render Change in the last changed control\n      $(\":focus\", self.container).blur();\n      var pointer = event.originalEvent.changedTouches ? event.originalEvent.changedTouches[0] : event;\n      var currentPositionY = pointer.pageY;\n\n      self.startLoading();\n\n      // If the finger is too far from the button when you stop touching the screen, then do nothing\n      if (event.type !== \"click\" && currentPositionY > touchMoveStart + 40 || currentPositionY < touchMoveStart - 40) {\n        self.endLoading();\n      } else {\n        var button = $(this);\n        var ordinal = button.attr(\"ordinal\");\n        var buttonProperties = self.buttons[ordinal];\n\n        // Execute button\n        $.when(self.processButton(buttonProperties)).always(function () {\n          self.endLoading();\n        });\n      }\n    });\n\n    buttons.bind(\"click\", function () {\n      self.startLoading();\n      var ordinal = $(this).attr(\"ordinal\");\n      var buttonProperties = self.buttons[ordinal];\n\n      // Execute button\n      $.when(self.processButton(buttonProperties)).always(function () {\n        self.endLoading();\n      });\n    });\n\n    return;\n  },\n\n  /**\r\n      * Configure actions to complex-gateway\r\n      */\n  configureComplexGateway: function configureComplexGateway() {\n    var self = this;\n    var complexGatewayContainer;\n    var form = self.container;\n\n    if (form.length > 1) {\n      $(form.children()).each(function () {\n        if ($(this).hasClass('.bz-complex-gateway'))\n        complexGatewayContainer = this;\n      });\n    } else {\n      complexGatewayContainer = $(\".bz-complex-gateway\", form);\n    }\n\n    // activeTransitions is used to store ids of activities in Complex Gateway\n    self.activeTransitions = {};\n\n    // Set events for complex gateway interface\n    $(\".bz-checkbox__input\", complexGatewayContainer).on(\"click\", function () {\n      var $selected = $(this);\n      var transitionId = $selected.data(\"value\") || \"\";\n\n      if (typeof self.activeTransitions[transitionId] == \"undefined\") {\n        self.activeTransitions[transitionId] = false;\n      }\n\n      self.activeTransitions[transitionId] = $selected.is(':checked') || false;\n\n    });\n  },\n\n  /**\r\n      * Perform validation container\r\n      * @param form\r\n      * @param mainForm\r\n      * @returns {*}\r\n      */\n  getValidationsContainer: function getValidationsContainer(mainForm) {\n    var form = this;\n    var navigation = form.getNavigation();\n\n    if (typeof navigation !== \"undefined\") {\n      var view_container = form.getViewContainer();\n      var $currentView = typeof view_container !== \"undefined\" ? view_container.view : navigation.view;\n\n      if ($currentView && $currentView.footer) {\n        return $currentView.footer;\n      }\n    }\n\n    return this._super(mainForm);\n  } });","/**\r\n *   Name: Bizagi Smartphone Panel Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.panel\", bizagi.rendering.panel.prototype);\n// Extends itself\nbizagi.rendering.smartphone.panel.extend(\"bizagi.rendering.smartphone.panel\", {}, {});","/**\r\n *   Name: Bizagi Smartphone ContentPanel Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the content panel class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.contentPanel\", bizagi.rendering.contentPanel.prototype);\n// Extends itself\nbizagi.rendering.smartphone.contentPanel.extend(\"bizagi.rendering.smartphone.contentPanel\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Nested Form Extension\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define a nested form container class for smartphone devices\r\n*/\n\n// Extends from panel smartphone base\nbizagi.rendering.smartphone.panel.extend(\"bizagi.rendering.smartphone.nestedForm\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Tab Container Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.tab\", bizagi.rendering.tab.prototype);\n// Auto extend\nbizagi.rendering.smartphone.tab.extend(\"bizagi.rendering.smartphone.tab\", {}, {\n\n  /* POST RENDER CONTAINER ACTIONS\r\n                                                                                =================================================*/\n  postRenderContainer: function postRenderContainer(container) {\n    var self = this;\n\n    this._super(container);\n\n    container.material_bizagi_tabs({\n      direction: this.properties.orientation,\n      active_index_tab: this.activeTab }).\n    on(\"updateActive\", function (ev, info) {\n      ev.stopPropagation();\n\n      self.setActiveTab(info.index);\n    });\n\n    $(\"> .bz-tabs > .bz-tab\", container).rippleEffect();\n  } });","/*\r\n*   Name: Bizagi Smartphone Panel Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the container class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.tabItem\", bizagi.rendering.tabItem.prototype);\n// Extends itself\nbizagi.rendering.smartphone.tabItem.extend(\"bizagi.rendering.smartphone.tabItem\", {}, {\n\n  /**\r\n                                                                                         * Change selected item\r\n                                                                                         *\r\n                                                                                         * @param {} argument\r\n                                                                                         * @returns {}\r\n                                                                                         */\n  setAsActiveContainer: function setAsActiveContainer(argument) {\n    var self = this;\n\n    $.when(self.ready()).done(function () {\n      var tabItem = $(\"[data-reference='#ui-bizagi-tab-\" + self.properties.id + \"']\", self.parent.tabs);\n\n      tabItem.css(\"display\", \"\");\n      tabItem.click();\n    });\n  },\n  /* \r\n     *   Focus on container\r\n     */\n  focus: function focus() {\n    // Activate the tab if it hasn't been loaded\n    this.activate();\n\n    // Set this tab as an active container\n    this.setAsActiveContainer();\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      *  Hides / Show container\r\n      *\r\n      * @param {} argument\r\n      * @returns {}\r\n      */\n  changeVisibility: function changeVisibility(argument) {\n    var self = this;\n\n    // Store in properties\n    self.properties.visible = bizagi.util.parseBoolean(argument);\n\n    $.when(self.ready()).done(function () {\n      var tabItem = $(\"[data-reference='#ui-bizagi-tab-\" + self.properties.id + \"']\", self.parent.tabs);\n      var activeTab = self.parent.container.material_bizagi_tabs(\"getActiveTab\");\n\n      // Hide - show the render\n      if (self.properties.visible) {\n        tabItem.css(\"display\", \"\");\n        if (self.properties.counter === activeTab.index) {\n          self.container.css(\"display\", \"\");\n          self.setAsActiveContainer();\n        } else {\n          self.container.css(\"display\", \"none\");\n        }\n      } else {\n        self.container.css(\"display\", \"none\");\n        tabItem.css(\"display\", \"none\");\n\n        // If we are focus in the same tab is going to be invisible\n        activeTab = self.parent.container.material_bizagi_tabs(\"getActiveTab\");\n\n        if (self.properties.counter === activeTab.index) {\n          self.parent.container.material_bizagi_tabs(\"moveToNextTab\");\n        } else {\n          self.parent.container.material_bizagi_tabs(\"refreshPositions\");\n        }\n      }\n    });\n  },\n\n  afterToRefresh: function afterToRefresh() {\n    var self = this;\n    self._super();\n    $.when(self.ready()).done(function () {\n      self.parent.container.material_bizagi_tabs(\"refreshTab\", self.properties.id);\n    });\n  } });","/*\r\n*   Name: Bizagi Smartphone Horizontal Container Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the horizontal container class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.horizontal\", bizagi.rendering.horizontal.prototype);\n// Auto extend\nbizagi.rendering.smartphone.horizontal.extend(\"bizagi.rendering.smartphone.horizontal\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Layout Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the layout class to adjust to smartphone devices\r\n*/\n\n// Extends from container desktop base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.layout\", bizagi.rendering.layout.prototype);\n// Extends itself\nbizagi.rendering.smartphone.layout.extend(\"bizagi.rendering.smartphone.layout\", {}, {});","/*\r\n*   Name: Bizagi smartphone Accordion Container Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the accordion class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.accordion\", bizagi.rendering.accordion.prototype);\n// Extends itself\nbizagi.rendering.smartphone.accordion.extend(\"bizagi.rendering.smartphone.accordion\", {}, {});","/*\r\n*   Name: Bizagi smartphone AccordionItem Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the accordion item class to adjust to smartphone devices\r\n*/\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.accordionItem\", bizagi.rendering.accordionItem.prototype);\n// Extends itself\nbizagi.rendering.smartphone.accordionItem.extend(\"bizagi.rendering.smartphone.accordionItem\", {}, {});","/*\r\n *   Name: Bizagi Smartphones Group Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the group class to adjust to smartphones devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.group\", bizagi.rendering.group.prototype);\n// Auto extend\nbizagi.rendering.smartphone.group.extend(\"bizagi.rendering.smartphone.group\", {}, {\n\n  /**\r\n                                                                                    * Method to customize the container's behaviour to add handlers\r\n                                                                                    */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    $(\">h5.bz-collapsible__header\", self.container).bind(\"click\", function () {\n      $(self.container).toggleClass(\"bz-collapsible--collapsed\");\n    });\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each container after processeds\r\n      * @param {} group      \r\n      */\n  postRenderContainer: function postRenderContainer(group) {\n    // Call base\n    this._super(group);\n    if (this.properties.collapse) {\n      this.collapse();\n    }\n  },\n\n  /**\r\n     * Check if group its open\r\n     * \r\n     * @return boolean\r\n     */\n  isOpen: function isOpen() {\n    return this.container.hasClass(\"bz-collapsible--collapsed\") ? false : true;\n  },\n\n  /**\r\n      * Focus on container     \r\n      */\n  focus: function focus() {\n    // Expand container\n    this.expand();\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Expands group container \r\n      * @returns {} \r\n      */\n  expand: function expand() {\n    if (!this.isOpen()) {\n      $(\">h5.bz-collapsible__header\", this.container).trigger(\"click\");\n    }\n  },\n\n  /**\r\n      * Collapses group container \r\n      * @returns {} \r\n      */\n  collapse: function collapse() {\n    if (this.isOpen()) {\n      $(\">h5.bz-collapsible__header\", this.container).trigger(\"click\");\n    }\n  },\n\n  /**\r\n      * Expands or collapse the container from actions\r\n      * @param {} argument      \r\n      */\n  toogleContainer: function toogleContainer(argument) {\n    if (argument) {\n      this.expand();\n    } else {\n      this.collapse();\n    }\n  } });","/*\r\n *   Name: Bizagi Smartphone Section Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the section class to adjust to smartphone devices\r\n */\n\n// Extends from container tablet base\nbizagi.rendering.smartphone.container.extend(\"bizagi.rendering.smartphone.section\", bizagi.rendering.section.prototype);\n// Auto extend\nbizagi.rendering.smartphone.section.extend(\n\"bizagi.rendering.smartphone.section\",\n{},\n{\n  /*\r\n   *   Render the container layout\r\n   */\n  renderContainer: function renderContainer() {\n    var self = this;\n    var properties = this.properties;\n    var template = self.renderFactory.getTemplate(\"section\");\n\n    // Render the panel\n    var html = $.fasttmpl(template, {\n      expandedClassIcon: self.expandedIcon,\n      displayName: properties.displayName,\n      editable: properties.editable,\n      orientation: properties.orientation,\n      uniqueId: properties.uniqueId,\n      isDesign: self.getMode() !== \"execution\",\n      messageValidation: properties.messageValidation,\n      guid: properties.guid,\n      displayAs: properties.displayAs });\n\n\n    // Render children\n    html = self.replaceChildrenHtml(html, self.renderChildrenHtml());\n    return html;\n  },\n\n  /**\r\n      * Method to customize the container's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    //Fix para establecer la orientacin correcta en el modal\n    var dir = self.getSectionOrientationRTL(self) ? \"rtl\" : \"ltr\";\n    $(self.container).attr(\"dir\", dir);\n\n    self.bind(\"reopenSection\", function () {\n      self.expand();\n    });\n\n    $(\">div.bz-section__content\", self.container).mobileModal({\n      displayName: self.properties.displayName,\n      anchor: $(\">div.bz-section__header\", self.container),\n      appendTo: self.container,\n      dir: dir,\n      onBeforeShow: function onBeforeShow(m) {\n        self.addToHistoryNavigation();\n        setTimeout(function () {\n          var p = self.getSectionParent(self.parent);\n          var isIphoneNative = bizagi.util.isiOSSmartphoneDevice() && bizagi.util.isNativePluginSupported();\n          if (isIphoneNative) {\n            bizagiapp.sectionDidAppear();\n          } else {\n            $(\"header[data-role=header]\").css({ display: \"none\" });\n            $(\"div[data-role=footer] .bz-form-buttons\").css({ \"display\": \"none\" });\n          }\n\n          if (!self.isFirstLevel(true)) {\n            $($(\"div[data-role=header]\", p.container)[0]).css({ display: \"none\" });\n          }\n        }, 250);\n      },\n\n      onClose: function onClose(m) {\n        if (m) m.close();\n        self.removeFromHistoryNavigation();\n        var p = self.getSectionParent(self.parent);\n        if (self.isFirstLevel()) {\n          var isIphoneNative = bizagi.util.isiOSSmartphoneDevice() && bizagi.util.isNativePluginSupported();\n\n          if (isIphoneNative) {\n            bizagiapp.sectionDidDisappear();\n          } else {\n            $('header[data-role=header]').css({ \"display\": \"block\" });\n            $(\"div[data-role=footer] .bz-form-buttons\").css({ \"display\": \"flex\" });\n          }\n        } else {\n          $($(\"div[data-role=header]\", p.container)[0]).css({ display: \"flex\" });\n        }\n      } });\n\n  },\n\n  /**\r\n      * Return true if the section is on the main form, or false if it is nested.\r\n      */\n  isFirstLevel: function isFirstLevel(isOpen) {\n    var form = this.getFormContainer();\n    var params = form.getParams() || {};\n    var selected = params.selectedSection;\n    if (typeof selected === \"undefined\") return true;\n    return isOpen ? selected.length <= 1 : selected.length === 0;\n  },\n\n  /**\r\n      * Set the selected section opened\r\n      */\n  addToHistoryNavigation: function addToHistoryNavigation() {\n    var form = this.getFormContainer();\n    var params = form.getParams() || {};\n    if (typeof params.selectedSection === \"undefined\") {\n      form.setParam(\"selectedSection\", []);\n      params = form.getParams();\n    }\n    params.selectedSection.push(this.properties.id);\n  },\n\n  /**\r\n      * Unset the actual section as a opened section\r\n      */\n  removeFromHistoryNavigation: function removeFromHistoryNavigation() {\n    var form = this.getFormContainer();\n    var params = form.getParams() || {};\n    if (typeof params.selectedSection !== \"undefined\") {\n      params.selectedSection.pop();\n    }\n  },\n\n  /**\r\n      * Check if section its open\r\n      *\r\n      * @return boolean\r\n      */\n  isOpen: function isOpen() {\n    return this.container.hasClass(\"bz-section--collapsed\") ? false : true;\n  },\n\n  /**\r\n      * Focus on container\r\n      */\n  focus: function focus() {\n    // Expand container\n    this.expand();\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Shows slide section container\r\n      * @returns {}\r\n      */\n  expand: function expand() {\n    $(\">div.bz-section__header\", this.container).trigger(\"click\");\n  },\n\n  /**\r\n      * Closes slide section container\r\n      * @returns {}\r\n      */\n  collapse: function collapse() {\n    if (this.isOpen()) {\n      $(\">div.bz-section__header\", this.container).trigger(\"click\");\n    }\n  },\n\n  /**\r\n      * Shows or closes the slide section container from actions\r\n      * @param {} argument\r\n      */\n  toogleContainer: function toogleContainer(argument) {\n    if (argument) {\n      this.expand();\n    } else {\n      this.collapse();\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Search Form Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n */\n\n// Extends from container smartphone base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.searchForm\", bizagi.rendering.searchForm.prototype);\n// Extends itself\nbizagi.rendering.smartphone.searchForm.extend(\"bizagi.rendering.smartphone.searchForm\", {}, {\n\n  /*\r\n                                                                                              *   Render the results of the query\r\n                                                                                              *   Resolved in each device\r\n                                                                                              */\n  renderResult: function renderResult() {\n    var self = this;\n    var properties = self.properties;\n\n    // Creates grid definition\n    var data = {};\n    data.properties = {\n      displayName: self.getResource(\"render-search-advanced-results-label\"),\n      type: \"grid\",\n      xpath: \"searchForm\" + properties.id,\n      id: properties.id,\n      skipInitialLoad: true,\n      rowsPerPage: 10,\n      sortBy: properties.sortBy,\n      sortOrder: properties.sortOrder,\n      overrideGetRemoteData: function overrideGetRemoteData(params) {\n        return self.getRemoteData(params);\n      } };\n\n    data.elements = [];\n\n    // Creates columns\n    var columns = properties.columns;\n    $.each(columns, function (i) {\n      var column = {\n        render: {} };\n\n      column.render.properties = {\n        displayName: columns[i].caption,\n        xpath: columns[i].xpath,\n        editable: false };\n\n\n      $.extend(column.render.properties, self.parseAdditionalProperties(columns[i].dataType));\n\n      // Next conditional added to print only columns and not labels\n      // if type = label then column is not rendered on the results table\n      if (columns[i].dataType == 0)\n      column.render.properties.columnVisible = false;\n\n      // if column is number or monetary push allowDecimals property\n      if (columns[i].dataType == 7 || columns[i].dataType == 8)\n      column.render.properties.allowDecimals = columns[i].allowDecimals;\n\n      // if column is real or float set allowDecimals property to true\n      if (columns[i].dataType == 10 || columns[i].dataType == 11)\n      column.render.properties.allowDecimals = true;\n\n      // if column is date push showtime property\n      if (columns[i].dataType == 12)\n      column.render.properties.showTime = columns[i].showTime;\n\n      data.elements.push(column);\n    });\n\n    var grid = self.renderFactory.getRender({\n      type: \"grid\",\n      data: data,\n      parent: self,\n      mode: self.getMode() });\n\n\n    grid.properties.allowAdd = false;\n    grid.properties.allowEdit = false;\n    grid.properties.allowDelete = false;\n\n    // Saves reference\n    self.resultsGrid = grid;\n\n    return grid.render();\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize each container after processed\r\n     */\n  postRenderContainer: function postRenderContainer(container) {\n    var self = this;\n    self._super(container);\n\n    var results = container.find(\".bz-container__search-results\");\n    var mode = self.getMode();\n\n    // Process children elements\n    self.container = container;\n\n    // Process result\n    var grid = $(results.children()[0]);\n    self.resultsGrid.postRenderElement(grid);\n\n    // Apply handlers\n    if (mode == \"execution\") {\n      self.configureHandlers();\n    }\n\n    // Configure view\n    if (mode == \"design\") {\n      self.configureDesignView();\n    }\n\n    // Configure view\n    if (mode == \"layout\") {\n      self.configureDesignView();\n      self.configureLayoutView();\n    }\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Saves reference\n    self.criteriaContainer = $(\".bz-container__search-criteria\", self.container);\n    self.resultsContainer = $(\".bz-container__search-results\", self.container);\n\n    // Bind to grid row select event\n    self.resultsGrid.bind(\"rowSelected\", function (e, ui) {\n      if (self.properties.searchParams.hasOwnProperty(\"multiSelect\")) {\n        self.trigger(\"multiSelect\", ui);\n      } else {\n        // Trigger event to bubble up to main container\n        self.trigger(\"instanceSelected\", ui);\n      }\n    });\n  },\n\n  /*\r\n     *   Refresh the result panel, making it to query data with current criteria\r\n     */\n  refreshResults: function refreshResults() {\n    var self = this;\n    self.trigger(\"instancerefresh\");\n\n    $.when(self.resultsGrid.refresh()).done(function () {\n      self.trigger(\"instancerefreshdone\");\n\n      if (self.resultsGrid.properties.data && self.resultsGrid.properties.data.records == 0 && self.resultsGrid.properties.data.rows.length == 0) {\n        var message = bizagi.localization.getResource(\"workportal-general-no-records-found\");\n        var title = bizagi.localization.getResource(\"render-dialog-sendemail-message\");\n\n        bizagi.showMessageBox(message, title);\n      }\n    });\n  },\n  /*\r\n      *   Publish a global event that the facade will replicate, also will be triggered by the principal form\r\n      */\n  triggerGlobalHandler: function triggerGlobalHandler(eventType, data) {\n    var self = this;\n    self._super(eventType, data);\n    if (!self.parent) {\n      if (self.observableElement) {\n        return self.observableElement.trigger(eventType, data);\n      } else {\n        return null;\n      }\n    } else {\n      return self.parent.triggerGlobalHandler(eventType, data);\n    }\n  } });","/**\r\n *   Name: BizAgi Smartphone slide StartForm implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\n\n// Extends itself\n$.Class.extend(\"bizagi.rendering.smartphone.startForm\", {}, {\n\n  /* CONSTRUCTOR\r\n                                                               =====================================================*/\n  init: function init(dataService, renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    self.dataService = dataService;\n    self.renderFactory = renderFactory;\n    self.slideFormParams = slideFormParams || {};\n\n    // Create container    \t\n    self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n    self.configureViewHandlers();\n  },\n\n  /**\r\n      * Handlers de la vista de kendo\r\n      */\n  configureViewHandlers: function configureViewHandlers() {\n  },\n\n  /**\r\n      * go back and destroy\r\n      */\n  goBack: function goBack() {\n    var self = this;\n    self.slideContainer.destroy();\n  },\n\n  /*\r\n      *   Render the form\r\n      *   The params are the same that will be send to the ajax service\r\n      *   Returns a deferred\r\n      */\n  render: function render(params) {\n    var self = this;\n    // Fill content\n    self.renderSlideForm(params);\n  },\n\n  /* RENDERS slideForm\r\n      =====================================================*/\n  renderSlideForm: function renderSlideForm(params) {\n\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Load template and data\n    $.when(self.dataService.getStartForm(params)).then(function (data) {\n      /*** SUCCESS FILTER **/\n      // Apply editable param\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      // Render dialog template\n      var formClass = bizagi.rendering.smartphone.form.extend({\n        submitForm: function submitForm() {\n          if (self.form) {\n            this.endLoading();\n            // Perform validations\n            if (self.form.validateForm()) {\n              // Collect data\n              var data = {};\n              self.form.collectRenderValues(data);\n              // Add page cache for this form\n              data.idPageCache = self.form.getPageCache();\n              // Call user callback\n              if (self.slideFormParams.onSave) {\n                $.when(self.slideFormParams.onSave(data)).\n                done(function (result) {\n                  if (result === null || result === true || result.type === \"success\") {\n                    defer.resolve();\n                    self.goBack();\n                  } else if (result.type === \"validationMessages\") {\n                    // Add validation messages\n                    self.form.addValidationMessage(result.messages);\n                    // Update original value to use as reference to other futures changes in the dialogBox\n                    $.each(data, function (key) {\n                      var renders = self.form.getRenders(key);\n                      $.each(renders, function (i, render) {\n                        render.updateOriginalValue();\n                      });\n                    });\n                  } else if (result.type === \"error\") {\n                    // Add error messages\n                    self.form.addErrorMessage(result.message);\n                  }\n                });\n\n              } else {\n                defer.resolve();\n                self.goBack();\n              }\n            }\n          }\n        } });\n\n\n      var containerParams = $.extend({\n        type: \"form\",\n        data: data.form,\n        navigation: self.slideFormParams.navigation,\n        view_container: self.slideContainer },\n\n      {\n        renderFactory: self.renderFactory,\n        dataService: self.renderFactory.dataService });\n\n      self.form = new formClass(containerParams);\n      // Attach a refresh handler to recreate all the form\n      self.form.bind(\"refresh\", function (_, refreshParams) {\n        refreshParams = $.extend({\n          selectedTabs: self.form.getSelectedTabs(),\n          isRefresh: true },\n        params, refreshParams, { idStartScope: self.form.properties.idStartScope });\n\n        self.renderSlideForm(refreshParams);\n      });\n      // Return rendering promise\n\n      self.form.buttons = [\n      $.extend(\n      self.form.buttons[0] || {},\n      {\n        \"caption\": self.slideFormParams.saveButtonLabel,\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          self.form.submitForm();\n        } }),\n\n      $.extend(\n      self.form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          if (self.slideFormParams.onCancel) {\n            self.slideFormParams.onCancel();\n          }\n          self.goBack();\n        } })];\n\n\n\n      return self.form.render();\n    }).done(function (element) {\n      var saveButtonLabel = self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel : bizagi.localization.getResource(\"render-form-dialog-box-save\");\n      var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\n      // Append form  in the view\n      self.slideContainer.element.html(element);\n\n      if (!params.isRefresh) {\n        self.slideFormParams.navigation.navigate(self.slideContainer.id);\n      }\n\n      $(\".ui-bizagi-button-container div\", self.form.container).remove();\n\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal='0' id='formButton0' class='action-button ui-bizagi-form-button'>\" +\n      saveButtonLabel + \"</div>\").delegate(\"div[ordinal='0']\", \"click\", function () {\n        self.form.submitForm();\n      });\n\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal='1' id='formButton1' class='action-button ui-bizagi-form-button'>\" +\n      cancelButtonLabel + \"</div>\").delegate(\"div[ordinal='1']\", \"click\", function () {\n        self.slideFormParams.onCancel && self.slideFormParams.onCancel();\n        self.goBack();\n      });\n\n      //self.view.scroller.reset();\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n    }).fail(function (xhr, errorType, message) {\n      /*** FAIL FILTER **/\n      var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\n      var error_message = message.message || \"Error\";\n\n      $.tmpl(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\n      // Navigate on view\n      self.slideFormParams.navigation.navigate(self.slideContainer.id);\n    });\n\n    return defer.promise();\n  } });","/**\r\n *   Name: Bizagi Smartphone slide Grid AdHoc implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide view that will show hidden columns for a grid\r\n */\n\n// Extends itself\n$.Class.extend('bizagi.rendering.smartphone.slide.adhocForm', {}, {\n\n  /* CONSTRUCTOR\r\n                                                                      =====================================================*/\n  init: function init(renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    this.renderFactory = renderFactory;\n    this.slideFormDeferred = new $.Deferred();\n    this.slideFormParams = slideFormParams || {};\n\n    // Create container\n    self.container = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n  },\n\n  /**\r\n      * Render the grid view form\r\n      * The params are the same that will be send to the ajax service\r\n      * @param params\r\n      * @returns Returns a deferred\r\n      */\n  render: function render(params) {\n    var self = this;\n\n    // Fill content\n    self.renderSlideForm(params);\n    // Return promise\n    return self.slideFormDeferred.promise();\n  },\n\n  /* RENDERS slideForm\r\n      =====================================================*/\n  renderSlideForm: function renderSlideForm(params) {\n\n    var self = this;\n    var data = self.transformData(params);\n\n    // Load template and data\n    self.form = self.renderFactory.getContainer({\n      type: \"form\",\n      data: data.form,\n      navigation: this.slideFormParams.navigation,\n      view_container: self.container });\n\n\n    self.form.buttons = [$.extend(self.form.buttons[0] || {},\n    {\n      \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      \"actions\": [\"submitData\", \"refresh\"],\n      \"submitData\": true,\n      \"refresh\": true,\n      \"ordinal\": 0,\n      \"action\": \"save\",\n      \"save\": true,\n      \"style\": \"\",\n      // This callback avoid to call the default processButton in the form\n      callback: function callback() {\n        if (self.form.validateForm()) {\n          self.goBack();\n          // Resolve deferred with form data\n          var data = {};\n          self.form.collectRenderValues(data);\n          self.slideFormDeferred.resolve(data);\n        }\n      } }),\n\n    $.extend(self.form.buttons[1] || {}, {\n      \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      \"actions\": [\"submitData\", \"refresh\"],\n      \"submitData\": true,\n      \"refresh\": true,\n      \"ordinal\": 1,\n      \"action\": \"back\",\n      \"save\": true,\n      \"style\": \"\",\n      //This callback avoid to call the default processButton in the form\n      callback: function callback() {\n        // Close slide\n        self.goBack();\n        self.slideFormDeferred.reject();\n      } })];\n\n\n\n    // Add save button if the form is editable\n    if (!self.slideFormParams.allowEdition) {\n      self.form.buttons.shift();\n    }\n\n    $.when(self.form.render()).\n    done(function (element) {\n\n      if (params.row[0] == \"mock_id\") {// If it is an add form\n        $.each(data.elementsWithDefaultValue, function (i, item) {\n          var render = self.form.getRender(item.xpath + \".\" + item.id);\n          if (!render) {\n            render = self.form.getRender(item.xpath);\n          }\n          var defaultValue = bizagi.util.isArray(item.defaultValue) ? item.defaultValue[0] : item.defaultValue;\n          render.setDisplayValue(defaultValue);\n        });\n      }\n\n      // Append form in the slide view\n      self.container.element.html(element);\n\n      self.slideFormParams.navigation.navigate(self.container.id);\n\n      //self.container.setNavigationButtons(self.form);\n\n      // Remove default form buttons\n      $(\".ui-bizagi-button-container .action-button\", self.form.container).remove();\n\n      // Add Button\n      $(\".ui-bizagi-button-container\", self.form.container).append(self.buttonContainer);\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n    });\n  },\n\n  /**\r\n      * Transform data into a JSON standard rendering format\r\n      * @param params\r\n      * @returns {[]}\r\n      */\n  transformData: function transformData(params) {\n    var self = this;\n    var row = params.row;\n    var columns = params.columns;\n    var isAddForm = false;\n\n    // Set xpath context\n    var xpathContext = params.xpathContext.length > 0 ?\n    params.xpathContext + \".\" + params.xpath + \"[\" + params.row[0] + \"]\" :\n    params.xpath + \"[id=\" + params.row[0] + \"]\";\n\n    var data = {\n      type: \"form\",\n      form: {\n        elements: [],\n        pageCacheId: params.pageCacheId,\n        sessionId: params.sessionId,\n        properties: {\n          xpathContext: xpathContext },\n\n        actions: self.transformActions(params.xpath, params.actions),\n        validations: self.transformValidations(params.xpath, params.validations) },\n\n      elementsWithDefaultValue: [] };\n\n\n    if (row[0] === \"mock_id\") {\n      isAddForm = true;\n    }\n\n    $.each(row, function (i, item) {\n\n      // Skip first data (key not need to be rendered)\n      if (i > 0) {\n        var columnProperties = columns[i - 1].properties;\n        var element = { render: { properties: $.extend({}, columnProperties) } };\n\n        // Hack properties\n        element.render.properties.type = self.mapRenderType(element.render.properties.type);\n        element.render.properties.defaultvalue = typeof element.render.properties.defaultvalue !== \"undefined\" ? element.render.properties.defaultvalue : element.render.properties.defaultValue;\n        element.render.properties.displayType = 'both';\n        if (self.slideFormParams.allowEdition == false) element.render.properties.editable = false;\n        element.render.properties.value = self.mapValue(element.render.properties.type, item);\n        if (element.render.properties.recalculate) element.render.properties.data = null;\n\n        // Check defaultValue property\n        if (typeof element.render.properties.defaultvalue !== \"undefined\") {\n          if (typeof element.render.properties.value === \"undefined\" || element.render.properties.value == null) {\n            //element.render.properties.value = element.render.properties.defaultvalue;\n            data.elementsWithDefaultValue.push({\n              id: element.render.properties.id,\n              xpath: element.render.properties.xpath,\n              defaultValue: element.render.properties.defaultvalue });\n\n\n            delete element.render.properties.defaultvalue;\n            delete element.render.properties.defaultValue;\n          }\n        }\n\n        // Check columnVisible property\n        if (typeof element.render.properties.columnVisible !== \"undefined\") {\n          element.render.properties.visible = element.render.properties.columnVisible;\n        }\n\n        // Fix readonly columns\n        if (element.render.properties.type === \"readonly\") {\n          element.render.properties.type = \"text\";\n          element.render.properties.editable = false;\n        }\n\n        // Fix upload columns\n        if (element.render.properties.type === \"upload\") {\n          element.render.properties.isColumn = true;\n        }\n\n        // Fix search columns\n        if (element.render.properties.type === \"search\") {\n          var value = element.render.properties.value;\n\n          if (value == null) {\n            element.render.properties.value = {};\n          } else if (value.length > 0) {\n            value = [].concat(value[0]);\n            element.render.properties.value = {\n              id: value[0],\n              label: value[1],\n              additionallabel: value[2] || undefined };\n\n          }\n        }\n        var isDisabledControl = [\"document\", \"formLink\", \"upload\", \"uploadecm\", \"image\", \"search\"].includes(element.render.properties.type);\n        var isExclusiveCheck = (element.render.properties.isExclusive || false) && \"boolean\" === element.render.properties.type;\n\n        if (isExclusiveCheck || isAddForm && isDisabledControl) {\n          element.render.properties.editable = false;\n        } else if (isExclusiveCheck) {\n          element.render.properties.value = value;\n          element.render.properties.editable = false;\n        }\n\n        // Add element\n        data.form.elements.push(element);\n      }\n\n    });\n\n    return data;\n  },\n\n  /**\r\n      * Map column renderType into normal render\r\n      * @param type\r\n      * @returns {string}\r\n      */\n  mapRenderType: function mapRenderType(type) {\n    type = type.replaceAll(\"smartphone\", \"\").replaceAll(\"column\", \"\");\n\n    //some exceptions\n    if (type === \"FormLink\") return \"formLink\";\n\n    type = type.toLowerCase();\n    return type;\n  },\n\n  /**\r\n      * Method to translate grid values into render values\r\n      * @param type\r\n      * @param value\r\n      * @returns {[]}\r\n      */\n  mapValue: function mapValue(type, value) {\n    if ([\"combo\", \"radio\", \"list\"].includes(type)) {\n      if (value && value.length > 0) {\n\n        // Transform the value property\n        return [{\n          id: value[0][0],\n          value: value[0].length > 2 ? $.grep(value[0], function (item, i) {\n            return i !== 0;\n          }) : value[0][1] }];\n\n\n      } else {\n        return null;\n      }\n    }\n\n    // Else: Don't do anything\n    return value;\n  },\n\n  /**\r\n      * Parse form actions into just grid form actions\r\n      * @param xpath\r\n      * @param actions\r\n      * @returns {[]}\r\n      */\n  transformActions: function transformActions(xpath, actions) {\n    var self = this;\n    var gridActions = [];\n\n    if (bizagi.util.isEmpty(actions)) return gridActions;\n\n    $.each(actions, function (index, action) {\n      var bDependencyFound = false;\n      for (var i = 0; i < action.dependencies.length; i++) {\n        if (action.dependencies[i].indexOf(xpath) != -1) {\n          bDependencyFound = true;\n        }\n      }\n\n      if (bDependencyFound) {\n        var newAction = JSON.parse(JSON.encode(action));\n\n        // Replace dependencies\n        for (var j = 0; j < newAction.dependencies.length; j++) {\n          newAction.dependencies[j] = newAction.dependencies[j].replaceAll(xpath + \"[].\", \"\");\n        }\n\n        // Replace conditions\n        self.transformConditions(xpath, newAction.conditions);\n\n        // Replace commands\n        self.transformCommands(xpath, newAction.commands);\n        self.transformCommands(xpath, newAction.elseCommands);\n\n        // Add to grid actions\n        gridActions.push(newAction);\n      }\n    });\n\n    return gridActions;\n  },\n\n  /**\r\n      * Parse form validations into just grid form validations\r\n      * @param xpath\r\n      * @param validations\r\n      * @returns {[]}\r\n      */\n  transformValidations: function transformValidations(xpath, validations) {\n    var self = this;\n    var gridValidations = [];\n\n    if (bizagi.util.isEmpty(validations)) return gridValidations;\n\n    $.each(validations, function (index, validation) {\n      var newValidation = JSON.parse(JSON.encode(validation));\n\n      // Replace conditions\n      self.transformConditions(xpath, newValidation.conditions);\n\n      // Add to grid actions\n      gridValidations.push(newValidation);\n\n    });\n\n    return gridValidations;\n  },\n\n  /**\r\n      * Parse a single condition or a complex condition in order to prepare a grid action/validation\r\n      * @param xpath\r\n      * @param condition\r\n      */\n  transformConditions: function transformConditions(xpath, condition) {\n    var self = this;\n\n    if (condition.expressions) {\n      for (var index in condition.expressions) {\n        self.transformConditions(xpath, condition.expressions[index]);\n      }\n    } else if (condition.simple) {\n      self.transformConditions(xpath, condition.simple);\n    } else if (condition.complex) {\n      self.transformConditions(xpath, condition.complex);\n    } else {\n      if (condition.xpath) {\n        condition.xpath = condition.xpath.replaceAll(xpath + \"[].\", \"\");\n        if (condition.argumentType === 'xpath') {\n          condition.argument = condition.argument.replaceAll(xpath + \"[].\", \"\");\n        }\n      } else {\n        // Apply to button and label controls\n        if (condition && condition.renderId) {\n          condition.renderId = condition.renderId.replaceAll(xpath + \"[].\", \"\");\n        }\n      }\n    }\n  },\n\n  /**\r\n      * Parse a command action to prepare a grid action\r\n      * @param xpath\r\n      * @param commands\r\n      */\n  transformCommands: function transformCommands(xpath, commands) {\n    var refreshIndex = null;\n    if (commands == null || commands.length === 0) return;\n\n    for (var i = 0; i < commands.length; i++) {\n      if (commands[i].command === \"refresh\") {\n        refreshIndex = i;\n      } else {\n        if (commands[i].xpath) {\n          commands[i].xpath = commands[i].xpath.replaceAll(xpath + \"[].\", \"\");\n        }\n        if (commands[i].argumentType === 'xpath') {\n          commands[i].argument = commands[i].argument.replaceAll(xpath + \"[].\", \"\");\n        }\n\n        if (!commands[i].xpath && commands[i].renderId) {\n          commands[i].renderId = commands[i].renderId.replaceAll(xpath + \"[].\", \"\");\n        }\n      }\n    }\n\n    if (refreshIndex != null) {\n      commands.splice(i, 1);\n    }\n  },\n\n  /**\r\n      * Go back and destroy\r\n      */\n  goBack: function goBack() {\n    this.container.destroy();\n  } });","/**\r\n *   Name: Bizagi Smartphone slide form implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   Serves as an slide form that can render a inner form\r\n */\n$.Class.extend(\"bizagi.rendering.smartphone.slide.form\", {}, {\n  init: function init(dataService, renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    self.dataService = dataService;\n    self.renderFactory = renderFactory;\n    self.slideFormParams = slideFormParams || {};\n\n    // Create container\n    self.slideContainer = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n    self.configureViewHandlers();\n  },\n\n  /**\r\n      * go back and destroy\r\n      */\n  goBack: function goBack() {\n    this.slideContainer.destroy();\n  },\n\n  /**\r\n      * Handlers de la vista de kendo\r\n      */\n  configureViewHandlers: function configureViewHandlers() {\n  },\n\n  /*\r\n      *   Render the form\r\n      *   The params are the same that will be send to the ajax service\r\n      *   Returns a deferred\r\n      */\n  render: function render(params) {\n    this.renderSlideForm(params);\n  },\n\n  /* RENDERS slideForm\r\n      =====================================================*/\n  renderSlideForm: function renderSlideForm(params) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Load template and data\n    $.when(self.dataService.getFormData(params)).\n    pipe(function (data) {\n      /*** SUCCESS FILTER **/\n      // Apply editable param\n      if (params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      // Render dialog template\n      var formClass = bizagi.rendering.smartphone.form.extend({\n        submitForm: function submitForm(parameters) {\n          if (self.form) {\n            this.endLoading();\n            // Perform validations\n            if (self.form.validateForm()) {\n              // Collect data\n              var data = {};\n              self.form.collectRenderValues(data);\n              // Add page cache for this form\n              data.idPageCache = self.form.getPageCache();\n              // Call user callback\n              if (self.slideFormParams.onSave) {\n                $.when(self.slideFormParams.onSave(data)).\n                done(function (result) {\n                  if (result === null || result === true || result.type === \"success\") {\n                    defer.resolve();\n                    self.goBack();\n                  } else if (result.type === \"validationMessages\") {\n                    // Add validation messages\n                    self.form.addValidationMessage(result.messages);\n                    // Update original value to use as reference to other futures changes in the dialogBox\n                    $.each(data, function (key, value) {\n                      var renders = self.form.getRenders(key);\n                      $.each(renders, function (i, render) {\n                        render.updateOriginalValue();\n                      });\n                    });\n                  } else if (result.type === \"error\") {\n                    // Add error messages\n                    self.form.addErrorMessage(result.message);\n                  }\n                });\n\n              } else {\n                defer.resolve();\n                self.goBack();\n              }\n            }\n          }\n        } });\n\n      var containerParams = $.extend({\n        type: \"form\",\n        data: data.form,\n        navigation: self.slideFormParams.navigation,\n        view_container: self.slideContainer },\n      {\n        renderFactory: self.renderFactory,\n        dataService: self.renderFactory.dataService });\n\n      self.form = new formClass(containerParams);\n\n      self.form.buttons = [\n      $.extend(\n      self.form.buttons[0] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          self.form.submitForm();\n        } }),\n\n      $.extend(\n      self.form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\" },\n\n      {\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          if (self.slideFormParams.onCancel) {\n            self.slideFormParams.onCancel();\n          }\n          self.goBack();\n        } })];\n\n\n\n      // Return rendering promise\n      return self.form.render();\n    }).done(function (element) {\n      var saveButtonLabel = self.slideFormParams.saveButtonLabel ? self.slideFormParams.saveButtonLabel :\n      bizagi.localization.getResource(\"render-form-dialog-box-save\");\n      var cancelButtonLabel = bizagi.localization.getResource(\"render-form-dialog-box-cancel\");\n\n      // Append form  in the view\n      self.slideContainer.element.html(element);\n      // Navigate on view\n      self.slideFormParams.navigation.navigate(self.slideContainer.id);\n\n      $(\".ui-bizagi-button-container div\", self.form.container).remove();\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal=\\\"0\\\" id=\\\"formButton0\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\n      saveButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"0\\\"]\", \"click\", function () {\n        self.form.submitForm();\n      });\n      $(\".ui-bizagi-button-container\", self.form.container).\n      append(\"<div ordinal=\\\"1\\\" id=\\\"formButton1\\\" class=\\\"action-button ui-bizagi-form-button\\\">\" +\n      cancelButtonLabel + \"</div>\").delegate(\"div[ordinal=\\\"1\\\"]\", \"click\", function () {\n        self.slideFormParams.onCancel && self.slideFormParams.onCancel();\n        self.goBack();\n      });\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n      // Attach a refresh handler to recreate all the form\n      self.form.bind(\"refresh\", function () {\n        self.renderSlideForm(params);\n      });\n    }).fail(function (message) {\n      /*** FAIL FILTER **/\n      var errorTemplate = self.renderFactory.getCommonTemplate(\"form-error\");\n      var error_message = message.message || \"Error\";\n\n      $.tmpl(errorTemplate, { message: error_message }).appendTo(self.slideContainer.element);\n      // Navigate on view\n      self.slideFormParams.navigation.navigate(self.slideContainer.id);\n    });\n\n    return defer.promise();\n  } });","/**\r\n *   Name: Bizagi Smartphone ECM Slide Implementation\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will shows a ECM form\r\n */\n$.Class.extend(\"bizagi.rendering.smartphone.slide.ecm\", {}, {\n\n  /**\r\n                                                               * Constructor\r\n                                                               * @param dataService\r\n                                                               * @param renderFactory\r\n                                                               * @param slideFormParams\r\n                                                               */\n  init: function init(dataService, renderFactory, slideFormParams) {\n    var self = this;\n\n    // Define instance variables\n    self.dataService = dataService;\n    self.renderFactory = renderFactory;\n\n    self.slideFormParams = slideFormParams || {};\n    self.slideFormDeferred = new $.Deferred();\n\n    // Create container\n    self.container = self.slideFormParams.navigation.createRenderContainer({ title: self.slideFormParams.title });\n  },\n\n  /**\r\n      * Render the form\r\n      * @param params\r\n      */\n  render: function render(params) {\n\n    // Fill content\n    this.renderSlideForm(params);\n\n    // Return promise\n    return this.slideFormDeferred.promise();\n  },\n\n  renderSlideForm: function renderSlideForm(params) {\n    var self = this;\n    var data = self.getMetadataForm(params);\n\n    // Load template and data\n    self.form = self.renderFactory.getContainer({\n      type: \"form\",\n      data: data.form,\n      navigation: self.slideFormParams.navigation,\n      view_container: self.container });\n\n\n    // Binds the view close event\n    /*self.container.element.bind(\"close\", function () {\r\n        // delete self.container;\r\n        console.log(\"closed!\");\r\n    });*/\n\n    $.when(self.form.render()).\n    done(function ($renderEdition) {\n\n      // Append form in the slide view\n      self.container.element.html($renderEdition);\n\n      self.slideFormParams.navigation.navigate(self.container.id);\n\n      self.processButtons(self.form, params);\n      self.container.setNavigationButtons(self.form);\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n\n      // Attach a refresh handler to recreate all the form\n      /*self.form.bind(\"refresh\", function () {\r\n          // self.renderSlideForm(params);\r\n      });*/\n\n    }).always(function () {\n      self.slideFormDeferred.resolve();\n    });\n\n  },\n\n  /**\r\n      * Shows the slideForm form container in the browser\r\n      * @returns {} Returns a promise that the dialog will be closed\r\n      */\n  processButtons: function processButtons(form, params) {\n    var self = this;\n\n    form.buttons = [\n    {\n      ordinal: 0,\n      action: \"save\",\n      caption: bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      callback: self.onSaveDataMetadataForm.bind(self, params.fileData) },\n\n    {\n      ordinal: 1,\n      action: \"back\",\n      caption: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      callback: function callback() {\n        self.slideFormParams.onCancel({});\n\n        self.goBack();\n      } }];\n\n\n\n    // Add save button if the form is editable\n    if (!self.slideFormParams.editable) {\n      form.buttons.shift();\n    }\n  },\n\n  /**\r\n      * Process render data\r\n      * @param params\r\n      * @returns {{form: *, type: string}}\r\n      */\n  getMetadataForm: function getMetadataForm(params) {\n    var self = this;\n    var data = {\n      type: \"form\",\n      form: {\n        elements: [],\n        pageCacheId: params.pageCacheId,\n        sessionId: params.sessionId,\n        properties: {\n          id: 101,\n          xpathContext: params.xpathContext,\n          editable: self.slideFormParams.editable,\n          orientation: self.slideFormParams.orientation || \"ltr\" } } };\n\n\n\n\n    // Mapping metadata to render\n    $.each(params.metadata, function (index, item) {\n      var renderType = self.getRenderType(item.metadataType);\n\n      var newRender = Object.assign({\n        \"id\": index + 1,\n        \"xpath\": item.metadataId,\n        \"displayName\": item.description,\n        \"required\": bizagi.util.parseBoolean(item.required) === true,\n        \"editable\": bizagi.util.parseBoolean(item.readOnly) === false,\n        \"value\": item.value },\n      renderType);\n\n      data.form.elements.push({ \"render\": { \"properties\": newRender } });\n    });\n\n    return data;\n  },\n\n  /**\r\n      * Get type of render\r\n      * @param type\r\n      * @returns {*}\r\n      */\n  getRenderType: function getRenderType(type) {\n    switch (type.toUpperCase()) {\n      case \"INTEGER\":\n        return {\n          type: \"number\",\n          dataType: 2,\n          allowDecimals: false,\n          thousands: false };\n\n      case \"DECIMAL\":\n        return {\n          type: \"number\",\n          dataType: 10,\n          allowDecimals: true,\n          thousands: true };\n\n      case \"DATETIME\":\n        return { type: \"date\", dataType: 12 };\n      case \"BOOL\":\n        return { type: \"boolean\", dataType: 5 };\n      case \"STRING\":\n      default:\n        return {\n          type: \"text\",\n          dataType: 15,\n          maxLength: 50,\n          autoExtend: false };}\n\n\n\n  },\n\n  /**\r\n      * Save data to ECM form\r\n      * @returns {jQuery}\r\n      * @param fileData\r\n      */\n  onSaveDataMetadataForm: function onSaveDataMetadataForm(fileData) {\n    var self = this;\n    var deferred = $.Deferred();\n\n    if (self.form.validateForm()) {\n      // Check if the add form has data\n      var formData = {};\n      self.form.collectRenderValuesForSubmit(formData);\n\n      // Turn off flag\n      $.forceCollectData = false;\n\n      if (!bizagi.util.isMapEmpty(formData)) {\n\n        var metadataValues = Object.keys(formData).\n        map(function (key, index) {\n          return { \"idMetadata\": key, \"value\": formData[key] };\n        });\n\n        var params = {\n          \"idFileUpload\": fileData.idFileUpload,\n          \"fileName\": fileData.fileName,\n          \"idPageCache\": fileData.idPageCache,\n          \"xpathContext\": fileData.xpathContext,\n          \"xPath\": fileData.xpath,\n          \"idAttrib\": fileData.idAttrib };\n\n\n        params.metaValues = JSON.encode({ metadataValues: metadataValues });\n        bizagi.loading.start();\n\n        $.when(self.dataService.updateECMMetadata(params)).\n        done(function (fileProperties) {\n          if (fileProperties && fileProperties.idFileUpload) {\n\n            self.slideFormParams.onSave({\n              update: true,\n              idFileUpload: fileProperties.idFileUpload,\n              fileName: fileData.fileName });\n\n\n            deferred.resolve({ update: true });\n          }\n\n          self.goBack();\n\n        }).fail(function (message) {\n          self.form.addValidationMessage(message.message);\n          deferred.reject();\n        }).always(function () {\n          bizagi.loading.stop();\n        });\n      } else {\n        self.slideFormParams.onSave({ update: false });\n        deferred.resolve({ update: false });\n        self.goBack();\n      }\n    }\n\n    deferred.promise();\n  },\n\n  /**\r\n      * Go back and destroy\r\n      */\n  goBack: function goBack() {\n    this.container.destroy();\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the text render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.text\", bizagi.rendering.text.prototype);\n// Extends itself\nbizagi.rendering.smartphone.text.extend(\"bizagi.rendering.smartphone.text\", {}, {\n\n  //#region Side effects functions\n  /**\r\n   * Template method to implement in each device to customize each render after processed\r\n   */\n  postRender: function postRender() {\n    // Call base \n    this._super();\n\n    // Define max length of element\n    if (this.properties.maxLength > 0)\n    this.input.attr(\"maxlength\", this.properties.maxLength);\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"text-read-only\");\n    var value = this.getValue();\n\n    if (typeof value !== \"undefined\" && value !== null) {\n      value = bizagi.util.sanitizeHTML(value);\n    }\n\n    var data = {\n      value: value || \"\",\n      editable: this.properties.editable };\n\n\n    return $.fasttmpl(template, data);\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var decodedValue = bizagi.util.decodeURI(value);\n\n    value = this.validateValue(decodedValue, self.properties.maxLength);\n\n    // Set internal value\n    self.setValue(value, false);\n\n    // Set value in input\n    if (self.properties.editable) {\n      self.input.val(value);\n    } else {\n      $(\".bz-text-readonly\", self.getControl()).html(bizagi.util.sanitizeHTML(value));\n    }\n  },\n\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input\", element);\n    if (!input || input.length === 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      self.retypeDouble(control);\n    });\n  },\n\n  /**\r\n      * Retype actions\r\n      * @param {} control\r\n      */\n  retypeDouble: function retypeDouble(control) {\n    var self = this;\n    var currentValue = control.val();\n    var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\n\n    if (isVisible) {\n      if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\n\n        // Check that there is something in the value or if a value has already been set\n        if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\n\n        self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"));\n\n      } else {\n        // Check that there is something in the value\n        if (currentValue === \"\") return;\n\n        if (currentValue !== control.data(\"oldValue\")) {\n          self.setValue(\"\");\n\n          self.setValidationMessage(self.getResource(\"render-text-retype-error\"));\n          control.val(\"\");\n\n          setTimeout(function () {\n            control.focus();\n          }, 100);\n\n        } else {\n          control.data(\"newValue\", currentValue);\n        }\n        control.data(\"oldValue\", \"\");\n        if (control.data('ui-tooltip')) control.tooltip('destroy');\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".bz-text-readonly\", $context);\n  },\n\n  /**\r\n      * Helptext tooltip\r\n      * @param {} control\r\n      * @param {} currentValue\r\n      * @param {} currentTitle\r\n      */\n  createTooltip: function createTooltip(control, currentValue, currentTitle) {\n    this._super(control, currentValue, currentTitle);\n\n    $('body').bind('touchmove', function (e) {\n      $('body').unbind('touchmove');\n      if (control.data('ui-tooltip')) control.tooltip('destroy');\n    });\n  },\n\n  setValidationMessage: function setValidationMessage(message) {\n    // Call base\n    this._super(message);\n\n    if (this.cloneRender) {\n      this.cloneRender.setValidationMessage(message);\n    }\n  }\n\n  //#endregion Side effects functions\n});","/**\r\n *   Name: Bizagi Smartphone Render Readonly Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the readonly render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.readonly\", bizagi.rendering.readonly.prototype);\n// Extends itself\nbizagi.rendering.smartphone.readonly.extend(\"bizagi.rendering.smartphone.readonly\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Text Extension\r\n *   Author: UI Forms Team\r\n *   Comments: Extended text implementation\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.extendedText\", bizagi.rendering.extendedText.prototype);\n// Extends itself\nbizagi.rendering.smartphone.extendedText.extend(\"bizagi.rendering.smartphone.extendedText\", {\n  minLines: 2,\n  maxLines: 8,\n  maxCharactersToShow: 100 },\n{\n\n  //#region Side effects functions\n\n  /**\r\n   * Template method to implement in each device to customize each render after processed\r\n   */\n  postRender: function postRender() {\n    var self = this;\n    self._super();\n    self.textarea = self.getControl().find(\"textarea\");\n    if (self.textarea) self.textarea.css({ resize: \"vertical\" });\n  },\n\n  /**\r\n      * Update or init the element data\r\n      * @param {} data\r\n      */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n    var maxLines = this.properties.maxLines;\n    this.properties.maxLines = maxLines > this.Class.maxLines ? this.Class.maxLines : maxLines < this.Class.minLines ? this.Class.minLines : maxLines;\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"extendedText-readOnly\");\n    var value = this.getValue();\n    value = typeof value !== \"undefined\" && value !== null ? bizagi.util.sanitizeHTML(value) : \"\";\n    var showChar = this.Class.maxCharactersToShow;\n\n    var startString = value.substr(0, showChar);\n    var endString = value.substr(showChar - 1, value.length - showChar);\n\n    var data = {\n      \"value\": value,\n      \"startString\": startString,\n      \"endString\": endString };\n\n\n    return $.fasttmpl(template, data);\n  },\n\n  /**\r\n      * Sets the value in the redered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var decodedValue = bizagi.util.decodeURI(value);\n    decodedValue = !bizagi.util.isEmpty(decodedValue) && typeof decodedValue !== \"string\" ? decodedValue.toString() : decodedValue;\n    value = self.validateValue(typeof decodedValue == \"string\" ? decodedValue : \"\", self.properties.maxLength);\n\n    // Call base        \n    self.setValue(value, false);\n\n    // Set value in input\n    if (self.properties.editable) {\n      self.textarea.val(value);\n    } else {\n      var encodedText = bizagi.util.encodeHtmlText(self.getDisplayValue());\n      $(\".bz-textarea-readonly\", self.getControl()).html(encodedText);\n    }\n  },\n\n  /**\r\n      * Implement to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Call base\n    self._super();\n\n    // Define max length of element\n\n    // Cuando el tipo de dato es extended manda como maxlength 0 por lo que la validacion no puede ir sobre todo el metodo\n    if (self.properties.maxLength > 0) {\n      self.textarea.attr(\"maxlength\", self.properties.maxLength);\n      self.actualMaxLength = self.properties.maxLength;\n    }\n\n    $(self.textarea).bind(\"focus keyup paste\", function (e) {\n      if (e.which === 8 || e.which === 46) {\n        var currentRow = self.textarea.prop(\"rows\");\n        if (currentRow > self.properties.maxLines) {\n          self.textarea.prop(\"rows\", self.properties.maxLines);\n        }\n      }\n      self.updateTextareaSize(this);\n    });\n\n    $(self.textarea).bind(\"blur\", function (e) {\n      self.textarea.prop(\"rows\", self.properties.maxLines);\n    });\n  },\n\n  /**\r\n      * Sets the functions when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n\n    var $control = this.getControl();\n    $(\".bz-textarea-readonly\", $control).on(\"click\", \".bz-read-more\", function (e) {\n      if ($(e.delegateTarget).hasClass(\"bz-textarea-readonly--active\")) {\n        $(e.delegateTarget).removeClass(\"bz-textarea-readonly--active\");\n        $(this).html(self.getResource(\"workportal-project-discussion-comment-viewmore\"));\n      } else {\n        $(e.delegateTarget).addClass(\"bz-textarea-readonly--active\");\n        $(this).html(self.getResource(\"workportal-project-discussion-comment-viewless\"));\n      }\n      return false;\n    });\n  },\n\n  /**\r\n      * Changes control's height when it's auto extended\r\n      * @param {Object} control HTML Object\r\n      */\n  updateTextareaSize: function updateTextareaSize(textarea) {\n    if (this.properties.autoExtend) {\n      var currentRows = $(textarea).prop(\"rows\");\n      if (textarea.scrollHeight > textarea.offsetHeight && currentRows >= this.Class.minLines && currentRows < this.Class.maxLines) {\n        //Extend the rows\n        $(textarea).prop(\"rows\", currentRows + 1);\n        this.updateTextareaSize(textarea);\n      }\n    }\n  },\n\n  /**\r\n      * Handler of retype double actions\r\n      */\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input, textarea\", element);\n    if (!input || input.length === 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      var previousValue = self.previousValue;\n      var value = self.value;\n\n      if (previousValue != null && value != previousValue) {\n        if ($(this).data(\"newValue\") != undefined && control.val() != $(this).data(\"newValue\")) {\n          $(this).data().newValue = undefined;\n        }\n      }\n\n      self.retypeDouble(control);\n    });\n  },\n\n  /**\r\n      * Retype actions\r\n      * @param {} control\r\n      */\n  retypeDouble: function retypeDouble(control) {\n    var self = this;\n    var currentValue = control.val();\n    var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\n\n    if (isVisible) {\n      if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\n\n        // Check that there is something in the value or if a value has already been set\n        if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\n\n        self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"));\n\n      } else {\n        // Check that there is something in the value\n        if (currentValue === \"\") return;\n\n        if (currentValue !== control.data(\"oldValue\")) {\n          self.setValue(\"\");\n\n          self.setValidationMessage(self.getResource(\"render-text-retype-error\"));\n          control.val(\"\");\n\n          setTimeout(function () {\n            control.focus();\n          }, 100);\n\n        } else {\n          control.data(\"newValue\", currentValue);\n        }\n        control.data(\"oldValue\", \"\");\n        if (control.data('ui-tooltip')) control.tooltip('destroy');\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"textarea\", $context) : $(\".bz-textarea-readonly\", $context);\n  },\n\n  /**\r\n      * Helptext tooltip\r\n      * @param {} control\r\n      * @param {} currentValue\r\n      * @param {} currentTitle\r\n      */\n  createTooltip: function createTooltip(control, currentValue, currentTitle) {\n    this._super(control, currentValue, currentTitle);\n\n    $('body').bind('touchmove', function (e) {\n      $('body').unbind('touchmove');\n      if (control.data('ui-tooltip')) control.tooltip('destroy');\n    });\n  },\n\n  setValidationMessage: function setValidationMessage(message) {\n    // Call base\n    this._super(message);\n\n    if (this.cloneRender) {\n      this.cloneRender.setValidationMessage(message);\n    }\n  }\n\n  //#endregion Side effects functions\n});","/**\r\n *   Name: Bizagi Smartphone Render Label Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the label render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.label\", bizagi.rendering.label.prototype);\n// Extends itself\nbizagi.rendering.smartphone.label.extend(\"bizagi.rendering.smartphone.label\", {}, {\n  /**\r\n                                                                                    * Method to render non editable values\r\n                                                                                    */\n  renderReadOnly: function renderReadOnly() {\n    this.setValue(this.properties.displayName);\n    return this._super();\n  },\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // DON'T DO ANYTHING\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Number Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the number render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.number\", bizagi.rendering.number.prototype);\n// Extends itself\nbizagi.rendering.smartphone.number.extend(\"bizagi.rendering.smartphone.number\", {}, {\n\n  /**\r\n                                                                                       * Method to customize each render after processed in read-only mode\r\n                                                                                       * @returns {*|jQuery}\r\n                                                                                       */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"number\");\n\n    return $.fasttmpl(template, {\n      value: self.getDisplayValue(),\n      editable: self.properties.editable,\n      type: \"text\",\n      isDesign: self.getMode() !== \"execution\" });\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n\n    // Call base\n    self.setValue(value, false);\n\n    // Set value in input\n    if (value != null && self.properties.editable) {\n      self.numericInput.val(value);\n\n      self.value = self.properties.value = value;\n\n      // Formats the input\n      self.executeFormatCurrencyPlugin();\n    }\n  },\n\n  /**\r\n      * Retype function\r\n      */\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input\", element);\n    if (!input || input.length === 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      var previousValue = self.previousValue;\n      var value = self.value;\n      var typeControl = self.parent.properties.type;\n\n      if (typeControl === \"grid\") {\n        if (previousValue != null && value !== previousValue) {\n          if ($(this).data(\"newValue\") !== undefined && control.val() !== $(this).data(\"newValue\"))\n          $(this).data().newValue = undefined;\n        }\n\n        self.retypeDouble(control);\n      } else {\n        self.retypeDouble(control);\n      }\n    });\n  },\n\n  /**\r\n      * Retype function\r\n      * @param control\r\n      */\n  retypeDouble: function retypeDouble(control) {\n    var self = this;\n    var currentValue = control.val();\n    var isVisible = $(control).attr(\"type\") !== \"hidden\" && $(control).css(\"display\") !== \"none\" && $(control).css(\"visibility\") !== \"hidden\";\n\n    if (isVisible && $(this).data(\"newValue\") === undefined) {\n\n      if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") === \"\") {\n\n        // Check that there is something in the value or if a value has already been set\n        if (currentValue === \"\" || currentValue === control.attr(\"newValue\")) return;\n\n        self.createTooltip(control, currentValue, self.getResource(\"render-number-retype\"));\n\n      } else {\n        // Check that there is something in the value\n        if (currentValue === \"\") return;\n\n        if (currentValue !== control.data(\"oldValue\")) {\n          self.setValue(\"\");\n\n          self.createTooltip(control, \"\", self.getResource(\"render-text-retype-error\"));\n        } else {\n          control.data(\"newValue\", currentValue);\n          control.data(\"oldValue\", \"\");\n          try {\n            // Destroy tooltips\n            control.tooltip(\"destroy\");\n          } catch (e) {\n          }\n        }\n      }\n    }\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"input\", $context);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the money render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.money\", bizagi.rendering.number.prototype);\n// Extends itself\nbizagi.rendering.smartphone.money.extend(\"bizagi.rendering.smartphone.money\", bizagi.rendering.money.prototype);\n// Extends itself\nbizagi.rendering.smartphone.money.extend(\"bizagi.rendering.smartphone.money\", {}, {\n\n  /**\r\n                                                                                     * Method to customize each render after processed in read-only mode\r\n                                                                                     * @returns {*|jQuery}\r\n                                                                                     */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"number\");\n\n    return $.fasttmpl(template, {\n      value: self.getDisplayValue(),\n      editable: self.properties.editable,\n      type: \"text\",\n      isDesign: self.getMode() !== \"execution\" });\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // Call base\n    this.setValue(value, false);\n\n    // Set value in input\n    if (value !== undefined && value !== null && this.properties.editable) {\n      this.numericInput.val(value);\n\n      // Formats the input\n      this.executeFormatCurrencyPlugin();\n    }\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  /*getElementsToStylize: function (context) {\r\n             return $(\".bz-input\", context);\r\n         }*/\n\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"input\", $context);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the date render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.date\", bizagi.rendering.date.prototype);\n// Extends itself\nbizagi.rendering.smartphone.date.extend(\"bizagi.rendering.smartphone.date\", {\n  MAX_YEARS_DISPLAY: 100 },\n{\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var properties = self.properties;\n    var dateFormat = properties.dateFormat;\n    var ud = bizagi.util.dateFormatter;\n\n    var format = dateFormat.substring(0, dateFormat.search(\"h|H\") != -1 ? dateFormat.search(\"h|H\") - 1 : dateFormat.length);\n    var value = ud.formatDate(ud.getDateFromFormat(self.getValue(), format, self.i18n), properties.fullFormat);\n    var data = {\n      value: self.getMode() !== \"execution\" ? properties.fullFormat : value,\n      editable: properties.editable };\n\n\n    var template = this.renderFactory.getTemplate(\"readonly\");\n    return $.fasttmpl(template, data);\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.input = $(\"input\", this.getDateControl());\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var dateControl = self.getControl();\n    var inputDate = $(\".bz-input-icon\", dateControl);\n\n    self.configureMobiscollCalendar();\n    self.calendarInstance = inputDate.mobiscroll(\"getInst\");\n\n    // Bind event on input date\n    inputDate.on(\"focus\", function (e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (bizagi.util.isCordovaSupported() && bizagi.util.isAndroidDevice()) {\n        cordova.plugins.Keyboard.disableScroll(true);\n        cordova.plugins.Keyboard.close();\n      }\n      self.calendarInstance.show();\n    });\n\n    inputDate.attr(\"keyboard\", \"disable\");\n  },\n\n  /**\r\n      * Initializes the Mobiscroll Calendar with the indicated configuration\r\n      */\n  configureMobiscollCalendar: function configureMobiscollCalendar() {\n    var self = this;\n    var properties = self.properties;\n    var controlElements = properties.showTime ? [\"calendar\", \"time\"] : [\"calendar\"];\n    var dateControl = self.getControl();\n    var inputDate = $(\".bz-input-icon\", dateControl);\n    var orientation = self.getOrientation();\n\n    inputDate.mobiscroll().calendar({\n      mode: \"mixed\",\n      touchUi: true,\n      display: \"bottom\",\n      controls: controlElements,\n      min: self.getNormalizeDate(new Date(properties.minValue)),\n      max: self.getNormalizeDate(new Date(properties.maxValue)),\n      defaultValue: self.getDisplayValue(),\n      timeFormat: properties.timePickerFormat ? self.getTimeFormat(properties.timePickerFormat) : \"\",\n      dateFormat: properties.datePickerFormat,\n      dateWheels: 'dd/MM/yyyy',\n      select: \"single\",\n      selectType: \"Day\",\n      rtl: orientation && orientation === \"rtl\",\n      lang: bizagi.util.languages[BIZAGI_LANGUAGE] || bizagi.localization.language || \"en\",\n      buttons: self.properties.showTime ?\n      [\n      {\n        text: self.getResource(\"render-timeentry-now\"),\n        handler: function handler() {\n          self.setValueFromCalendarButtons(new Date(), function (v) {\n            self.getCalendarInstance().setVal(v, false, false, false);\n            self.getCalendarInstance().hide();\n          });\n        } },\n\n      {\n        text: self.getResource(\"render-plugin-search-users-select-link\"),\n        handler: \"set\" },\n\n      {\n        text: self.getResource(\"render-plugin-search-users-clear-button-name\"),\n        handler: function handler(e, inst) {\n          inst.clear();\n        } }] :\n\n\n      [\n      {\n        text: self.getResource(\"render-timeentry-now\"),\n        handler: function handler() {\n          self.setValueFromCalendarButtons(new Date(), function (v) {\n            self.getCalendarInstance().setVal(v, false, false, false);\n            self.getCalendarInstance().hide();\n          });\n        } },\n\n      {\n        text: self.getResource(\"render-plugin-search-users-clear-button-name\"),\n        handler: function handler(e, inst) {\n          inst.clear();\n        } }],\n\n\n      onSet: function onSet() {\n        self.onChangeHandler();\n      },\n      onDayChange: function onDayChange(obj) {\n        self.setValueFromCalendarButtons(obj.date, function (v) {\n          self.getCalendarInstance().setVal(v, false, false, false);\n          if (!self.properties.showTime) self.getCalendarInstance().hide();\n        });\n      },\n      onClear: function onClear() {\n        self.setValueFromCalendarButtons(null, function (v) {\n          self.getCalendarInstance().setVal(v, false, false, false);\n          self.getCalendarInstance().hide();\n        });\n      },\n      onBeforeShow: function onBeforeShow(event, inst) {\n        //self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n\n        inst.option({\n          max: bizagi.util.dateFormatter.getDateFromInvariant(properties.maxValue, properties.showTime),\n          min: bizagi.util.dateFormatter.getDateFromInvariant(properties.minValue, properties.showTime) });\n\n\n        //TODO temporal fix in ios smartphone when a notification container is already displayed (QAF-6385 / MOB-171), review mobiscroll.min versions\n        if (bizagi.util.isiOSDevice()) {\n          $(\".ui-bizagi-notifications-container\").css(\"display\", \"none\");\n        }\n      },\n      onClose: function onClose(event, inst) {\n        // Your custom event handler goes here\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"auto\");\n      },\n      onShow: function onShow(event, inst) {\n        $(\".mbsc-fr-scroll\").css(\"overflow-y\", \"hidden\");\n      } });\n\n  },\n\n  /**\r\n      * Get the DOM Control\r\n      */\n  getDateControl: function getDateControl() {\n    return $(\".bz-input-icon\", this.getControl());\n  },\n\n  /**\r\n      * Set the control value when the control change\r\n      */\n  onChangeHandler: function onChangeHandler(isNow) {\n    var self = this;\n    var properties = self.properties;\n    var currentDate = self.getNormalizeDate(self.getCalendarInstance().getVal());\n    var currentDateString = \"\";\n    var ud = bizagi.util.dateFormatter;\n\n    if (!currentDate || currentDate == 0) {\n      return;\n    }\n    //Attemp set the value of the datepicker control. If not valid go back to the previous.\n    var previousValue = self.value;\n\n    //sets the value with the current format date, changed to use the same displayValue method\n    if (isNow == true) {\n      currentDate = self.getNormalizeDate(new Date());\n      currentDateString = ud.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\n      self.value = currentDateString;\n    } else {\n      self.value = ud.formatInvariant(currentDate, properties.showTime);\n    }\n\n    if (isNow || currentDate) {\n      self.value = previousValue;\n      currentDateString = ud.formatDate(currentDate, \"MM/dd/yyyy HH:mm:ss\");\n      self.setValue(currentDateString);\n      self.setDisplayValue(currentDateString);\n    }\n  },\n\n  /**\r\n      * Apply the final format that will be showed on the input\r\n      */\n  getFullFormatedDate: function getFullFormatedDate(currentDate, currentTime) {\n    var fullDate = \"\";\n\n    if (currentDate.length > 0) {\n      fullDate = currentDate;\n    } else if (currentDate !== undefined) {\n      fullDate = bizagi.util.dateFormatter.formatISO(currentDate, false);\n    } else {\n      fullDate = bizagi.util.dateFormatter.formatISO(new Date(), false);\n    }\n\n    fullDate += currentTime;\n    var dateFromFormat = bizagi.util.dateFormatter.getDateFromFormat(fullDate, \"yyyy-MM-dd H:m\");\n\n    return bizagi.util.dateFormatter.formatDate(dateFromFormat !== 0 ? dateFromFormat : currentDate, \"yyyy-MM-dd H:mm:ss\");\n  },\n\n  /*\r\n      *  Checks if the date could be localized using site language\r\n      */\n  preprocessDateValue: function preprocessDateValue(date) {\n    return bizagi.util.dateFormatter.formatDate(date, this.properties.fullFormat);\n  },\n\n  /**\r\n      * Public method to determine if a value is valid or not\r\n      */\n  isValid: function isValid(invalidElements) {\n    var self = this;\n    var properties = self.properties;\n    var bValid = true;\n    var value = self.getValue();\n\n    if (value) {\n      if (bizagi.util.parseBoolean(properties.editable)) {\n        value = self.getNormalizeDate(bizagi.util.dateFormatter.getDateFromInvariant(value));\n\n        if (value != 0) {\n          // Check min value and max value\n          if (properties.minValue && typeof properties.minValue === \"string\") {\n            bValid = self.checkMinAndMaxValue(value, true, properties, invalidElements) ? false : bValid;\n          }\n\n          if (properties.maxValue && typeof properties.maxValue === \"string\") {\n            bValid = self.checkMinAndMaxValue(value, false, properties, invalidElements) ? false : bValid;\n          }\n        }\n      }\n    }\n\n    if (bizagi.util.parseBoolean(properties.editable)) {\n      // Check required\n      if (properties.required && !self.hasValue()) {\n        self.showMandatoryMessage(properties, invalidElements);\n      }\n    }\n\n    if (bValid) {\n      // Clear error message\n      self.setValidationMessage(\"\");\n    }\n\n    return bValid;\n  },\n\n  /**\r\n      * To validate the min and max values\r\n      * @param {} value\r\n      * @param {} isMinValue\r\n      * @param {} properties\r\n      * @param {} invalidElements\r\n      */\n  checkMinAndMaxValue: function checkMinAndMaxValue(value, isMinValue, properties, invalidElements) {\n    var vValue = this.getNormalizeDate(\n    bizagi.util.dateFormatter.getDateFromInvariant(isMinValue ? properties.minValue : properties.maxValue));\n\n\n    //In case the value from the minValue or maxValue are assigned from a Date control that does not have the option  \"showTime!\n    if (vValue == 0) {\n      var resultValue = \"\";\n      if (properties.timeFormat.indexOf(\":ss\") == -1) {\n        if (isMinValue) {\n          resultValue = properties.minValue + \":00\";\n        } else {\n          resultValue = properties.maxValue + \":00\";\n        }\n      }\n      vValue = this.getNormalizeDate(bizagi.util.dateFormatter.getDateFromFormat(resultValue, properties.fullFormat + \":ss\"));\n    }\n\n    if (isMinValue && value.getTime() < vValue.getTime() || !isMinValue && value.getTime() > vValue.getTime()) {\n      var formatedDate = bizagi.util.dateFormatter.formatDate(vValue, properties.fullFormat);\n      var message = \"\";\n\n      if (isMinValue) {\n        message = this.getResource(\"render-date-minimum-validation\").\n        replaceAll(\"#label#\", properties.displayName).\n        replaceAll(\"#minValue#\", formatedDate);\n      } else {\n        message = this.getResource(\"render-date-maximum-validation\").\n        replaceAll(\"#label#\", properties.displayName).\n        replaceAll(\"#maxValue#\", formatedDate);\n      }\n\n      invalidElements.push({ xpath: properties.xpath, message: message });\n      return true;\n    }\n    return false;\n  },\n\n  /**\r\n      * To show the mandatory values message\r\n      * */\n  showMandatoryMessage: function showMandatoryMessage(properties, invalidElements) {\n    var self = this;\n    var message = self.getResource(\"render-required-text\").replaceAll(\"#label#\", properties.displayName);\n\n    invalidElements.push({ xpath: properties.xpath, message: message });\n\n    return false;\n  },\n\n  setHour: function setHour(date) {\n    return date.replace(/\\s(\\d:)/, \" 0$1\");\n  },\n\n  /**\r\n      * Cleans the control fields as it requires\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    var self = this;\n\n    self.date = undefined;\n    self.time = undefined;\n    self.timeS = undefined;\n    self.setValue(\"\");\n    self.setDisplayValue(\"\");\n  },\n\n  isValidMinMaxValue: function isValidMinMaxValue() {\n    var self = this;\n    var isValid = true;\n    var value = self.getValue();\n\n    if (value) {\n      value = bizagi.util.dateFormatter.getDateFromInvariant(value);\n\n      if (value !== 0) {\n        // Check min value and max value\n        if (self.properties.minValue && typeof self.properties.minValue === \"string\") isValid = self.validateMinAndMaxValue(value, true);\n\n        if (self.properties.maxValue && typeof self.properties.maxValue === \"string\") isValid = self.validateMinAndMaxValue(value, false);\n      }\n    }\n\n    return isValid;\n  },\n\n  validateMinAndMaxValue: function validateMinAndMaxValue(currentDate, isMinValue) {\n    var self = this;\n    var date = isMinValue ? self.properties.minValue : self.properties.maxValue;\n    var formattedDate = self.getNormalizeDate(bizagi.util.dateFormatter.getDateFromInvariant(date));\n\n    return !(\n    isMinValue && currentDate.getTime() < formattedDate.getTime() ||\n    !isMinValue && currentDate.getTime() > formattedDate.getTime());\n\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"input, .bz-input--readonly\", $context);\n  },\n\n  /**\r\n      * Gets Mobiscroll Calendar's instance\r\n      * @returns {Object} Mobiscroll's instance\r\n      */\n  getCalendarInstance: function getCalendarInstance() {\n    return this.calendarInstance || (this.calendarInstance = $(this.getDateControl()).mobiscroll(\"getInst\"));\n  },\n\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    if (self.getMode() !== \"execution\") {\n      return;\n    }\n\n    var properties = self.properties;\n    var dateControl = self.getControl();\n    var input = $(\".bz-input-icon__input, .bz-input--readonly\", dateControl);\n    var ud = bizagi.util.dateFormatter;\n\n    if (bizagi.util.isNumeric(value) && value !== 0) {\n      value = ud.formatInvariant(new Date(value), properties.showTime);\n    }\n\n    if (value) {\n      if (typeof value == \"string\") {\n        value = self.getNormalizeDate(ud.getDateFromInvariant(value, properties.showTime));\n      } else {\n        value = self.getNormalizeDate(value);\n      }\n    }\n\n    // Assert that the date could be parsed\n    var ci = self.getCalendarInstance();\n    if (properties.editable && ci.setVal) ci.setVal(value);\n    self.setValue(ud.formatInvariant(value, true));\n    properties.displayValue = ud.formatDate(value, properties.fullFormat, self.i18n);\n\n    // Set display value\n    if (typeof properties.displayValue === \"string\" || typeof properties.displayValue === \"number\") {\n      input.prop(\"value\", properties.displayValue);\n      input.prop(\"title\", properties.displayValue);\n    }\n\n    if (!properties.editable) {\n      input.html(properties.displayValue);\n    }\n  },\n  /**\r\n      * Sets value to the control and execute a callback function\r\n      * @param {Date} date date to asign\r\n      * @param {Function} callBack function to execute\r\n      * @returns {}\r\n      */\n  setValueFromCalendarButtons: function setValueFromCalendarButtons(date, callBack) {\n    this._super(date);\n    if (typeof callBack === \"function\") callBack(date);\n    this.onChangeHandler();\n  } });","/**\r\n * Tablet definition of Action Launcher\r\n *\r\n * @author: Ricardo Prez\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.actionLauncher\", bizagi.rendering.actionLauncher.prototype);\n// Extends itself\nbizagi.rendering.smartphone.actionLauncher.extend(\"bizagi.rendering.smartphone.actionLauncher\", {}, {\n\n  /**\r\n                                                                                                       * Render a specific implementation for Desktop device\r\n                                                                                                       */\n  postRender: function postRender() {\n    if (this.getMode() == \"design\") {\n      return;\n    }\n\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n    self.actions = [];\n    self.startLoading();\n\n    // Define params to get list of actions        \n    $.when(self.dataService.multiaction().getActions(self.processPropertyValueArgs)).\n    then(function (response) {\n      response = self.getPropertiesActionLaucher(response);\n      self.actions = response;\n      self.deferredActions.resolve(response);\n\n      if (self.actions.length > 0) {\n        $(\"[data-element='actions-add-btn']\", control).show();\n      } else\n      {\n        $(\"[data-element='actions-add-btn']\", control).hide();\n      }\n\n      if (properties.isHorizontal) {\n        if (properties.templatetype != \"none\") {\n          return self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs).\n          then(function (templateData) {\n            return self.engine.render($.extend(templateData, {\n              isDefaultTemplate: properties.templatetype === \"default\",\n              sessionId: self.properties.sessionId }),\n            self.processPropertyValueDataTmplArgs);\n          }).then(function (tmpl) {\n            template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\n            var html = $($.fasttmpl(template, {\n              template: true }));\n\n\n            $(\".bz-template\", html.wrap(\"<div>\").parent()).append(tmpl);\n            return html;\n          });\n        }\n      } else\n      {\n        template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\n        return $.fasttmpl(template, {\n          template: false });\n\n      }\n    }).done(function (html) {\n      $(\"[data-element='template-container']\", control).append(html);\n      self.configureActionsHandlers();\n      self.configureTemplateHandlers();\n    }).always(function () {\n      self.endLoading();\n    });\n  },\n\n\n  /**\r\n      * Validates if the action launcher control contains a valid value\r\n      * @returns {boolean}\r\n      */\n  hasValue: function hasValue() {\n    var value = this.getValue();\n    return typeof value !== \"undefined\" && value !== null && value.length > 0;\n  },\n\n  /**\r\n      * Add binding to html elements\r\n      */\n  configureActionsHandlers: function configureActionsHandlers() {\n    var self = this;\n    var control = self.getControl();\n    var actionLauncherControls = $(\".action-launcher-control\", control);\n\n    //Binding for click action on buttons\n    actionLauncherControls.on(\"click\", function () {\n      var item = self.actions[parseInt($(this).data(\"index\"))];\n      var action = {\n        guidProcess: item[0],\n        guidAction: item[4],\n        displayName: item[1],\n        actionType: item[3],\n        xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\n        readOnlyForm: item[6] || false,\n        guidEntity: self.properties.guidEntity,\n        xpathActions: self.properties.xpathActions || \"\" };\n\n\n      self.processAction(action);\n    });\n\n    var actions = [];\n    for (var i = 0, length = self.actions.length; i < length; i++) {\n      actions.push({\n        guid: self.actions[i][0],\n        displayName: self.actions[i][1] });\n\n    }\n\n\n    //Binding for click action sheet\n    $(\"[data-element='actions-add-btn']\", control).actionSheet({\n      actions: actions,\n      actionClicked: function actionClicked(action) {\n        var item = self.actions.find(function (element) {\n          return element[0] == action.guid;\n        });\n\n        self.processAction({\n          guidProcess: item[0],\n          guidAction: item[4],\n          displayName: item[1],\n          actionType: item[3],\n          xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\n          readOnlyForm: item[6] || false,\n          xpathActions: self.properties.xpathActions || \"\" });\n\n      } });\n\n\n    //Catch the typed text in the search field and filter the action list\n    $.expr[\":\"].FilterAction = function (entity, i, array) {\n      var search = array[3];\n      if (!search) {\n        return false;\n      }\n      return new RegExp(search, \"i\").test($(entity).text());\n    };\n    $(\"input#ui-bizagi-render-action-launcher-filter-input\", control).keyup(function () {\n      var search = $(this).val();\n      $(\".action-launcher-control\", control).show();\n      if (search) {\n        $(\".action-launcher-control\", control).\n        not(\":FilterAction(\" + search + \")\").hide();\n      }\n    });\n  },\n  /**\r\n      *\r\n      */\n  configureTemplateHandlers: function configureTemplateHandlers() {\n    var self = this;\n    var control = self.getControl();\n\n    //Catch the event from the layout link\n    self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\n      params.filters = [];\n      self.triggerGlobalHandler(\"dataNavigation\", params);\n    });\n\n    $(\".bz-template-more-or-less\", control).bind(\"click\", function () {\n      $(\".bz-template\", control).toggleClass(\"bz-template--collapsed\");\n    });\n  },\n  /**\r\n      *\r\n      * @param action\r\n      */\n  processAction: function processAction(action) {\n    var self = this;\n    var control = self.getControl();\n    var properties = self.properties;\n    var multipleSelection = typeof properties.multipleSelection == \"undefined\" ? true : properties.multipleSelection;\n\n    if (multipleSelection) {\n      // If this is a form and has been queued, so open it\n      if (action.actionType == \"Form\" && self.countSameActions(action) >= 1 && !action.xpathContext) {\n        //Open action\n        $(\".action-to-execute-control[data-guidaction='\" + action.guidAction + \"'] label\", control).click();\n      } else {\n        $.when(self.actionManager(action)).done(function (act) {\n          self.executeAction(act);\n        });\n      }\n    } else if (self.getValue().length > 0) {\n      self.showConfirmationDialog(action);\n    } else {\n      $.when(self.actionManager(action)).done(function (act) {\n        self.executeAction(act);\n      });\n    }\n  },\n\n  /**\r\n      *\r\n      * @param data\r\n      * @param action\r\n      */\n  notifyExecution: function notifyExecution(data, action) {\n    var self = this;\n\n    if (data.response == \"success\") {\n      $.notifier.add({\n        class_name: \"success\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n    } else {\n      $.notifier.add({\n        class_name: \"error\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n    }\n  },\n  /**\r\n      *\r\n      * @param action\r\n      * @returns {*}\r\n      */\n  processActionForm: function processActionForm(action) {\n    var self = this;\n    var properties = self.properties;\n    var formParams = self.getParams();\n\n    var additionalXpaths = self.properties.additionalXpath.join(\",\");\n    var xpathContext = action.xpathContext ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\n    var def = new $.Deferred();\n\n    // Show dialog with new form after that\n    var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\n      title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\n      navigation: formParams.navigation,\n      showSaveButton: true,\n      cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      onSave: function onSave(data) {\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: slideForm.form.properties.xpathContext,\n          idPageCache: data.idPageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          if (!action.editMode && self.countSameActions(action) === 0) {\n            action.idStartScope = savedData.IdScope;\n          }\n          def.resolve(savedData.IdScope);\n        });\n      },\n      onCancel: function onCancel(data) {\n\n      } });\n\n\n    var renderParams = {\n      \"idForm\": action.guidProcess,\n      \"contextType\": \"start\",\n      \"idCase\": self.properties.caseId,\n      \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      \"additionalXpaths\": additionalXpaths,\n      \"xpathContext\": xpathContext,\n      \"idStartScope\": action.idStartScope,\n      \"surrogateKey\": self.properties.surrogatedKey,\n      \"readOnlyForm\": action.readOnlyForm,\n      \"recordXpath\": action.recordXpath };\n\n\n    if (action.actionType === \"Form\") {\n      renderParams.contextType = \"entitytemplate\";\n      renderParams.xpathContext = undefined;\n      renderParams.guidEntity = action.guidEntity;\n      renderParams.rewriteContextType = true;\n    }\n\n    slideForm.render(renderParams);\n\n    return def.promise();\n  },\n  /**\r\n      *\r\n      * @param action\r\n      * @returns {*}\r\n      */\n  processActionFormCollection: function processActionFormCollection(action) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var additionalXpaths = self.properties.additionalXpath.join(\",\");\n    var def = new $.Deferred();\n    var xpathContext = action.xpathContext ? self.properties.xpathActions + \".\" + action.xpathContext : self.properties.xpathActions;\n    var xpathPattern = \"%s[id=%s]\";\n    var xpathPatternWithoutkey = \"%s[]\";\n    var xpathContextWithKey = xpathContext !== \"\" ? printf(xpathPattern, xpathContext, action.idEntity) : xpathContext;\n    var xpathContextWithoutKey = xpathContext !== \"\" ? printf(xpathPatternWithoutkey, xpathContext) : xpathContext;\n    var formParams = form.getParams();\n\n    var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\n      title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\n      navigation: formParams.navigation,\n      showSaveButton: true,\n      cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      onSave: function onSave(data) {\n        if (action.editMode) {\n          return self.dataService.multiaction().submitData({\n            action: \"SAVE\",\n            data: data,\n            xpathContext: xpathContextWithKey,\n            idPageCache: data.idPageCache,\n            isOfflineForm: false,\n            isActionStartForm: true }).\n          done(function (savedData) {\n            def.resolve(savedData.IdScope);\n          });\n        } else {\n          return self.dataService.addGridRecordData({\n            idRender: properties.id,\n            //xpath: properties.xpath,\n            xpathContext: xpathContext,\n            contexttype: \"start\",\n            idPageCache: data.idPageCache,\n            submitData: data }).\n          done(function (savedData) {\n            action.idStartScope = savedData.IdScope;\n            action.idEntity = savedData.IdEntity;\n            self.addActionToQueue(action);\n            def.resolve(savedData.IdScope);\n          });\n        }\n      },\n      onCancel: function onCancel(data) {\n\n      } });\n\n\n    slideForm.render({\n      \"idForm\": action.guidProcess,\n      \"contextType\": \"start\",\n      \"idCase\": formParams.idCase,\n      \"additionalXpaths\": additionalXpaths,\n      \"xpathContext\": action.editMode ? xpathContextWithKey : xpathContextWithoutKey,\n      \"idStartScope\": action.idStartScope,\n      \"surrogateKey\": self.properties.surrogatedKey,\n      \"readOnlyForm\": action.readOnlyForm,\n      \"recordXpath\": action.recordXpath });\n\n\n    return def.promise();\n  },\n  /**\r\n      * Process a start form\r\n      * @param args\r\n      * @return {*}\r\n      */\n  processStartForm: function processStartForm(args) {\n    var self = this;\n    var def = new $.Deferred();\n    args = args || {};\n    var formParams = self.getFormContainer().getParams();\n\n    // Show dialog\n    var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\n      title: args.title || \"\",\n      navigation: formParams.navigation,\n      saveButtonLabel: self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\" ?\n      bizagi.localization.getResource(\"render-form-button-create\") :\n      bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      onSave: function onSave(data) {\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: self.properties.xpathContext,\n          idPageCache: data.idPageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          def.resolve(savedData.IdScope);\n        });\n      } });\n\n    // Render the search form\n    slideForm.render({\n      guidprocess: args.guidprocess,\n      idStartScope: args.idStartScope,\n      idCase: self.properties.caseId,\n      idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      additionalXpaths: self.properties.additionalXpath.join(\",\"),\n      surrogatedKey: self.properties.surrogatedKey,\n      recordXpath: args.recordXpath,\n      mappingstakeholders: true });\n\n\n    return def.promise();\n  },\n  /**\r\n      *\r\n      * @param action\r\n      */\n  executeAction: function executeAction(action) {\n    var self = this;\n\n    if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\n      var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\n\n      $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n      done(function () {\n        self.executeActionImmediately(action);\n      });\n    } else {\n      self.addActionToQueue(action);\n    }\n  },\n\n  /**\r\n      * Show the confirmation dialog\r\n      * bizagi.createOkCancelPopup\r\n      * @param action\r\n      * */\n  showConfirmationDialog: function showConfirmationDialog(action) {\n    var self = this;\n    var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\n\n    $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n    done(function () {\n      self.setValue([]);\n\n      $.when(self.actionManager(action)).done(function (act) {\n        self.executeAction(act);\n      });\n    });\n  },\n\n  /**\r\n      * Render actual value of control and set events\r\n      * @param data\r\n      */\n  setDisplayValue: function setDisplayValue(data) {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\"[data-element='actions-container']\", control);\n    var template = self.renderFactory.getTemplate(\"render-actionLauncher-actions-to-execute\");\n\n    self.configureQueueVisibility();\n\n    $.when(self.deferredActions).done(function (listOfActions) {\n      var getMappingAction = function getMappingAction(guidAction) {\n        var mapping = [];\n        $.each(listOfActions, function (key, value) {\n          if (value[4] == guidAction) {\n            mapping = value;\n          }\n        });\n\n        return mapping;\n\n      };\n\n      $.each(data, function (key, value) {\n        var mapping = getMappingAction(value.guidAction);\n        data[key].displayName = mapping[1];\n        data[key].guidProcess = mapping[0];\n        data[key].actionType = mapping[3];\n        data[key].xpathContext = mapping[5];\n        data[key].readOnlyForm = mapping[6];\n\n        if (data[key].params && data[key].params.idStartScope) {\n          data[key].idStartScope = data[key].params.idStartScope;\n        }\n        if (data[key].params && data[key].params.idPageCache) {\n          data[key].idPageCache = data[key].params.idPageCache;\n        }\n        if (data[key].params && data[key].params.idEntity) {\n          data[key].idEntity = data[key].params.idEntity;\n        }\n      });\n\n      if (data.length > 0) {\n        $.when($.fasttmpl(template, { actions: data })).done(function (html) {\n          actionsToExecuteContainer.empty();\n          actionsToExecuteContainer.append(html);\n\n          var removeActionSelector = $(\".bz-actions-to-execute .bz-btn-icn\", actionsToExecuteContainer);\n          var openActionSelector = $(\"label\", actionsToExecuteContainer);\n\n          removeActionSelector.on(\"click\", function () {\n            var index = $(this).parent().data(\"index\");\n            self.removeActionToQueue(index);\n          });\n\n          openActionSelector.on(\"click\", function () {\n            var target = $(this).parent();\n            var type = target.data(\"actiontype\");\n            var guidprocess = target.data(\"guidprocess\");\n            var idStartScope = target.data(\"idstartscope\");\n            var title = target.data(\"title\");\n            // When undefined return string \"undefined\" instead of type \"undefined\"\n            var xpathContext = target.data(\"xpathcontext\");\n            var readOnlyForm = target.data(\"readonlyform\") || false;\n            var idEntity = target.data(\"identity\") || \"\";\n            var guidAction = target.data(\"guidaction\");\n            var recordXpath = xpathContext || self.properties.xpathContext;\n            switch (type) {\n              case \"Process\":\n                if (idStartScope) {\n                  self.processStartForm({\n                    guidprocess: guidprocess,\n                    idStartScope: idStartScope,\n                    title: title,\n                    xpathContext: xpathContext,\n                    recordXpath: recordXpath });\n\n                }\n                break;\n              case \"Form\":\n                var action = {\n                  guidProcess: guidprocess,\n                  idStartScope: idStartScope,\n                  editMode: true,\n                  xpathContext: xpathContext,\n                  readOnlyForm: readOnlyForm,\n                  idEntity: idEntity,\n                  recordXpath: recordXpath };\n\n\n                if (action.xpathContext) {\n                  self.processActionFormCollection(action);\n                } else {\n                  // Convert string \"undefined\" into type \"undefined\"\n                  action.xpathContext = undefined;\n\n                  // Add parameters if action form\n                  var extraParams = {};\n                  var dataAction = self.value.filter(function (item) {\n                    return item.guidAction == guidAction;\n                  });\n\n                  if (dataAction.length > 0) {\n                    extraParams = {\n                      actionType: \"Form\",\n                      contextType: \"entitytemplate\",\n                      guidEntity: self.properties.guidEntity || dataAction[0].guidEntity };\n\n                  }\n\n                  self.processActionForm($.extend(action, extraParams));\n                }\n                break;\n              case \"Rule\":\n                // Rules dont have forms or something like that\n                break;}\n\n          });\n        });\n      } else {\n        actionsToExecuteContainer.empty();\n      }\n\n    });\n  },\n  /**\r\n      * Show container if it has actions\r\n      */\n  configureQueueVisibility: function configureQueueVisibility() {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\".bz-action-launcher-actions-to-execute-container\", control);\n    var actionsToExecuteTitle = $(\".action-to-execute-label\", control);\n\n    if (self.getValue().length > 0) {\n      actionsToExecuteContainer.show();\n      actionsToExecuteTitle.show();\n    } else {\n      actionsToExecuteContainer.hide();\n      actionsToExecuteTitle.hide();\n    }\n  } });","/**\r\n * Tablet definition of entity template\r\n *\r\n * @author: Ricardo Prez\r\n */\n\nbizagi.rendering.smartphone.actionLauncher.extend(\"bizagi.rendering.smartphone.entityTemplate\", {}, {\n\n  /**\r\n                                                                                                       * Render a specific implementation for smartphone device\r\n                                                                                                       */\n  postRender: function postRender() {\n    if (this.getMode() == \"design\") {\n      return;\n    }\n\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n    self.actions = [];\n    self.configureQueueVisibility();\n    self.startLoading();\n\n    // Define params to get template               \n    self.dataService.multiaction().getPropertyData(self.processPropertyValueDataTmplArgs).\n    then(function (templateData) {\n      return self.engine.render(templateData, self.processPropertyValueDataTmplArgs).\n      then(function (tmpl) {\n        var template = self.renderFactory.getTemplate(\"render-actionLauncher-horizontal\");\n        var html = $($.fasttmpl(template, { template: true }));\n        $(\".bz-template\", html.wrap(\"<div>\").parent()).append(tmpl);\n\n        if (properties.allowactions) {\n          return self.dataService.multiaction().getActions(self.processPropertyValueArgs).\n          then(function (response) {\n            self.deferredActions.resolve(response);\n            self.actions = response;\n\n            if (self.actions.length > 0) {\n              $(\"[data-element='actions-add-btn']\", control).show();\n            } else\n            {\n              $(\"[data-element='actions-add-btn']\", control).hide();\n            }\n            return html;\n          });\n        } else\n        {\n          return html;\n        }\n      });\n\n    }).done(function (html) {\n      $(\"[data-element='template-container']\", control).append(html);\n      self.configureActionsHandlers();\n      self.configureTemplateHandlers();\n    }).always(function () {\n      self.endLoading();\n    });\n  },\n\n  /**\r\n      * Add binding to html elements\r\n      */\n  configureActionsHandlers: function configureActionsHandlers() {\n    var self = this;\n    var control = self.getControl();\n    var entityTemplateControls = $(\".action-launcher-control\", control);\n\n    /**\r\n                                                                          * Binding for click action on buttons\r\n                                                                          */\n    entityTemplateControls.on(\"click\", function () {\n      var item = self.actions[parseInt($(this).data(\"index\"))];\n      var action = {\n        guidProcess: item[0],\n        guidAction: item[4],\n        displayName: item[1],\n        actionType: item[3],\n        xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\",\n        xpathActions: self.properties.xpathActions || \"\" };\n\n\n      if (action.actionType === \"Form\") {\n        action.xpathContext = undefined;\n        action.contextType = \"entitytemplate\";\n        action.guidEntity = self.properties.guidEntity;\n      }\n\n      self.processAction(action);\n    });\n\n    var actions = [];\n    for (var i = 0, len = self.actions.length; i < len; i++) {\n      actions.push({\n        guid: self.actions[i][0],\n        displayName: self.actions[i][1] });\n\n    }\n\n    /**\r\n       * Binding for click action sheet\r\n       */\n    $(\"[data-element='actions-add-btn']\", control).actionSheet({\n      actions: actions,\n      actionClicked: function actionClicked(action) {\n        var item = self.actions.find(function (e) {\n          return e[0] == action.guid;\n        });\n        self.processAction({\n          guidProcess: item[0],\n          guidAction: item[4],\n          displayName: item[1],\n          actionType: item[3],\n          xpathContext: typeof item[5] !== \"undefined\" && item[5] === \"true\" });\n\n      } });\n\n\n  },\n\n  configureTemplateHandlers: function configureTemplateHandlers() {\n    var self = this;\n    var control = self.getControl();\n    /**\r\n                                      * Catch the event from the layout link\r\n                                      */\n    self.engine.subscribe(\"onLoadDataNavigation\", function (ev, params) {\n      params.filters = [];\n      params.calculateFilters = params.calculateFilters || true;\n\n      self.triggerGlobalHandler(\"dataNavigation\", params);\n    });\n\n    $(\".bz-template-more-or-less\", control).bind(\"click\", function () {\n      $(\".bz-template\", control).toggleClass(\"bz-template--collapsed\");\n    });\n  } });","/**\r\n * Device definition of Polymorphic launcher\r\n *\r\n * @author: Andres Felipe Arenas\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.polymorphicLauncher\", bizagi.rendering.polymorphicLauncher.prototype);\n// Extends itself\nbizagi.rendering.smartphone.polymorphicLauncher.extend(\"bizagi.rendering.smartphone.polymorphicLauncher\", {}, {\n  /**\r\n                                                                                                                  * Render a specific implementation for Smartphone device\r\n                                                                                                                  */\n  postRender: function postRender() {\n    var self = this;\n    var properties = self.properties;\n    var mode = self.getMode();\n    var html, template;\n\n    if (mode == \"design\" || !self.properties.surrogatedKey) {\n      return \"\";\n    }\n\n    self.configureQueueVisibility();\n\n    /**\r\n                                      * Define params to get list of actions\r\n                                      */\n    return $.when(self.dataService.multiaction().getPolymorphicActions(self.processPropertyValueArgs)).done(function (response) {\n      // Convert default response to tree data structure\n      response = self.dataService.serializePolymorphicActions(response);\n      self.totalActions = bizagi.clone(response);\n      var actions = bizagi.clone(response);\n      self.lessActions = bizagi.clone(actions);\n\n      // NOTE: Code extracted\n      var templateArguments = {\n        actions: actions,\n        allowSearch: properties.allowSearch,\n        treeActionsList: self.getTreeItems(actions) };\n\n      template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree\");\n\n      var control = self.getControl();\n      var actionsContainer = $(\".bz-polymorphic-launcher__constructors\", control);\n      actionsContainer.append($.fasttmpl(template, templateArguments));\n      self.bindHandlers();\n    });\n  },\n\n  /**\r\n      * Get rendered html of each node of constructors\r\n      * @param actions\r\n      * @param level\r\n      * @return {string}\r\n      */\n  getTreeItems: function getTreeItems(actions, level) {\n    var self = this;\n    var item = \"<ul>\";\n    var templateTreeItem = self.renderFactory.getTemplate(\"render-polymorphicLauncher-vertical-tree-item\");\n    actions = actions || {};\n    level = level || 1;\n\n    $.each(actions, function (key, value) {\n      item += $.fasttmpl(templateTreeItem, value);\n\n      if (value.children) {\n        item += self.getTreeItems(value.children, level + 1);\n      }\n    });\n    item += \"</ul>\";\n    return item;\n  },\n\n  /**\r\n      * Add binding to html elements\r\n      */\n  bindHandlers: function bindHandlers() {\n    var self = this;\n    var control = self.getControl();\n    var actionLauncherControls = $(\".bz-polymorphic-launcher__constructors li span\", control);\n\n    //Binding for click action on buttons\n    actionLauncherControls.on(\"click\", function () {\n      var $targetData = $(this).parent();\n      var action = {\n        guidEntity: $targetData.data(\"guidentity\"),\n        guidObject: $targetData.data(\"guidobject\"),\n        guidConstructor: $targetData.data(\"guidconstructor\"),\n        displayName: $targetData.data(\"display-name\"),\n        actionType: $targetData.data(\"action-type\"),\n        xpathContext: $targetData.data(\"xpathcontext\") };\n\n      self.onActionClicked(action);\n    });\n    //Catch the typed text in the search field and filter the action list\n    $.expr[\":\"].FilterAction = function (entity, i, array) {\n      var search = array[3];\n      if (!search) {\n        return false;\n      }\n      return new RegExp(search, \"i\").test($(entity).text());\n    };\n    $(\"input[data-action=search]\", control).keyup(function () {\n      var search = $(this).val();\n      $(\".bz-polymorphic-launcher__constructors li\", control).show();\n      if (search) {\n        $(\".bz-polymorphic-launcher__constructors li\", control).not(\":FilterAction(\" + search + \")\").hide();\n      }\n    });\n\n  },\n  /**\r\n      * Execute an Action\r\n      * @param action\r\n      */\n  onActionClicked: function onActionClicked(action) {\n    var self = this;\n\n    $.when(self.actionManager(action)).done(function (act) {\n      self.executeAction(act);\n    });\n  },\n  /**\r\n      * Show a message when action has been executed\r\n      * @param status\r\n      * @param action\r\n      */\n  notifyExecution: function notifyExecution(status, action) {\n    var self = this;\n    if (status == \"success\") {\n      $.notifier.add({\n        class_name: \"success\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-success-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n\n    } else {\n      $.notifier.add({\n        class_name: \"error\",\n        title: action.displayName,\n        text: self.getResource(\"render-action-launcher-failed-excecution\").replace('%s', action.displayName),\n        sticky: false });\n\n    }\n  },\n  /**\r\n      * Show a dialog with a form\r\n      * @param action\r\n      * @return {*}\r\n      */\n  processActionForm: function processActionForm(action) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var additionalXpaths = self.properties.additionalXpath.join(\",\");\n    var def = new $.Deferred();\n    var xpathContext = action.xpathContext || \"\";\n    var formParams = form.getParams();\n\n    var recordXpath = self.properties.recordXpath;\n\n    // Show dialog with new form after that\n    var slideForm = new bizagi.rendering.smartphone.slide.form(self.dataService, self.renderFactory, {\n      title: properties.detailLabel || bizagi.localization.getResource(\"render-grid-details-form\"),\n      navigation: formParams.navigation,\n      showSaveButton: true,\n      cancelButtonLabel: bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n      onSave: function onSave(data) {\n        var pageCache = data.idPageCache;\n        data.idPageCache = null;\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: slideForm.form.properties.xpathContext, //self.properties.xpathContext,\n          idPageCache: pageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          if (!action.editMode && self.countSameActions(action) == 0) {\n            action.idStartScope = savedData.IdScope;\n          }\n          def.resolve(savedData.IdScope);\n        });\n      },\n      onCancel: function onCancel(data) {\n\n      } });\n\n\n    slideForm.render({\n      \"idForm\": action.guidObject,\n      \"contextType\": \"entity\",\n      \"guidEntity\": action.guidEntity,\n      \"idCase\": self.properties.caseId,\n      \"idWorkitem\": self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      \"additionalXpaths\": additionalXpaths,\n      //\"xpathContext\": xpathContext,\n      \"idStartScope\": action.idStartScope,\n      \"surrogateKey\": self.properties.surrogatedKey,\n      \"recordXpath\": recordXpath });\n\n\n    return def.promise();\n  },\n\n  /**\r\n      * Process a start form\r\n      * @param args\r\n      * @return {*}\r\n      */\n  processStartForm: function processStartForm(args) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var def = new $.Deferred();\n    var formParams = form.getParams();\n    args = args || {};\n\n\n    var slideForm = new bizagi.rendering.smartphone.startForm(self.dataService, self.renderFactory, {\n      //showSaveButton: properties.editable,\n      maximized: properties.maximized,\n      title: args.title || \"\",\n      navigation: formParams.navigation,\n      saveButtonLabel: self.typeForm == \"GlobalForm\" || this.typeForm == \"SummaryForm\" ? bizagi.localization.getResource(\"render-form-button-create\") : bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n      onSave: function onSave(data) {\n        form.startLoading();\n\n        // Submit the form\n        return self.dataService.multiaction().submitData({\n          action: \"SAVE\",\n          data: data,\n          xpathContext: self.properties.xpathContext,\n          idPageCache: data.idPageCache,\n          isOfflineForm: false,\n          isActionStartForm: true }).\n        done(function (savedData) {\n          form.endLoading();\n          def.resolve(savedData.IdScope);\n        });\n      } });\n\n\n    slideForm.render({\n      guidprocess: args.guidprocess,\n      idStartScope: args.idStartScope,\n      idCase: self.properties.caseId,\n      idWorkitem: self.typeForm != \"SummaryForm\" ? formParams.idWorkitem : undefined,\n      additionalXpaths: self.properties.additionalXpath.join(\",\"),\n      surrogatedKey: self.properties.surrogatedKey,\n      recordXpath: args.recordXpath,\n      mappingstakeholders: true });\n\n\n    return def.promise();\n  },\n  /**\r\n      * Execute and action if a form is global form or summary, or send to queue\r\n      * @param action\r\n      */\n  executeAction: function executeAction(action) {\n    var self = this;\n\n    if (self.typeForm == \"GlobalForm\" || self.typeForm == \"SummaryForm\") {\n      var message = bizagi.localization.getResource(\"render-action-launcher-immediatly-action-confirmation\");\n\n      $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n      done(function () {\n        self.executeActionImmediately(action);\n      });\n    } else {\n      self.addActionToQueue(action);\n    }\n  },\n\n  /**\r\n      * Show confirmation dialog\r\n      * @param action\r\n      */\n  showConfirmationDialog: function showConfirmationDialog(action) {\n    var self = this;\n    var message = bizagi.localization.getResource(\"render-action-launcher-single-action-confirmation\");\n\n    $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n    done(function () {\n      self.setValue([]);\n\n      $.when(self.actionManager(action)).\n      done(function (act) {\n        self.executeAction(act);\n      });\n    });\n  },\n\n  /**\r\n      * Render actual value of control and set events\r\n      * @param data\r\n      */\n  setDisplayValue: function setDisplayValue(data) {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\n    var template = self.renderFactory.getTemplate(\"render-polymorphicLauncher-actions-to-execute\");\n    self.configureQueueVisibility();\n\n    $.when($.fasttmpl(template, { actions: data })).done(function (html) {\n      actionsToExecuteContainer.empty();\n      actionsToExecuteContainer.append(html);\n      var removeActionSelector = $(\".bz-pill .bz-btn-icn\", actionsToExecuteContainer);\n      var openActionSelector = $(\".bz-pill__label\", actionsToExecuteContainer);\n      removeActionSelector.on(\"click\", function () {\n        var index = $(this).parent().data(\"index\");\n        self.removeActionToQueue(index);\n      });\n      openActionSelector.bind(\"click\", function () {\n        var $target = $(this).parent();\n        var type = $target.data(\"actiontype\");\n        var guidprocess = $target.data(\"guidprocess\");\n        var idStartScope = $target.data(\"idstartscope\");\n        var title = $target.data(\"title\");\n        var xpathContext = $target.data(\"xpathcontext\");\n        var idEntity = $target.data(\"identity\") || \"\";\n        var guidEntity = $target.data(\"guidentity\");\n        var recordXpath = xpathContext || self.properties.xpathContext;\n\n        switch (type) {\n          case \"Process\":\n            if (idStartScope) {\n              self.processStartForm({\n                guidprocess: guidprocess,\n                idStartScope: idStartScope,\n                title: title,\n                xpathContext: xpathContext,\n                recordXpath: recordXpath });\n\n            }\n            break;\n          case \"Form\":\n            var action = {\n              guidProcess: guidprocess,\n              idStartScope: idStartScope,\n              editMode: true,\n              xpathContext: xpathContext,\n              idEntity: idEntity,\n              guidEntity: guidEntity,\n              guidObject: guidprocess };\n\n\n            self.processActionForm(action);\n            break;\n          case \"Rule\":\n            // Rules dont have forms or something like that\n            break;}\n\n      });\n    });\n  },\n  /**\r\n      * Show container if it has actions\r\n      */\n  configureQueueVisibility: function configureQueueVisibility() {\n    var self = this;\n    var control = self.getControl();\n    var actionsToExecuteContainer = $(\".bz-polymorphic-launcher-constructors-to-execute-container\", control);\n    var actionsToExecuteTitle = $(\".bz-polymorphic-launcher__title\", control);\n    if (self.getValue().length > 0) {\n      actionsToExecuteContainer.show();\n      actionsToExecuteTitle.show();\n    } else {\n      actionsToExecuteContainer.hide();\n      actionsToExecuteTitle.hide();\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Yes-No Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.yesno\", bizagi.rendering.yesno.prototype);\n// Extends itself\nbizagi.rendering.smartphone.yesno.extend(\"bizagi.rendering.smartphone.yesno\", {}, {\n\n  /**\r\n                                                                                     * Method to customize each render after processed\r\n                                                                                     */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input[type=radio]\");\n\n    if (this.properties.editable && (this.value == null || this.value === undefined) && this.properties.value != null) {\n      this.value = this.properties.value;\n    }\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var $control = this.getControl();\n    var parsedValue = bizagi.util.parseBoolean(value);\n\n    this.setValue(parsedValue, false);\n\n    if (this.properties.editable) {\n      if (parsedValue) {\n        $control.find(\"input[value=true]\").prop('checked', true);\n        $control.find(\"input[value=false]\").prop('checked', false);\n      } else {\n        $control.find(\"input[value=false]\").prop('checked', true);\n        $control.find(\"input[value=true]\").prop('checked', false);\n      }\n    } else {\n      this.radio.val(this.getDisplayValue());\n    }\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    self.radio.change(function () {\n      var $selected = $(this);\n      var value = $selected.prop('value');\n\n      if (self.value !== value) {\n        self.setValue(value);\n      }\n    });\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\"label.bz-radio__label\", context);\n  },\n\n  /**\r\n      * Cleans current data\r\n      */\n  cleanData: function cleanData() {\n    var value = null;\n    this.setValue(value, false);\n    this.clearDisplayValue();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    if (this.properties.editable) {\n      this.radio.prop('checked', false);\n    } else {\n      this.radio.val(this.getDisplayValue());\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Check\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Yes-No render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.check\", bizagi.rendering.check.prototype);\n// Extends itself\nbizagi.rendering.smartphone.check.extend(\"bizagi.rendering.smartphone.check\", {}, {\n\n  /**\r\n                                                                                     * Template method to implement in each device to customize each render after processed\r\n                                                                                     */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.check = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.check = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // Render as simple value\n    var displayValue = bizagi.util.parseBoolean(value);\n\n    // Set internal value\n    this.setValue(displayValue, false);\n\n    if (this.properties.editable && this.check) {\n      if (displayValue) {\n        this.check.attr(\"checked\", \"checked\");\n      } else {\n        this.check.removeAttr(\"checked\");\n      }\n    } else if (this.check) {\n      this.check.val(this.getDisplayValue());\n    }\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    this.check.on(\"click\", function (evt) {\n      var isCheck = $(this).is(':checked');\n\n      self.setValue(isCheck, true);\n\n    });\n  },\n\n  /**\r\n      * Cleans current data\r\n      */\n  cleanData: function cleanData() {\n    this.setDisplayValue(false);\n    this.setValue(false, false);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the list render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.checkList\", bizagi.rendering.checkList.prototype);\n// Extends itself\nbizagi.rendering.smartphone.checkList.extend(\"bizagi.rendering.smartphone.checkList\", {}, {\n\n  /**\r\n                                                                                             *   Template method to implement in each device to customize each render after processed\r\n                                                                                             */\n  postRender: function postRender() {\n    this._super();\n    this.properties.unique = Math.ceil(Math.random() * 1000);\n    this.properties.required = true;\n  },\n\n  /**\r\n      *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    // Call base\n    self._super();\n    $(\"input[type=checkbox]\", self.getControl()).bind(\"change\", function () {\n      var itemId = $(this).data(\"item-guid\");\n      self.onCheckListGroupChange(itemId, this.checked);\n    });\n  },\n\n  onCheckListGroupChange: function onCheckListGroupChange(itemId, checked) {\n    var self = this;\n    var item;\n    var items = $.grep(self.properties.items, function (element, index) {\n      return element.guid === itemId;\n    });\n    if (items && items.length > 0) {\n      item = items[0];\n    }\n    item.checked = checked;\n  },\n\n  /**\r\n      *   Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    $(\"input[type=checkbox]\", this.getControl()).removeAttr(\"checked\");\n  },\n\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render MultiSelect Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the multiSelect render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.multiSelect\", bizagi.rendering.multiSelect.prototype);\n// Extends itself\nbizagi.rendering.smartphone.multiSelect.extend(\"bizagi.rendering.smartphone.multiSelect\", {\n  MORE_OPTION_WIDTH: 40,\n  SEARCH_MIN_LENGTH: 1 },\n{\n\n  /**\r\n   * Update or init the element data\r\n   * @param {} data submitData\r\n   * @returns {}\r\n   */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.readonly\");\n    var dataList = self.getDataValue() || [];\n\n    // Render template\n    var content = $.fasttmpl(template, {\n      items: dataList,\n      editable: self.properties.editable || true },\n    {\n      formatItem: self.formatItem });\n\n\n    return content;\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var self = this;\n\n    if (this.isExecutionMode()) {\n      this.getData().done(function (data) {\n        self.properties.data = data;\n      });\n    }\n\n    // Call base\n    this._super();\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $control = self.getControl();\n\n    $(\"[data-action=modal]\", $control).bind(\"click\", function () {\n      self.openModalView();\n    });\n  },\n\n  /**\r\n      * Sets the value and display, avoid to include setValue in this method.\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    this._super(value);\n\n    if (value !== undefined) {\n      var dataList = self.getDataValue() || [];\n      var dataMapped = dataList.map(function (el) {\n        return self.formatItem(el.value);\n      }).join(\", \");\n\n      $(\".bz-input-icon__input\", this.getControl()).html(dataMapped);\n    }\n  },\n\n  /**\r\n      * Opens the modal view\r\n      */\n  openModalView: function openModalView() {\n    var self = this;\n    self.getData().done(function (result) {\n      var template_content = self.renderFactory.getTemplate('multiselect-list');\n      var value = self.getDataValue() || [];\n\n      var data = {\n        values: result,\n        isChecked: function isChecked(id) {\n          return self.isChecked(value, id);\n        } };\n\n\n      var content = $.fasttmpl(template_content, data, {\n        formatItem: self.formatItem });\n\n\n      var template_footer = self.renderFactory.getTemplate(\"modal-footer-done\");\n      var footer = $.fasttmpl(template_footer, {});\n\n      self.getControl().mobileView({\n        customHeader: $.fasttmpl(self.renderFactory.getTemplate(\"modal-header-search\"), {\n          hideSearch: self.properties.enableTyping === false }),\n\n        orientation: self.properties.orientation || \"\",\n        contentTemplate: content,\n        footerTemplate: footer,\n        transition: \"slideIn:up\",\n        close: function close() {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        },\n        afterOpenAnimation: function afterOpenAnimation(event) {\n          var $context = $(\".bz-modal-view__search\", event.view.header);\n\n          // Fix the moving content to top\n          if ($context && $context[0]) {\n            $context[0].scrollIntoView(true);\n            $context.focus();\n          }\n        },\n        open: function open() {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        configureActions: function configureActions(modalView) {\n          self.configureModalViewHandlers(modalView);\n        } });\n\n    });\n  },\n\n  /**\r\n      * Configure the modalView Handlers for the new combo control.\r\n      * */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n\n    var $listContainer = $(\".bz-checkbox-list li\", modalView.content);\n    //clear button\n    var $clearButton = $(\".bz-modal-view__clear\", modalView.header);\n    // Suggest input\n    var $suggestInput = $(\".bz-modal-view__search\", modalView.header);\n\n    if (this.properties.enableTyping) {\n      $suggestInput.on(\"change keyup\", function () {\n        if (this.value === \"\") {\n          $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n        } else {\n          $clearButton.addClass(\"bz-modal-view__clear--visible\");\n        }\n        self.filterList(this.value, $listContainer);\n      }).on(\"focus\", function () {\n        modalView.header.addClass(\"bz-modal-view__header--active\");\n      }).on(\"blur\", function () {\n        modalView.header.removeClass(\"bz-modal-view__header--active\");\n      });\n\n      //Clear the search\n      $clearButton.on(\"click\", function () {\n        $suggestInput.val(\"\").trigger(\"change\");\n      });\n    }\n\n    $(\"[data-action=close]\", modalView.header).on(\"click\", function () {\n      modalView.close();\n    });\n\n    $(modalView.footer).on(\"click\", \"[data-action=save]\", function () {\n      // Create a temporal array\n      var newList = [];\n\n      $.each.call(this, $listContainer, function (index, item) {\n        var check = item.querySelector(\"input\");\n\n        if (check.checked) {\n          var id = check.getAttribute(\"data-id\");\n          var element = this.findItemById(id);\n          var value = element.value;\n          newList.push({ id: id, value: value });\n        }\n      }.bind(self));\n\n      self.setDisplayValue(newList);\n\n      modalView.close();\n    });\n  },\n\n  /**\r\n      * Fetch the data into a deferred\r\n      * @returns {*[]}\r\n      */\n  getData: function getData() {\n    var self = this;\n\n    return this.isOfflineForm ?\n    this.getOfflineData() :\n    $.when(this._super()).fail(function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n      var message = typeof error_obj === \"undefined\" ? {\n        \"message\": bizagi.localization.getResource(\"workportal-general-error\") } :\n      error_obj;\n\n      self.getFormContainer().failHandler(message);\n    });\n  },\n\n  /**\r\n      * Get offline data for request\r\n      */\n  getOfflineData: function getOfflineData() {\n    var data = this.properties.data || [];\n\n    return $.when(this.normalizeData(data));\n  } });","/**\r\n *   Name: Bizagi Render HandSignature Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Hand Signature render class to adjust to smartphone devices\r\n */\n\n// Extends from render Smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.handSignature\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.handSignature.prototype);\n// Extends itself\nbizagi.rendering.smartphone.handSignature.extend(\"bizagi.rendering.smartphone.handSignature\", {}, {\n\n  /**\r\n                                                                                                     * Whether or not is a native device\r\n                                                                                                     * @var isNative boolean\r\n                                                                                                     */\n  isNative: false,\n\n  /**\r\n                    * Whether or not is a offline control\r\n                    * @var isOfflineForm boolean\r\n                    */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.isNative = bizagi.util.isCordovaSupported();\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $actions = $(\".bz-actions\", this.getControl());\n    var $container = self.getSignatureContainer();\n\n    var autoSave = bizagi.util.debounce2(function (params) {\n      if (!changed) return;\n\n      var data = Array.prototype.slice.call(params || []);\n      var dataImage = (data && data[0] || []).dataImage || \"\";\n\n      self.saveDeferred = $.when(self.saveSignature(dataImage));\n    }, !self.isOfflineForm ? self.DELAY_TO_SAVE : 0);\n\n    var changed = false;\n\n    $container.bind(\"change\", function () {\n      changed = true;\n      if ($(this).BzjSignature(\"isModified\")) {\n        self.saveTimestamp = new Date().getTime();\n        var $canvas = $(\".bz-signature__container-canvas\", this)[0];\n        var dataImage = $canvas.toDataURL(\"image/png\");\n        autoSave.fire({ dataImage: dataImage });\n        self.setData(dataImage.replace(/^data:image\\/(png|jpg|jpeg);base64,/, \"\"));\n        self.properties.url = dataImage;\n        self.setState(self.STATE_TYPE.done);\n      }\n    });\n\n    $actions.on(\"click\", \"[data-action='clear']\", function () {\n      changed = true;\n      autoSave.cancel();\n      self.onSignatureClear($container);\n    });\n\n    $actions.on(\"click\", \"[data-action='edit']\", function () {\n      self.onSignatureEdit($container);\n      changed = false;\n    });\n\n    $actions.on(\"click\", \"[data-action='save']\", function () {\n      if (!changed) {\n        self.setState(self.STATE_TYPE.edit);\n        $container.BzjSignature(\"disable\");\n        return;\n      }\n\n      self.onSignatureSave($container, autoSave);\n      changed = false;\n    });\n\n  },\n\n  onSignatureClear: function onSignatureClear($container) {\n    var self = this;\n\n    $container.BzjSignature(\"reset\");\n\n    if (self.hasValue()) {\n      bizagi.loading.start();\n      self.setData(self.EMPTY_VALUE);\n      self.properties.url = self.EMPTY_VALUE;\n      $.when(self.deleteSignature()).then(function (result) {\n        self.setData(result);\n        self.properties.url = result;\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    }\n  },\n\n  onSignatureEdit: function onSignatureEdit($container) {\n    this.setState(this.STATE_TYPE.draw);\n    $container.BzjSignature(\"enable\");\n  },\n\n  onSignatureSave: function onSignatureSave($container, autoSave) {\n    var self = this;\n\n    $container.BzjSignature(\"disable\");\n\n    if ($container && $container.BzjSignature(\"isModified\")) {\n      var $canvas = $(\".bz-signature__container-canvas\", $container)[0];\n      bizagi.loading.start();\n\n      autoSave.cancel();\n      self.saveSignature($canvas.toDataURL(\"image/png\")).always(function () {\n        self.setState(self.STATE_TYPE.edit);\n        bizagi.loading.stop();\n      });\n    } else {\n      self.setState(self.STATE_TYPE.edit);\n    }\n  },\n\n  /**\r\n      * Apply plugin\r\n      */\n  renderSignature: function renderSignature() {\n    var self = this;\n    var $container = self.getSignatureContainer();\n    var config = {\n      sizeRatio: 3,\n      cssclass: \"bz-signature__container-canvas\",\n      color: \"#000\" };\n\n\n    $container.empty();\n    $container.BzjSignature(config);\n    $container.BzjSignature(\"disable\");\n\n    if (self.pluginInitialized && self.properties.url) {\n      self.setSignature($container);\n    } else {\n      self.renderSignatureValue($container);\n    }\n\n    // Only apply for mobile\n    var $canvas = $(\".bz-signature__container-canvas\", $container);\n    var height = Math.round($canvas.width() / 2);\n\n    $canvas.attr(\"height\", height).css(\"height\", height);\n    $canvas.css(\"width\", \"100%\");\n\n    // Required for resize observer\n    self.pluginInitialized = true;\n  },\n\n  /**\r\n      * Set data to control\r\n      * @param $container\r\n      * @returns {*}\r\n      */\n  renderSignatureValue: function renderSignatureValue($container) {\n    var self = this;\n\n    bizagi.util.sleepUntil(function () {\n      return !self.dataService.getFileService().isLoading(self);\n    }).then(function () {\n      return self.buildItemUrl();\n    }).then(function (dataUrl) {\n      if (!self.isDisposed()) {\n        // Fake empty\n        if (dataUrl === self.BASE_IMAGE + self.EMPTY_IMAGE) {\n          dataUrl = \"\";\n        }\n\n        var url = dataUrl !== \"\" ? dataUrl : \"\";\n        self.properties.url = url;\n\n        if (!bizagi.util.isEmpty(url)) {\n          $container.BzjSignature(\"setData\", url);\n        } else {\n          self.setData(self.EMPTY_VALUE);\n        }\n      }\n    });\n  },\n\n  /**\r\n      * Execute upload image\r\n      * @param dataImage\r\n      * @returns {*}\r\n      */\n  postSignature: function postSignature(dataImage) {\n    var signature = dataImage.replace(/^data:image\\/(png|jpg|jpeg);base64,/, \"\");\n\n    if (!this.isOfflineForm) {\n      return this.postSignatureOnline(signature);\n    }\n\n    return this.postSignatureOffline(signature);\n  },\n\n  /**\r\n      * Execute upload image for offline mode\r\n      * @param signature\r\n      * @returns {*}\r\n      */\n  postSignatureOffline: function postSignatureOffline(signature) {\n    var self = this;\n\n    return self.saveImageOffline(signature).then(function () {\n      self.properties.isChanged = true;\n      return signature;\n    });\n  },\n\n  /**\r\n      * Delete data image\r\n      * @returns {*}\r\n      */\n  deleteSignature: function deleteSignature() {\n    var self = this;\n\n    if (!self.isOfflineForm) {\n      return this.deleteImage().then(function () {\n        return self.EMPTY_VALUE;\n      });\n    }\n    return self.saveImageOffline(self.EMPTY_IMAGE).then(function () {\n      self.properties.isChanged = true;\n      return self.EMPTY_VALUE;\n    });\n  },\n\n  /**\r\n      * Builds the upload item url\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  buildItemUrl: function buildItemUrl(params) {\n    if (this.isOfflineForm) {\n      return this.buildItemUrlOffline(params);\n    } else {\n      return this._super(params);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the radio render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.radio\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.radio.extend(\"bizagi.rendering.smartphone.radio\", bizagi.rendering.radio.prototype);\n// Extends itself\nbizagi.rendering.smartphone.radio.extend(\"bizagi.rendering.smartphone.radio\", {}, {\n\n  /**\r\n                                                                                     * Template method to implement in each device to customize each render after processed\r\n                                                                                     */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input[type=radio]\");\n\n    if (this.properties.editable && (this.value == null || this.value === undefined) && this.properties.value != null) {\n      this.value = this.properties.value;\n    }\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.radio = $control.find(\"input\");\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param value\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var $control = self.getControl();\n\n    // Map data from actions\n    value = self.mapValue(value);\n\n    // Set internal value\n    self.setValue(value, false);\n\n    if (value !== undefined && value.id != null && value.id !== \"\") {\n\n      if (this.properties.editable) {\n\n        var radioItem = $control.\n        find('input[type=\"radio\"][value=\"' + value.id + '\"]');\n\n        radioItem.prop('checked', 'checked');\n      } else {\n        self.radio.val(this.getDisplayValue());\n        self.radio.attr(\"id\", value.id);\n      }\n    }\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    this.radio.change(function () {\n      var $selected = $(this);\n\n      var newValue = {\n        id: $selected.prop('value'),\n        value: $.trim($selected.siblings(\"label\").text()) };\n\n\n      self.setValue(newValue);\n    });\n  },\n\n  /**\r\n      * Context to apply styles\r\n      * @param context\r\n      * @returns {jQuery|HTMLElement}\r\n      */\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\"label.bz-radio__label, .bz-input.bz-input--readonly\", context);\n  },\n\n  /**\r\n      * Cleans current data\r\n      */\n  cleanData: function cleanData() {\n    var value = { id: \"\", label: \"\" };\n    this.setValue(value, false);\n\n    this.clearDisplayValue();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    if (this.properties.editable) {\n      this.radio.prop('checked', false);\n    } else {\n      this.radio.val(this.getDisplayValue());\n    }\n  },\n\n  /**\r\n      * Returns the selected value in the template\r\n      * @returns {*}\r\n      */\n  getSelectedValue: function getSelectedValue() {\n    return this.selectedValue;\n  } });","/**\r\n*   Name: BizAgi Smartphone Render Cascading combo Extension\r\n*   Author: Forms team\r\n*   Comments:\r\n*   -   This script will redefine the cascading combo render class to adjust to tablet devices\r\n*/\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.cascadingCombo\", bizagi.rendering.combo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.cascadingCombo.extend(\"bizagi.rendering.smartphone.cascadingCombo\", bizagi.rendering.cascadingCombo.prototype);\n// Extends itself\nbizagi.rendering.smartphone.cascadingCombo.extend(\"bizagi.rendering.smartphone.cascadingCombo\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX },\n{\n\n  /*\r\n  *   Template method to implement in each children to customize each control\r\n  */\n  renderControl: function renderControl() {\n    var mode = this.getMode();\n\n    // Check if this is a dependant combo\n    this.parentCombo = this.getParentCombo();\n    if (this.parentCombo != null) {\n\n      if (/cascadingcombo/i.test(this.parentCombo.properties.type)) {\n        this.isDependant = true;\n      }\n    }\n\n    // Apply element plugin, set a flag to avoid dependant combo ajax requests\n    this.initializingCascadingCombo = true;\n\n    if (mode != \"execution\") {\n      this.initializingCascadingCombo = false;\n    }\n\n    return bizagi.rendering.smartphone.combo.prototype.renderControl.apply(this, arguments);\n  },\n\n  postRender: function postRender() {\n    bizagi.rendering.smartphone.combo.prototype.postRender.apply(this, arguments);\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\n  configureHandlers: function configureHandlers() {\n    // Call base\n    this._super();\n\n    // Call desktop.combo method\n    bizagi.rendering.smartphone.combo.prototype.configureHandlers.apply(this, arguments);\n  },\n\n  /**\r\n      * Override to avoid the trigguer\r\n      */\n  cleanData: function cleanData() {\n    bizagi.rendering.smartphone.combo.prototype.cleanData.apply(this, arguments);\n  },\n\n  /*\r\n     *   Refresh the combo, after it has been painted\r\n     */\n  refresh: function refresh(params, isInitialValue) {\n    var self = this;\n    // Wait until current element is rendered\n    $.when(self.isRendered()).done(function () {\n      // Clear current control\n      var control = self.getControl();\n      var mode = self.getMode();\n      control.empty();\n\n      // Render combo again\n      $.when(self.renderControl()).then(function (html) {\n        // Append new element\n        control.html(html);\n        // Post-render method\n        self.postRender();\n\n        if (mode == \"execution\") {\n          self.configureHandlers();\n        }\n\n        // Set current value\n        if (isInitialValue) {\n          self.setDisplayValue(self.getValue());\n        } else {\n          self.setDisplayValue({\n            \"id\": \"\",\n            \"value\": \"\" });\n\n        }\n\n        if (self.deferredVisible) {\n          self.deferredVisible.resolve();\n        }\n\n        self.trigger(\"select\", [self.getValue(), isInitialValue]);\n      });\n    });\n  },\n  /*\r\n     *   Sets the value in the rendered control\r\n     */\n  setDisplayValue: function setDisplayValue(value) {\n    bizagi.rendering.smartphone.combo.prototype.setDisplayValue.apply(this, arguments);\n  },\n\n  processComboData: function processComboData() {\n    bizagi.rendering.smartphone.combo.prototype.processComboData.apply(this, arguments);\n  },\n\n  validateValue: function validateValue() {\n    return bizagi.rendering.smartphone.combo.prototype.validateValue.apply(this, arguments);\n  },\n\n  renderComboTemplate: function renderComboTemplate() {\n    return bizagi.rendering.smartphone.combo.prototype.renderComboTemplate.apply(this, arguments);\n  },\n\n  configureModalViewHandlers: function configureModalViewHandlers() {\n    bizagi.rendering.smartphone.combo.prototype.configureModalViewHandlers.apply(this, arguments);\n  },\n\n  configureCombo: function configureCombo() {\n    bizagi.rendering.smartphone.combo.prototype.configureCombo.apply(this, arguments);\n  },\n\n  changeCombo: function changeCombo(valueItem, valueObjet) {\n    bizagi.rendering.smartphone.combo.prototype.changeCombo.apply(this, arguments);\n  },\n\n  /*\r\n     *   Returns the selected value in the template\r\n     */\n  getSelectedValue: function getSelectedValue() {\n    return bizagi.rendering.smartphone.combo.prototype.getSelectedValue.call(this, arguments);\n  },\n\n  getTemplateName: function getTemplateName() {\n    return \"combo\";\n  },\n  /**\r\n      * Filtering list of elements\r\n      * @returns {}\r\n      */\n  filterList: function filterList(search, $li) {\n    return bizagi.rendering.smartphone.combo.prototype.filterList.call(this, search, $li);\n  } });","/**\r\n *   Name: Bizagi Smartphone Collection Navigator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the collection Navigator class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.collectionnavigator\", bizagi.rendering.collectionnavigator.prototype);\n// Extends itself\nbizagi.rendering.smartphone.collectionnavigator.extend(\"bizagi.rendering.smartphone.collectionnavigator\", {}, {\n\n  /**\r\n                                                                                                                 * Method to customize each render after processed\r\n                                                                                                                 */\n  postRender: function postRender() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  } });","/**\r\n *   Name: Bizagi Smartphones Render Hidden Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.hidden\", bizagi.rendering.hidden.prototype);\n// Extends itself\nbizagi.rendering.smartphone.hidden.extend(\"bizagi.rendering.smartphone.hidden\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Upload Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the upload render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.upload\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.upload.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.upload.extend(\"bizagi.rendering.smartphone.upload\", {\n  QUALITY_PICTURE: 50,\n  LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\n  EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\n  EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\n  EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\n  EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"] },\n{\n  /**\r\n   * Whether or not is a native device\r\n   * @var isNative boolean\r\n   */\n  isNative: false,\n\n  /**\r\n                    * Whether or not we are offline\r\n                    * @var isOfflineForm boolean\r\n                    */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.isNative = bizagi.util.isCordovaSupported();\n  },\n\n  /**\r\n      * Template method to implement in each children to customize each control\r\n      * @returns {}\r\n      */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"upload\");\n\n    return this.renderItem(template, {});\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"upload-readonly\");\n    var data = {\n      noFiles: this.filesCount === 0 };\n\n\n    return this.renderItem(template, data);\n  },\n\n  /**\r\n      * Method to render items\r\n      * @returns {*|jQuery}\r\n      */\n  renderItem: function renderItem(template, data) {\n    var self = this;\n    var items = \"\";\n\n    // Render template\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    for (var i = 0; i < self.filesCount; i++) {\n      var file = { id: self.files[i][0], fileName: self.files[i][1] };\n      var item = self.renderUploadItem(file);\n      items += item;\n    }\n\n    html = self.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this.$contentFile = $(\".bz-file-upload__container\", $control);\n    this.$inputFile = $(\".bz-file-upload__input\", $control);\n    this.$nativeFile = $(\".bz-file-upload__native\", $control);\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    this.checkFileExtensions();\n    this.attachEvents();\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handler to download a file\n    $(\"ul.bz-readonly-lists\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  /**\r\n      * Method to configure the actions with control\r\n      * @return {}\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n    var counterChoseFiles = 0;\n    // Attach all events\n    this.$contentFile.off(\"click\").on(\"click\", function (evt) {\n      if (!self.isNative || counterChoseFiles > 0) {\n        self.chooseFile();\n      } else {\n        bizagi.showMessageBox(bizagi.localization.getResource(\"render-upload-error-files-extension-supported-app\", \"You can only add images or videos.\"), 'Userfield error');\n      }\n\n    });\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n\n    // Attach delete option & Removes a file from the upload control\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-icn\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      self.removeFile(item, file.id);\n    });\n\n    if (self.isNative) {\n      // Upload files\n      var actions = self.getUploadChoices();\n      counterChoseFiles = actions.length;\n      this.$nativeFile.off(\"click\").actionSheet({\n        actions: actions,\n        actionClicked: function actionClicked(action) {\n          self.handlerUploadFile(action.guid);\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n\n      // Resolution upload\n      $(\".bz-file-upload__resolution\", $control).off(\"click\").actionSheet({\n        actions: bizagi.util.media.getImageResolutionSizes(),\n        withoutCancel: true,\n        actionClicked: function actionClicked(action) {\n          bizagi.loading.start();\n\n          $.when(self.handlerResolutionUpload(action.guid)).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n    } else {\n\n      // Attach event to web upload-control\n      this.$inputFile.off(\"change\").on(\"change\", function () {\n        self.addFile();\n        this.value = \"\";\n      });\n\n      // Just in case\n      this.$inputFile.off(\"click\").on(\"click\", function (evt) {\n        evt.stopPropagation();\n      });\n    }\n  },\n\n  /**\r\n      * Handler of upload files\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerUploadFile: function handlerUploadFile(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    switch (actionSelected) {\n      case 2:\n\n        navigator.camera.getPicture(function (dataImage) {\n          self.dataImage = dataImage;\n          var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\n\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).\n          then(function () {\n            //Gets the real properties for the file\n            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage)).\n            then(function (fileData) {\n              self.fileProperties = fileData;\n\n              if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\n                // \"new Blob\" constructor is not supported in android version 4.2.2\n                var version = bizagi.util.getAndroidVersion();\n\n                if (version && version <= 4.2 || self.isOfflineForm) {\n                  return self.saveImage(self.dataImage);\n                } else {\n\n                  if (!bizagi.util.isAndroid()) {\n                    return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\n                      if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\n                        return self.handlerResolutionUpload(buttonIndex);\n                      }\n                    });\n\n                  } else {\n                    // Force click to show actionSheet menu\n                    $(\".bz-file-upload__resolution\", self.getControl()).click();\n                  }\n                }\n              }\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          correctOrientation: true,\n          sourceType: Camera.PictureSourceType.PHOTOLIBRARY });\n\n        break;\n      case 1:\n        navigator.camera.getPicture(function (dataImage) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\n            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\n              self.fileProperties = fileData;\n              return self.saveImage(dataImage);\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: navigator.camera.PictureSourceType.CAMERA,\n          mediaType: navigator.camera.MediaType.PICTURE,\n          destinationType: Camera.DestinationType.FILE_URI,\n          correctOrientation: true,\n          targetWidth: 1280,\n          targetHeight: 960 });\n\n        break;\n      case 3:\n        navigator.device.capture.captureVideo(function (dataVideo) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties)).\n          then(function () {\n            return self.saveVideo(dataVideo);\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), { limit: self.Class.LIMIT });\n        break;}\n\n  },\n\n  /**\r\n      * Handler of resolution upload\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerResolutionUpload: function handlerResolutionUpload(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    // If original, save image normally, if not, reduce quality and size\n    if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\n      return self.saveImage(self.dataImage);\n    } else {\n      var resolution = bizagi.util.media.getImageResolution(actionSelected);\n\n      return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\n        self.editedImageURL = result.localUrl;\n        self.properties.url = result.base64Image;\n\n        return self.saveImage(self.dataImage);\n      });\n    }\n  },\n\n  /**\r\n      * Send image using HTTP\r\n      * @param {} dataImage\r\n      */\n  saveImage: function saveImage(dataImage) {\n    var self = this;\n    var dataItem = \"\";\n\n    if (self.editedImageURL) {\n      dataItem = self.editedImageURL;\n    } else if (self.fileProperties) {\n      dataItem = self.fileProperties.url;\n    }\n\n    // Fix android 4.4 getting images from recent folder\n    var dataFile = bizagi.util.media.getImagePath(dataItem);\n    var data = {\n      dataFile: dataFile,\n      fileName: self.fileProperties.name,\n      mimeType: \"image/jpeg\" };\n\n\n    // Cleans variables related previous uploads\n    self.editedImageURL = null;\n    self.fileProperties = null;\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a video file\r\n      * @param {} dataVideo\r\n      * @returns {}\r\n      */\n  saveVideo: function saveVideo(dataVideo) {\n    var data = {\n      dataFile: dataVideo[0].fullPath,\n      fileName: dataVideo[0].name,\n      mimeType: \"video/quicktime\" };\n\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a file\r\n      * @param data\r\n      * @returns {*|void}\r\n      */\n  uploadFile: function uploadFile(data) {\n    var self = this;\n    var params = {};\n    var addParams = self.buildAddParams();\n    addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\n\n    params.data = addParams;\n    params.options = new FileUploadOptions();\n    params.options.fileKey = \"file\";\n    params.options.fileName = data.fileName;\n    params.options.uploadKey = { key: addParams[\"h_xpath\"] };\n    params.options.addUrl = self.properties.addUrl;\n    params.dataFile = data.dataFile;\n\n    if (data.mimeType)\n    params.options.mimeType = data.mimeType;\n\n    return $.when(bizagi.util.media.uploadFile(params)).then(function (result) {\n      var response = JSON.parse(decodeURIComponent(result.response));\n\n      if (response.type === \"error\") {\n        bizagi.showMessageBox(response.message, response.errorType);\n      } else {\n        self.onUploadFileCompleted(response);\n      }\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    });\n  },\n\n  /**\r\n      * onFail\r\n      * @param {} error\r\n      */\n  onFail: function onFail(error) {\n    var messageError = bizagi.util.processFailMessage(error);\n\n    bizagi.loading.stop();\n\n    if (messageError && typeof messageError === \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\n      var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\n      var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\n\n      bizagi.showMessageBox(message);\n    }\n  },\n\n  /**\r\n      * onUploadFileCompleted\r\n      * @param {} result\r\n      */\n  onUploadFileCompleted: function onUploadFileCompleted(result) {\n    var self = this;\n    var $wrapper = $(\".bz-files\", self.getControl());\n\n    if (result.id && result.fileName) {\n      // Locate it before the upload wrapper\n      var newItem = self.renderUploadItem(result);\n      $wrapper.append(newItem);\n\n      // Increment counter\n      self.filesCount = self.filesCount + 1;\n\n      // Copy the files value but not its reference\n      var files = self.files.slice();\n\n      //Add the new item to this temporal array\n      files.push([result.id, result.fileName]);\n\n      // Update value\n      self.setValue(files, true);\n\n      // Check maxFiles\n      self.checkMaxFiles();\n\n      self.editedImageURL = null;\n    } else {\n      bizagi.showMessageBox(result.message, \"Error\");\n    }\n  },\n\n  /**\r\n      * Check maximum number of files\r\n      */\n  checkMaxFiles: function checkMaxFiles() {\n    if (this.isMaxFilesReached()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    } else {\n      $(this.$contentFile).removeClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Check if the maximum number of files than can be uploaded has been reached\r\n      * @returns {}\r\n      */\n  isMaxFilesReached: function isMaxFilesReached() {\n    var maxFiles = this.properties.maxfiles;\n    var actualFiles = this.properties.value ? this.properties.value.length : 0;\n\n    return maxFiles !== 0 && this.filesCount >= maxFiles && actualFiles >= maxFiles;\n  },\n\n  /**\r\n      * Check allow extensions and define possible choices\r\n      * @returns {}\r\n      */\n  checkFileExtensions: function checkFileExtensions() {\n    var self = this;\n    var validExtensions = self.properties.validExtensions || \"\";\n\n    self.validOptions = { video: false, image: false, file: false };\n\n    // Preprocess the extensions string\n    validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\n\n    if (typeof validExtensions === \"undefined\" || validExtensions === \"\") {\n      self.validOptions = { video: true, image: true, file: true };\n    } else {\n      validExtensions = validExtensions.split(\";\");\n\n      if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\n        self.validOptions.video = true;\n        self.validOptions.image = true;\n      } else {\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\n          validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\n\n          if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.file = true;\n          } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.image = true;\n          } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.video = true;\n          }\n        }\n      }\n    }\n\n    // Media is not supported then upload control is disabled\n    if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\n      $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n\n    // Limit of files is reached then upload control is disabled\n    if (self.isMaxFilesReached() || !self.isNative && (!bizagi.util.media.fileAPISupported() || self.isOfflineForm)) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Build add params to send to the server\r\n      * @param {} dataFile\r\n      */\n  buildAddFileParams: function buildAddFileParams(dataFile) {\n    var self = this;\n    var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\n\n    // Get form data for POSTing\n    var formData = new FormData();\n    var form = self.getFormContainer();\n\n    // Build add params to send to the server\n    formData.append(prefix + \"xpath\", self.getUploadXpath());\n    formData.append(prefix + \"idRender\", self.properties.id);\n    formData.append(prefix + \"xpathContext\", self.properties.xpathContext);\n    formData.append(prefix + self.Class.BA_PAGE_CACHE, self.properties.idPageCache);\n    formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\n    formData.append(self.properties.xpath, dataFile);\n\n    if (self.properties.contexttype)\n    formData.append(prefix + \"contexttype\", self.properties.contexttype);\n\n    try {\n      if (typeof BIZAGI_SESSION_NAME !== \"undefined\") {\n        formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\n      } else {\n        formData.append(\"JSESSIONID\", form.properties.sessionId);\n      }\n    } catch (e) {\n      formData.append(\"JSESSIONID\", form.properties.sessionId);\n    }\n\n    return formData;\n  },\n\n  /**\r\n      * Process an upload file into the server\r\n      * @param {} dataFile\r\n      * @returns {}\r\n      */\n  processUploadFile: function processUploadFile(dataFile) {\n    var data = {\n      url: this.properties.addUrl,\n      formData: this.buildAddFileParams(dataFile) };\n\n\n    return this.dataService.processUploadFile(data);\n  },\n\n  /*\r\n     * Cleans current value\r\n     */\n  cleanData: function cleanData() {\n    return this.clearDisplayValue();\n  },\n  /**\r\n      * Remove data of file upload\r\n      */\n  clearDisplayValue: function clearDisplayValue() {\n    var self = this;\n    var items = $(\".bz-files\", self.getControl());\n    var promises = [];\n\n    $(\".bz-file\", items).each(function (index, item) {\n      item = $(item);\n      var file = item.data();\n\n      promises.push($.when(self.removeFile(item, file.id)));\n    });\n\n    return $.when.apply($, promises).then(function () {\n      return self.getValue();\n    });\n  },\n\n  /**\r\n      * Add upload options\r\n      */\n  getUploadChoices: function getUploadChoices() {\n    var self = this;\n    var itemsUpload = [];\n\n    // Take photo, Choose photo\n    if (self.validOptions.image) {\n      itemsUpload.push({\n        \"guid\": 1,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") });\n\n      itemsUpload.push({\n        \"guid\": 2,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") });\n\n    }\n\n    // Take video\n    if (self.validOptions.video) {\n      itemsUpload.push({\n        \"guid\": 3,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\") });\n\n    }\n\n    // Stores the upload options        \n    return [].concat(itemsUpload);\n  },\n\n  /**\r\n      * Call the form failhandler with an specific error\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  executeFormFailHandler: function executeFormFailHandler(error) {\n    var errorResponse = \"\";\n\n    if (error && error.responseText) {\n      errorResponse = error.responseText;\n    } else {\n      errorResponse = bizagi.localization.getResource(\"workportal-general-error\");\n    }\n\n    this.getFormContainer().failHandler(errorResponse);\n  },\n\n  /**\r\n      * Method to add new file from native or hybrid environment\r\n      */\n  chooseFile: function chooseFile() {\n    if (this.isNative) {\n      this.$nativeFile.click();\n    } else if (bizagi.util.media.fileAPISupported() && !this.isOfflineForm) {\n      this.$inputFile.click();\n    }\n  },\n\n  /**\r\n      * Method to add new file\r\n      */\n  addFile: function addFile() {\n    var self = this;\n    var dataFile = this.$inputFile[0].files[0];\n    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\n\n    dataFile.fullPath = this.$inputFile[0].value;\n    bizagi.loading.start();\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\n\n      $.when(self.processUploadFile(dataFile)).\n      then(function (result) {\n        self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result)));\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    } else {\n      bizagi.loading.stop();\n    }\n  },\n\n  /**\r\n      * Method to remove item\r\n      * @param item\r\n      * @param id\r\n      */\n  removeFile: function removeFile(item, id) {\n    var self = this;\n\n    return $.when(self.deleteUploadItem(item, id)).done(function () {\n      // Remove item\n      item.hide();\n      item.remove();\n\n      // Update value\n      self.setValue(self.files, false);\n\n      // Check maxFiles\n      self.checkMaxFiles();\n\n      // Trigger change\n      self.triggerRenderChange();\n    });\n  },\n\n  /**\r\n      * Template for upload items\r\n      */\n  getTemplateItemName: function getTemplateItemName() {\n    return \"upload-item\";\n  },\n\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $(\".bz-input-icon__input\", context);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render upload Extension\r\n *   Author: Mobile SWAT Team\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.upload.extend(\"bizagi.rendering.smartphone.upload.offline\", {\n  QUALITY_PICTURE: 50,\n  LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\n  EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\n  EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\n  EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\n  EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"] },\n{\n\n  /**\r\n   * Update or init the element data\r\n   * @param {} data\r\n   */\n  initializeData: function initializeData(data) {\n    // Call base\n    var self = this;\n    this._super(data);\n\n    var maxFileSizeOfProperty = Number(this.properties.maxSize) || 1048576;\n    var maxFileSizeOfUser = typeof BIZAGI_SETTINGS !== \"undefined\" && typeof BIZAGI_SETTINGS.UploadMaxFileSize !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\n\n    this.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\n\n    this.updateFilesCount();\n  },\n  /**\r\n      * Method to render items\r\n      * @returns {*|jQuery}\r\n      */\n  renderItem: function renderItem(template, data) {\n    var self = this;\n    var items = \"\";\n\n    // Render template\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    for (var i = 0; i < self.files.length; i++) {\n      var file = self.files[i];\n      if (file.status && file.status !== \"deleted\" && file.status !== \"new-deleted\") {\n        var item = self.renderUploadItem(file, i);\n        items += item;\n      }\n    }\n\n    html = self.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.openOfflineFile(item);\n    });\n  },\n\n  /**\r\n      * Method to configure the actions with control\r\n      * @return {}\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Attach all events\n    this.$contentFile.off(\"click\").on(\"click\", function (evt) {\n      if (self.isNative)\n      self.$nativeFile.click();else\n\n      self.$inputFile.click();\n      self.$inputFile.off(\"change\").on(\"change\", function () {\n        self.handlerWebUploadFile();\n      });\n    });\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.openOfflineFile(item);\n    });\n\n    // Attach delete option & Removes a file from the upload control\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-icn\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.removeOfflineFile(item);\n    });\n\n    if (self.isNative) {\n      // Upload files\n      this.$nativeFile.off(\"click\").actionSheet({\n        actions: self.getUploadChoices(),\n        actionClicked: function actionClicked(action) {\n          // this.getBoundingClientRect()\n          self.handlerUploadFile(action.guid);\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n    }\n  },\n\n  //Only should be used for testing purposes\n  handlerWebUploadFile: function handlerWebUploadFile() {\n    var self = this;\n    var dataFile = self.$inputFile[0].files[0];\n\n    var fileId = bizagi.util.randomNumber();\n    var fileName, mimeType;\n\n    $.when(self.getBlobFromPath(dataFile)).\n    then(function (blob) {\n      bizagi.loading.start();\n      mimeType = blob.type;\n      fileName = blob.name;\n      return self.saveOfflineFile(blob, fileId, mimeType);\n    }).then(function (saveResponse) {\n      self.onUploadOfflineFileCompleted(fileName, mimeType, fileId);\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n    self.$inputFile[0].value = \"\";\n  },\n\n  /**\r\n      * Handler of upload image\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerUploadFile: function handlerUploadFile(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n    switch (actionSelected) {\n      case 2:\n        navigator.camera.getPicture(function (dataImage) {\n          self.dataImage = dataImage;\n          var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\n\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).\n          then(function () {\n            //Gets the real properties for the file\n            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage)).\n            then(function (fileData) {\n              self.fileProperties = fileData;\n              if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\n                return self.saveImage(self.dataImage);\n              }\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\n          correctOrientation: true });\n\n        break;\n      case 1:\n        navigator.camera.getPicture(function (dataImage) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\n            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\n              self.fileProperties = fileData;\n              return self.saveImage(dataImage);\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: navigator.camera.PictureSourceType.CAMERA,\n          mediaType: navigator.camera.MediaType.PICTURE,\n          destinationType: Camera.DestinationType.FILE_URI,\n          correctOrientation: true,\n          targetWidth: 1280,\n          targetHeight: 960 });\n\n        break;\n      default:\n        console.log(\"The option is not supported!\");\n        break;}\n\n  },\n\n  /**\r\n      * Add the interactions to the upload control items\r\n      * @return {}\r\n      */\n  addInteractions: function addInteractions() {\n    var self = this;\n    var control = self.getControl();\n\n    // Attach delete option & Removes a file from the upload control\n    $(\"ul.bz-files\", control).on(\"click\", \".bz-file .bz-file__delete\", function () {\n      var item = $(this).parent(\".bz-file\");\n      self.removeOfflineFile(item);\n    });\n  },\n\n  /**\r\n      * Collect Data\r\n      * @param {} renderValues\r\n      * @returns {}\r\n      */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    if (self.properties.originalValue === self.files) {\n      return;\n    }\n    if (self.filesCount > 0) {\n      renderValues[self.properties.xpath] = self.files;\n    } else if (self.properties.method === \"delete\") {\n      renderValues[self.properties.xpath] = [];\n\n      delete self.properties.method;\n    }\n  },\n\n  /**\r\n      * Send image using HTTP\r\n      * @param {} dataImage\r\n      */\n  saveImage: function saveImage(dataImage) {\n    var self = this;\n    bizagi.loading.start();\n\n    var fileId = bizagi.util.randomNumber();\n    var fileName = self.fileProperties.name;\n    var mimeType;\n\n    //TODO: SWAT Check if the file already exists\n    $.when(self.getBlobFromPath(dataImage)).\n    always(function () {\n      bizagi.loading.stop();\n    }).\n    then(function (blob) {\n      mimeType = blob.type;\n      fileName = blob.name;\n      return self.saveOfflineFile(blob, fileId, mimeType);\n    }).then(function (saveResponse) {\n      self.onUploadOfflineFileCompleted(fileName, mimeType, fileId);\n    });\n    self.$inputFile[0].value = \"\";\n  },\n\n  /**\r\n      * Check allow extensions and define possible choices\r\n      * Only support to image in offline capability\r\n      * @returns {}\r\n      */\n  checkFileExtensions: function checkFileExtensions() {\n    var self = this;\n    var validExtensions = self.properties.validExtensions || \"\";\n\n    self.validOptions = { video: false, image: false, file: false };\n\n    // Preprocess the extensions string\n    validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\n\n    if (typeof validExtensions === \"undefined\" || validExtensions === \"\") {\n      self.validOptions.image = true;\n    } else {\n      validExtensions = validExtensions.split(\";\");\n\n      if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\n        self.validOptions.image = true;\n      } else {\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\n          validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\n\n          if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.image = true;\n          }\n        }\n      }\n    }\n\n    // Media is not supported then upload control is disabled\n    if (!self.validOptions.image) {\n      $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n\n    // Limit of files is reached then upload control is disabled\n    if (self.isMaxFilesReached() || !bizagi.util.media.fileAPISupported()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * onUploadOfflineFileCompleted\r\n      * @param {} result\r\n      */\n  onUploadOfflineFileCompleted: function onUploadOfflineFileCompleted(fileName, mimeType, fileId) {\n    var self = this;\n    var $wrapper = $(\".bz-files\", self.getControl());\n\n    var fileUploaded = {\n      id: fileId,\n      fileName: fileName,\n      mimeType: mimeType,\n      status: \"new\" };\n\n\n    // Locate it before the upload wrapper\n    var newItem = self.renderUploadItem(fileUploaded, self.files.length);\n    $wrapper.append(newItem);\n\n    // Increment counter\n    self.filesCount = self.filesCount + 1;\n\n    // Copy the files value but not its reference\n    var files = self.files.slice();\n\n    //Add the new item to this temporal array\n    files.push(fileUploaded);\n\n    // Update value\n    self.setValue(files, false);\n\n    // Check maxFiles\n    self.checkMaxFiles();\n  },\n\n  /**\r\n      * Renders a single upload item\r\n      * @param file\r\n      * @returns {*|jQuery}\r\n      */\n  renderUploadItem: function renderUploadItem(file, index) {\n    var self = this;\n    var itemTemplate = self.getTemplateItemName();\n    var template = self.renderFactory.getTemplate(itemTemplate);\n\n    var html = $.fasttmpl(template, {\n      url: \"javascript:void(0);\",\n      id: file.id,\n      allowDelete: self.properties.allowDelete || false,\n      filename: file.fileName,\n      index: index });\n\n\n    return html;\n  },\n\n  /**\r\n      * This render cannot be sent because it is full ajax\r\n      * @returns {}\r\n      */\n  canBeSent: function canBeSent() {\n    return true;\n  },\n\n  /**\r\n      * Fail action\r\n      * @param {} evt\r\n      * @returns {}\r\n      */\n  failReadFile: function failReadFile(evt) {\n    try {\n      bizagi.log(\"Error code: \" + evt.target.error.code);\n    } catch (e) {\n    }\n  },\n\n  /**\r\n      * Fail action\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  onFail: function onFail(error) {\n    this._super(error);\n  },\n\n  /**\r\n      * Method to remove item\r\n      * @param item\r\n      * @param id\r\n      */\n  removeOfflineFile: function removeOfflineFile(item) {\n    var self = this;\n    var file = item.data();\n    var fileIndex = file.index;\n\n\n\n    // Mark the file as deleted\n    var fileValue = self.files[fileIndex];\n    if (!fileValue) {\n      //Nothing to do\n      return;\n    }\n    if (fileValue.status !== \"new\") {\n      fileValue.status = \"deleted\";\n    } else\n    {\n      fileValue.status = \"new-deleted\";\n    }\n\n\n    // Remove item\n    item.hide();\n    item.remove();\n\n    // Update value\n    self.setValue(self.files, false);\n\n    // Check maxFiles\n    self.checkMaxFiles();\n\n    // Trigger change\n    self.triggerRenderChange();\n  },\n  /**\r\n      * Update the filesCount attribute based on the status (new|deleted) of each file\r\n      */\n  updateFilesCount: function updateFilesCount() {\n    var self = this;\n    var files = this.properties.value;\n    for (var i = 0; i < files.length; i++) {\n      var status = files[i].status;\n      if (status && status.includes(\"deleted\")) {\n        self.filesCount = self.filesCount - 1;\n      }\n    }\n  },\n  /**\r\n      * Sets the internal value\r\n      * @param value\r\n      * @param triggerEvents\r\n      */\n  setValue: function setValue(value, triggerEvents) {\n    var self = this;\n    self._super(value, triggerEvents);\n    self.updateFilesCount();\n    if (self.filesCount === 0) {\n      self.properties.method = \"delete\";\n    }\n  },\n  /**\r\n      * Check if the maximum number of files than can be uploaded has been reached\r\n      * @returns {}\r\n      */\n  isMaxFilesReached: function isMaxFilesReached() {\n    var maxFiles = this.properties.maxfiles;\n    return maxFiles !== 0 && this.filesCount >= maxFiles;\n  },\n\n  openOfflineFile: function openOfflineFile(item) {\n    var self = this;\n    var file = item.data();\n    var dataIndex = file.index;\n    var selectedValue = typeof dataIndex == \"number\" ? self.properties.value[dataIndex] : null;\n    if (selectedValue) {\n      var formParams = self.getFormParams();\n      var getFileParams = {\n        idCase: formParams.idCase,\n        idWorkitem: formParams.idWorkitem,\n        id: (self.properties.xpathContext ? self.properties.xpathContext + \".\" : \"\") +\n        self.properties.xpath + '.' + selectedValue.id,\n        offlineType: formParams.offlineType };\n\n      bizagi.loading.start();\n      $.when(self.dataService.getOfflineFile(getFileParams, \"blob\", selectedValue.mimeType)).\n      done(function (binaryFile) {\n        if (binaryFile != undefined) {\n          var fileName = file.title;\n          bizagi.util.media.handleBinaryFile(binaryFile, fileName);\n        }\n      }).\n      fail(function (error) {\n        console.log(\"Error opening offline file\", error);\n      }).\n      always(function () {\n        bizagi.loading.stop();\n      });\n    }\n  },\n\n  getBlobFromPath: function getBlobFromPath(path) {\n    var blobPromise = new $.Deferred();\n    var self = this;\n\n    if (self.isNative) {\n      var fileName = self.fileProperties.name;\n      if (!bizagi.util.isAndroidDevice()) {\n        path = bizagi.util.media.normalizeIOSFilePath(path);\n      } else\n      {\n        // Fix android 4.4 getting images from recent folder\n        path = bizagi.util.media.getImagePath(path);\n      }\n\n      var errorHandler = function errorHandler(error) {\n        console.log('Error converting path to blob', error);\n        blobPromise.reject(error);\n      };\n\n      window.resolveLocalFileSystemURL(path, function (fileEntry) {\n        fileEntry.file(function (file) {\n          var reader = new FileReader();\n          reader.onloadend = function () {\n            var blob = new Blob([this.result], { type: file.type });\n            blob.name = fileName;\n            blobPromise.resolve(blob);\n          };\n          reader.readAsArrayBuffer(file);\n        }, errorHandler);\n      }, errorHandler);\n    } else\n    {\n      //In browser is the File\n      blobPromise.resolve(path);\n    }\n    return blobPromise;\n  },\n\n  saveOfflineFile: function saveOfflineFile(blobFile, fileId, mimeType) {\n    var self = this;\n    var formParams = self.getFormParams();\n    var parameters = {\n      idCase: formParams.idCase,\n      idWorkitem: formParams.idWorkitem,\n      id: (self.properties.xpathContext ? self.properties.xpathContext + \".\" : \"\") +\n      self.properties.xpath + '.' + fileId,\n      operationType: \"edition\",\n      offlineType: formParams.offlineType };\n\n    return self.dataService.saveOfflineFile(parameters, blobFile, mimeType);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render ECM Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the ecm render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.ecm\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.ecm.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.ecm.extend(\"bizagi.rendering.smartphone.ecm\", {\n  QUALITY_PICTURE: 50,\n  LIMIT: 1, // The maximum number of media in the device user can record in a single capture operation.\n  EXTENSIONSIMG: [\"image/jpeg\", \"jpeg\", \"image\", \"png\", \"jpg\", \"bmp\"],\n  EXTENSIONSFILE: [\"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"zip\", \"rar\", \"txt\"],\n  EXTENSIONSVIDEO: [\"video/quicktime\", \"quicktime\", \"qt\", \"mov\"],\n  EXTENSIONSAUDIO: [\"audio/wav\", \"audio\", \"wav\", \"mp3\"],\n  ERROR_ECM_NO_AVAILABLE: 3,\n  ACTION_DETAILS: \"details\",\n  ACTION_EDIT: \"edit\" },\n{\n\n  /**\r\n   * Whether or not is a native device\r\n   * @var isNative boolean\r\n   */\n  isNative: false,\n\n  /**\r\n                    * Update or init the element data\r\n                    * @param {} data\r\n                    */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    this.isNative = bizagi.util.isCordovaSupported();\n    this.fileData = [];\n  },\n\n  /**\r\n      * Method to customize each control\r\n      * @returns {}\r\n      */\n  renderControl: function renderControl() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(\"ecm\");\n\n    // Set files property\n    self.files = self.properties.value || [];\n    self.filesCount = self.files.length;\n\n    return this.renderItem(template, {});\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"ecm-readonly\");\n    var data = {\n      noFiles: this.filesCount === 0 };\n\n\n    return this.renderItem(template, data);\n  },\n\n  /**\r\n      * Method to render items\r\n      * @returns {*|jQuery}\r\n      */\n  renderItem: function renderItem(template, data) {\n    var self = this;\n    var items = \"\";\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    for (var i = 0; i < self.filesCount; i++) {\n      var item = self.renderUploadItem(self.files[i]);\n\n      items += item;\n    }\n\n    html = self.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Renders a single upload item\r\n      * @param file\r\n      * @returns {*}\r\n      */\n  renderUploadItem: function renderUploadItem(file) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"ecm-item\");\n    var form = self.getFormContainer();\n\n    var data = {\n      id: self.properties.id,\n      idFileUpload: file[0],\n      fileName: file[1],\n      editable: self.properties.editable,\n      xPath: self.properties.xpath,\n      xpathContext: self.getXpathContext() || form.properties.xpathContext || \"\",\n      idPageCache: self.properties.idPageCache,\n      idAttrib: self.properties.idAttrib,\n      sessionId: form.properties.sessionId };\n\n\n    // Builds the upload item url\n    var originalData = $.extend({}, data);\n    data.url = self.buildItemUrl(originalData);\n\n    // Define File Properties\n    file.getFileProperties = $.when(self.renderFileLayout(data));\n\n    var html = $.fasttmpl(template, data);\n\n    return html;\n  },\n\n  /**\r\n      * Method to get properties and metadata of ECM item\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  renderFileLayout: function renderFileLayout(data) {\n    var self = this;\n    var form = self.getFormContainer();\n    var deferred = new $.Deferred();\n\n    var originalData = $.extend({}, data);\n\n    $.when(\n    self.dataService.metadataECMMultiaction().getECMMetadata(data),\n    self.dataService.metadataECMMultiaction().getFileProperties(originalData)).\n    done(function (metaData, fileProperties) {\n\n      if (Array.isArray(fileProperties)) {\n        fileProperties = fileProperties[0];\n      }\n\n      if (Array.isArray(metaData)) {\n        metaData = metaData[0];\n      }\n\n      fileProperties.idAttrib = self.properties.idAttrib;\n      fileProperties.showMetadata = self.properties.showMetadata;\n      fileProperties.xpathContext = self.getXpathContext() || form.properties.xpathContext || \"\";\n      fileProperties.xpath = self.properties.xpath;\n      fileProperties.fileName = data.fileName;\n      fileProperties.idPageCache = self.properties.idPageCache;\n      fileProperties.fileData = originalData;\n\n      var result = $.extend({}, fileProperties, metaData);\n\n      deferred.resolve(result);\n\n    });\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Replaces a {{files}} tag in the container for the specified \"replace\" element\r\n      * @param html\r\n      * @param replace\r\n      * @returns {*}\r\n      */\n  replaceFilesHtml: function replaceFilesHtml(html, replace) {\n    return html.replace(\"{{files}}\", replace);\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this.$contentFile = $(\".bz-file-upload__container\", $control);\n    this.$inputFile = $(\".bz-file-upload__input\", $control);\n    this.$nativeFile = $(\".bz-file-upload__native\", $control);\n  },\n\n  configureHandlers: function configureHandlers() {\n    this.checkFileExtensions();\n    this.attachEvents();\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handler to download the file\n    $(\"ul.bz-readonly-lists\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  /**\r\n      * Send image using HTTP\r\n      */\n  saveImage: function saveImage() {\n    var self = this;\n    var dataItem = \"\";\n\n    if (self.editedImageURL) {\n      dataItem = self.editedImageURL;\n    } else if (self.fileProperties) {\n      dataItem = self.fileProperties.url;\n    }\n\n    // Fix android 4.4 getting images from recent folder\n    var dataFile = bizagi.util.media.getImagePath(dataItem);\n    var data = {\n      dataFile: dataFile,\n      fileName: self.fileProperties.name,\n      mimeType: \"image/jpeg\" };\n\n\n    // Cleans variables related previous uploads\n    self.editedImageURL = null;\n    self.fileProperties = null;\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a video file\r\n      * @param {} dataVideo\r\n      * @returns {}\r\n      */\n  saveVideo: function saveVideo(dataVideo) {\n    var data = {\n      dataFile: dataVideo[0].fullPath,\n      fileName: dataVideo[0].name,\n      mimeType: \"video/quicktime\" };\n\n\n    return this.uploadFile(data);\n  },\n\n  /**\r\n      * Method to save a file\r\n      * @param data\r\n      * @returns {*|void}\r\n      */\n  uploadFile: function uploadFile(data) {\n    var self = this;\n    var params = {};\n    var addParams = self.buildAddParams();\n\n    addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\n    addParams[\"xPath\"] = addParams[\"xPath\"];\n    addParams.Filename = data.fileName;\n\n    params.data = addParams;\n    params.options = new FileUploadOptions();\n    params.options.fileKey = \"file\";\n    params.options.fileName = data.fileName;\n    params.options.uploadKey = { key: \"Filedata\" };\n    params.options.addUrl = self.properties.addUrl;\n    params.dataFile = data.dataFile;\n\n    if (data.mimeType)\n    params.options.mimeType = data.mimeType;\n\n    return $.when(bizagi.util.media.uploadFile(params)).then(function (result) {\n      self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result.response)));\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    });\n  },\n\n  /**\r\n      * Method to configure the actions with control\r\n      * @return {}\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n\n    // Handlers to management of menu actions\n    $.each(self.files, function (i, file) {\n      self.attackMenuEvents(file);\n    });\n\n    // Attach all events\n    this.$contentFile.off(\"click\").on(\"click\", function (evt) {\n      self.chooseFile();\n    });\n\n    // Handler to download the file\n    $(\"ul.bz-files\", $control).on(\"click\", \".bz-file .bz-file-name\", function () {\n      var item = $(this).parent(\".bz-file\");\n      var file = item.data();\n\n      bizagi.loading.start();\n\n      $.when(bizagi.util.media.downloadFile(file.url, file.title)).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n\n\n    if (self.isNative) {\n      // Upload files\n      this.$nativeFile.off(\"click\").actionSheet({\n        actions: self.getUploadChoices(),\n        actionClicked: function actionClicked(action) {\n          self.handlerUploadFile(action.guid);\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n\n      // Resolution upload\n      $(\".bz-file-upload__resolution\", $control).off(\"click\").actionSheet({\n        actions: bizagi.util.media.getImageResolutionSizes(),\n        withoutCancel: true,\n        actionClicked: function actionClicked(action) {\n          bizagi.loading.start();\n\n          $.when(self.handlerResolutionUpload(action.guid)).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        appear: function appear(action) {\n          self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n          self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n        },\n        cancelClicked: function cancelClicked(action) {\n          self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n        } });\n\n    } else {\n\n      // Attach event to web upload-control\n      this.$inputFile.off(\"change\").on(\"change\", function () {\n        self.addFile();\n        this.value = \"\";\n      });\n\n      // Just in case\n      this.$inputFile.off(\"click\").on(\"click\", function (evt) {\n        evt.stopPropagation();\n      });\n    }\n  },\n\n  /**\r\n      * Update menu options\r\n      * @param $fileItem\r\n      * @param fileProperties\r\n      */\n  addMenuEvents: function addMenuEvents($fileItem, fileProperties) {\n    var self = this;\n    var viewMore = $fileItem.find(\".bz-file-menu\");\n    var items = [];\n\n    if (fileProperties.showMetadata) {\n      items.push({\n        name: self.getResource(\"render-collection-navigator-details-form\"),\n        fn: function fn() {\n          self.processActionByType(self.Class.ACTION_DETAILS, fileProperties, $fileItem);\n        } });\n\n    }\n\n    if (fileProperties.showMetadata && fileProperties.allowUpdateMetadata)\n    items.push({\n      name: self.getResource(\"render-collection-navigator-edit-form\"),\n      fn: function fn() {\n        self.processActionByType(self.Class.ACTION_EDIT, fileProperties, $fileItem);\n      } });\n\n\n    if (fileProperties.allowCheckOut) {\n      items.push({\n        name: self.getResource(\"render-ecm-bt-lock\"),\n        fn: function fn() {\n          self.lockECMFile($fileItem, fileProperties);\n        } });\n\n    }\n\n    if (fileProperties.allowCancelCheckOut) {\n      items.push({\n        name: self.getResource(\"render-ecm-bt-unlock\"),\n        fn: function fn() {\n          self.unlockECMFile($fileItem, fileProperties);\n        } });\n\n    }\n\n    /*if (fileProperties.allowUpdateContent) {\r\n          items.push({\r\n              name: self.getResource(\"render-ecm-bt-upgrade\"),\r\n              fn: function () {\r\n                  self.processActionByType(\"upgrade\", fileProperties);\r\n              }\r\n          });\r\n      }*/\n\n    if (fileProperties.allowDelete) {\n      items.push({\n        name: self.getResource(\"render-ecm-bt-delete\"),\n        fn: function fn() {\n          self.deleteECMFile($fileItem, fileProperties.idFileUpload);\n        } });\n\n    }\n\n    // TODO: Check items has data\n    viewMore.overflowMenu({ items: items });\n  },\n\n  /**\r\n      * Removes a file from the ECM control\r\n      * @param $fileItem\r\n      * @param fileId\r\n      */\n  deleteECMFile: function deleteECMFile($fileItem, fileId) {\n    var self = this;\n\n    bizagi.showConfirmationBox(this.getResource(\"render-ecm-confirm-message\")).\n    done(function () {\n      $.when(self.deleteUploadItem($fileItem, fileId)).\n      done(function () {\n        // Detach item\n        $fileItem.hide();\n        $fileItem.remove();\n\n        // Update value\n        self.setValue(self.files, false);\n\n        // Check maxFiles\n        self.checkMaxFiles();\n\n        // Trigger change\n        self.triggerRenderChange();\n      });\n    });\n  },\n\n  /**\r\n      * Check maximum number of files\r\n      */\n  checkMaxFiles: function checkMaxFiles() {\n    if (this.isMaxFilesReached()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    } else {\n      $(this.$contentFile).removeClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Check if the maximum number of files than can be uploaded has been reached\r\n      * @returns {}\r\n      */\n  isMaxFilesReached: function isMaxFilesReached() {\n    var maxFiles = this.properties.maxfiles;\n    var actualFiles = this.properties.value ? this.properties.value.length : 0;\n\n    return maxFiles !== 0 && this.filesCount >= maxFiles && actualFiles >= maxFiles;\n  },\n\n  /**\r\n      * Call the form failhandler with an specific error\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  executeFormFailHandler: function executeFormFailHandler(error) {\n    var errorResponse = \"\";\n\n    if (error && error.code === this.Class.ERROR_ECM_NO_AVAILABLE) {\n      errorResponse = this.getResource(\"render-ecm-service-not-available\");\n    } else if (error && error.responseText) {\n      errorResponse = error.responseText;\n    } else {\n      errorResponse = this.getResource(\"render-ecm-service-general-error\");\n    }\n\n    this.getFormContainer().failHandler(errorResponse);\n  },\n\n  lockECMFile: function lockECMFile($fileItem, fileProperties) {\n    var self = this;\n\n    $.when(self.lockUploadItem(fileProperties.idFileUpload)).done(\n    function (result) {\n      var file = [result.idFileUpload, fileProperties.fileName];\n      var newItem = self.renderUploadItem(file);\n\n      $fileItem.replaceWith(newItem);\n      self.attackMenuEvents(file);\n    });\n  },\n\n  unlockECMFile: function unlockECMFile($fileItem, fileProperties) {\n    var self = this;\n\n    $.when(self.unlockUploadItem(fileProperties.idFileUpload)).\n    done(function (result) {\n      var file = [result.idFileUpload, fileProperties.fileName];\n      var newItem = self.renderUploadItem(file);\n\n      $fileItem.replaceWith(newItem);\n      self.attackMenuEvents(file);\n    });\n  },\n\n  /**\r\n      * Method to add new file from native or hybrid environment\r\n      */\n  chooseFile: function chooseFile() {\n    if (this.isNative) {\n      this.$nativeFile.click();\n    } else if (bizagi.util.media.fileAPISupported()) {\n      this.$inputFile.click();\n    }\n  },\n\n  /**\r\n      * Check allow extensions and define possible choices\r\n      * @returns {}\r\n      */\n  checkFileExtensions: function checkFileExtensions() {\n    var self = this;\n    var validExtensions = self.properties.validExtensions || \"\";\n\n    self.validOptions = { video: false, image: false, file: false };\n\n    // Preprocess the extensions string\n    validExtensions = validExtensions.replace(/\\s+/g, \"\").toLowerCase();\n\n    if (typeof validExtensions === \"undefined\" || validExtensions === \"\") {\n      self.validOptions = { video: true, image: true, file: true };\n    } else {\n      validExtensions = validExtensions.split(\";\");\n\n      if (validExtensions.length === 1 && validExtensions[0].indexOf(\"*.*\") !== -1) {\n        self.validOptions.video = true;\n        self.validOptions.image = true;\n      } else {\n        for (var i = 0, length = validExtensions.length; i < length; i++) {\n          validExtensions[i] = validExtensions[i].replace(\"*.\", \"\");\n\n          if (self.Class.EXTENSIONSFILE.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.file = true;\n          } else if (self.Class.EXTENSIONSIMG.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.image = true;\n          } else if (self.Class.EXTENSIONSVIDEO.toString().indexOf(validExtensions[i]) >= 0) {\n            self.validOptions.video = true;\n          }\n        }\n      }\n    }\n\n    // Media is not supported then upload control is disabled\n    if (!self.validOptions.file && !self.validOptions.image && !self.validOptions.video) {\n      $(self.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n\n    // Limit of files is reached then upload control is disabled\n    if (self.isMaxFilesReached() || !self.isNative && !bizagi.util.media.fileAPISupported()) {\n      $(this.$contentFile).addClass(\"bz-file-upload__container--hidden\");\n    }\n  },\n\n  /**\r\n      * Add upload options\r\n      */\n  getUploadChoices: function getUploadChoices() {\n    var self = this;\n    var itemsUpload = [];\n\n    // Take photo, Choose photo\n    if (self.validOptions.image) {\n      itemsUpload.push({\n        \"guid\": 1,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") });\n\n      itemsUpload.push({\n        \"guid\": 2,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") });\n\n    }\n\n    // Take video\n    if (self.validOptions.video) {\n      itemsUpload.push({\n        \"guid\": 3,\n        \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-video\") });\n\n    }\n\n    // Stores the upload options\n    return [].concat(itemsUpload);\n  },\n\n  /**\r\n      * Handler of upload files\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerUploadFile: function handlerUploadFile(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    switch (actionSelected) {\n      case 2:\n\n        navigator.camera.getPicture(function (dataImage) {\n          self.dataImage = dataImage;\n          var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSVIDEO);\n\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).\n          then(function () {\n            // Gets the real properties for the file\n            return $.when(bizagi.util.media.getFileDataInfo(self.dataImage)).\n            then(function (fileData) {\n              self.fileProperties = fileData;\n\n              if (bizagi.util.media.checkFileTypes(fileData, self.properties, extensions)) {\n                if (!bizagi.util.isAndroid()) {\n                  return $.when(bizagi.util.media.modalResolutionUpload()).then(function (buttonIndex) {\n                    if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\n                      return self.handlerResolutionUpload(buttonIndex);\n                    }\n                  });\n\n                } else {\n                  // Force click to show actionsheet menu\n                  $(\".bz-file-upload__resolution\", self.getControl()).click();\n                }\n              }\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: Camera.PictureSourceType.PHOTOLIBRARY });\n\n        break;\n      case 1:\n        navigator.camera.getPicture(function (dataImage) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSize(dataImage, self.properties)).then(function () {\n            return $.when(bizagi.util.media.getFileDataInfo(dataImage)).then(function (fileData) {\n              self.fileProperties = fileData;\n              return self.saveImage(dataImage);\n            });\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n        },\n        self.onFail.bind(self), {\n          quality: self.Class.QUALITY_PICTURE,\n          sourceType: navigator.camera.PictureSourceType.CAMERA,\n          mediaType: navigator.camera.MediaType.PICTURE,\n          destinationType: Camera.DestinationType.FILE_URI,\n          correctOrientation: true,\n          targetWidth: 1280,\n          targetHeight: 960 });\n\n        break;\n      case 3:\n        navigator.device.capture.captureVideo(function (dataVideo) {\n          bizagi.loading.start();\n\n          $.when(bizagi.util.media.checkMaxSizeVideo(dataVideo, self.properties)).\n          then(function () {\n            return self.saveVideo(dataVideo);\n          }).always(function () {\n            bizagi.loading.stop();\n          });\n\n        }, self.onFail.bind(self), { limit: self.Class.LIMIT });\n        break;}\n\n  },\n\n  /**\r\n      * Catch errors\r\n      * @param {} error\r\n      */\n  onFail: function onFail(error) {\n    var messageError = bizagi.util.processFailMessage(error);\n\n    bizagi.loading.stop();\n\n    if (messageError && typeof messageError === \"string\" && messageError.indexOf(\"No Activity found to handle Intent\") !== -1) {\n      var hasResource = bizagi.util.isValidResource(\"render-upload-error-media-app\");\n      var message = hasResource ? bizagi.localization.getResource(\"render-upload-error-media-app\") : \"Your device does not have an app to execute this action.\";\n\n      self.performValidationMessage(message);\n    }\n  },\n\n  /**\r\n      * Adds a validation message to the render\r\n      * @param message\r\n      */\n  performValidationMessage: function performValidationMessage(message) {\n    var fail = bizagi.util.processFailMessage(message);\n\n    bizagi.showMessageBox(fail);\n  },\n\n  /**\r\n      * Handler of resolution upload\r\n      * @param {} ordinal\r\n      * @returns {}\r\n      */\n  handlerResolutionUpload: function handlerResolutionUpload(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    // If original, save image normally, if not, reduce quality and size\n    if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\n      return self.saveImage(self.dataImage);\n    } else {\n      var resolution = bizagi.util.media.getImageResolution(actionSelected);\n\n      return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).then(function (result) {\n\n        self.editedImageURL = result.localUrl;\n        self.properties.url = result.base64Image;\n\n        return self.saveImage(self.dataImage);\n      });\n    }\n  },\n\n  /**\r\n      * Method to add new file\r\n      */\n  addFile: function addFile() {\n    var self = this;\n    var dataFile = this.$inputFile[0].files[0];\n    var extensions = self.Class.EXTENSIONSIMG.concat(self.Class.EXTENSIONSFILE, self.Class.EXTENSIONSVIDEO);\n\n    dataFile.fullPath = this.$inputFile[0].value;\n    bizagi.loading.start();\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\n\n      $.when(self.processUploadFile(dataFile)).done(function (result) {\n        if (!bizagi.util.isFailResponse(result)) {\n          self.onUploadFileCompleted(JSON.parse(decodeURIComponent(result)));\n        } else {\n          self.performValidationMessage(result);\n        }\n      }).fail(function (error) {\n        self.executeFormFailHandler(error);\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    } else {\n      bizagi.loading.stop();\n    }\n  },\n\n  /**\r\n      * Build add params to send to the server\r\n      * @param {} dataFile\r\n      */\n  buildAddFileParams: function buildAddFileParams(dataFile) {\n    var self = this;\n    var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\n\n    // Get form data for POSTing\n    var formData = new FormData();\n    var form = self.getFormContainer();\n    var data = self.buildAddParams();\n\n    // Build add params to send to the server\n    var keys = Object.keys(data);\n\n    keys.map(function (key) {\n      formData.append(key, data[key]);\n    });\n\n    formData.append(\"Filedata\", dataFile);\n    formData.append(\"Filename\", dataFile.name.substr(dataFile.name.replace(/([\\\\\\/]+)/g, \"/\").lastIndexOf(\"/\") + 1));\n    formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\n\n    if (self.properties.contexttype)\n    formData.append(prefix + \"contexttype\", self.properties.contexttype);\n\n    try {\n      if (typeof BIZAGI_SESSION_NAME !== \"undefined\") {\n        formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\n      } else {\n        formData.append(\"JSESSIONID\", form.properties.sessionId);\n      }\n    } catch (e) {\n      formData.append(\"JSESSIONID\", form.properties.sessionId);\n    }\n\n    return formData;\n  },\n\n  /**\r\n      * Process an upload file into the server\r\n      * @param {} dataFile\r\n      * @returns {}\r\n      */\n  processUploadFile: function processUploadFile(dataFile) {\n    var data = {\n      url: this.properties.addUrl,\n      formData: this.buildAddFileParams(dataFile) };\n\n\n    return this.dataService.processUploadFile(data);\n  },\n\n  /**\r\n      * onUploadFileCompleted\r\n      * @param {} result\r\n      */\n  onUploadFileCompleted: function onUploadFileCompleted(result) {\n    var self = this;\n    var $wrapper = $(\".bz-files\", self.getControl());\n\n    if (result.idFileUpload && result.fileName) {\n      var file = [result.idFileUpload, result.fileName];\n      var newItem = self.renderUploadItem(file);\n\n      // Locate it before the upload wrapper\n      $wrapper.append(newItem);\n\n      // Copy the files value but not its reference\n      var files = self.files.slice();\n\n      //Add the new item to this temporal array\n      files.push(file);\n\n      // Update value\n      self.setValue(files, true);\n\n      // Check maxFiles\n      self.checkMaxFiles();\n      self.attackMenuEvents(file);\n\n      self.editedImageURL = null;\n    } else {\n      self.performValidationMessage(result.message);\n    }\n  },\n\n  attackMenuEvents: function attackMenuEvents(file) {\n    var self = this;\n    var $control = self.getControl();\n\n    if (file && file.getFileProperties) {\n      $.when(file.getFileProperties).done(function (fileProperties) {\n        // TODO: Fail scenario...\n        var $fileItem = $(\".\" + self.properties.id + \"-\" + fileProperties.idFileUpload, $control);\n\n        self.fileData[fileProperties.idFileUpload] = fileProperties.metadata || [];\n        self.addMenuEvents($fileItem, fileProperties);\n      });\n    }\n  },\n\n  processActionByType: function processActionByType(type, fileData, $fileItem) {\n    var self = this;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n\n    bizagi.loading.start();\n\n    // Instantiate slide form object\n    var slideView = new bizagi.rendering.smartphone.slide.ecm(self.dataService, self.renderFactory, {\n      title: self.properties.displayName || \"\",\n      container: form.container,\n      navigation: self.getParams().navigation,\n      editable: properties.editable && type !== self.Class.ACTION_DETAILS,\n      orientation: properties.orientation || \"ltr\",\n      onSave: function onSave(result) {\n        if (result.update) {\n          var file = [result.idFileUpload, result.fileName];\n          var newItem = self.renderUploadItem(file);\n\n          $fileItem.replaceWith(newItem);\n          self.attackMenuEvents(file);\n        }\n      },\n      onCancel: function onCancel() {\n        // console.log(\"CANCEL\");\n      } });\n\n\n    slideView.render({ metadata: fileData.metadata, fileData: fileData }).\n    always(function () {\n      bizagi.loading.stop();\n    });\n\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Grouped Grid Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the Grouped Grid render class to adjust to smartphone devices\r\n */\n\n// Extends from Grid Smartphone base\nbizagi.rendering.smartphone.grid.extend(\"bizagi.rendering.smartphone.grid.grouped\", {}, {\n\n  /**\r\n                                                                                           * Method to customize each render after processed\r\n                                                                                           */\n  postRender: function postRender() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.getControlFiller().addClass(\"bz-form-item__control--hidden\");\n  },\n\n  isValidGrid: function isValidGrid(invalidElements) {\n    return this._super(invalidElements);\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Letter Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the letter render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.letter\", bizagi.rendering.letter.prototype);\n// Extends itself\nbizagi.rendering.smartphone.label.extend(\"bizagi.rendering.smartphone.letter\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Render Button Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the button render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.button\", bizagi.rendering.button.prototype);\n// Extends itself\nbizagi.rendering.smartphone.button.extend(\"bizagi.rendering.smartphone.button\", {}, {\n\n  /**\r\n                                                                                       * Whether or not we are offline 'Just a shortcut\r\n                                                                                       * @var isOfflineForm boolean\r\n                                                                                       */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if the form is offline\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    $(\":button\", self.getControl()).on(\"click\", function () {\n      self.processButton();\n    });\n  },\n\n  /**\r\n      * In offline forms the button only works for actions and validations\r\n      * @returns {boolean|*}\r\n      */\n  executeButton: function executeButton() {\n    if (!this.isOfflineForm) {\n      return this._super();\n    } else {\n      // returns false to prevent form refreshing\n      return false;\n    }\n  },\n\n  /**\r\n      * Process the button actions workflow\r\n      * @returns {}\r\n      */\n  processButton: function processButton() {\n    var self = this;\n\n    if (self.properties.editable) {\n\n      // Check if action need conformation\n      if (self.properties.needsUserConfirmation) {\n        $.when(bizagi.showConfirmationBox(self.properties.userConfirmationMessage, \"Bizagi\", \"warning\")).\n        done(function () {\n          if (!self.properties.preventDefault)\n          self.runButtonAction();\n          // Trigger change\n          self.triggerRenderChange({ pressed: true });\n        });\n      } else {\n        if (!self.properties.preventDefault)\n        self.runButtonAction();\n\n        // Trigger change\n        self.triggerRenderChange({ pressed: true });\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\"button\", $context);\n  },\n\n  /**\r\n      * Customizes the font weight\r\n      * @param {} $label\r\n      * @param {} bold\r\n      * @returns {}\r\n      */\n  changeFontBold: function changeFontBold($label, bold) {\n    if (bizagi.util.parseBoolean(bold)) {\n      $label.css(\"font-weight\", \"bold\");\n    }\n\n    return this;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render fileprint Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the fileprint render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.fileprint\", bizagi.rendering.fileprint.prototype);\n// Extends itself\nbizagi.rendering.smartphone.fileprint.extend(\"bizagi.rendering.smartphone.fileprint\", {}, {\n\n  /**\r\n                                                                                             * Template method to implement in each device to customize each render after processed\r\n                                                                                             */\n  postRender: function postRender() {\n    this.getControl().parent().hide();\n  } });","/**\r\n *   Name: Bizagi smartphone Render Link Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to smartphoe devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.link\", bizagi.rendering.link.prototype);\n// Extends itself\nbizagi.rendering.smartphone.link.extend(\"bizagi.rendering.smartphone.link\", {}, {\n\n  /**\r\n                                                                                   * Template method to implement in each device to customize each render after processed\r\n                                                                                   * @returns {}\r\n                                                                                   */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.link = $control.find(\".bz-link\");\n\n    this._super();\n\n    this.preventDefaultForAnchorTag();\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.link = $control.find(\".bz-link\");\n\n    this._super();\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    // Set internal value\n    this.setValue(value, false);\n\n    if (this.isValidValue()) {\n      // Get the decoded version of the URL\n      value = getFullyDecodedURI($.trim(value));\n\n      this.link.attr(\"href\", value);\n    }\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Configure event handlers\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n\n    if (self.isValidValue()) {\n      self.link.on(\"click\", function (evt) {\n        evt.preventDefault();\n        evt.stopPropagation();\n\n        var linkEncode = encodeURI(this.getAttribute(\"href\"));\n\n        self.linkSolver(linkEncode, self.properties.linktarget);\n      });\n    } else {\n      self.link && self.link.addClass(\"bz-link--disabled\");\n    }\n  },\n\n  /**\r\n      * Checks if the value is a valid url (http/https valid urls)\r\n      * TODO: Check if this validation is necessary\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  isValidValue: function isValidValue() {\n    if (!this.hasValue()) return false;\n    var value = $.trim(this.getValue() || \"\");\n\n    return value.toLowerCase().match(/^(http|https):\\/\\//) !== null || false;\n  },\n\n  /**\r\n      * Executes the link\r\n      * @param {} linkEncode\r\n      * @param {} linkTarget\r\n      * @returns {}\r\n      */\n  linkSolver: function linkSolver(linkEncode, linkTarget) {\n    if (linkTarget === \"newwindow\" || bizagi.util.isCordovaSupported()) {\n      window.open(linkEncode, \"_system\", \"location=yes\");\n    } else {\n      window.open(linkEncode, \"_system\");\n    }\n  },\n\n  processLayout: function processLayout(isLabelFormat) {\n    if (!isLabelFormat) {\n      this._super(isLabelFormat, this.properties.textFormat);\n    } else {\n      if (typeof this.properties.textFormat.background !== \"undefined\") {\n        this._super(isLabelFormat, { background: this.properties.textFormat.background });\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\".bz-link\", $context);\n  } });","/**\r\n *   Name: Bizagi Render Image Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the image render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.image\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,\n  BA_CONTEXT_PARAMETER_PREFIX: bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,\n  BA_PAGE_CACHE: bizagi.render.services.service.BA_PAGE_CACHE },\nbizagi.rendering.image.prototype);\n\n// Extends itself\nbizagi.rendering.smartphone.image.extend(\"bizagi.rendering.smartphone.image\", {\n  QUALITY_PICTURE: 80,\n  EXTENSIONSIMG: [\"jpeg\", \"jpg\", \"png\"] },\n{\n\n  /**\r\n   * DOM input to handle HTML uploads\r\n   * @var $inputFile jQuery DOM\r\n   */\n  $inputFile: null,\n\n  /**\r\n                     * Whether or not is a native device 'Just a shortcut\r\n                     * @var isNative boolean\r\n                     */\n  isNative: false,\n\n  /**\r\n                    * Whether or not we are offline 'Just a shortcut\r\n                    * @var isOfflineForm boolean\r\n                    */\n  isOfflineForm: false,\n\n  /**\r\n                         * Update or init the element data\r\n                         * @param {} data\r\n                         */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n\n    // Check if offline forms is supported\n    this.isOfflineForm = bizagi.util.isOfflineForm({ context: this });\n    this.isNative = bizagi.util.isCordovaSupported();\n\n    if (this.isOfflineForm) {\n      var maxFileSizeOfProperty = Number(this.properties.maxSize) || 1048576;\n      var maxFileSizeOfUser = typeof BIZAGI_SETTINGS !== \"undefined\" && typeof BIZAGI_SETTINGS.UploadMaxFileSize !== \"undefined\" ? Number(BIZAGI_SETTINGS.UploadMaxFileSize) : 1048576;\n      this.properties.maxSize = maxFileSizeOfProperty < maxFileSizeOfUser ? maxFileSizeOfProperty : maxFileSizeOfUser;\n    }\n  },\n\n  /**\r\n      * This method tries to get the HTML template an render the current object inside\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  renderControl: function renderControl() {\n    var template = this.renderFactory.getTemplate(\"image\");\n\n    return $.fasttmpl(template, { url: \"\" });\n  },\n\n  getElementsToStylize: function getElementsToStylize(context) {\n    return $({});\n  },\n\n  /**\r\n      * There is no difference when rendering a readonly image, so...\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(\"image-readonly\");\n\n    return self.buildItemUrl().\n    then(function (dataUrl) {\n      var url = dataUrl || \"\";\n\n      if (!self.isDisposed()) {\n        self.properties.url = url;\n        var html = $.fasttmpl(template, { url: self.properties.url });\n        return html;\n      }\n    });\n  },\n\n  /**\r\n      * After rendering element\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.$inputFile = $(\".bz-image__input\", $control);\n    this.$nativeFile = $(\".bz-image__native\", $control);\n\n    if (!this.isDesignMode())\n    this.showAsyncImage();\n  },\n\n  /**\r\n      * Add action handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $control = this.getControl();\n\n    // Attach all events\n    $control.on(\"click\", \"[data-action=upload]\", function (evt) {\n      self.choosePhoto();\n    });\n\n    if (this.isNative) {\n      self.configureNativeHandlers();\n    } else {\n      self.configureHybridHandlers();\n    }\n  },\n\n  configureNativeHandlers: function configureNativeHandlers() {\n    var self = this;\n    var $control = this.getControl();\n\n    // Upload Image Options\n    this.$nativeFile.off(\"click\").actionSheet({\n      actions: self.getUploadChoices(),\n      actionClicked: function actionClicked(action) {\n        switch (action.guid) {\n          case 1:\n            self.imageAdd();\n            break;\n          case 2:\n            self.imageAdd(true);\n            break;}\n\n      },\n      appear: function appear() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      cancelClicked: function cancelClicked(action) {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      } });\n\n\n    $(\".bz-image__resolution\", $control).off(\"click\").actionSheet({\n      actions: bizagi.util.media.getImageResolutionSizes(),\n      withoutCancel: true,\n      actionClicked: function actionClicked(action) {\n        bizagi.loading.start();\n        self.resolutionButtonHandler(action.guid).\n        always(function () {\n          bizagi.loading.stop();\n        });\n      },\n      appear: function appear(action) {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      cancelClicked: function cancelClicked(action) {\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      } });\n\n  },\n\n  configureHybridHandlers: function configureHybridHandlers() {\n    var self = this;\n\n    // Image change (Hybrid only)\n    this.$inputFile.off(\"change\").on(\"change\", function () {\n      self.imageAdd();\n      this.value = \"\";\n    });\n\n    // Just in case\n    this.$inputFile.off(\"click\").on(\"click\", function (evt) {\n      evt.stopPropagation();\n    });\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n    var $control = this.getControl();\n\n    $control.on(\"click\", \".bz-image\", function () {\n      self.imagePreview();\n    });\n  },\n\n  /**\r\n      * Add an image\r\n      * @param useCamera boolean Whether or not to use device's camera\r\n      */\n  imageAdd: function imageAdd(useCamera) {\n    var self = this;\n\n    if (!this.isNative) {\n      self.imageAddHybrid();\n    } else {\n      self.imageAddNative(useCamera);\n    }\n  },\n\n  imageAddHybrid: function imageAddHybrid() {\n    var self = this;\n    var extensions = this.Class.EXTENSIONSIMG;\n    var dataFile = this.$inputFile[0].files[0];\n\n    dataFile.fullPath = this.$inputFile[0].value;\n    bizagi.loading.start();\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) && bizagi.util.media.checkFileTypes(dataFile, self.properties, extensions)) {\n      self.performUploadFile(dataFile).\n      always(function () {\n        bizagi.loading.stop();\n      });\n    } else {\n      bizagi.loading.stop();\n    }\n  },\n\n  imageAddNative: function imageAddNative(useCamera) {\n    var self = this;\n    var options = {\n      quality: self.Class.QUALITY_PICTURE,\n      targetWidth: 1280,\n      targetHeight: 960,\n      correctOrientation: true };\n\n\n    if (!useCamera) {\n      var coordinates = self.getControl()[0].getBoundingClientRect();\n\n      options = {\n        quality: self.Class.QUALITY_PICTURE,\n        sourceType: Camera.PictureSourceType.PHOTOLIBRARY,\n        popoverOptions: new CameraPopoverOptions(coordinates.left, coordinates.top - 20, 200, 100, 4),\n        destinationType: navigator.camera.DestinationType.FILE_URI,\n        correctOrientation: true };\n\n    }\n\n    navigator.camera.getPicture(\n    function (dataImage) {// on success\n      return self.imageAddNativeFromCamera(dataImage);\n    }, function () {// on fail \n      bizagi.loading.stop();\n    }, options);\n\n  },\n\n  imageAddNativeFromCamera: function imageAddNativeFromCamera(dataImage) {\n    var self = this;\n    bizagi.loading.start();\n\n    // Check max size, then get file data info and upload file\n    bizagi.util.media.checkMaxSize(dataImage, self.properties).\n    then(function () {\n      return bizagi.util.media.getFileDataInfo(dataImage);\n    }).\n    then(function (fileData) {\n      if (bizagi.util.media.checkFileTypes(fileData, self.properties, self.Class.EXTENSIONSIMG)) {\n\n        self.dataImage = dataImage;\n        self.fileProperties = fileData;\n\n        // \"new Blob\" constructor is not supported in android version 4.2.2\n        var version = bizagi.util.getAndroidVersion();\n        if (version && version <= 4.2 || self.isOfflineForm) {\n          self.performUploadFile(self.dataImage).\n          always(function () {\n            bizagi.loading.stop();\n          });\n        } else {\n\n          if (!bizagi.util.isAndroid()) {\n            return $.when(bizagi.util.media.modalResolutionUpload()).\n            then(function (buttonIndex) {\n              if (buttonIndex <= bizagi.util.media.getImageResolutionItems().length) {\n                return self.resolutionButtonHandler(buttonIndex);\n              }\n            });\n          } else {\n            // Force click to show actionsheet menu\n            $(\".bz-image__resolution\", self.getControl()).click();\n          }\n        }\n      }\n    }).\n    always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Remove the current image\r\n      */\n  imageDelete: function imageDelete() {\n    var self = this;\n\n    bizagi.loading.start();\n\n    return self.dataService.deleteImage({\n      url: self.properties.deleteUrl,\n      idRender: self.properties.id,\n      xpath: self.properties.xpath,\n      xpathContext: self.properties.xpathContext,\n      idPageCache: self.properties.idPageCache,\n      contexttype: self.properties.contexttype }).\n    then(function () {\n      self.properties.value = [];\n      self.uploadFileCompleted();\n    }).fail(function (msg) {\n      var message;\n      var responseText = msg.responseText;\n\n      try {\n        message = JSON.parse(responseText);\n        message = message.message || responseText;\n      } catch (e) {\n        message = responseText;\n      }\n\n      self.setValidationMessage(message);\n\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Send file using HTTP\r\n      * @param dataFile\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  uploadFile: function uploadFile(dataFile) {\n    var self = this;\n    self.properties.isChanged = true;\n\n    if (!this.isOfflineForm) {\n      if (this.isNative) {\n        return self.uploadFileNativeOnline(dataFile);\n      }\n      return self.uploadFileHybridOnline(dataFile);\n    }\n\n    // Offline code\n    if (bizagi.util.isEmpty(self.properties.value)) self.properties.value = [[null, null]];\n    var fileName = self.fileProperties != undefined ? self.fileProperties.name : dataFile.name;\n    self.dataService.fileService.changeOfflineImageName(self.properties.value, fileName);\n    return self.saveImageOffline(dataFile);\n  },\n\n  uploadFileNativeOnline: function uploadFileNativeOnline() {\n    var self = this;\n    var params = {};\n    var addParams = self.buildAddParams();\n    var fileName = self.fileProperties.name;\n\n    if (self.editedImageURL) {\n      params.dataFile = self.editedImageURL;\n    } else if (self.fileProperties) {\n      params.dataFile = self.fileProperties.url;\n    }\n\n    addParams.queueID = \"q_\" + bizagi.util.encodeXpath(self.getUploadXpath());\n\n    params.data = addParams;\n    params.options = new FileUploadOptions();\n    params.options.fileKey = \"file\";\n    params.options.fileName = fileName;\n    params.options.mimeType = \"image/jpeg\";\n    params.options.uploadKey = { key: addParams[\"h_xpath\"] };\n    params.options.addUrl = self.properties.addUrl;\n\n    //Cleans variables related previous uploads\n    self.editedImageURL = null;\n    self.fileProperties = null;\n\n    // Fix android 4.4 getting images from recent folder\n    params.dataFile = bizagi.util.media.getImagePath(params.dataFile);\n\n    return $.when(bizagi.util.media.uploadFile(params)).\n    then(function (result) {\n      var response = JSON.parse(decodeURIComponent(result.response));\n      if (response.type === \"error\") {\n        return $.Deferred().reject(response).promise();\n      }\n      return response;\n    });\n  },\n\n  uploadFileHybridOnline: function uploadFileHybridOnline(dataFile) {\n    var self = this;\n\n    if (bizagi.util.media.checkMaxSizeFile(dataFile, self.properties) &&\n    bizagi.util.media.checkFileTypes(dataFile, self.properties, self.Class.EXTENSIONSIMG)) {\n\n      return self.dataService.processUploadFile({\n        url: self.properties.addUrl,\n        formData: self.buildAddFileParams(dataFile) });\n\n\n    } else {\n      return $.Deferred().reject().promise();\n    }\n  },\n\n  /**\r\n      * File upload is done\r\n      */\n  uploadFileCompleted: function uploadFileCompleted() {\n    try {\n      this.showAsyncImage();\n      this.editedImageURL = null;\n    } catch (error) {\n      // TODO: Review scenario\n      this.getFormContainer().refreshForm();\n    }\n  },\n\n  /**\r\n      * Show async image\r\n      * */\n  showAsyncImage: function showAsyncImage() {\n    var self = this;\n    var $control = self.getControl();\n    var $wrapper = $(\".bz-input-icon\", $control);\n\n    self.renderUploadItem().\n    then(function (htmlImage) {\n      if (!self.isDisposed()) {\n\n        // Empty container and add new image\n        $wrapper.empty();\n        $wrapper.append(htmlImage);\n\n        var action = self.hasValue() ? \"update\" : \"upload\";\n\n        $wrapper.attr(\"data-action\", action);\n\n        // Attack events to overflow-menu\n        if (self.hasValue()) {\n          self.configureMenu();\n        }\n      }\n    });\n  },\n\n  /**\r\n      * resolutionButtonHandler\r\n      * @param ordinal\r\n      */\n  resolutionButtonHandler: function resolutionButtonHandler(ordinal) {\n    var self = this;\n    var actionSelected = ordinal || 0;\n\n    // If original, save image normally, if not, reduce quality and size\n    if (actionSelected === bizagi.util.media.ResolutionType.ORIGINAL) {\n      return self.performUploadFile(self.dataImage);\n    } else {\n\n      var resolution = bizagi.util.media.getImageResolution(actionSelected);\n\n      return $.when(bizagi.util.media.transformImageSize(self.dataImage, resolution)).\n      then(function (result) {\n\n        self.editedImageURL = result.localUrl;\n        self.properties.url = result.base64Image;\n\n        return self.performUploadFile(self.dataImage);\n      });\n    }\n  },\n\n  /**\r\n      * Render edition view\r\n      * @returns {}\r\n      */\n  imagePreview: function imagePreview() {\n    var self = this;\n    var baseParams = self.getParams();\n    var container = baseParams.navigation.createRenderContainer({\n      title: self.properties.displayName,\n      view: {\n        zoom: true,\n        useNativeScrolling: false } });\n\n\n\n    var form = self.getFormContainer();\n    var template = self.renderFactory.getTemplate(\"image-preview\");\n    var imageData = { \"url\": self.properties.url && self.properties.url !== \"\" ? self.properties.url : \"\" };\n    var img = $.fasttmpl(template, imageData);\n\n    container.element.css(\"display\", \"none\");\n    self.inputEdition = container.element.html(img);\n    baseParams.navigation.navigate(container.id);\n\n    bizagi.loading.start();\n\n    var getFullImage = form.properties.compatibilityVersion >= 2 ? function () {\n      return imageData.url;\n    } : self.buildFullItemUrl.bind(self);\n\n    $.when(getFullImage()).then(function (dataUrl) {\n      container.element.css(\"display\", \"block\");\n\n      if (dataUrl.indexOf(\"error\") < 0) {\n        var $preview = $(\".bz-image__preview-item:first\", container.element).attr(\"src\", dataUrl);\n        var originalImageWidth = $preview.css(\"width\");\n\n        originalImageWidth = Number(originalImageWidth.substring(0, originalImageWidth.length - 2));\n\n        if (self.properties.width !== -1 && self.properties.width < originalImageWidth) {\n          $preview.css(\"width\", \"100%\");\n        }\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Build add params to send to the server\r\n      * @param {} dataFile\r\n      * @returns {}\r\n      */\n  buildAddFileParams: function buildAddFileParams(dataFile) {\n    var self = this;\n    var properties = self.properties;\n    var prefix = self.Class.BA_CONTEXT_PARAMETER_PREFIX;\n\n    // Get form data for POSTing\n    var formData = new FormData();\n    var form = self.getFormContainer();\n\n    // Build add params to send to the server\n    formData.append(prefix + \"xpath\", properties.xpath);\n    formData.append(prefix + \"idRender\", properties.id);\n    formData.append(prefix + \"xpathContext\", properties.xpathContext);\n    formData.append(prefix + self.Class.BA_PAGE_CACHE, properties.idPageCache);\n    formData.append(self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\", form.properties.sessionId);\n    formData.append(prefix + \"action\", \"savefile\");\n    formData.append(self.properties.xpath, dataFile);\n\n    if (properties.contexttype) {\n      formData.append(prefix + \"contexttype\", properties.contexttype);\n    }\n\n    try {\n      if (typeof BIZAGI_SESSION_NAME !== \"undefined\") {\n        formData.append(BIZAGI_SESSION_NAME, form.properties.sessionId);\n      } else {\n        formData.append(\"JSESSIONID\", form.properties.sessionId);\n      }\n    } catch (e) {\n      formData.append(\"JSESSIONID\", form.properties.sessionId);\n    }\n\n    return formData;\n  },\n\n  /**\r\n      * Call the form failhandler with an specific error\r\n      * @param {} error\r\n      * @returns {}\r\n      */\n  executeFormFailHandler: function executeFormFailHandler(error) {\n    var self = this;\n    var errorResponse = error.responseText ? error.responseText : bizagi.localization.getResource(\"workportal-general-error\");\n\n    self.getFormContainer().failHandler(errorResponse);\n  },\n\n  /**\r\n      * Execute upload file\r\n      * @param {} context\r\n      * @param {} dataImage\r\n      * @returns {}\r\n      */\n  performUploadFile: function performUploadFile(dataImage) {\n    var self = this;\n\n    return $.when(self.uploadFile(dataImage)).\n    then(function () {\n      if (bizagi.util.isEmpty(self.properties.value)) self.properties.value = [[0, \"uploaded\"]];\n      self.uploadFileCompleted();\n    }).fail(function (error) {\n      self.executeFormFailHandler(error);\n    });\n  },\n\n  /**\r\n      * Choose photo\r\n      */\n  choosePhoto: function choosePhoto() {\n    if (this.isNative) {\n      this.$nativeFile.click();\n    } else if (bizagi.util.media.fileAPISupported() && !this.isOfflineForm) {\n      this.$inputFile.click();\n    }\n  },\n\n  /**\r\n      * Process an action in order to do something with the image\r\n      */\n  configureMenu: function configureMenu() {\n    var self = this;\n    var items = [];\n    var $control = this.getControl();\n    var $viewMore = $(\".bz-input-icon__input + .bz-icn\", $control);\n    var allowDelete = self.isOfflineForm ? false : self.properties.allowDelete && self.properties.editable;\n\n    items.push({\n      name: bizagi.localization.getResource(\"workportal-actionsheet-upload-image-preview\"),\n      fn: function fn() {\n        self.imagePreview();\n      } });\n\n\n    items.push({\n      name: bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\"),\n      fn: function fn() {\n        self.choosePhoto();\n      } });\n\n\n    if (allowDelete) {\n      items.push({\n        name: bizagi.localization.getResource(\"workportal-actionsheet-upload-remove-photo\"),\n        fn: function fn() {\n          bizagi.showConfirmationBox(self.getResource(\"render-grid-delete-confirmation\")).\n          then(function () {\n            self.imageDelete();\n          });\n        } });\n\n    }\n\n    $viewMore.overflowMenu({ items: items });\n  },\n\n  /**\r\n      * Add upload options\r\n      */\n  getUploadChoices: function getUploadChoices() {\n    return [\n    { \"guid\": 1, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-choose-photo\") },\n    { \"guid\": 2, \"displayName\": bizagi.localization.getResource(\"workportal-actionsheet-upload-take-photo\") }];\n\n  },\n\n  /**\r\n      * Builds the upload item url\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  buildItemUrl: function buildItemUrl(params) {\n    var self = this;\n\n    if (self.isOfflineForm) {\n      return self.buildItemUrlOffline();\n    }\n\n    return self.buildItemUrlOnline(params);\n  },\n\n  buildItemUrlOffline: function buildItemUrlOffline() {\n    var self = this;\n    return bizagi.util.sleepUntil(function () {\n      return !self.dataService.getFileService().isLoading(self);\n    }).then(function () {\n      return bizagi.rendering.image.prototype.buildItemUrlOffline.apply(self, arguments);\n    });\n  },\n\n  buildItemUrlOnline: function buildItemUrlOnline() {\n    return bizagi.rendering.image.prototype.buildItemUrl.apply(this, arguments);\n  },\n\n  collectData: function collectData(renderValues) {\n    var self = this;\n\n    if (self.isOfflineForm && bizagi.util.isOfflineFormsV2Supported()) {\n      if (!self.properties.isChanged) return;\n\n      var xpath = self.properties.xpath;\n      if (!bizagi.util.isEmpty(xpath)) {\n        renderValues[xpath] = {\n          offlineId: self.buildOfflineImageId(),\n          name: self.dataService.fileService.getOfflineImageName(self.getValue()) };\n\n      }\n    }\n  },\n\n  /**\r\n      * Cleans current value\r\n      */\n  cleanData: function cleanData() {\n    if (!this.hasValue()) return;\n    return $.when(this.imageDelete());\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Form Link Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the link render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.formLink\", {\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"pageCacheId\" },\nbizagi.rendering.formLink.prototype);\n// Extends itself\nbizagi.rendering.smartphone.formLink.extend(\"bizagi.rendering.smartphone.formLink\", {}, {\n\n  init: function init(params) {\n    var self = this;\n\n    // Call base\n    self._super(params);\n\n    params.context = params.context || \"workflow\";\n\n    var paramsRender = $.extend({}, this._params, {\n      \"proxyPrefix\": this.dataService.serviceLocator.proxyPrefix,\n      \"context\": this.dataService.serviceLocator.context });\n\n\n    this.serviceLocator = new bizagi.render.services.context(paramsRender);\n  },\n\n  /**\r\n      * Update or init the element data\r\n      * @param data\r\n      */\n  initializeData: function initializeData(data) {\n    var self = this;\n\n    self._super(data);\n\n    var properties = self.properties;\n\n    self.originalElement = self.element;\n    properties.orgiginalDisplayType = properties.displayType;\n    properties.displayType = \"normal\";\n\n    self._sendRelation = self.submitEditRequest;\n    self._getData = self.dataService.getFormData;\n    self._isRefreshForm = false;\n  },\n\n  /**\r\n      * Method to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    var properties = self.properties;\n\n    self._super();\n\n    self._params = {\n      idRender: properties.id,\n      xpathContext: self.getFormLinkXpathContext(),\n      idPageCache: properties.idPageCache,\n      recordXPath: self.getFormLinkXpath(),\n      requestedForm: \"linkform\",\n      editable: properties.editable,\n      url: properties.editPage };\n\n\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    // Execute the same as post-render\n    this.postRender();\n  },\n\n  /**\r\n      * Para la grilla lo que se debe hacer es sobreescribir o crear los metodos params, sendrelation,getData\r\n      * @returns {*}\r\n      */\n  renderEdition: function renderEdition() {\n    var self = this;\n    var properties = self.properties;\n\n    self.container = self.getParams().navigation.createRenderContainer({ title: properties.displayName });\n    self.inputEdition = self.container.element;\n\n    if (self.properties.hasentryrule) {\n      var form = self.getFormContainer();\n\n      $.when(form.saveForm()).done(function () {\n        self.resolveCheckpointRequest().done(function () {\n          return self.openLinkRule(\"entryrule\");\n        });\n      });\n    } else {\n      return self.openLink();\n    }\n  },\n\n  /**\r\n      * Open link display from inside a dialog\r\n      */\n  openLink: function openLink() {\n    var self = this;\n\n    return $.when(self._sendRelation.apply(self)).done(function () {\n      bizagi.loading.start();\n\n      $.when(self.paintFormLink()).done(function () {\n        bizagi.loading.stop();\n      }).fail(function () {\n        //Executes Rollback action\n        bizagi.loading.start();\n        self.rollbackForm();\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    }).fail(function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n      var message = error_obj.message || bizagi.localization.getResource(\"workportal-general-error\");\n      var form = self.getFormContainer();\n\n      if (typeof form !== \"undefined\") {\n        form.addValidationMessage(message);\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  openLinkRule: function openLinkRule(property) {\n    var self = this;\n    var def = new $.Deferred();\n\n    bizagi.loading.start();\n\n    self.getPropertyValue(property, {}).\n    done(function (dataRuleResp) {\n      if (dataRuleResp.messages) {\n        var message = dataRuleResp.messages[0];\n        var form = self.getFormContainer();\n\n        form.validationController.showErrorMessage(message);\n        def.reject();\n      } else {\n        if (property === \"entryrule\") {\n          self.openLink();\n        }\n      }\n      def.resolve();\n    }).fail(function () {\n      def.reject();\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n\n    return def.promise();\n  },\n\n  getPropertyValue: function getPropertyValue(propertyName, params) {\n    var self = this;\n    var properties = self.properties;\n    var defer = new $.Deferred();\n\n    self.dataService.multiaction().getPropertyData({\n      url: properties.dataUrl,\n      xpath: properties.xpath,\n      idRender: properties.id,\n      xpathContext: properties.xpathContext,\n      idPageCache: properties.idPageCache,\n      property: propertyName,\n      extra: params,\n      dataType: params ? params.dataType : null }).\n    done(function (data) {\n      if (data.type === \"error\") {\n        // Workflow engine error, we gotta show it with error\n        var form = self.getFormContainer();\n\n        form.validationController.showErrorMessage(data.message);\n        defer.reject(data);\n      } else {\n        defer.resolve(data);\n      }\n    }).fail(function (jqXHR, textStatus, errorThrown) {\n      // Add error messages\n      var form = self.getFormContainer();\n\n      form.validationController.showErrorMessage(jqXHR.message);\n\n      defer.reject(jqXHR, textStatus, errorThrown);\n    });\n\n    return defer.promise();\n  },\n\n  paintFormLink: function paintFormLink() {\n    var self = this;\n    var deferred = $.Deferred();\n\n    $.extend(self._params, { \"proxyPrefix\": self.serviceLocator.proxyPrefix });\n\n    $.when(self._getData.call(self, self._params)).pipe(function (data) {\n      if (self._params.recordXPath) {\n        data.form.properties.recordXpath = self._params.recordXPath;\n      }\n\n      if (self._params.editable === false) {\n        data.form.properties.editable = false;\n      }\n\n      // Grid\n      if (self._params.hasOwnProperty(\"withAddForm\") && self._params.withAddForm) {\n        if (!data.form.elements || data.form.elements && data.form.elements.length === 0) {\n          self._params.hideSaveButton = true;\n        }\n      }\n\n      /**\r\n         * This creation of form on every action like refresh or save\r\n         * is driving nuts the listeners in native apps\r\n         */\n      self.form = self.renderFactory.getContainer({\n        type: \"form\",\n        data: data.form,\n        navigation: self.getParams().navigation,\n        view_container: self.container });\n\n\n      self.form.params = $.extend(self.form.params, self.getFormContainer().getParams());\n\n      self.form.buttons = [\n      $.extend(\n      self.form.buttons[0] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-save\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 0,\n        \"action\": \"save\",\n        \"save\": true,\n        \"style\": \"\",\n        // This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          // When the data is saved then\n          return self.saveRecord().then(function () {\n            self.container.destroy();\n          }).fail(function (error) {\n            if (error && error.error_code && error.error_code == 1) {\n              //if doesn't support commit, rollback, etc.\n              $.when(self.actionSave(error.data)).then(function () {\n                self.container.destroy();\n              });\n            } else if (error && error.type === \"validationMessages\") {\n              self.form.addValidationMessage(error.messages);\n            } else if (error && error.responseText) {\n              var error_obj = bizagi.util.getErrorFormatted(error);\n              var message = error_obj && error_obj.message ? error_obj.message : error_obj || bizagi.localization.getResource(\"workportal-general-error\");\n\n              if (self.hasSessionFormException(error_obj)) {\n                self.goToStartPage(error_obj);\n              } else {\n                bizagi.showMessageBox(message, \"Error\");\n              }\n            }\n          });\n        } }),\n\n      $.extend(\n      self.form.buttons[1] || {},\n      {\n        \"caption\": bizagi.localization.getResource(\"render-form-dialog-box-close\"),\n        \"actions\": [\"submitData\", \"refresh\"],\n        \"submitData\": true,\n        \"refresh\": true,\n        \"ordinal\": 1,\n        \"action\": \"back\",\n        \"save\": true,\n        \"style\": \"\",\n        //This callback avoid to call the default processButton in the form\n        callback: function callback() {\n          self.container.destroy();\n          deferred.reject();\n        } })];\n\n\n\n      $.extend(self.form, {\n        processButtons: function processButtons() {\n          //not send information set in memory and save\n          $.each(self.form.buttons, function (index, element) {\n            switch (element[\"ordinal\"]) {\n              case 1: //next button will behave as a cancel button\n                $(self.form.getButtons()[index]).click(function () {\n                  self.container.destroy();\n                  deferred.reject();\n                });\n\n                self.form.getButtons()[index].innerHTML = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n\n                self.form.buttons[index].caption = bizagi.localization.getResource(\"render-form-dialog-box-close\");\n                self.form.buttons[index].action = \"back\";\n                break;\n\n              default:\n                $(self.form.getButtons()[index]).click(function () {\n                  if (self._params.hideSaveButton) {\n                    $(self.form.getButtons()[index]).hide();\n                  }\n\n                  return self.saveRecord().then(function () {\n                    self.container.destroy();\n                  }).fail(function (error) {\n                    if (error && error.error_code && error.error_code == 1) {\n                      //if doesn't support commit, rollback, etc.\n                      $.when(self.actionSave(error.data)).then(function () {\n                        self.container.destroy();\n                      });\n                    } else {\n                      var error_obj = bizagi.util.getErrorFormatted(error);\n                      var message = error_obj && error_obj.message ? error_obj.message : error_obj || bizagi.localization.getResource(\"workportal-general-error\");\n\n                      bizagi.showMessageBox(message, \"Error\");\n                    }\n                  });\n                });\n                break;}\n\n          });\n        } });\n\n\n      return self.form.render();\n\n    }, function (error) {\n      var error_obj = bizagi.util.getErrorFormatted(error);\n      var message = error_obj.message || bizagi.localization.getResource(\"workportal-general-error\");\n      var form = self.getFormContainer();\n\n      if (typeof form !== \"undefined\") {\n        form.addValidationMessage(message);\n      }\n\n      deferred.reject();\n    }).done(function (element) {\n      self.inputEdition.html(element);\n\n      if (!self._isRefreshForm) {\n        self.getParams().navigation.navigate(self.container.id);\n      }\n\n      self.container.setNavigationButtons(self.form);\n\n      // Publish an event to check if the form has been set in the DOM\n      self.form.triggerHandler(\"ondomincluded\");\n\n      // Attach a refresh handler to recreate all the form\n      self.form.bind(\"refresh\", function () {\n        //TODO the parent who call this class implement redraw. see smartphone.grid _InternalRenderLinkForm\n        self.inputEdition.empty();\n        self._isRefreshForm = true;\n\n        //Adds the events to capture the\n        $.when(self.paintFormLink()).done(function () {\n        }).fail(function () {\n          self.submitRollbackRequest();\n        });\n      });\n\n      // Binds the view close event, and send the RollBack\n      self.container.element.bind(\"close\", function () {\n        self.rollbackForm();\n      });\n\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n\n    return deferred.promise();\n  },\n\n  rollbackForm: function rollbackForm() {\n    var self = this;\n    var form = self.form || self.getFormContainer();\n\n    $.when(self.submitRollbackRequest({ idPageCache: form.idPageCache })).done(function () {\n      // Sends additional rollback request to delete checkpoint from entry rule\n      if (self.properties.hasentryrule) {\n        self.submitRollbackRequest({ idPageCache: form.idPageCache });\n      }\n    });\n  },\n\n  saveRecord: function saveRecord() {\n    var self = this;\n    var deferred = $.Deferred();\n    var properties = self.properties;\n\n    if (self.form.validateForm()) {\n      var data = {};\n      self.form.collectRenderValues(data);\n      // Add page cache for this form\n      data.idPageCache = self.form.getPageCache();\n\n      $.when(self.submitSaveRequest(data)).done(function (result) {\n        try {\n          if (self.properties.hasExclusiveCheck && self.addExclusiveChange) {\n            self.addExclusiveChange(self.properties.idAsigned, data, self.parent);\n          }\n          var executeSubmitOnChange = true;\n          if (result && result.type === \"validationMessages\") {\n            executeSubmitOnChange = false;\n            deferred.reject(result);\n          }\n          if (properties.hasexitrule) {\n            self.closeExitRule().done(function () {\n              if (executeSubmitOnChange) {\n                self.resolveSubmitCommitRequest().then(function () {\n                  self.submitOnChange({}).then(function () {\n                    deferred.resolve(result);\n                    if (properties.hasentryrule) {\n                      self.resolveSubmitCommitRequest();\n                    }\n                  });\n                });\n              } else {\n                deferred.reject();\n              }\n            }).fail(function () {\n              deferred.reject();\n            });\n          } else if (executeSubmitOnChange) {\n            self.resolveSubmitCommitRequest().then(function () {\n              if (properties.hasentryrule) {\n                self.resolveSubmitCommitRequest().done(function () {\n                  self.submitOnChange({}).then(function () {\n                    deferred.resolve(result);\n                  });\n                });\n              } else {\n                self.submitOnChange({}).then(function () {\n                  deferred.resolve(result);\n                });\n              }\n            });\n          } else {\n            deferred.reject();\n          }\n        } catch (ex) {\n          deferred.reject();\n        }\n      }).fail(function (error) {\n        var err = JSON.parse(error.responseText || '{\"message\":\"\",\"code\":\"\"}');\n\n        if (err.code === \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1 &&\n        err.message.indexOf(\"was not found\") !== -1) {\n          deferred.reject({ error_code: 1, data: data });\n        } else {\n          deferred.reject(error);\n        }\n      });\n    } else {\n      deferred.reject();\n    }\n\n    return deferred.promise();\n  },\n\n  submitSaveRequest: function submitSaveRequest(data) {\n    var self = this;\n    var properties = self.properties;\n\n    // Don't send request when the link is not editable\n    if (properties.editable === false && !properties.value) {\n      return null;\n    }\n\n    var xpath = self.getFormLinkXpath();\n    var xpathContext = xpath;\n\n    if (properties.xpathContext !== undefined && properties.xpathContext !== \"\") {\n      xpathContext = xpath ? properties.xpathContext + \".\" + xpath : properties.xpathContext;\n    }\n\n    // SaveGridRecord\n    return self.dataService.saveGridRecord({\n      url: properties.saveUrl,\n      idRender: properties.id,\n      xpathContext: xpathContext,\n      submitData: data });\n\n  },\n\n  resolveSubmitCommitRequest: function resolveSubmitCommitRequest() {\n    var def = new $.Deferred();\n\n    this.submitCommitRequest().done(function () {\n      def.resolve();\n    }).fail(function (error) {\n      var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\n      if (err.code === \"UNKNOWN_ERROR\") {\n        def.resolve();\n      } else {\n        def.reject();\n      }\n    });\n\n    return def.promise();\n  },\n\n  resolveCheckpointRequest: function resolveCheckpointRequest() {\n    var def = new $.Deferred();\n\n    this.submitCheckpointRequest().done(function () {\n      def.resolve();\n    }).fail(function (error) {\n      var err = JSON.parse(error.responseText || \"{message:'', code: ''}\");\n\n      if (err.code === \"UNKNOWN_ERROR\" && err.message.indexOf(\"Requested value\") !== -1 &&\n      err.message.indexOf(\"was not found\") !== -1) {\n        def.resolve();\n      } else {\n        def.reject();\n      }\n    });\n\n    return def.promise();\n  },\n\n  closeExitRule: function closeExitRule() {\n    var def = new $.Deferred();\n\n    if (this.properties.hasexitrule) {\n      $.when(this.openLinkRule(\"exitrule\")).done(function (result) {\n        def.resolve(result);\n      }).fail(function () {\n        def.reject();\n      });\n    } else {\n      def.resolve();\n    }\n\n    return def.promise();\n  },\n\n  getFormLinkXpathContext: function getFormLinkXpathContext() {\n    var xpathContext = this.properties.xpathContext;\n    var parentXpathContext = this.getXpathContext();\n\n    if (parentXpathContext && xpathContext) {\n      return xpathContext.indexOf(parentXpathContext) === 0 ? xpathContext : parentXpathContext + \".\" + xpathContext;\n    } else {\n      return xpathContext;\n    }\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    this.attachEvents();\n  },\n\n  /**\r\n      * Configure event handlers\r\n      */\n  attachEvents: function attachEvents() {\n    var self = this;\n    var $control = self.getControl();\n\n    $(\"[data-action=open]\", $control).on(\"click\", function () {\n      bizagi.loading.start();\n\n      $.when(self.renderEdition()).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  processLayout: function processLayout(isLabelFormat) {\n    if (!isLabelFormat) {\n      this._super(isLabelFormat, this.properties.textFormat);\n    } else {\n      if (typeof this.properties.textFormat.background !== \"undefined\") {\n        this._super(isLabelFormat, { background: this.properties.textFormat.background });\n      }\n    }\n  },\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return $(\".bz-link\", $context);\n  },\n  /**\r\n      * Idle timer expired exception\r\n      * @param error\r\n      * @returns {boolean}\r\n      */\n  hasSessionFormException: function hasSessionFormException(error) {\n    return typeof error !== \"undefined\" && error.code === \"AUTH_ERROR\";\n  },\n\n  /**\r\n      * Navigate to main page\r\n      * @param error\r\n      */\n  goToStartPage: function goToStartPage(error) {\n    var navigation = this.getParams().navigation;\n    if (navigation) {\n      navigation.goToStartPage(error);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Geolocation Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the geolocation render class to adjust to Smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.geolocation\", bizagi.rendering.geolocation.prototype);\n// Extends itself\nbizagi.rendering.smartphone.geolocation.extend(\"bizagi.rendering.smartphone.geolocation\", {\n  ALLOW_UPDATE: \"update\" },\n{\n\n  /**\r\n   * Template method to implement in each device to customize each render after processed\r\n   */\n  postRender: function postRender() {\n    var $control = this.getControl();\n    this.coordinate = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var template = this.renderFactory.getTemplate(\"readonly\");\n\n    return $.fasttmpl(template, { value: this.getDisplayValue() });\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n    this.coordinate = $control.find(\"input\");\n\n    // Call base\n    this._super();\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var $control = self.getControl();\n\n    // If the control doesn't have a value set the position\n    if (self.value == null) {\n      self.updateDisplayValue();\n    }\n\n    $control.on(\"click\", \"[data-action=\" + self.Class.ALLOW_UPDATE + \"]\", self.processAction.bind(self));\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (value != null && value !== \"\") {\n      if (self.coordinate)\n      self.coordinate.val(self.performPrecision(value));\n\n      // Set internal value \n      self.setValue(value, false);\n      def.resolve();\n    } else {\n      var onSuccess = function onSuccess(position) {\n        var coordinates = position.coords.latitude + \" \" + position.coords.longitude;\n\n        self.coordinate.val(self.performPrecision(coordinates));\n\n        // Set internal value \n        self.setValue(coordinates, false);\n        def.resolve();\n      };\n\n      var onFail = function onFail(message) {\n        def.reject(message);\n      };\n\n      if (bizagi.util.isCordovaSupported() && bizagi.util.isiOSDevice()) {\n        navigator.geolocation.getCurrentPosition(onSuccess, onFail);\n      } else {\n        self.getCurrentPosition(onSuccess, onFail);\n      }\n    }\n\n    return def.promise();\n  },\n\n  updateDisplayValue: function updateDisplayValue() {\n    var self = this;\n\n    self.setDisplayValue().then(function () {\n      self.setValidationMessage(\"\");\n    }).fail(function (message) {\n      self.coordinate.val(\"\");\n      self.setValidationMessage(message);\n    });\n  },\n\n  /**\r\n      * Process an action in order to do something with the geolocation\r\n      */\n  processAction: function processAction() {\n    this.coordinate.empty();\n    this.updateDisplayValue();\n  },\n\n\n  getElementsToStylize: function getElementsToStylize($context) {\n    return this.properties.editable ? $(\"input\", $context) : $(\".readonly-control\", $context);\n  } });","/*\r\n*   Name: BizAgi smartphone Render Association\r\n*   Author: UI Forms Team\r\n*   Comments: Defines the association control\r\n*/\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.association\", bizagi.rendering.association.prototype);\n// Extends itself\nbizagi.rendering.smartphone.association.extend(\"bizagi.rendering.smartphone.association\", {}, {\n\n  /**\r\n                                                                                                  * Template method to implement in each children to customize each control\r\n                                                                                                  * \r\n                                                                                                  * @returns {} \r\n                                                                                                  */\n  renderControl: function renderControl() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"association\");\n    var def = new $.Deferred();\n\n    self.properties.property = \"flipped\";\n    self.properties.idRender = self.properties.id;\n\n    // Define flipped\n    $.when(self.getFlipAssociation()).done(function (flip) {\n      // Make json base, create self.properties.formatJson\n      self.makeJsonBase();\n\n      self.properties.flipped = bizagi.util.parseBoolean(flip) || false;\n\n      var columnData = self.getColumnData();\n\n      var html = $.fasttmpl(template, $.extend(self.properties, { columnData: columnData }), {\n        getColumnData: self.getColumnData,\n        getRightAssociation: self.getRightAssociation });\n\n\n      /* by default need set self.properties.formatJson */\n      self.setValue(JSON.encode(self.properties.formatJson));\n\n      def.resolve(html);\n    });\n    return def.promise();\n  },\n\n\n  /**\r\n      * Get Left Data, verify if flipper flags sets true\r\n      *\r\n      * @param column {'0'||'1'}\r\n      */\n  getColumnData: function getColumnData() {\n    var self = this;\n    var properties = self.properties;\n    var data = [];\n\n    self.data = properties;\n\n    var dataAssociation = properties.flipped ? properties.rightData : properties.leftData;\n\n    $.each(dataAssociation, function (key, item) {\n      data.push({\n        id: item.id,\n        value: item.value,\n        association: self.getRightAssociation(item.id) });\n\n    });\n\n    return data;\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    var isExecution = self.getMode() === \"execution\";\n    var $control = self.getControl();\n\n    // Cache control\n    self.association = $(\".bz-association\", $control);\n\n    // Add Events at Association Control\n    if (isExecution) {self.addEventControl();}\n\n    self.showDefaultGroupList();\n  },\n\n  showDefaultGroupList: function showDefaultGroupList() {\n    var self = this;\n    var $control = self.getControl();\n    var $groups = $('.bz-association-group', $control);\n\n    if ($groups.length > 0) {\n      $(\"[data-action='collapse']\", $groups[0]).toggleClass(\"bz-icn--expanded\");\n\n      $(\".bz-association-group__list\", $groups[0]).\n      slideDown(300, function () {\n        $(this).toggleClass(\"bz-association-group__list--hidden\");\n      });\n    }\n  },\n\n  /**\r\n      * Add event to control\r\n      * @returns {} \r\n      */\n  addEventControl: function addEventControl() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"association\");\n    var control = self.getControl();\n\n    // Bind check toggle\n    self.association.\n    on(\"change\", \"input:checkbox\", function () {\n      var $input = $(this);\n      var parentId = $input.data(\"parent-id\");\n      var id = $input.data(\"id\");\n\n      if ($input.prop(\"checked\")) {self.addElement(parentId, id);} else\n      {self.removeElement(parentId, id);}\n    });\n\n    // Bind flip actions\n    self.association.\n    find(\"[data-action='flip']\").\n    click(function () {\n      $(control).empty();\n\n      // Define flipped\n      self.properties.flipped = !self.properties.flipped;\n\n      // Send flip data to server\n      self.properties.flipstate = self.properties.flipped;\n\n      self.dataService.getFlipAssociation(self.properties);\n\n      var columnData = self.getColumnData();\n\n      // Render template\n      $($.fasttmpl(template, $.extend(self.properties, { columnData: columnData }), {\n        getColumnData: self.getColumnData,\n        getRightAssociation: self.getRightAssociation })).\n      appendTo(control);\n\n      self.postRender();\n    });\n\n    //header\n    self.association.on(\"click\", \"[data-action='collapse']\", function () {\n      var $element = $(this);\n      var $groupList =\n      $element.\n      parents('.bz-association-group').\n      find(\".bz-association-group__list\");\n\n      self.closeAccordionSection();\n      if ($groupList.hasClass(\"bz-association-group__list--hidden\")) {\n\n        $element.toggleClass(\"bz-icn--expanded\");\n\n        $groupList.slideDown(300, function () {\n          $(this).toggleClass(\"bz-association-group__list--hidden\");\n        });\n      }\n    });\n  },\n\n  closeAccordionSection: function closeAccordionSection(active) {\n    var self = this;\n    var $control = self.getControl();\n\n    $(\"[data-action='collapse']\", $control).removeClass('bz-icn--expanded');\n\n    $(\".bz-association-group__list\", $control).\n    slideUp(300, function () {\n      $(this).addClass(\"bz-association-group__list--hidden\");\n    });\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n\n    return self.renderControl();\n  },\n\n  /**\r\n      * Render for readonly\r\n      * @returns {} \r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.postRender();\n  },\n\n  /* SET-DISPLAY-VALUE\r\n      =====================================================*/\n  setDisplayValue: function setDisplayValue(value) {\n    // Set internal value\n    this.setValue(value, false);\n  },\n\n  getLabel: function getLabel() {\n    if (!this.label) {\n      var label = $(\"> .bz-form-label\", this.element || this.observableElement);\n\n      if (label.length > 0)\n      this.label = label;\n\n      return label;\n    }\n    return this.label;\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Search List Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the search-list render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.searchList\", bizagi.rendering.searchList.prototype);\n// Extends itself\nbizagi.rendering.smartphone.searchList.extend(\"bizagi.rendering.smartphone.searchList\", {\n  SEARCH_MIN_LENGTH: 2,\n  SEARCH_MAX_RECORDS: 50,\n  SEARCH_DELAY: 250,\n  SEARCH_ELEMENTS: {} },\n{\n\n  renderControl: function renderControl() {\n    var self = this;\n    var properties = self.properties;\n    var template = self.renderFactory.getTemplate(\"searchList\");\n\n    return $.fasttmpl(template, {\n      id: properties.id,\n      value: properties.value.map(function (el) {\n        return self.formatItem(el.value);\n      }).join(\", \") });\n\n  },\n\n  /**\r\n      * Template method to implement in each device to customize each render after processed\r\n      * @returns {}\r\n      */\n  postRender: function postRender() {\n    this.searchListInput = $(\".bz-search-list__input\", this.getControl());\n  },\n\n  postRenderReadOnly: function postRenderReadOnly() {\n    this.searchListInput = $(\".bz-search-list__input\", this.getControl());\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.readonly\");\n\n    // Render template\n    var content = $.fasttmpl(template, {\n      items: self.properties.value || {},\n      editable: self.properties.editable || true },\n    {\n      formatItem: self.formatItem });\n\n\n    return content;\n  },\n\n  /**\r\n      * Template method to implement in each device to customize the render's behaviour\r\n      * to add handlers\r\n      * @returns {}\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Select new item\n    self.searchListInput.on(\"click\", function (evt) {\n      var parent = $(evt.target).parent() || {};\n      if (parent.hasClass('bz-pill')) return;\n\n      self._searchListViewModal();\n    });\n  },\n\n  _searchListViewModal: function _searchListViewModal() {\n    var self = this;\n    var header = self.getHeaderTemplate();\n    var content = self.getContentTemplate();\n    var footer = self.getFooterTemplate();\n\n    self.searchListInput.mobileView({\n      customHeader: header,\n      orientation: self.properties.orientation || \"\",\n      cssClassHeader: \"bz-modal-view__header-multiple\",\n      contentTemplate: content,\n      footerTemplate: footer,\n      transition: \"slideIn:up\",\n      close: function close() {\n        $(window).unbind(\"resize\");\n        self.triggerGlobalHandler(\"modalViewDidDisappear\", {});\n      },\n      afterOpenAnimation: function afterOpenAnimation(event) {\n        var $context = $(\".bz-modal-view__search\", event.view.header);\n\n        // Fix the moving content to top\n        if ($context && $context[0]) {\n          $context[0].scrollIntoView(true);\n          $context.focus();\n        }\n      },\n      open: function open() {\n        self.triggerGlobalHandler(\"closeModalValidationMessage\", {});\n        self.triggerGlobalHandler(\"modalViewDidAppear\", {});\n      },\n      configureActions: function configureActions(context) {\n        self.adjustResize();\n        self.configureModalViewHandlers(context);\n      } });\n\n  },\n\n  /**\r\n      * Sets the value in the rendered control\r\n      * @param {} value\r\n      * @returns {}\r\n      */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\n\n    // Set internal value\n    self.setValue(finalValue);\n\n    if (value !== undefined) {\n      if (self.properties.editable) {\n        self.searchListInput.html(finalValue.map(function (el) {\n          return self.formatItem(el.value);\n        }).join(\", \"));\n      }\n    }\n  },\n\n  /**\r\n      * Remove a item from the list\r\n      * @param {} element\r\n      * @returns {}\r\n      */\n  deleteItem: function deleteItem(element) {\n    var self = this;\n    var item = element.parent('div');\n\n    // Remove from main memory and set the new value\n    self.removeElement({ id: item.data(\"id\") });\n\n    // Remove list element\n    item.remove();\n  },\n\n  selectItem: function selectItem(item) {\n    var templateItem = this.getTagTemplate(item, this.properties.editable);\n    this.modalViewTagList.append(templateItem);\n  },\n\n  /**\r\n      * Configure the modalView Handlers for the new suggest control\r\n      * @param {} inputContainer\r\n      * @returns {}\r\n      */\n  configureModalViewHandlers: function configureModalViewHandlers(modalView) {\n    var self = this;\n    var modalFooter = modalView.footer;\n    var modalHeader = modalView.header;\n\n    // Initialize data\n    var elements = {};\n\n    if (self.hasValue()) {\n      var list = self.getListItems();\n      $.each(list, function (index, item) {\n        elements[item.id] = item;\n      });\n    }\n\n    // Configuring list as a selectable element\n    self.modalViewList = $(\".bz-list\", modalView.content);\n    self.modalViewTagList = $(\".bz-search-pill__results\", modalHeader);\n\n    var $clearButton = $(\".bz-modal-view__clear\", modalHeader);\n\n    // Suggest\n    var $suggestInput = $(\".bz-modal-view__search\", modalHeader);\n    var suggestFilter = bizagi.util.debounce(function () {\n      if (this.value === \"\") {\n        $clearButton.removeClass(\"bz-modal-view__clear--visible\");\n      } else {\n        $clearButton.addClass(\"bz-modal-view__clear--visible\");\n      }\n      self.autoCompleteSearchResults($.trim(this.value));\n    }, this.Class.SEARCH_DELAY);\n\n    $suggestInput.on(\"change keyup\", suggestFilter).on(\"focus\", function () {\n      $(\".bz-search__header\", modalView.header).addClass(\"bz-search__header--active\");\n    }).on(\"blur\", function () {\n      $(\".bz-search__header\", modalView.header).addClass(\"bz-search__header--active\");\n    });\n\n    //Clear the search\n    $clearButton.bind(\"click\", function () {\n      $suggestInput.val(\"\").trigger(\"change\");\n    });\n\n    $(\"[data-action=close]\", modalView.header).bind(\"click\", function () {\n      modalView.close();\n    });\n\n    // Add tags to list\n    self.modalViewList.on(\"click\", \"li\", function () {\n      var item = $.data(this).item;\n\n      // Prevent duplicate elements\n      if (!item || item && elements[item.id]) return;\n      elements[item.id] = item;\n\n      // Update state of button\n      $(modalFooter).find('.bz-btn').removeClass(\"bz-btn--secundary\");\n      $(modalFooter).find('.bz-btn').addClass(\"bz-btn--primary\");\n\n      // Update list\n      if ((Object.keys(elements) || []).length === 1) {\n        $(modalHeader).find(\".bz-search-pill__selected \").\n        removeClass(\"bz-search-pill__selected--hidden\");\n      }\n\n      self.selectItem(item);\n    });\n\n    // Remove tags of list\n    self.modalViewTagList.on(\"click\", '.bz-pill > .bz-btn-icn', function (evt) {\n      evt.preventDefault();\n      evt.stopPropagation();\n\n      var element = $(this);\n      var tag = element.parent('div');\n\n      // Update state of button\n      $(modalFooter).find('.bz-btn').removeClass(\"bz-btn--secundary\");\n      $(modalFooter).find('.bz-btn').addClass(\"bz-btn--primary\");\n\n      // Remove from main memory and set the new value\n      delete elements[tag.data(\"id\")];\n\n      // Remove list element\n      tag.remove();\n\n      // Update list\n      if ((Object.keys(elements) || []).length === 0) {\n        $(modalHeader).find(\".bz-search-pill__selected \").\n        addClass(\"bz-search-pill__selected--hidden\");\n      }\n    });\n\n    $(modalFooter).delegate(\"[data-action=save]\", \"click\", function (evt) {\n      // Create a temporal array\n      var newList = [];\n      $.each(elements, function (index, item) {\n        newList.push(item);\n      });\n\n      self.setDisplayValue({ value: newList });\n\n      modalView.close();\n    });\n  },\n\n  autoCompleteSearchResults: function autoCompleteSearchResults(currentValue) {\n    var self = this;\n\n    $.when(self.processRequest({ term: currentValue })).\n    done(function (response) {\n\n      self.modalViewList.find(\"li\").remove();\n\n      for (var i = 0, length = response.length; i < length; i++) {\n        var searchItem = self.renderSearchItem(response[i]);\n\n        searchItem.appendTo(self.modalViewList);\n      }\n    });\n  },\n\n  renderSearchItem: function renderSearchItem(item) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.item\");\n\n    var searchItem = $.tmpl(template, {\n      id: item.id,\n      label: item.label,\n      value: this.formatItem(item.value) });\n\n\n    searchItem.data(\"item\", item);\n\n    return searchItem;\n  },\n\n  /**\r\n      * Process the request data for the autocomplete control\r\n      * @param {} req\r\n      * @returns {}\r\n      */\n  processRequest: function processRequest(req) {\n    var self = this;\n    var properties = self.properties;\n    var deferred = new $.Deferred();\n\n    // Create array for response objects   \n    var suggestions = [];\n\n    if (req.term.length >= this.Class.SEARCH_MIN_LENGTH) {\n\n      // Update term property to reflect the search\n      properties.term = req.term;\n\n      // Cancel previous request in order to improve the performance\n      if (self.deferredReference && typeof self.deferredReference.reject === \"function\" &&\n      self.deferredReference.state() !== \"resolved\") {\n        self.deferredReference.reject({ hideStatus: true });\n      }\n\n      self.deferredReference = self.getData().done(function (data) {\n        if (data && data.length > 0) {\n          data = data.slice(0, properties.maxRecords);\n\n          if (data.length > self.Class.SEARCH_MAX_RECORDS) {\n            data = data.slice(0, self.Class.SEARCH_MAX_RECORDS);\n\n            suggestions.push({\n              id: self.Class.NO_RESULTS_SEARCH_ID,\n              label: self.getResource(\"render-search-maximum-records-allowed\"),\n              value: \"\" });\n\n\n\n          } else {\n            data = data.slice(0, properties.maxRecords);\n          }\n\n          $.each(data, function (i, val) {\n            if (properties.maxRecords === 0 || i < properties.maxRecords) {\n              var parseValue = bizagi.util.performTermMatches(val.value, req.term);\n\n              suggestions.push({ id: val.id, label: parseValue, value: val.value });\n            }\n          });\n\n        } else {\n          suggestions.push({\n            id: self.Class.NO_RESULTS_SEARCH_ID,\n            label: self.getResource(\"render-grid-no-records\"),\n            value: \"\" });\n\n        }\n\n        deferred.resolve(suggestions);\n\n      }).fail(function () {\n        deferred.reject();\n      });\n\n    } else {\n      deferred.resolve(suggestions);\n    }\n\n    return deferred.promise();\n  },\n\n  getContentTemplate: function getContentTemplate() {\n    var self = this;\n    var value = self.getValue();\n    var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\n\n    var template = this.renderFactory.getTemplate(\"searchList.items\");\n    var content = $.fasttmpl(template, {\n      items: finalValue || {},\n      editable: self.properties.editable || true },\n    {\n      formatItem: self.formatItem });\n\n\n    return $.trim(content);\n  },\n\n  getFooterTemplate: function getFooterTemplate() {\n    var self = this;\n    var template = self.renderFactory.getTemplate(\"searchList.actions\");\n    var content = $.fasttmpl(template, {\n      items: self.properties.value || {},\n      editable: self.properties.editable || true });\n\n\n    return $.trim(content);\n  },\n\n  getTagTemplate: function getTagTemplate(item, editable) {\n    var template = this.renderFactory.getTemplate(\"searchList.tag\");\n    var content = $.fasttmpl(template, {\n      id: item.id,\n      label: item.label,\n      value: this.formatItem(item.value),\n      editable: editable });\n\n    return $.trim(content);\n  },\n\n  adjustResize: function adjustResize() {\n    var self = this;\n    var initialScreenSize = window.innerHeight;\n\n    $(window).off(\"resize\").on(\"resize\", bizagi.util.debounce(function () {\n      var that = $(this);\n\n      // Hide the footer\n      if (that.height() < initialScreenSize) {\n        $(\".bz-mobile-view__footer_content\").addClass(\"bz-hidden\");\n      } else {\n        $(\".bz-mobile-view__footer_content\").removeClass(\"bz-hidden\");\n      }\n    }, self.Class.SEARCH_DELAY));\n  },\n\n  getHeaderTemplate: function getHeaderTemplate() {\n    var self = this;\n    var value = self.getValue();\n    var finalValue = typeof value === \"string\" ? JSON.parse(value).value : value.value;\n    var template = this.renderFactory.getTemplate(\"searchList-modal-header\");\n\n    var content = $.fasttmpl(template, {\n      items: finalValue || {},\n      editable: self.properties.editable || true,\n      emptyItems: (finalValue || []).length === 0 },\n    {\n      formatItem: self.formatItem });\n\n\n    return $.trim(content);\n  } });","/**\r\n *   Name: Bizagi User Field render tablet Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will define the basic behaviour for userfields\r\n */\n\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.userfieldWrapper\", bizagi.rendering.userfieldWrapper.prototype);\nbizagi.rendering.smartphone.userfieldWrapper.extend(\"bizagi.rendering.smartphone.userfieldWrapper\", {}, {\n\n  /**\r\n                                                                                                           *   Load userfield\r\n                                                                                                           */\n  getUserfieldControl: function getUserfieldControl() {\n    var self = this;\n    var sControl = self.userfieldName;\n    var mode = self.getMode();\n    var exists = eval(\"typeof bizagi.rendering.smartphone.\" + sControl + \" !== 'undefined'\");\n    var def = new $.Deferred();\n\n    if (exists) {\n      // Creates the userfield instance\n      // Set true argument for tabItem\n      $.when(self.parent.ready()).done(function () {\n        def.resolve(self.createUserfieldInstance(sControl));\n      });\n\n    } else {\n      if (mode != \"execution\") {\n        setTimeout(function () {\n          $.when(self.triggerGlobalHandler(\"loadUserField\", { userfield: self.userfieldGuid, device: \"Smartphone\" })).\n          pipe(function (result) {\n            if (result) {\n              // Creates the userfield instance\n              def.resolve(self.createUserfieldInstance(sControl));\n            }\n          });\n        }, 10);\n\n      } else\n      {\n        // Call ajax service in order to retrieve user field definitions\n        $.when(self.dataService.getUserfieldDefinition({\n          userfield: self.userfieldGuid,\n          device: \"smartphone\" })).\n        pipe(function (data) {\n          // Load userfield in memory\n          self.loadUserfield(data);\n\n          // Creates the userfield instance\n          def.resolve(self.createUserfieldInstance(sControl));\n        });\n      }\n    }\n\n\n    return def.promise();\n  },\n\n  /**\r\n      * Creates the userfield instance when the userfield prototype is loaded in memory\r\n      */\n  createUserfieldInstance: function createUserfieldInstance(sControl) {\n    var self = this;\n    var control;\n    try {\n      // Create a dynamic function to avoid problem with eval calls when minifying the code\n      var dynamicFunction = \"var baDynamicFn = function(renderParams){ \\r\\n\";\n      dynamicFunction += \"return new bizagi.rendering.smartphone.\" + sControl + \"(renderParams);\\r\\n\";\n      dynamicFunction += \"}\\r\\n\";\n      dynamicFunction += \"baDynamicFn\";\n      dynamicFunction = eval(dynamicFunction);\n\n      // Call the dynamic function\n      control = dynamicFunction(self.initialParams);\n    } catch (e) {\n      // If the call fails, return the default user field\n      control = self.getUserFieldInstance(self.initialParams);\n    }\n    control.properties.isUserField = true;\n\n    // Save userfield instance\n    self.userfieldInstance = control;\n\n    // Create proxy methods from the wrapper to the userfield instance\n    self.replicateUserfieldMethods(control);\n\n    // Replicate renderchange event from wrapped element to grid if applies\n    self.userfieldInstance.bind(\"renderchange\", function (_, data) {\n      self.triggerHandler(\"renderchange\", data);\n    });\n\n    return control;\n  },\n\n  /**\r\n      * Load userfield into memory\r\n      */\n  loadUserfield: function loadUserfield(data) {\n    var self = this;\n    var styleContent = \"\";\n\n    self.properties.styleGuid = self.properties.styleGuid || Math.guid();\n\n    try {\n      // Parse data\n      try {\n        data = eval(data);\n      } catch (e) {\n        bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\n      }\n\n      // Iterate elements\n      $.each(data, function (index, val) {\n        if (val.type === \"js\") {\n          try {var\n            replaceWithDevice = function replaceWithDevice(str) {\n              return str.replace(/bizagi.rendering/gi, \"bizagi.rendering.smartphone\");\n            };\n\n            val.content = val.content.replace(/bizagi\\.rendering\\.[^\\s]+\\.extend(\\s|\\n|\\s)*\\((\\s|\\n|\\s)*\\\"bizagi\\.rendering\\.[^\\s]+\\\"/gmi, replaceWithDevice);\n            window.eval(val.content);\n          } catch (ex) {\n            bizagi.log(\"Could not parse result userfield3 \" + self.userfieldName, ex.message);\n          }\n        }\n        if (val.type === \"css\") {\n          styleContent += val.content;\n        }\n      });\n\n      if ($.trim(styleContent) !== \"\") {\n        bizagi.util.loadStyle(styleContent, self.properties.styleGuid);\n      }\n\n      // Replicate userfield methods to the wrapper\n      var control = eval(\"bizagi.rendering.\" + self.userfieldName);\n\n    } catch (e) {\n      bizagi.log(\"Could not parse result userfield \" + self.userfieldName, e.message);\n    }\n  },\n\n  getUserFieldInstance: function getUserFieldInstance(params) {\n    var mode = this.getMode();\n    // If the call fails, return the default user field\n    return mode === \"execution\" ?\n    new bizagi.rendering.smartphone.defaultUserField(params) :\n    new bizagi.rendering.smartphone.designUserField(params);\n  },\n\n  /*\r\n     *   Starts waiting signal for async stuff\r\n     */\n  startUserfieldLoading: function startUserfieldLoading() {\n    this.element.addClass(\"bz-form-userfield__loader\");\n  },\n\n  /*\r\n     *   Ends waiting for async stuff\r\n     */\n  endUserfieldLoading: function endUserfieldLoading() {\n    this.element.removeClass(\"bz-form-userfield__loader\");\n  } });\n\n\n// Auto-extension\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.basicUserField\", bizagi.rendering.userfieldDefinition.prototype);\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.basicUserField\", bizagi.rendering.basicUserField.prototype);\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.basicUserField\", {}, {\n\n  renderSingle: function renderSingle() {\n    return this.postRender();\n  },\n\n  renderEdition: function renderEdition() {\n    var self = this;\n    var defer = $.Deferred();\n    $.when(self.postRender()).done(function () {\n      $.when(self.renderUserfieldControl()).done(function () {\n\n        self.inputEdition = self.input;\n        // alert(\"render Edition\");\n        defer.resolve();\n      });\n\n    });\n\n    return defer.promise();\n  },\n\n  getEditableControl: function getEditableControl() {\n    if (!this.isSupported()) {\n      return bizagi.rendering.defaultUserField.prototype.getEditableControl.apply(this, arguments);\n    }\n  },\n\n  getReadonlyControl: function getReadonlyControl() {\n    if (!this.isSupported()) {\n      return bizagi.rendering.defaultUserField.prototype.getReadonlyControl.apply(this, arguments);\n    }\n  },\n\n  isSupported: function isSupported() {\n    return true;\n  } });\n\n\n/*\r\n        *   Default implementation for user fields\r\n        */\nbizagi.rendering.smartphone.basicUserField.extend(\"bizagi.rendering.smartphone.defaultUserField\", {}, {\n\n  /*\r\n                                                                                                        *   Template method to implement in each device to customize each render after processed\r\n                                                                                                        */\n  getEditableControl: function getEditableControl() {\n    var self = this;\n    var control = self.getControl();\n    var container = self.getContainerRender();\n    var properties = self.properties;\n    var controlName = properties.control.replace(/column/g, \"\");\n\n    self.input = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\n    self.input.addClass(\"ui-bizagi-render-userfield-notSupported\");\n\n    container.addClass(\"bz-command-not-edit\");\n\n    return self.input;\n  },\n\n  /*\r\n     *  Dont send the data to the server\r\n     */\n  collectData: function collectData(renderValues) {\n  },\n\n  getDisplayValue: function getDisplayValue() {\n    var self = this;\n    var properties = self.properties;\n    var controlName = properties.control;\n\n    return \"Userfield: \" + controlName + \" not found\";\n  },\n\n  getReadonlyControl: function getReadonlyControl() {\n    var self = this;\n    var control = self.getControl();\n    var properties = self.properties;\n    var controlName = properties.control;\n    var mycontrol = $(\"<label>Userfield: \" + controlName + \" not found</label>\").appendTo(control);\n\n    return mycontrol;\n  } });","/*\r\n *   Name: Bizagi Smartphone Render list Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the activity checkList render class to adjust to smartphone devices\r\n */\n\n// Extends from base list\nbizagi.rendering.smartphone.checkList.extend(\"bizagi.rendering.smartphone.activityCheckList\", {}, {\n\n  /**\r\n                                                                                                     * Update or init the element data\r\n                                                                                                     * @param data\r\n                                                                                                     */\n  initializeData: function initializeData(data) {\n    // Call base\n    this._super(data);\n    var goal = this.properties.activityDescription && this.properties.activityDescription !== \"\" ?\n    bizagi.localization.getResource(\"workportal-project-plan-activity-goal\") + \": \" + this.properties.activityDescription : \"\";\n    this.properties.displayName = goal !== \"\" ? goal : bizagi.localization.getResource(\"workportal-project-plan-activity-work-title\");\n    this.properties.displayType = \"vertical\";\n  },\n  /*\r\n      *   Template method to implement in each device to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var self = this;\n    var $control = self.getControl();\n    // Call base\n    this._super();\n\n    self.newItemName = $(\".bz-checkList__input\", $control);\n    self.addEditButton = $(\".add-edit-item-button-checklist\", $control);\n    self.cancelEditButton = $(\".cancel-edit-item-button-checklist\", $control);\n\n    self.additionalElements();\n    self.notifyLoadItems();\n  },\n\n  notifyLoadItems: function notifyLoadItems() {\n    var self = this;\n    setTimeout(function () {\n      var resolvedItems = self.properties.items.filter(function (i) {\n        return i.resolved;\n      }).length;\n      bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\n        'hasChanges': true,\n        'idActivity': self.properties.idActivity,\n        'itemsResolved': resolvedItems,\n        'items': self.properties.items,\n        'progress': self.properties.activityWork }));\n\n\n      bizagi.webpart.publish(\"onLoadDataItemsFromFormActivityPlan\", { \"items\": self.properties.items, \"activityWork\": self.properties.activityWork });\n    }, 100);\n  },\n\n  additionalElements: function additionalElements() {\n    var self = this;\n\n    if (self.addEditButton && self.addEditButton.length > 0) {\n      self.addEditButton.hide();\n    }\n    if (self.cancelEditButton && self.cancelEditButton.length > 0) {\n      self.cancelEditButton.hide();\n    }\n    //control.parent().addClass(\"render-activity-check\");\n  },\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var control = self.getControl();\n    this._super();\n    $(\"[data-action=add]\", control).unbind(\"click\").click(function () {\n      var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\n      if (itemSelected.length <= 0) {\n        self.prepareNewItem();\n      } else {\n        $(\".bz-checkList__input\", itemSelected).focus();\n      }\n    });\n\n    $(\"[data-action=delete]\", self.control).bind(\"click\", function () {\n      var that = this;\n      var message = bizagi.localization.getResource(\"workportal-widget-reports-confirm\");\n      var contentHolder = $(this).closest(\".bz-checkList__item\");\n\n      contentHolder.addClass(\"ui-bizagi-to-remove\");\n\n      $.when(bizagi.showConfirmationBox(message, \"Bizagi\", \"info\")).\n      done(function () {\n\n        var itemId = $(that).closest(\".bz-checkList__item\").data(\"item-guid\");\n\n        self.deleteItem(itemId);\n      }).fail(function () {\n        contentHolder.removeClass(\"ui-bizagi-to-remove\");\n      });\n    });\n\n    $(\"label[data-action=edit-item]\", self.control).bind(\"click\", function () {\n      var element = $(this).closest(\".bz-checkList__item\");\n      var itemId = element.data(\"item-guid\");\n      var itemPosition = element.data(\"item-position\");\n\n      self.selectItem(itemId, itemPosition);\n    });\n  },\n\n  selectItem: function selectItem(itemId) {\n    var self = this;\n\n    for (var i = 0, length = self.properties.items.length; i < length; i++) {\n      if (self.properties.items[i].guid === itemId) {\n        self.properties.items[i].selected = true;\n      } else {\n        self.properties.items[i].selected = false;\n      }\n    }\n\n    self.repaintControl();\n\n    var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.getControl());\n    var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n    var itemContent = itemSelectedName.val();\n\n    itemSelectedName.focus();\n    itemSelectedName[0].setSelectionRange(itemContent.length, itemContent.length);\n\n    self.addSelectedHandlers();\n  },\n\n  deleteItem: function deleteItem(itemId) {\n    var self = this;\n\n    for (var i = 0, length = self.properties.items.length; i < length; i++) {\n      if (self.properties.items[i].guid === itemId) {\n        self.properties.items.splice(i, 1);\n        break;\n      }\n    }\n\n    self.setValue(self.properties.items);\n    self.repaintControl();\n    self.addSelectedHandlers();\n  },\n\n  prepareNewItem: function prepareNewItem() {\n    var self = this;\n    var newItem = {\n      guid: Math.guid(),\n      resolved: false,\n      name: \"\",\n      selected: true };\n\n\n    self.properties.items.push(newItem);\n    self.repaintControl();\n    self.newItemName.focus();\n\n    self.newItemName.blur(function () {\n      var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\n      var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n      var valueInput = itemSelectedName.val();\n\n      if (valueInput === \"\" && self.properties.items && self.properties.items.length >= 1 &&\n      self.properties.items.slice(-1)[0].name === \"\") {\n        self.properties.items.pop();\n      }\n    });\n    self.addSelectedHandlers();\n    self.newItemName.keypress(function (event) {\n      if (event.which == 13) {\n        event.preventDefault();\n        self.addItem();\n        self.prepareNewItem();\n      }\n    });\n  },\n\n  addSelectedHandlers: function addSelectedHandlers() {\n    var self = this;\n    var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", self.control);\n    var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n    itemSelectedName.focus();\n    $(\"[data-action=accept-edit]\", itemSelected).bind(\"click\", function () {\n      var newItemName = itemSelectedName.val();\n      if (newItemName && newItemName !== \"\") {\n        self.addItem();\n      }\n    });\n\n\n    $(\"[data-action=cancel-edit]\", itemSelected).bind(\"click\", function (e) {\n      var newItemName = itemSelectedName.val();\n      var element = $(this).closest(\".bz-checkList__item\");\n      var itemPosition = element.data(\"item-position\");\n      var guidItem = element.data(\"item-guid\");\n\n      if (newItemName && newItemName !== \"\" && self.properties.items[itemPosition].name !== \"\") {\n        self.properties.items[itemPosition].selected = false;\n      }\n      if (newItemName === \"\" || self.properties.items[itemPosition].name === \"\") {\n        self.deleteItem(guidItem);\n      }\n      //self.addButton.show();\n      self.repaintControl();\n    });\n  },\n\n  addItem: function addItem() {\n    var self = this;\n    var $control = self.getControl();\n\n    var itemSelected = $(\".bz-checkList__item.bz-checkList__item--selected\", $control);\n    var itemSelectedName = $(\".bz-checkList__input\", itemSelected);\n    var newItemName = itemSelectedName.val();\n\n    $.each(self.properties.items, function (index, item) {\n      if (item.selected) {\n        item.name = newItemName;\n        item.selected = false;\n      }\n    });\n    self.updateOriginalValue();\n    self.setValue(self.properties.items);\n    self.repaintControl();\n  },\n\n  repaintControl: function repaintControl() {\n    var self = this;\n    var checkListHtml = self.renderControl();\n    $(\"[data-component=checkList]\", self.control).replaceWith(checkListHtml);\n    self.postRender();\n    self.configureHandlers();\n  },\n\n  onCheckListGroupChange: function onCheckListGroupChange(itemId, checked) {\n    var self = this;\n    var item;\n    var items = $.grep(self.properties.items, function (element, index) {\n      return element.guid === itemId;\n    });\n    if (items && items.length > 0) {\n      item = items[0];\n    }\n    item.resolved = checked;\n    self.setValue(self.properties.items);\n    self.refreshValue(self.properties.items);\n  },\n\n  refreshValue: function refreshValue(items) {\n    var self = this,\n    length = items.length,\n    completed = 0;\n\n    for (var i = 0; i < length; i++) {\n      if (items[i].resolved) {\n        completed += 1;\n      }\n    }\n\n    if (length > 0) {\n      self.properties.activityWork = Math.floor(100 * completed / length);\n    } else\n    {\n      self.properties.activityWork = 100;\n    }\n\n    self.notifyLoadItems();\n  },\n\n  getValue: function getValue() {\n    var self = this;\n    return self.value || [];\n  },\n\n  controlValueIsChanged: function controlValueIsChanged() {\n    var self = this;\n    var originalValue = JSON.stringify(self.properties.originalValue);\n    var newValue = JSON.stringify(self.value);\n    return originalValue !== newValue;\n  },\n\n  /*\r\n      *   Updates original value for some comparisons\r\n      */\n  updateOriginalValue: function updateOriginalValue() {\n    var self = this;\n    self.properties.originalValue = bizagi.clone(self.value);\n  },\n\n  /*\r\n      *   Add the render data to the given collection in order to send data to the server\r\n      */\n  collectData: function collectData(renderValues) {\n    var self = this;\n    var properties = self.properties;\n\n    // Add the render value\n    var xpath = properties.xpath;\n    var value = self.getValue();\n    var idActivity = self.properties.idActivity;\n\n    if (self.controlValueIsChanged()) {\n      // Filter by valid xpaths and valid values\n      if (!bizagi.util.isEmpty(xpath) && !bizagi.util.isEmpty(idActivity)) {\n        if (Array.isArray(value)) {\n          renderValues[properties.xpath] = {\n            idActivity: idActivity,\n            items: value };\n\n        } else if (value === \"\") {\n          renderValues[properties.xpath] = \"\";\n        }\n      }\n    } else {\n      bizagi.util.setItemLocalStorage(\"newChanges\", JSON.stringify({\n        'hasChanges': false }));\n\n    }\n  },\n\n  isValid: function isValid(invalidElements) {\n    var self = this,\n    properties = self.properties,\n    message;\n    var items = self.getValue();\n    message = self.getResource(\"render-activity-check-list-validation\");\n    for (var i = 0; i < items.length; i += 1) {\n      var item = items[i];\n      if (!item.resolved) {\n        invalidElements.push({\n          xpath: properties.xpath,\n          message: message });\n\n        break;\n      }\n    }\n  } });","/*\r\n*   Name: Bizagi smartphone Render Number Extension\r\n*   Author: Bizagi Mobile Team \r\n*   Comments:\r\n*   -   This script will redefine the number render class to adjust to smartphone devices\r\n*/\n\n// Extends from render smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.numberScientificNotation\", bizagi.rendering.numberScientificNotation.prototype);\n// Extends itself\nbizagi.rendering.smartphone.numberScientificNotation.extend(\"bizagi.rendering.smartphone.numberScientificNotation\", {}, {});","/*  \r\n *   Name: Bizagi Smartphone Range Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range render class to adjust to smartphone devices\r\n */\n\n// Extends from render Smartphone base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.range\", bizagi.rendering.range.prototype);\n// Extends itself\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.range\", {}, {\n\n  /**\r\n                                                                                     * Render a specific implementation for Smartphone device\r\n                                                                                     */\n  postRender: function postRender() {\n    var properties = this.properties;\n  },\n  /**\r\n      * Render actual value of control and set events\r\n      * @param data\r\n      */\n  setDisplayValue: function setDisplayValue(data) {\n    var control = this.getControl();\n  } });","/*  \r\n *   Name: Bizagi Smartphone Range Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range date render class to adjust to smartphone devices\r\n */\n\n// Extends from range smartphone base\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeDate\", bizagi.rendering.rangeDate.prototype);\n// Extends itself\nbizagi.rendering.smartphone.rangeDate.extend(\"bizagi.rendering.smartphone.rangeDate\", {}, {\n\n  /**\r\n                                                                                             * Render a specific implementation for Desktop device\r\n                                                                                             */\n  postRender: function postRender() {\n    this.defineRangeControl();\n  } });","/*  \r\n *   Name: Bizagi Smartphone Money Date Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range money render class to adjust to smartphone devices\r\n */\n\n// Extends from range smartphone base\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeMoney\", bizagi.rendering.rangeMoney.prototype);\n// Extends itself\nbizagi.rendering.smartphone.rangeMoney.extend(\"bizagi.rendering.smartphone.rangeMoney\", {}, {\n\n  /**\r\n                                                                                               * Render a specific implementation for Desktop device\r\n                                                                                               */\n  postRender: function postRender() {\n    this.defineRangeControl();\n  } });","/*  \r\n *   Name: Bizagi Smartphone Range Number Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the range number render class to adjust to smartphone devices\r\n */\n\n// Extends from range smartphone base\nbizagi.rendering.smartphone.range.extend(\"bizagi.rendering.smartphone.rangeNumber\", bizagi.rendering.rangeNumber.prototype);\n// Extends itself\nbizagi.rendering.smartphone.rangeNumber.extend(\"bizagi.rendering.smartphone.rangeNumber\", {}, {\n\n  /**\r\n                                                                                                 * Render a specific implementation for Desktop device\r\n                                                                                                 */\n  postRender: function postRender() {\n    this.defineRangeControl();\n  } });","/*\r\n*   Name: BizAgi Desktop Render Template Text Extension\r\n*   Author: Andrs Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the layout render class to adjust to desktop devices\r\n*/\n\n// Extends from render desktop base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.layoutRender\", bizagi.rendering.layoutRender.prototype);","/*\r\n *   Name: BizAgi Render Layout Image Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable image control inside templates\r\n *   -   This control is based on the image no flash render control\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutImage\", bizagi.rendering.layoutImage.prototype);\n\nbizagi.rendering.smartphone.layoutImage.extend(\"bizagi.rendering.smartphone.layoutImage\", {},\n{\n\n  renderControl: function renderControl() {\n    var self = this;\n    var templateUri = self.renderFactory.getTemplate(\"layout-image\");\n    self.control = self.getControl();\n    return $.fasttmpl(templateUri, {});\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    var control = self.getControl();\n\n    if (self.value && typeof self.value.value !== \"undefined\" && self.value.value !== \"\" && self.value.value !== null) {\n      //Get image of customer in binary format\n      var url = self.getImageUri();\n      $.ajax({\n        url: url,\n        type: \"GET\",\n        dataType: \"binary\",\n        processData: false,\n        success: function success(blob) {\n\n          if (typeof blob == \"string\") {\n            var xhr = arguments[2];\n            var contentType = xhr.getResponseHeader('Content-type');\n            blob = bizagi.util.media.byteArrayToBlob(bizagi.util.media.stringToByteArray(blob), contentType);\n          }\n\n          var urlCreator = window.URL || window.webkitURL;\n          var imageUrl = urlCreator.createObjectURL(blob);\n\n          $(control).find('img').attr(\"src\", imageUrl);\n        } });\n\n    }\n  },\n\n  /**\r\n      * Gets the url to get the array image\r\n      */\n  getImageUri: function getImageUri() {\n    var self = this;\n\n    var map = {\n      entity: self.value.guid,\n      surrogateKey: self.value.surrogateKey,\n      xpath: self.properties.xpath,\n      width: 96,\n      height: 96,\n      hash: self.value.value };\n\n\n    return self.dataService.serviceLocator.getUrl(\"render-entity-layout-imageByteArray\").replaceMultiple(map);\n  },\n  /**\r\n      *   Sets the value in the rendered control\r\n      */\n  getDisplayValue: function getDisplayValue() {\n    var self = this;\n    return [self.value];\n  } });","/*\r\n *   Name: BizAgi Render Layout Label Class\r\n *   Author: Mauricio Snchez\r\n *   Comments:\r\n *   -   This script will define basic stuff for labels inside templates\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutPlaceholder\", bizagi.rendering.layoutPlaceholder.prototype);","/*\r\n*   Name: BizAgi Render Layout Boolean Class\r\n*   Author: Alexander Mejia\r\n*   Comments:\r\n*   -   This script will define basic stuff for boolean renders inside templates\r\n*/\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutBoolean\", bizagi.rendering.layoutBoolean.prototype);","/*\r\n *   Name: BizAgi Render Layout Simple Link Class\r\n *   Author: Ricardo Prez\r\n *   Comments:\r\n *   -   This script will define basic stuff for non editable link renders inside templates\r\n *   -   This control is based on the link render control\r\n */\n\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutLink\", bizagi.rendering.layoutLink.prototype);\n\nbizagi.rendering.smartphone.layoutLink.extend(\"bizagi.rendering.smartphone.layoutLink\", {\n\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var element = self.element;\n    if (element) {\n      element.on(\"click\", $.proxy(self.onClickElement, self));\n    }\n  },\n\n  onClickElement: function onClickElement() {\n    var self = this,\n    params = {\n      \"displayName\": self.properties.displayName,\n      \"navigateFromRender\": false,\n      \"reference\": self.properties.reference,\n      \"referenceType\": self.properties.referenceType,\n      \"xpath\": self.properties.xpath };\n\n    if (bizagi.kendoMobileApplication && bizagi.kendoMobileApplication.view().id == \"#renderSplitView\") {\n      params.navigateFromRender = true;\n    }\n    self.triggerGlobalHandler(\"DATA-NAVIGATION\", params);\n  } });","/*\r\n*   Name: BizAgi Render Layout Label Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for labels inside templates\r\n*/\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutLabel\", bizagi.rendering.layoutLabel.prototype);\n\nbizagi.rendering.smartphone.layoutLabel.extend(\"bizagi.rendering.smartphone.layoutLabel\", {\n\n  setValue: function setValue(val, triggerEvents) {\n    var self = this;\n    self.properties.displayName = val;\n    this._super(val, triggerEvents);\n    var control = self.getControl();\n    if (control) {\n      $(\".ui-bizagi-render-label\", control).text(val);\n    }\n  } });","/*\r\n*   Name: BizAgi Render Layout Text Class\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will define basic stuff for text renders inside templates\r\n*/\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutText\", bizagi.rendering.layoutText.prototype);\n\nbizagi.rendering.smartphone.layoutText.extend(\"bizagi.rendering.smartphone.layoutText\", {\n  setDisplayValue: function setDisplayValue(value) {\n  } });","/*\r\n*   Name: BizAgi Desktop Render Template dateTime Extension\r\n*   Author: Andres Fernando Muoz\r\n*   Comments:\r\n*   -   This script will redefine the date time render class inside templates to adjust to desktop devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutDateTime\", bizagi.rendering.layoutDateTime.prototype);","/*\r\n *   Name: BizAgi Desktop Render Template number Extension\r\n *   Author: Mauricio Sanchez\r\n *   Comments:\r\n *   -   This script will redefine the number render class inside templates to adjust to desktop devices\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutNumber\", bizagi.rendering.layoutNumber.prototype);\n\nbizagi.rendering.smartphone.layoutNumber.extend(\"bizagi.rendering.smartphone.layoutNumber\", {\n  /**\r\n                                                                                               * Sets the value in the rendered control\r\n                                                                                               */\n  setValue: function setValue(val, triggerEvents) {\n    var self = this;\n    var control = self.getControl();\n    val = typeof val === \"undefined\" || val === null ? \"\" : self.getDisplayValue(val);\n    self.properties.displayName = val;\n\n    this._super(val, triggerEvents);\n    if (control) {\n      $(\".ui-bizagi-render-number\", control).text(val);\n    }\n  },\n\n  /**\r\n      * Returns the display value of the render\r\n      */\n  getDisplayValue: function getDisplayValue(value) {\n    var self = this;\n    var properties = self.properties;\n    var label = $('<label/>').html(value); // To get the display value by the format currency plugin, because it requires a control\n\n    label.formatCurrency({\n      symbol: properties.symbol,\n      positiveFormat: properties.positiveFormat,\n      negativeFormat: properties.negativeFormat,\n      decimalSymbol: properties.decimalSymbol,\n      digitGroupSymbol: properties.digitGroupSymbol,\n      groupDigits: properties.groupDigits,\n      roundToDecimalPlace: properties.numDecimals,\n      colorize: properties.colorize });\n\n\n    return [label.text()];\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Template Money Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the money render class inside templates to adjust to smartphone devices\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutMoney\", bizagi.rendering.layoutNumber.prototype);\n// Extends itself\nbizagi.rendering.smartphone.layoutMoney.extend(\"bizagi.rendering.smartphone.layoutMoney\", bizagi.rendering.layoutMoney.prototype);\nbizagi.rendering.smartphone.layoutMoney.extend(\"bizagi.rendering.smartphone.layoutMoney\", {\n  /**\r\n                                                                                             * Sets the value in the rendered control\r\n                                                                                             */\n  setValue: function setValue(val, triggerEvents) {\n    var self = this;\n    var control = self.getControl();\n\n    val = typeof val === \"undefined\" || val === null ? \"\" : self.getDisplayValue(val);\n    self.properties.displayName = val;\n\n    this._super(val, triggerEvents);\n    if (control) {\n      $(\".ui-bizagi-render-number\", control).text(val);\n    }\n  } });","/*\r\n *   Name: BizAgi Desktop Render Layout Upload\r\n *   Author: Bizagi\r\n *   Comments:\r\n *   -   This script will define the upload on entity template\r\n */\n\nbizagi.rendering.smartphone.layoutRender.extend(\"bizagi.rendering.smartphone.layoutUpload\", bizagi.rendering.layoutUpload.prototype);\n\nbizagi.rendering.smartphone.layoutUpload.extend(\"bizagi.rendering.smartphone.layoutUpload\", {\n  /**\r\n                                                                                               *   Template method to implement in each children to customize each control\r\n                                                                                               */\n  renderControl: function renderControl() {\n    var self = this,\n    properties = self.properties,\n    defer = $.Deferred();\n\n    $.when(self.getValueFilesByData(bizagi.clone(properties))).done(function (properties, valueResult) {\n      self.properties = properties;\n      self.files = valueResult.files;\n      defer.resolve(self.getHTMLFiles());\n    });\n\n    return defer.promise();\n  },\n\n  postRender: function postRender() {\n    var self = this;\n    var control = self.getControl();\n    var filesLinkElements = control.find(\".ui-bizagi-render-upload-item a\");\n\n    filesLinkElements.on(\"click\", function () {\n      bizagi.loading.start();\n      $.when(bizagi.util.media.downloadFile($(this).attr(\"data-url\"), this.title)).fail(function (error) {\n        if (error.responseText) {\n          self.getFormContainer().failHandler(error.responseText);\n        }\n      }).always(function () {\n        bizagi.loading.stop();\n      });\n    });\n  },\n\n  getHTMLFiles: function getHTMLFiles() {\n    var self = this;\n    var files = $.map(self.files, function (el) {\n      var file = { \"id\": el[0], \"filename\": el[1] };\n      file.url = self.buildItemUrl(file);\n      return file;\n    });\n\n    var template = self.renderFactory.getTemplate(\"layout-upload\");\n    return $.fasttmpl(template, { \"files\": files });\n  },\n\n  /**\r\n      *   Builds the upload item url\r\n      */\n  buildItemUrl: function buildItemUrl(file) {\n    var self = this,\n    properties = self.properties;\n\n    var form = self.getFormContainer();\n\n    return self.dataService.getUploadFileEntityUrl({\n      isContextContainerWidgetRender: self.isContextContainerWidgetRender(),\n      xpath: self.getUploadXpath(),\n      fileId: file.id,\n      idRender: form.properties.paramsRender.idRender || \"undefined\",\n      xpathContext: properties.xpathContext,\n      idPageCache: form.properties.paramsRender.idPageCache || \"undefined\",\n      xpathActions: form.properties.paramsRender.xpathActions || \"undefined\",\n      sessionId: form.properties.sessionId,\n      surrogatekey: self.properties.value.surrogateKey,\n      guidentity: self.properties.value.guid });\n\n  } });","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\n\n\n// Extends itself\nbizagi.rendering.columns.column.extend(\"bizagi.rendering.smartphone.columns.column\", {}, {\n\n  /*\r\n                                                                                           *   Apply custom overrides to each decorated instance\r\n                                                                                           */\n  applyOverrides: function applyOverrides(decorated) {\n    // Hacks the getControl method in the decorated render to add features\n    if (decorated && decorated.getControl) {\n      this.originalGetControl = decorated.getControl;\n      decorated.getControl = this.getControl;\n      decorated.properties.displayType = \"normal\";\n    }\n  },\n\n  getContainerMessage: function getContainerMessage(surrogateKey) {\n    var decorated = this.getDecorated(surrogateKey);\n    return $(\".bz-form-cell-message__text\", decorated.element);\n  },\n\n  /*\r\n     *   Template method to get the control element\r\n     *   This code runs under the decorated element context\r\n     */\n  getControl: function getControl() {\n    return $(\".bz-control\", this.element || this.observableElement);\n  },\n\n  isValueValid: function isValueValid(surrogateKey, value, messages, propertyOverrides) {\n    var isValid = this._super(surrogateKey, value, messages, propertyOverrides);\n    var decorated = this.getDecorated(surrogateKey);\n    var $message = this.getContainerMessage(surrogateKey);\n\n    if (decorated && decorated.element) {\n      if (!isValid) {\n        var message = messages.join(\",\").replace(/<\\w+>([^<]*)<\\/\\w+>/g, \"$1\");\n        $message.text(message);\n        decorated.element.addClass(\"bz-form-item--error\");\n      } else {\n        $message.text(\"\");\n        decorated.element.removeClass(\"bz-form-item--error\");\n      }\n    }\n\n    return isValid;\n  },\n\n  /*\r\n     *   Apply column styles to a specified element\r\n     */\n  applyColumnStyles: function applyColumnStyles(element) {\n    var self = this;\n    var properties = self.properties;\n\n    // Set cell back color\n    if (properties.textFormat.background) {\n      element.css(\"background-color\", properties.textFormat.background);\n      element.css(\"background-image\", \"none\");\n    }\n  },\n\n  /*\r\n     *   Post process the element after it has been rendered\r\n     */\n  postRenderReadOnly: function postRenderReadOnly(surrogateKey, cell) {\n    var self = this;\n\n    // Call base        \n    self._super(surrogateKey, cell);\n\n    // Just draw render if the cell layout has been filled\n    if (cell && cell.length > 0) {\n      var cellIcon = $(\".ui-bizagi-cell-icon\", cell);\n      if (!self.properties.editable) cellIcon.detach();\n\n      // Apply styles to cell\n      self.applyColumnStyles(cell);\n\n      if (self.properties.align == \"left\") {\n        cellIcon.addClass(\"ui-bizagi-cell-icon-right\");\n      }\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone Render Document Generator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to smartphone devices\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.document\", {}, {\n\n  /**\r\n                                                                                                         * Apply custom overrides to each decorated instance\r\n                                                                                                         * @param decorated\r\n                                                                                                         */\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n    var mode = self.getMode();\n\n    self._super(decorated);\n\n    if (mode !== \"design\") {\n      self.surrogateKey = decorated.surrogateKey;\n\n      decorated.getXpath = this.getXpath;\n      decorated.getDocumentXpath = this.getDocumentXpath;\n      decorated.getContextXpath = this.getContextXpath;\n      decorated.documentTemplateGenerate = this.documentTemplateGenerate;\n      decorated.preRenderControl = this.preRenderControl;\n      decorated.deleteDocumentTemplate = this.deleteDocumentTemplate;\n      decorated.properties.xpathContext = self.getContextXpath();\n    }\n  },\n\n  /**\r\n      * This method tries to get the HTML template an render the current object inside\r\n      * @return {jQuery} $.Deferred()\r\n      */\n  renderControl: function renderControl() {\n    this.preRenderControl();\n\n    return this._super();\n  },\n\n  /**\r\n      * Creates the event of generation of templates.\r\n      */\n  documentTemplateGenerate: function documentTemplateGenerate() {\n    var self = this;\n    var properties = self.properties;\n\n    self.startLoading();\n\n    // Get the context xPath\n    properties.xpathcontext = self.getContextXpath();\n    properties.xpath = self.getDocumentXpath(properties.xpath);\n\n    var grid = self.parent;\n    var form = self.getFormContainer();\n\n    $.when(form.submitData()).done(function () {\n      $.when(self.dataService.generateDocumentTemplate(properties)).done(function (response) {\n        $.when(grid.refresh()).done(function () {\n          self.autoOpenDocuments();\n        });\n\n        self.endLoading();\n\n      }).fail(function () {\n        self.showErrorMessage();\n        self.endLoading();\n      });\n    }).fail(function (message) {\n      // Add error messages\n      self.getFormContainer().addErrorMessage(message);\n\n      self.endLoading();\n    });\n  },\n\n  /**\r\n      * Apply custom overrides to each decorated instance\r\n      * @param xpath\r\n      * @returns {string}\r\n      */\n  getXpath: function getXpath(xpath) {\n    var xpathPath = xpath;\n    var index = xpathPath.indexOf(this.grid.properties.xpath);\n\n    if (index !== -1) {\n      xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\n    }\n\n    return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\n  },\n\n  /**\r\n      * Returns the xpath to be used\r\n      * @param xpath\r\n      * @returns {*|string}\r\n      */\n  getDocumentXpath: function getDocumentXpath(xpath) {\n    var xpathPath = xpath;\n    var index = xpathPath.indexOf(this.grid.properties.xpath);\n\n    if (index !== -1) {\n      xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\n    }\n\n    return xpathPath;\n  },\n\n  /**\r\n      * Post process the element after it has been rendered\r\n      * @param surrogateKey\r\n      * @param cell\r\n      * @param tableCell\r\n      */\n  postRenderReadOnly: function postRenderReadOnly(surrogateKey, cell, tableCell) {\n    // Call base\n    this._super(surrogateKey, cell, tableCell);\n  },\n\n  /**\r\n      * Returns the xpath to be used\r\n      * @returns {string}\r\n      */\n  getContextXpath: function getContextXpath() {\n    var self = this;\n    var form = self.getFormContainer();\n    var xpathContext = form.properties.xpathContext ? form.properties.xpathContext + \".\" : \"\";\n    return xpathContext + this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\n  },\n\n  /**\r\n      * Template method to implement in each children to customize each control\r\n      */\n  preRenderControl: function preRenderControl() {\n    if (this.value != undefined && this.properties.value != undefined) {\n      this.properties.value = this.value;\n    }\n  },\n\n  /**\r\n      * Creates the event of generation of templates.\r\n      * @param filename\r\n      */\n  deleteDocumentTemplate: function deleteDocumentTemplate(filename) {\n    var self = this;\n    var grid = self.parent;\n    var params = {};\n\n    params.xpath = self.properties.xpath + \"[fileName='\" + filename + \"']\";\n    params.idRender = self.properties.id;\n    params.xpathContext = self.getContextXpath();\n    params.idPageCache = self.properties.idPageCache;\n\n    $.when(self.dataService.deleteUploadFile(params)).done(function () {\n      grid.refresh();\n    });\n  } });","/*\r\n*   Name: Bizagi Smartphone Date Column Decorator Extension\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will redefine the date column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.date\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Text Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the text column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.text\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Number Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the number column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.number\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Column Decorator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n */\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.image\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n\n    this._super(decorated);\n\n    var propertiesGrid = self.grid.properties != \"undefined\" ? self.grid.properties : decorated.grid.properties;\n    var xpath = propertiesGrid.xpath + \"[id=\" + decorated.surrogateKey + \"]\";\n    //decorated.getUploadXpath = this.getUploadXpath;\n    decorated.properties.xpathContext =\n    self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\n    decorated.setDisplayValue = function () {\n      return true;\n    };\n  }\n  /**\r\n     * Returns the xpath to be used  \r\n     * @returns {} \r\n     */\n  /*getUploadXpath: function() {\r\n            return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + this.properties.xpath;\r\n        }*/ });","/*\r\n*   Name: Bizagi smartphone Upload Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the upload column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.upload\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n    var mode = self.getMode();\n\n    self._super(decorated);\n\n    if (mode != \"design\" && mode != \"layout\") {\n\n      decorated.getUploadXpath = self.getUploadXpath;\n\n      decorated.getXpathContext = function () {\n\n        var surrogateKey = this.surrogateKey || \"\";\n        var columnXpath = self.getUploadXpath(decorated);\n        var columnXpathSplit = columnXpath.split(\".\");\n        var nameFile = columnXpathSplit[columnXpathSplit.length - 1];\n        var xpath = self.grid.properties.xpath + \"[id=\" + surrogateKey + \"]\";\n\n        var xpathContext = self.properties.xpathContext.length > 0 ? self.properties.xpathContext + \".\" + xpath : xpath;\n\n        return { xpathContext: xpathContext, nameFile: nameFile };\n      };\n\n      decorated.buildItemUrl = function (file) {\n        var that = this;\n        var form = that.getFormContainer();\n        var context = that.getXpathContext();\n\n        return that.dataService.getUploadFileUrl({\n          idRender: that.properties.id,\n          xpath: context.nameFile,\n          xpathContext: context.xpathContext,\n          idPageCache: that.properties.idPageCache,\n          fileId: file.id,\n          sessionId: form.properties.sessionId,\n          contexttype: that.properties.contexttype });\n\n      };\n\n    }\n  },\n\n  /**\r\n      * Returns the xpath to be used  \r\n      * @param {} decorated \r\n      * @returns {} \r\n      */\n  getUploadXpath: function getUploadXpath(decorated) {\n    var self = decorated || this;\n\n    return self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"].\" + self.properties.xpath;\n  } });","/**\r\n *   Name: Bizagi Smartphone Link Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the number column decorator class to adjust to smartphone devices\r\n */\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.link\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    var self = this;\n    var mode = self.getMode();\n\n    self._super(decorated);\n\n    if (mode !== \"design\" && mode !== \"layout\") {\n      self.surrogateKey = decorated.surrogateKey;\n\n      decorated.getXpath = self.getXpath;\n      decorated.properties.xpathContext = self.grid.properties.xpath + \"[id=\" + self.surrogateKey + \"]\";\n\n      if (self.grid.properties.xpathContext && decorated.properties.xpathContext.indexOf(self.grid.properties.xpathContext) === -1) {\n        decorated.properties.xpathContext = self.grid.properties.xpathContext + \".\" + decorated.properties.xpathContext;\n      }\n\n    }\n\n    if (decorated.properties.type === \"columnFormLink\") {\n      decorated.getFormLinkXpath = this.getFormLinkXpath;\n    }\n  },\n\n  /**\r\n      * Apply custom overrides to each decorated instance\r\n      * @param {} xpath\r\n      * @returns {}\r\n      */\n  getXpath: function getXpath(xpath) {\n    var xpathPath = xpath;\n    var index = xpathPath.indexOf(this.grid.properties.xpath);\n\n    if (index !== -1) {\n      xpathPath = xpathPath.substr(index + this.grid.properties.xpath.length + 1);\n    }\n\n    return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"].\" + xpathPath;\n  },\n\n  /**\r\n      * Returns the xpath to be used\r\n      * @returns {}\r\n      */\n  getContextXpath: function getContextXpath() {\n    return this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\n  },\n\n  /**\r\n      * Get Form Link xpath to use\r\n      * @returns {*}\r\n      */\n  getFormLinkXpath: function getFormLinkXpath() {\n    // Calculate layout properties to maximized property\n    this.properties.maximized = bizagi.util.parseBoolean(this.properties.maximized) !== null ? bizagi.util.parseBoolean(this.properties.maximized) : false;\n    this.calculateInitialLayoutProperties();\n\n    if (!this.properties.xpath) return;\n    return this.properties.xpath;\n  } });","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\n\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.search\", {}, bizagi.rendering.columns.search.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.search.extend(\"bizagi.rendering.smartphone.columns.search\", {}, {\n\n  applyOverrides: function applyOverrides(decorated) {\n    this._super(decorated);\n  },\n\n  render: function render(surrogateKey, value) {\n    var self = this;\n    if (value && value.length > 0) {\n      value = [].concat(value[0]);\n      return self._super(surrogateKey, {\n        id: value[0],\n        label: value[1],\n        additionallabel: value[2] || undefined });\n\n    } else {\n      return self._super(surrogateKey, value);\n    }\n  },\n\n  /*\r\n     *   Post process the element after it has been rendered\r\n     */\n  postRender: function postRender(surrogateKey, cell) {\n    // Call base\n    this._super(surrogateKey, cell);\n    var decorated = this.getDecorated(surrogateKey);\n    decorated.refreshControl = this.refreshControl;\n  },\n\n  refreshControl: function refreshControl() {\n    this.grid.refreshCell({\n      key: this.surrogateKey,\n      column: this.properties.xpath,\n      xpathContext: this.getFormContainer().properties.xpathContext });\n\n  } });","/*\r\n*   Name: Bizagi Smartphone ECM Column Decorator Extension\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will redefine the ECM column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.uploadecm\", {}, {\n\n  /**\r\n                                                                                                          * Apply custom overrides to each decorated instance\r\n                                                                                                          * @param {} decorated      \r\n                                                                                                          */\n  applyOverrides: function applyOverrides(decorated) {\n    this._super(decorated);\n\n    if (decorated && decorated.getControl) {\n      this.originalGetControl = decorated.getControl;\n      decorated.getControl = this.getControl;\n    }\n\n    decorated.getUploadXpath = this.getUploadXpath;\n    decorated.getXpathContext = this.getECMXpathContext;\n\n    decorated.buildItemUrl = function (file) {\n      var self = this;\n      var properties = self.properties;\n      var form = self.getFormContainer();\n      var columnXpath = self.getUploadXpath(self.surrogateKey);\n\n      columnXpath = columnXpath.split(\".\");\n\n      var nameFile = columnXpath[columnXpath.length - 1];\n      var xpathContext = self.getXpathContext(self.surrogateKey);\n\n      return self.dataService.getUploadFileUrl({\n        idRender: properties.id,\n        xpath: nameFile,\n        xpathContext: xpathContext,\n        idPageCache: properties.idPageCache,\n        fileId: file.idFileUpload,\n        sessionId: form.properties.sessionId,\n        contexttype: properties.contexttype });\n\n    };\n\n    decorated.buildAddParams = function () {\n      var self = this;\n      var properties = self.properties;\n      var form = self.getFormContainer();\n      var columnXpath = self.getUploadXpath(self.surrogateKey);\n\n      columnXpath = columnXpath.split(\".\");\n      var nameFile = columnXpath[columnXpath.length - 1];\n      var xpathContext = self.getXpathContext(self.surrogateKey);\n\n      var data = {\n        url: properties.addUrl,\n        xpath: properties.xpath,\n        idAttrib: properties.idAttrib,\n        xpathContext: xpathContext,\n        metaValues: [],\n        idSession: form.properties.sessionId,\n        contexttype: \"entity\",\n        validExtensions: properties.validExtensions,\n        maxSize: properties.maxSize };\n\n\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = properties.idPageCache;\n\n      return data;\n    };\n  },\n\n  /**\r\n      * Post process the element after it has been rendered\r\n      * @param {} surrogateKey      \r\n      */\n  getUploadXpath: function getUploadXpath(surrogateKey) {\n    surrogateKey = this.surrogateKey || surrogateKey || \"\";\n    return this.grid.properties.xpath + \"[id=\" + surrogateKey + \"].\" + this.properties.xpath;\n  },\n\n\n  getControl: function getControl() {\n    var result = this._super();\n\n    if (!result || result.length == 0) {\n      return $(\".ui-bizagi-cell-readonly\", this.element || this.observableElement);\n    } else {\n      return $(\".bz-control\", this.element || this.observableElement);\n    }\n\n  },\n\n  getECMXpathContext: function getECMXpathContext() {\n    var xpath = this.grid.properties.xpath + \"[id=\" + this.surrogateKey + \"]\";\n\n    return this.column.properties.xpathContext ? this.column.properties.xpathContext + \".\" + xpath : xpath;\n  } });","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.button\", {}, {});","/**\r\n *   Name: Bizagi Smartphone Radio Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the Radio column decorator class to adjust to smartphone devices\r\n */\n\n// Extends from column\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.radio\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Column Decorator Extension\r\n*   Author: Bizagi UI Forms\r\n*   Comments:\r\n*   -   This script will redefine the column decorator class to adjust to Smartphone devices\r\n*/\n\n// Extends itself\nbizagi.rendering.smartphone.columns.combo.extend(\"bizagi.rendering.smartphone.columns.list\", {}, {});","/*\r\n*   Name: Bizagi Smartphone Date Column Decorator Extension\r\n*   Author: Ricardo Prez\r\n*   Comments:\r\n*   -   This script will redefine the check column to adjust to smartphone devices\r\n*/\n\n// Extends from column\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.exclusiveCheck\", {}, {\n\n  /*\r\n                                                                                                               *   Returns the in-memory processed element\r\n                                                                                                               *   so the caller could append it to any place\r\n                                                                                                               */\n  render: function render(surrogateKey, value) {\n\n    var self = this;\n    // Set flag to check when a render has changed\n    self.changed = false;\n    var properties = self.properties;\n    var form = self.getFormContainer();\n    var gridChanges = self.grid.changes;\n    // Set grid and id references to the control in order to render the content\n    var decorated = self.getDecorated(surrogateKey);\n    decorated.grid = self.grid;\n    decorated.column = this;\n    decorated.surrogateKey = surrogateKey;\n\n    value = self.mapValue(value);\n    // Set cell value\n    if (self.getMode() == \"execution\") {\n      self.setValue(surrogateKey, value);\n      //Add to enabledCheck\n      if (form.isOfflineForm) {\n        self.mapEnabledOfflineChecks();\n      } else\n      {\n        self.mapEnabledCheck(surrogateKey, value);\n      }\n    }\n    if (value == null) {\n      self.changed = true;\n      var obj = {};\n      obj[self.properties.xpath] = self.getValue(surrogateKey);\n      if (bizagi.util.isEmpty(gridChanges[surrogateKey])) gridChanges[surrogateKey] = {};\n      gridChanges[surrogateKey] = $.extend({}, gridChanges[surrogateKey], obj);\n    }\n\n    // Override render properties\n    self.overrideDecoratedRenderProperties(surrogateKey);\n\n\n    // If the render is not editable return the readonly version of the column\n    if (!properties.editable)\n    return self.renderReadOnly.apply(self, arguments);\n\n    // Returns the decorated render inside a custom layout for columns\n    self.readyDeferred = new $.Deferred();\n    var cell = decorated.render(\"cell\");\n\n    // If the render changes set the flag on\n    decorated.bind(\"renderchange\", function () {\n      self.changed = true;\n      var checkList = self.grid.enabledChecks[self.properties.xpath];\n\n      checkList.forEach(function (el) {\n        if (el.id == surrogateKey) {\n          el.value = decorated.value;\n          el.changed = true;\n        } else\n        if (decorated.value && el.value) {\n          var tmpDecorated = self.getDecorated(el.id);\n          tmpDecorated.setDisplayValue(false);\n          self.setValue(el.id, false);\n          el.value = false;\n          el.changed = true;\n          if (form.isOfflineForm) {\n            self.handleOfflineChange(tmpDecorated, el);\n          }\n        }\n      });\n\n      var simpleXpathArray = self.properties.xpath.split(\".\");\n      self.grid.exclusiveChanges[self.properties.xpath] = {\n        xpath: self.properties.xpath,\n        simpleXpath: simpleXpathArray[simpleXpathArray.length - 1],\n        value: self.getValue(surrogateKey),\n        key: surrogateKey };\n\n    });\n\n    self.bind(\"rendered\", function () {\n      self.readyDeferred.resolve();\n    });\n\n\n    return cell;\n  },\n\n  /*\r\n      *   Post process the element after it has been rendered\r\n      */\n  postRender: function postRender(surrogateKey, cell) {\n    // Call base\n    this._super(surrogateKey, cell);\n\n    var self = this;\n    var mode = self.getMode();\n\n    this.setSurrogateKey(surrogateKey);\n    if (mode == \"execution\") {\n\n      var decorated = this.getDecorated(surrogateKey);\n      var control = decorated.getControl();\n\n      // Check if its new row\n      if (control.parents(\"tr\").data(\"new-row\")) {\n        // Show a disabled check box\n        control.html('<input type=\"checkbox\" name=\"exclusiveCheck\" title=\"' + bizagi.localization.getResource('render-grid-column-button-mandatory-key') + '\" disabled=\"disabled\" style=\"width:16.5px;height:16.5px;\">');\n\n        //Set the column with this attribute, so when the control is evaluated in isValid(), validated\n        //also if it is required, and belongs from a new row\n        self.isNewRow = true;\n      } else {\n        self.isNewRow = false;\n      }\n    }\n  },\n\n  isValueValid: function isValueValid(surrogateKey, value, invalidElements, propertyOverrides) {\n    var self = this;\n    self.grid.enabledChecks = self.grid.enabledChecks || {};\n    var checkedValues = (self.grid.enabledChecks[self.properties.xpath] || []).filter(function (el) {\n      return el.value;\n    });\n\n    if (checkedValues.length > 1) {\n      var message = self.getResource(\"render-exclusive-column-check-error\").replaceAll(\"#label#\", self.properties.displayName);\n      /* var messageData = {xpath: self.properties.xpath, message: message}; */\n      invalidElements.push(message);\n      return false;\n    } else {\n      return true;\n    }\n\n  },\n  /**\r\n     * Add change in grid changes and update grid data rows\r\n     * @param {*} decorated \r\n     * @param {*} element \r\n     */\n  handleOfflineChange: function handleOfflineChange(decorated, element) {\n    var self = this;\n    var gridChanges = self.grid.changes;\n    var newChange = {};\n    newChange[decorated.properties.xpath] = element.value;\n    if (bizagi.util.isEmpty(gridChanges[element.id])) gridChanges[element.id] = {};\n    gridChanges[element.id] = $.extend({}, gridChanges[element.id], newChange);\n    //Update grid data (grid.properties.data.completeRows)\n    self.updateGridData(element);\n  },\n  /**\r\n      * Update completeRows property of grid \r\n      */\n  updateGridData: function updateGridData(element) {\n    var gridProperties = this.grid.properties || {};\n    var data = gridProperties.data || {};\n    var row = (data.completeRows || []).find(function (r) {\n      return r[0] === element.id;\n    });\n    if (row && typeof row[this.columnIndex] !== \"undefined\") {\n      row[this.columnIndex] = element.value || false;\n    }\n  },\n  /**\r\n      * Add all enabled checks in offline grid\r\n      */\n  mapEnabledOfflineChecks: function mapEnabledOfflineChecks() {\n    var self = this;\n\n    var gridProperties = self.grid.properties || {};\n    var data = gridProperties.data || {};\n    var allRows = data.completeRows || [];\n    var columnIndex = self.columnIndex;\n    var enabledChecks = self.grid.enabledChecks;\n\n    allRows.forEach(function (row) {\n      var rowId = row[0];\n      var rowValue = row[columnIndex];\n\n      var tmpCheck = enabledChecks[self.properties.xpath].find(function (el) {\n        return el.id == rowId;\n      });\n\n      if (typeof tmpCheck === \"undefined\") {\n        enabledChecks[self.properties.xpath].push({\n          id: rowId,\n          value: rowValue,\n          originalValue: rowValue,\n          changed: false });\n\n      }\n    });\n  },\n  /**\r\n      * Add current check in enabled check\r\n      * @param {*} surrogateKey \r\n      * @param {*} value \r\n      */\n  mapEnabledCheck: function mapEnabledCheck(surrogateKey, value) {\n    var self = this;\n    var enabledChecks = self.grid.enabledChecks;\n\n    var tmpCheck = enabledChecks[self.properties.xpath].find(function (el) {\n      return el.id == surrogateKey;\n    });\n    if (typeof tmpCheck == \"undefined\") {\n      enabledChecks[self.properties.xpath].push({\n        id: surrogateKey,\n        value: value || false,\n        originalValue: value || false,\n        changed: false });\n\n    }\n  },\n  mapValue: function mapValue(value) {\n    var self = this;\n    value = value || false;\n    self.grid.changes = self.grid.changes || {};\n\n    if (value) {\n      for (var key in self.grid.changes) {\n        var changes = self.grid.changes;\n        if (changes[key][self.properties.xpath] && key != self.surrogateKey) {\n          value = false;\n          break;\n        }\n      }\n    }\n    return value;\n  } });","/**\r\n *   Name: Bizagi Smartphone Column Decorator Extension\r\n *   Author: Bizagi UI Forms\r\n *   Comments:\r\n *   -   This script will redefine the column decorator class to adjust to smartphone devices\r\n */\n\n// Extends from columns smartphone base\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.readonly\", bizagi.rendering.columns.readonly.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.readonly.extend(\"bizagi.rendering.smartphone.columns.readonly\", {}, {});","/**\r\n *   Name: Bizagi Render Hidden Column Decorator Class\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the hidden render class to adjust to smartphone devices\r\n */\n\n// Extends from columns smartphone base\nbizagi.rendering.smartphone.columns.column.extend(\"bizagi.rendering.smartphone.columns.hidden\", bizagi.rendering.columns.hidden.prototype);\n// Extends itself\nbizagi.rendering.smartphone.columns.hidden.extend(\"bizagi.rendering.smartphone.columns.hidden\", {}, {});","/**\r\n *   Name: Bizagi smartphone Render Document Generator Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the document generator render class to adjust to smartphone devices\r\n */\n\n// Extends from render smartphone base and document base\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.document\", bizagi.rendering.document.prototype);\n// Extends itself\nbizagi.rendering.smartphone.document.extend(\"bizagi.rendering.smartphone.document\", {\n  ACTION_SHOW: \"show\",\n  ACTION_DOWNLOAD: \"download\",\n  ACTION_DELETE: \"delete\" },\n{\n\n  /**\r\n   * This method tries to get the HTML template an render the current object inside\r\n   * @return {jQuery} $.Deferred()\r\n   */\n  renderControl: function renderControl() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(self.getTemplate());\n    var documents = this.properties.value || [];\n\n    var data = {\n      downloadalldocuments: this.properties.downloadalldocuments,\n      allowgenerate: this.properties.allowGenerate,\n      noFiles: documents ? documents.length === 0 : true,\n      append: this.properties.append,\n      caption: this.properties.caption };\n\n\n    // Render template\n    var html = $.fasttmpl(template, data);\n\n    // Render current children\n    var items = this.renderDocumentsHtml(documents);\n    html = this.replaceFilesHtml(html, items);\n\n    // Render current children\n    var actions = this.renderActionsHtml(documents, data.noFiles, data.downloadalldocuments);\n    html = this.replaceActionsHtml(html, actions);\n\n    return html;\n  },\n\n  /**\r\n      * Method to customize each render after processed\r\n      */\n  postRender: function postRender() {\n    var $control = this.getControl();\n\n    this.$inputDocument = $(\".bz-document-template__container\", $control);\n    this.$listDocuments = $(\"[data-component=files]\", $control);\n    this.$listActions = $(\"[data-component=actions]\", $control);\n\n    this._super();\n  },\n\n  /**\r\n      * Method to render non editable values\r\n      * @returns {*|jQuery}\r\n      */\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var template = this.renderFactory.getTemplate(self.getTemplateReadonly());\n    var documents = this.properties.value || [];\n    var noFiles = documents ? documents.length === 0 : true;\n\n    // Render template\n    var html = $.fasttmpl(template, { noFiles: noFiles });\n\n    // Render current children\n    var items = this.renderDocumentsHtml(documents);\n    html = this.replaceFilesHtml(html, items);\n\n    return html;\n  },\n\n  /**\r\n      * Method to customize each render after processed in read-only mode\r\n      */\n  postRenderReadOnly: function postRenderReadOnly() {\n    var $control = this.getControl();\n\n    this.$listDocuments = $(\"[data-component=files]\", $control);\n  },\n\n  /**\r\n      * TMethod to customize the render's behaviour to add handlers\r\n      */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n\n    // Attach handler\n    this.$inputDocument.on(\"click\", function (evt) {\n      self.properties.buttonExecuted = true;\n\n      if (self.properties.validate) {\n        // Check if the form is valid, then generate\n        if (self.validateContainer()) self.documentTemplateGenerate();\n      } else {\n        // Just generate the form\n        self.documentTemplateGenerate();\n      }\n\n      self.properties.buttonExecuted = false;\n    });\n\n    // Configure delete and preview handler\n    this.$listDocuments.on(\"click\", \"[data-action]\", function (evt) {\n      var $context = $(this);\n\n      var item = $context.parent(\".bz-document\");\n      var documentFile = item.data();\n      var action = $context.data(\"action\");\n\n      self.processAction(action, documentFile);\n    });\n\n    // Configure delete and download handler\n    self.$listActions.on(\"click\", \"[data-action]\", function (evt) {\n      var $context = $(this);\n\n      var item = $context.parent(\".bz-document__download\");\n      var documentFile = item.data();\n      var action = $context.data(\"action\");\n\n      self.processAction(action, documentFile);\n    });\n  },\n\n  /**\r\n      * Method to customize the render's behaviour to add handlers when the control is readonly\r\n      */\n  configureHandlersReadOnly: function configureHandlersReadOnly() {\n    var self = this;\n\n    // Configure delete and preview handler\n    this.$listDocuments.on(\"click\", \"[data-action]\", function (evt) {\n      var $context = $(this);\n\n      var item = $context.parent(\".bz-document\");\n      var documentFile = item.data();\n      var action = $context.data(\"action\");\n\n      self.processAction(action, documentFile);\n    });\n  },\n\n  /**\r\n      * This method must be implemented by the specific class of each device. (Virtual method)\r\n      * @param file\r\n      * @returns {*|*|*}\r\n      */\n  renderAllDocumentDownload: function renderAllDocumentDownload(file) {\n    var self = this;\n    var template = self.renderFactory.getTemplate(self.getTemplateDownload());\n    var url = self.buildAllDocumentsUrl();\n\n    // Don't render urls when not running in execution mode\n    if (!this.isExecutionMode()) url = \"javascript:void(0);\";\n\n    var html = $.fasttmpl(template, {\n      url: url,\n      filename: file.fileName,\n      joined: true });\n\n\n    return html;\n  },\n\n  /**\r\n      * Redraw documents when needed\r\n      * @param documents\r\n      * @param noFiles\r\n      * @param downloadAllDocuments\r\n      */\n  redrawDocuments: function redrawDocuments(documents, noFiles, downloadAllDocuments) {\n    var self = this;\n    var $control = self.getControl();\n    var $documentContainer = $(\"[data-component='files']\", $control);\n    var $actionContainer = $(\"[data-component='actions']\", $control);\n\n    // Clear current links\n    $documentContainer.empty();\n    $actionContainer.empty();\n\n    // Draw links again\n    var items = this.renderDocumentsHtml(documents);\n    $documentContainer.append(items);\n\n    // Check if there are documents and the flag to download all are available to show the link.\n    var actions = this.renderActionsHtml(documents, noFiles, downloadAllDocuments);\n    $actionContainer.append(actions);\n\n    //Set value\n    self.setValue(documents);\n  },\n\n  /**\r\n      * Method to customize each render after processed (Virtual method)\r\n      * @param url\r\n      * @param filename\r\n      */\n  showDocumentPreview: function showDocumentPreview(url, filename) {\n    bizagi.loading.start();\n\n    $.when(bizagi.util.media.downloadFile(url, filename)).\n    fail(function (error) {\n      if (error.responseText) {\n        self.getFormContainer().failHandler(error.responseText);\n      }\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Process request of DocumentTemplateGenerate action\r\n      * @param documents\r\n      * @param noFiles\r\n      * @param downloadAllDocuments\r\n      */\n  resolveDocumentTemplateGenerate: function resolveDocumentTemplateGenerate(documents, noFiles, downloadAllDocuments) {\n    // Redraw documents\n    this.redrawDocuments(documents, noFiles, downloadAllDocuments);\n    this.value = documents;\n  },\n\n  /**\r\n      * Process request of DocumentTemplateGenerate action\r\n      * @param documents\r\n      * @param noFiles\r\n      * @param downloadAllDocuments\r\n      */\n  resolveDeleteDocumentTemplate: function resolveDeleteDocumentTemplate(documents, noFiles, downloadAllDocuments) {\n    // Redraw documents\n    this.redrawDocuments(documents, noFiles, downloadAllDocuments);\n    this.value = documents;\n  },\n\n  processAction: function processAction(action, documentFile) {\n    if (action === this.Class.ACTION_DELETE) {\n      this.deleteDocumentTemplate(documentFile.filename);\n    } else if (action === this.Class.ACTION_SHOW) {\n      this.showDocumentPreview(documentFile.url, documentFile.filename);\n    } else if (action === this.Class.ACTION_DOWNLOAD) {\n      this.showDocumentPreview(documentFile.url, documentFile.filename);\n    }\n  } });","/**\r\n *   Name: Bizagi Smartphone queryForm Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the container class to adjust to smartphone devices\r\n *   -   Will apply a desktop form template\r\n */\n\n// Extends from form smartphone base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.queryForm\", {}, {});","/**\r\n *   Name: Bizagi Smartphone FormTemplate Extension\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script will redefine the form template class to adjust to smartphone devices\r\n */\n\n// Extends from form smartphone base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.formTemplate\", bizagi.rendering.formTemplate.prototype);\n// Extends itself\nbizagi.rendering.smartphone.formTemplate.extend(\"bizagi.rendering.smartphone.formTemplate\", {}, {});","/**\r\n *   Name: Bizagi Rendering Users Form\r\n *   Author: UI Forms Team\r\n *   Comments:\r\n *   -   This script override rendering.form to create and update users\r\n */\n\n// Extends from container smartphone form base\nbizagi.rendering.smartphone.form.extend(\"bizagi.rendering.smartphone.usersForm\", {}, {});","/*\r\n *   Name: BizAgi Render Text Class\r\n *   Author: Ricardo Perez\r\n *   Comments:\r\n *   -   This script will define basic stuff for text renders\r\n */\n\nbizagi.rendering.smartphone.render.extend(\"bizagi.rendering.smartphone.specific_text\", {}, {\n\n  /*\r\n                                                                                             *   Update or init the element data\r\n                                                                                             */\n  initializeData: function initializeData(data) {\n    var self = this;\n    // Call base\n    this._super(data);\n\n    // Fill default properties\n    var properties = this.properties;\n    if (properties.regularExpressionExpression) {\n      properties.regularExpression = {\n        \"expression\": properties.regularExpressionExpression,\n        \"message\": properties.regularExpressionMessage || this.getResource(\"render-text-regular-expression-default-message\") };\n\n    }\n  },\n  /*\r\n     *   Template method to implement in each children to customize each control\r\n     */\n  renderControl: function renderControl() {\n    var self = this;\n    var properties = self.properties;\n    var template = self.renderFactory.getTemplate(\"text\");\n    // Render template\n    var html = $.fasttmpl(template, { value: properties.value, \"isEmptyField\": typeof properties.value === \"undefined\", helpText: properties.helpText, editable: properties.editable });\n    return html;\n  },\n\n  renderReadOnly: function renderReadOnly() {\n    var self = this;\n    var properties = self.properties;\n    var template = self.renderFactory.getTemplate(\"text-read-only\");\n\n    // Render template\n    var html = $.fasttmpl(template, { value: self.getValue() });\n    return html;\n  },\n\n  /*\r\n     *   Template method to implement in each device to customize each render after processed\r\n     */\n  postRender: function postRender() {\n    var self = this;\n    var control = self.getControl();\n    var properties = self.properties;\n\n    // Call base\n    self._super();\n\n    self.input = control.find(\"input\");\n    //Attach event for retype double\n    if (properties.retype == \"double\") {\n      self.attachRetypeDouble();\n    }\n\n  },\n  attachRetypeDouble: function attachRetypeDouble() {\n    var self = this;\n    var element = self.element;\n\n    var input = $(\"input\", element);\n    if (!input || input.length == 0) return;\n\n    // Apply blur handler to check value\n    input.blur(function () {\n      var control = $(this);\n      if ($(control).attr(\"type\") != \"hidden\" &&\n      $(control).css(\"display\") != \"none\" &&\n      $(control).css(\"visibility\") != \"hidden\") {\n\n        if (!control.data(\"oldValue\") || $(this).data(\"oldValue\") == \"\") {\n\n          // Check that there is something in the value\n          if (control.val() == \"\")\n          return;\n\n          // Check if a value has already been set\n          if (control.val() == control.attr(\"newValue\"))\n          return;\n\n          control.data(\"oldValue\", control.val());\n          control.val(\"\");\n          // Create new tooltip\n          try {\n            control.tooltip(\"destroy\");\n          } catch (e) {}\n          control.attr(\"title\", self.getResource(\"render-number-retype\")); //\"Re-escriba el valor\"\n          control.tooltip();\n          control.tooltip(\"open\");\n          // Focus after 100ms to avoid bubbling\n          setTimeout(function () {control.focus();input.focus();}, 100);\n\n        } else\n\n        {\n          if (control.val() != control.data(\"oldValue\")) {\n            self.setValue(\"\");\n            control.val(\"\");\n            control.data(\"oldValue\", \"\");\n            control.tooltip(\"destroy\");\n            control.attr(\"title\", self.getResource(\"render-text-retype-error\"));\n            control.tooltip();\n            control.tooltip(\"open\");\n            setTimeout(function () {control.focus();}, 100);\n          } else {\n\n            control.data(\"newValue\", control.val());\n            control.data(\"oldValue\", \"\");\n            // Destroy tooltips\n            control.tooltip(\"destroy\");\n          }\n\n        }\n      }\n    });\n\n  },\n  /*\r\n     *   Template method to implement in each device to customize the render's behaviour to add handlers\r\n     */\n  configureHandlers: function configureHandlers() {\n    var self = this;\n    var properties = self.properties;\n    var control = self.getControl();\n    var input = self.input;\n\n    // Check mask property\n    if (properties.mask) {\n      self.input.mask({ mask: properties.mask });\n    }\n\n    // Attach change event\n    self.input.bind(\"change\", function () {\n\n      // Updates internal value\n      var oldValue = self.getValue();\n      self.setValue(self.input.val(), false);\n\n      // Check that the value is valid\n      var validationMessages = [];\n      if (properties.retype != \"duplicate\") {\n        if (self.isValid(validationMessages) || typeof properties.regularExpression == \"undefined\") {\n          // Update value again triggering handlers\n          self.setValue(self.input.val(), true);\n        } else {\n          // Set error message\n          message = validationMessages[0].message;\n          //bizagi.showMessageBox(message, \"Bizagi\", \"error\");\n        }\n      }\n\n    }).keypress(function (e) {\n      e = window.event || e;\n      var keyUnicode = e.charCode || e.keyCode;\n      if (e !== undefined) {\n        if (keyUnicode == 13) {\n          $(this).trigger(\"change\");\n        }\n      }\n    });\n  },\n  /* \r\n     * Public method to determine if a value is valid or not\r\n     */\n  isValid: function isValid(invalidElements) {\n    var self = this,\n    properties = self.properties;\n\n    // Call base\n    var bValid = this._super(invalidElements);\n    var value = self.getValue();\n\n    //When the form have big data, block browser executing RegExp. QAF-1418.\n    // Check regular expression\n    if (typeof value == \"string\") {\n      if (properties.regularExpression) {\n        if (value && (value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\")) || !value.match(new RegExp(properties.regularExpression.expression)) && self.properties && self.properties.xpath === \"userName\")) {\n          var message = properties.regularExpression.message;\n          invalidElements.push({ xpath: properties.xpath, message: message });\n          bValid = false;\n        } else {\n          if (value && (value.match(new RegExp(\".*?(<|\\\\u003C)(.+?)(>|\\\\u003E)(.?)|eval\\\\(|eval\\\\u0028\", \"g\")) || !value.match(new RegExp(properties.regularExpression.expression)))) {\n            var message = properties.regularExpression.message;\n            invalidElements.push({ xpath: properties.xpath, message: message });\n            bValid = false;\n          }\n        }\n      } else {\n        //strange behavior on IE. When matchs are united on IE have is very slow\n        //solution, divide matchs\n        //.*? means for more information search: \"Lazy matching regexp\"\n        if (value && value.match(new RegExp(\".*?eval\\\\(\", \"g\")) && value.match(new RegExp(\".*?eval\\\\u0028\", \"g\"))) {\n          if (properties.editable) {\n            var message = this.getResource(\"render-text-regular-expression-default-message\");\n            invalidElements.push({ xpath: properties.xpath, message: message });\n            bValid = false;\n          }\n        }\n      }\n    }\n\n    return bValid;\n  },\n  /*\r\n     *   Sets the value in the rendered control\r\n     */\n  setDisplayValue: function setDisplayValue(value) {\n    var self = this;\n    var control = self.getControl();\n    var displayValue = self.getDisplayValue();\n    var decodedValue = bizagi.util.decodeURI(value);\n    var decodedDisplayValue = bizagi.util.decodeURI(displayValue);\n\n    if (!bizagi.util.parseBoolean(self.properties.editable)) {\n      // Render as simple value\n      if (typeof value == \"string\") {\n        // Replace line breaks for html line breaks\n        var valueToDisplay = decodedDisplayValue.replaceAll(\"&\", \"&amp;\");\n        valueToDisplay = valueToDisplay.replaceAll(\"<\", \"&lt;\").replaceAll(\">\", \"&gt;\");\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\"\", \"&#34;\").replaceAll(\"'\", \"&#39;\").replaceAll(\"/\", \"&#47;\");\n        valueToDisplay = valueToDisplay.replaceAll(\"\\\\n\", \"<br/>\");\n        valueToDisplay = valueToDisplay.replaceAll(\"\\n\", \"<br/>\");\n        control.html(\"<input class='readonly-control bz-form-control' readonly='readonly' value=\" + valueToDisplay + \" >\");\n\n      } else {\n        if (bizagi.util.isNull(value)) {\n          control.html(\"\");\n        }\n      }\n    }\n    // Set internal value\n    self.setValue(decodedValue, false);\n  },\n  /**\r\n     * Extend setValue to fix all encode data from database\r\n     * More information SUITE-9407\r\n     */\n  setValue: function setValue(value) {\n    /*ISUPP-4116/*\r\n                                      /*var decodedValue = bizagi.util.decodeURI(value);*/\n    var self = this;\n    self._super(value);\n  },\n  /*\r\n     *   Execute design only methods\r\n     */\n  performDesignModeMethods: function performDesignModeMethods() {\n    var self = this;\n    var properties = self.properties;\n\n    // Set all controls read-only\n    var control = self.getControl();\n    //Valid control\n    if (control !== null) {\n      $(\"select, button, textarea\", control).attr(\"readonly\", true);\n    }\n    // Execute custom code for each render\n    self.configureDesignView();\n\n    // Set initial value\n    self.internalSetInitialValue();\n  } });","/*\r\n*   Name: Bizagi Smartphone Render Factory\r\n*   Author: UI Forms Team\r\n*   Comments:\r\n*   -   This script will define a render factory to create smartphone versions of each render type\r\n*/\n\nbizagi.rendering.base.factory.extend(\"bizagi.rendering.smartphone.factory\", {}, {\n\n  /**\r\n                                                                                   * Load all the templates used for rendering\r\n                                                                                   * @returns {} \r\n                                                                                   */\n  loadTemplates: function loadTemplates() {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(\n    // Icons\n    self.loadTemplate(\"icons\", self.getFileTemplate(\"common.bizagi.rendering.icons\")),\n\n    // Containers\n    self.loadTemplate(\"form\", self.getFileTemplate(\"bizagi.rendering.smartphone.form\") + \"#bz-form-container\"),\n    self.loadTemplate(\"complexgateway\", self.getFileTemplate(\"bizagi.rendering.smartphone.form\") + \"#bz-form-complex-gateway\"),\n\n    self.loadTemplate(\"panel\", self.getFileTemplate(\"bizagi.rendering.smartphone.panel\")),\n    self.loadTemplate(\"tab\", self.getFileTemplate(\"bizagi.rendering.smartphone.tab\")),\n    self.loadTemplate(\"tabItem\", self.getFileTemplate(\"bizagi.rendering.smartphone.tabItem\")),\n    self.loadTemplate(\"horizontal\", self.getFileTemplate(\"bizagi.rendering.smartphone.horizontal\")),\n    self.loadTemplate(\"group\", self.getFileTemplate(\"bizagi.rendering.smartphone.group\")),\n    self.loadTemplate(\"section\", self.getFileTemplate(\"bizagi.rendering.smartphone.section\")),\n    self.loadTemplate(\"searchForm\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchForm\")),\n    self.loadTemplate(\"accordion\", self.getFileTemplate(\"bizagi.rendering.smartphone.accordion\")),\n    self.loadTemplate(\"accordionItem\", self.getFileTemplate(\"bizagi.rendering.smartphone.accordionItem\")),\n    self.loadTemplate(\"contentPanel\", self.getFileTemplate(\"bizagi.rendering.smartphone.contentPanel\")),\n\n    // Renders\n    self.loadTemplate(\"render\", self.getFileTemplate(\"bizagi.rendering.smartphone.render\")),\n    self.loadTemplate(\"readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.readonly\")),\n    self.loadTemplate(\"readonly-value\", self.getFileTemplate(\"bizagi.rendering.smartphone.readonly\")),\n    self.loadTemplate(\"text\", self.getFileTemplate(\"bizagi.rendering.smartphone.text\") + \"#bz-render-text\"),\n    self.loadTemplate(\"text-read-only\", self.getFileTemplate(\"bizagi.rendering.smartphone.text\") + \"#bz-render-text-readonly\"),\n\n    self.loadTemplate(\"number\", self.getFileTemplate(\"bizagi.rendering.smartphone.number\")),\n    self.loadTemplate(\"extendedText\", self.getFileTemplate(\"bizagi.rendering.smartphone.extendedText\") + \"#bz-render-extended-text\"),\n    self.loadTemplate(\"extendedText-readOnly\", self.getFileTemplate(\"bizagi.rendering.smartphone.extendedText\") + \"#bz-render-extended-text-readonly\"),\n    self.loadTemplate(\"date\", self.getFileTemplate(\"bizagi.rendering.smartphone.date\")),\n    self.loadTemplate(\"yesno\", self.getFileTemplate(\"bizagi.rendering.smartphone.yesno\")),\n    self.loadTemplate(\"check\", self.getFileTemplate(\"bizagi.rendering.smartphone.check\")),\n    self.loadTemplate(\"checkList\", self.getFileTemplate(\"bizagi.rendering.smartphone.checkList\")),\n    self.loadTemplate(\"button\", self.getFileTemplate(\"bizagi.rendering.smartphone.button\")),\n    self.loadTemplate(\"link\", self.getFileTemplate(\"bizagi.rendering.smartphone.link\")),\n    self.loadTemplate(\"formLink\", self.getFileTemplate(\"bizagi.rendering.smartphone.formLink\")),\n    self.loadTemplate(\"geolocation\", self.getFileTemplate(\"bizagi.rendering.smartphone.geolocation\")),\n    self.loadTemplate(\"radio\", self.getFileTemplate(\"bizagi.rendering.smartphone.radio\")),\n\n    self.loadTemplate('association', self.getFileTemplate('bizagi.rendering.smartphone.association')),\n\n    self.loadTemplate(\"ecm\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm\"),\n    self.loadTemplate(\"ecm-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm-item\"),\n    self.loadTemplate(\"ecm-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.ecm\") + \"#bz-render-ecm-readonly\"),\n\n    self.loadTemplate(\"image\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image\"),\n    self.loadTemplate(\"image-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-item\"),\n    self.loadTemplate(\"image-preview\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-preview\"),\n    self.loadTemplate(\"image-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.image\") + \"#bz-render-image-readonly\"),\n\n    self.loadTemplate(\"upload\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload\"),\n    self.loadTemplate(\"upload-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload-readonly\"),\n    self.loadTemplate(\"upload-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.upload\") + \"#bz-render-upload-item\"),\n\n    self.loadTemplate(\"document\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator\"),\n    self.loadTemplate(\"document-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-item\"),\n    self.loadTemplate(\"document-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-readonly\"),\n    self.loadTemplate(\"document-download\", self.getFileTemplate(\"bizagi.rendering.smartphone.document\") + \"#bz-document-generator-download\"),\n\n    self.loadTemplate(\"list-multiselect\", self.getFileTemplate(\"bizagi.rendering.smartphone.multiSelect\") + \"#bz-multiselect\"),\n    self.loadTemplate(\"multiselect-list\", self.getFileTemplate(\"bizagi.rendering.smartphone.multiSelect\") + \"#bz-multiselect-list\"),\n\n    self.loadTemplate(\"combo\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control\"),\n    self.loadTemplate(\"combo-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control-readonly\"),\n    self.loadTemplate(\"combo-list\", self.getFileTemplate(\"bizagi.rendering.smartphone.combo\") + \"#bz-combo-control-list\"),\n\n    self.loadTemplate(\"modal-header-search\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-header-search\"),\n    self.loadTemplate(\"modal-header-title\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-header-title\"),\n    self.loadTemplate(\"modal-footer-done\", self.getFileTemplate(\"bizagi.rendering.smartphone.modal\") + \"#bz-modal-view-footer-done\"),\n\n    self.loadTemplate(\"list\", self.getFileTemplate(\"bizagi.rendering.smartphone.list\") + \"#bz-render-list\"),\n    self.loadTemplate(\"list-items\", self.getFileTemplate(\"bizagi.rendering.smartphone.list\") + \"#bz-render-list-items\"),\n\n    self.loadTemplate(\"search\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search\"),\n    self.loadTemplate(\"search.item\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search-item\"),\n    self.loadTemplate(\"search.items\", self.getFileTemplate(\"bizagi.rendering.smartphone.search\") + \"#bz-render-search-items\"),\n\n    self.loadTemplate('searchList', self.getFileTemplate('bizagi.rendering.smartphone.searchList') + \"#bz-render-search-list\"),\n    self.loadTemplate(\"searchList.item\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-item\"),\n    self.loadTemplate(\"searchList.items\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-items\"),\n    self.loadTemplate(\"searchList.actions\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-actions\"),\n    self.loadTemplate(\"searchList.tag\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-tag\"),\n    self.loadTemplate(\"searchList.readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-readonly\"),\n    self.loadTemplate(\"searchList-modal-header\", self.getFileTemplate(\"bizagi.rendering.smartphone.searchList\") + \"#bz-render-search-list-modal-header\"),\n\n    self.loadTemplate(\"letter\", self.getFileTemplate(\"bizagi.rendering.smartphone.letter\")),\n\n    // Hand Signature\n    self.loadTemplate(\"hand-signature\", self.getFileTemplate(\"bizagi.rendering.smartphone.handSignature\") + \"#bz-signature\"),\n    self.loadTemplate(\"hand-signature-readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.handSignature\") + \"#bz-signature-readonly\"),\n\n    //Renders commons\n    self.loadTemplate(\"form-error\", self.getFileTemplate(\"bizagi.rendering.smartphone.form-error\")),\n    self.loadTemplate(\"form-waiting\", self.getFileTemplate(\"bizagi.rendering.smartphone.form-waiting\")),\n\n    // Action launcher\n    self.loadTemplate(\"render-actionLauncher\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher\"),\n    self.loadTemplate(\"render-actionLauncher-horizontal\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-horizontal\"),\n    self.loadTemplate(\"render-actionLauncher-vertical\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-vertical\"),\n    self.loadTemplate(\"render-actionLauncher-actions-to-execute\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-actions-to-execute\"),\n    self.loadTemplate(\"render-actionLauncher-design\", self.getFileTemplate(\"bizagi.rendering.smartphone.actionLauncher\") + \"#bz-rendering-actionLauncher-design\"),\n\n    // Polymorphic launcher\n    self.loadTemplate(\"render-polymorphicLauncher\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher\"),\n    self.loadTemplate(\"render-polymorphicLauncher-vertical-tree\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree\"),\n    self.loadTemplate(\"render-polymorphicLauncher-vertical-tree-item\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-vertical-tree-item\"),\n    self.loadTemplate(\"render-polymorphicLauncher-actions-to-execute\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-actions-to-execute\"),\n    self.loadTemplate(\"render-polymorphicLauncher-confirm\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-confirm\"),\n    self.loadTemplate(\"render-polymorphicLauncher-design\", self.getFileTemplate(\"bizagi.rendering.smartphone.polymorphicLauncher\") + \"#bz-rendering-polymorphicLauncher-design\"),\n\n    //GRIDS SMARTPHONES\n    self.loadTemplate(\"grid\", self.getFileTemplate(\"bizagi.rendering.smartphone.grid\")),\n    self.loadTemplate(\"cell\", self.getFileTemplate(\"bizagi.rendering.smartphone.cell\")),\n    self.loadTemplate(\"cell.readonly\", self.getFileTemplate(\"bizagi.rendering.smartphone.cell.readonly\")),\n\n    //grid items\n    self.loadTemplate(\"bizagi.grid.grid\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid\"),\n    self.loadTemplate(\"bizagi.grid.totalizer\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-totalizer\"),\n    self.loadTemplate(\"bizagi.grid.waiting\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-waiting\"),\n    self.loadTemplate(\"bizagi.grid.table\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table\"),\n    self.loadTemplate(\"bizagi.grid.table.empty\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-table-empty\"),\n    self.loadTemplate(\"bizagi.grid.column\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column\"),\n    self.loadTemplate(\"bizagi.grid.column.special\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-column-special\"),\n    self.loadTemplate(\"bizagi.grid.row\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row\"),\n    self.loadTemplate(\"bizagi.grid.row.buttons\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-row-buttons\"),\n    self.loadTemplate(\"bizagi.grid.cell\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell\"),\n    self.loadTemplate(\"bizagi.grid.cell.special\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-cell-special\"),\n    self.loadTemplate(\"bizagi.grid.pager\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-pager\"),\n    self.loadTemplate(\"bizagi.grid.buttons\", self.getFileTemplate(\"bizagi.rendering.smartphone.bizagi.grid\") + \"#ui-bizagi-grid-buttons\"),\n\n    // Renders Layouts\n    self.loadTemplate(\"render-layout\", self.getFileTemplate(\"bizagi.rendering.smartphone.render.layout\")),\n\n    self.loadTemplate(\"layout-image\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image\"),\n    self.loadTemplate(\"layout-image64\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.image\") + \"#ui-bizagi-render-layout-image64\"),\n    self.loadTemplate(\"layout-label\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.label\")),\n    self.loadTemplate(\"layout-link\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.link\")),\n    self.loadTemplate(\"layout-text\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.text\")),\n    self.loadTemplate(\"layout-date-time\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.dateTime\")),\n    self.loadTemplate(\"layout-money\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.money\")),\n    self.loadTemplate(\"layout-number\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.number\")),\n    self.loadTemplate(\"layout-upload\", self.getFileTemplate(\"bizagi.rendering.smartphone.layout.upload\"))).\n\n    done(function () {\n      var tmplIcons = $.fasttmpl(self.getTemplate(\"icons\"));\n      var svgStoreCounter = $(\"head\").find('#genome-forms-icons').length;\n\n      if (svgStoreCounter === 0) {\n        $(\"head\").append(tmplIcons);\n      }\n\n      // Resolve when all templates are loaded\n      defer.resolve();\n    });\n\n    return defer.promise();\n  },\n\n  getFileTemplate: function getFileTemplate(src, onDemand) {\n    var device = bizagi.detectDevice();\n    return bizagi.getTemplate(src, onDemand, device == \"desktop\" ? \"smartphone_ios\" : device);\n  },\n\n  /**\r\n      * Returns the appropiate container based on the container type\r\n      * @param {} params \r\n      * @returns {} \r\n      */\n  getContainer: function getContainer(params) {\n    var self = this;\n    var type = params.type;\n    var containerParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"form\")\n    return new bizagi.rendering.smartphone.form(containerParams);\n\n    if (type == \"template\")\n    return new bizagi.rendering.smartphone.formTemplate(containerParams);\n\n    if (type == \"queryForm\")\n    return new bizagi.rendering.smartphone.queryForm(containerParams);\n\n    if (type == \"layout\")\n    return new bizagi.rendering.smartphone.layout(containerParams);\n\n    if (type == \"usersForm\")\n    return new bizagi.rendering.smartphone.usersForm(containerParams);\n\n    if (type == \"panel\")\n    return new bizagi.rendering.smartphone.panel(containerParams);\n\n    if (/^contentpanel$/i.test(type))\n    return new bizagi.rendering.smartphone.contentPanel(containerParams);\n\n    if (/^nestedform$/i.test(type))\n    return new bizagi.rendering.smartphone.nestedForm(containerParams);\n\n    if (type == \"tab\")\n    return new bizagi.rendering.smartphone.tab(containerParams);\n\n    if (/^tabitem$/i.test(type))\n    return new bizagi.rendering.smartphone.tabItem(containerParams);\n\n    if (type == \"horizontal\")\n    return new bizagi.rendering.smartphone.horizontal(containerParams);\n\n    if (type == \"accordion\")\n    return new bizagi.rendering.smartphone.accordion(containerParams);\n\n    if (type == \"accordionItem\")\n    return new bizagi.rendering.smartphone.accordionItem(containerParams);\n\n    if (type == \"group\")\n    return new bizagi.rendering.smartphone.group(containerParams);\n\n    if (type == \"searchForm\") {\n      containerParams.context = \"search\";\n      containerParams.contexttype = \"metadata\";\n      return new bizagi.rendering.smartphone.searchForm(containerParams);\n    }\n\n    if (type == \"mobileform\")\n    return new bizagi.rendering.mobileform(containerParams);\n\n    if (type == \"mobilegroup\")\n    return new bizagi.rendering.mobilegroup(containerParams);\n\n    if (type == \"section\")\n    return new bizagi.rendering.smartphone.section(containerParams);\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", params.data, \"error\");\n\n    return null;\n  },\n\n  /**\r\n      * Returns the appropriate column based on the render type\r\n      * @param {} params \r\n      * @returns {} \r\n      */\n  getColumn: function getColumn(params) {\n    var type = params.type;\n    var data = params.data;\n    var columnParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService,\n      singleInstance: bizagi.util.isEmpty(params.singleInstance) ? true : params.singleInstance });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"columnText\") {\n      var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\n\n      if (isExtended) {\n        // Creates one extended render\n        columnParams.decorated = bizagi.rendering.smartphone.extendedText;\n      } else {\n        // Creates one normal text render\n        columnParams.decorated = bizagi.rendering.smartphone.text;\n      }\n\n      return new bizagi.rendering.smartphone.columns.text(columnParams);\n    }\n\n    if (type == \"columnSearchList\") {\n      columnParams.decorated = bizagi.rendering.smartphone.searchList;\n      return new bizagi.rendering.smartphone.columns.searchList(columnParams);\n    }\n\n    if (type == \"columnNumber\") {\n      columnParams.decorated = bizagi.rendering.smartphone.number;\n      return new bizagi.rendering.smartphone.columns.number(columnParams);\n    }\n\n    if (type == \"columnMoney\") {\n      columnParams.decorated = bizagi.rendering.smartphone.money;\n      return new bizagi.rendering.smartphone.columns.number(columnParams);\n    }\n\n    if (type == \"columnDate\") {\n      columnParams.decorated = bizagi.rendering.smartphone.date;\n      return new bizagi.rendering.smartphone.columns.date(columnParams);\n    }\n\n    if (type == \"columnBoolean\") {\n      var display = data.properties.display || \"option\";\n\n      if (display == \"check\") {\n        // Creates one check render\n        columnParams.decorated = bizagi.rendering.smartphone.check;\n        if (params.data.properties.isExclusive) {\n          return new bizagi.rendering.smartphone.columns.exclusiveCheck(columnParams);\n        }\n      } else {\n        // Creates one yes-no render\n        columnParams.decorated = bizagi.rendering.smartphone.yesno;\n      }\n      return new bizagi.rendering.smartphone.columns.column(columnParams);\n    }\n\n    if (type == \"columnCombo\") {\n      columnParams.decorated = bizagi.rendering.smartphone.combo;\n      return new bizagi.rendering.smartphone.columns.combo(columnParams);\n    }\n\n    if (type == \"columnRadio\") {\n      columnParams.decorated = bizagi.rendering.smartphone.radio;\n      return new bizagi.rendering.smartphone.columns.radio(columnParams);\n    }\n\n    if (type == \"columnList\") {\n      columnParams.decorated = bizagi.rendering.smartphone.list;\n      return new bizagi.rendering.smartphone.columns.list(columnParams);\n    }\n\n    if (type == \"columnHidden\") {\n      columnParams.decorated = bizagi.rendering.smartphone.hidden;\n      return new bizagi.rendering.smartphone.columns.hidden(columnParams);\n    }\n\n    if (type == \"columnUpload\") {\n      columnParams.decorated = bizagi.rendering.smartphone.upload;\n      return new bizagi.rendering.smartphone.columns.upload(columnParams);\n    }\n\n    if (type == \"columnImage\") {\n      columnParams.decorated = bizagi.rendering.smartphone.image;\n      return new bizagi.rendering.smartphone.columns.image(columnParams);\n    }\n\n    if (type == \"columnUploadEcm\") {\n      columnParams.decorated = bizagi.rendering.smartphone.ecm;\n      return new bizagi.rendering.smartphone.columns.uploadecm(columnParams);\n    }\n\n    if (type == \"columnLink\") {\n      columnParams.decorated = bizagi.rendering.smartphone.link;\n      return new bizagi.rendering.smartphone.columns.link(columnParams);\n    }\n\n    if (type == \"columnFormLink\") {\n      columnParams.decorated = bizagi.rendering.smartphone.formLink;\n      return new bizagi.rendering.smartphone.columns.link(columnParams);\n    }\n\n    if (type == \"columnUserfield\") {\n      columnParams.decorated = bizagi.rendering.smartphone.userfieldWrapper;\n      return new bizagi.rendering.smartphone.columns.column(columnParams);\n    }\n\n    if (type == \"columnSearch\") {\n      columnParams.decorated = bizagi.rendering.smartphone.search;\n      return new bizagi.rendering.smartphone.columns.search(columnParams);\n    }\n\n    if (type == \"columnLabel\") {\n      columnParams.decorated = bizagi.rendering.smartphone.label;\n      return new bizagi.rendering.smartphone.columns.column(columnParams);\n    }\n\n    if (type == \"columnReadonly\") {\n      columnParams.decorated = bizagi.rendering.smartphone.readonly;\n      return new bizagi.rendering.smartphone.columns.readonly(columnParams);\n    }\n\n    if (type == \"columnDocument\") {\n      columnParams.decorated = bizagi.rendering.smartphone.document;\n      return new bizagi.rendering.smartphone.columns.document(columnParams);\n    }\n\n    /*\r\n      Not supported\r\n       if (type == \"columnLetter\") {\r\n          columnParams.decorated = bizagi.rendering.letter;\r\n          return new bizagi.rendering.columns.letter(columnParams);\r\n      } */\n\n    if (type == \"columnButton\") {\n      columnParams.decorated = bizagi.rendering.smartphone.button;\n      return new bizagi.rendering.smartphone.columns.button(columnParams);\n    }\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  },\n\n  getRender: function getRender(params) {\n    var self = this;\n    var type = params.type;\n    var data = params.data;\n    var properties = data.properties;\n    var renderParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    // Check is offline form        \n    var isOfflineForm = bizagi.util.isOfflineForm({ container: params.parent });\n\n    if (!type)\n    type = \"label\";\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"text\") {\n      var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\n\n      // Creates one extended render\n      if (isExtended) {\n        return new bizagi.rendering.smartphone.extendedText(renderParams);\n      }\n\n      // Creates one normal text render\n      return new bizagi.rendering.smartphone.text(renderParams);\n    }\n\n    if (type == \"association\") {\n      return new bizagi.rendering.smartphone.association(renderParams);\n    }\n\n    if (type == \"label\") {\n      return new bizagi.rendering.smartphone.label(renderParams);\n    }\n\n    if (type == \"hidden\") {\n      return new bizagi.rendering.smartphone.hidden(renderParams);\n    }\n\n    if (type == \"number\") {\n      // Number Scientific Notation\n      if (properties && properties.dataType === 29) {\n        return new bizagi.rendering.smartphone.numberScientificNotation(renderParams);\n      }\n\n      return new bizagi.rendering.smartphone.number(renderParams);\n    }\n\n    if (type == \"money\") {\n      return new bizagi.rendering.smartphone.money(renderParams);\n    }\n\n    if (type == \"date\") {\n      return new bizagi.rendering.smartphone.date(renderParams);\n    }\n\n    if (type == \"boolean\") {\n      var display = data.properties.display || \"option\";\n\n      // Creates one check render\n      if (display == \"check\") {\n        return new bizagi.rendering.smartphone.check(renderParams);\n      }\n\n      // Creates one yes-no render\n      return new bizagi.rendering.smartphone.yesno(renderParams);\n    }\n\n    if (type == \"combo\") {\n      return new bizagi.rendering.smartphone.combo(renderParams);\n    }\n\n    if (/^cascadingcombo$/i.test(type)) {\n      return new bizagi.rendering.smartphone.cascadingCombo(renderParams);\n    }\n\n    if (type == \"list\") {\n      return new bizagi.rendering.smartphone.list(renderParams);\n    }\n\n    if (type == \"radio\") {\n      return new bizagi.rendering.smartphone.radio(renderParams);\n    }\n\n    if (type == \"image\") {\n      return new bizagi.rendering.smartphone.image(renderParams);\n    }\n\n    if (type == \"uploadecm\") {\n      return new bizagi.rendering.smartphone.ecm(renderParams);\n    }\n\n    if (type == \"upload\") {\n      if (isOfflineForm) {\n        return new bizagi.rendering.smartphone.upload.offline(renderParams);\n      } else\n      {\n        return new bizagi.rendering.smartphone.upload(renderParams);\n      }\n    }\n\n    if (type == \"grid\") {\n      if (isOfflineForm) {\n        return new bizagi.rendering.smartphone.grid.offline(renderParams);\n      } else {\n        return new bizagi.rendering.smartphone.grid(renderParams);\n      }\n    }\n\n    if (type == \"groupedgrid\") {\n      // return new bizagi.rendering.smartphone.grid.grouped(renderParams);\n      return new bizagi.rendering.smartphone.grid(renderParams); // Not supported. Nonetheless, all entries are shown.\n    }\n\n    if (type == \"search\") {\n      return new bizagi.rendering.smartphone.search(renderParams);\n    }\n\n    if (type == \"suggest\") {\n      renderParams.data.properties.enableQuerySuggestBehavior = true;\n      return new bizagi.rendering.smartphone.search(renderParams);\n    }\n\n    if (type == \"searchList\") {\n      return new bizagi.rendering.smartphone.searchList(renderParams);\n    }\n\n    if (type == \"multiSelect\") {\n      return new bizagi.rendering.smartphone.multiSelect(renderParams);\n    }\n\n    if (type == \"button\") {\n      return new bizagi.rendering.smartphone.button(renderParams);\n    }\n\n    if (type == \"formLink\") {\n      return new bizagi.rendering.smartphone.formLink(renderParams);\n    }\n\n    if (type == \"link\") {\n      return new bizagi.rendering.smartphone.link(renderParams);\n    }\n\n    if (type == \"actionLauncher\") {\n      return new bizagi.rendering.smartphone.actionLauncher(renderParams);\n    }\n\n    if (type == \"entityTemplate\") {\n      return new bizagi.rendering.smartphone.entityTemplate(renderParams);\n    }\n\n    if (type == \"polymorphicLauncher\") {\n      return new bizagi.rendering.smartphone.polymorphicLauncher(renderParams);\n    }\n\n    if (type == \"userfield\") {\n      return new bizagi.rendering.smartphone.userfieldWrapper(renderParams);\n    }\n\n    // Check query renders (starts with \"query\")\n    //if (type.indexOf(\"query\") == 0) {\n    //    return this.getQueryRender(params);\n    //}\n\n    // Check search renders (starts with \"search\")\n    if (type.indexOf(\"search\") == 0) {\n      return this.getSearchRender(params);\n    }\n\n    if (type == \"document\") {\n      return new bizagi.rendering.smartphone.document(renderParams);\n    }\n\n    if (type == \"image\") {\n      return new bizagi.rendering.smartphone.image(renderParams);\n    }\n\n    if (type == \"fileprint\") {\n      return new bizagi.rendering.smartphone.fileprint(renderParams);\n    }\n\n    if (type == \"geolocation\") {\n      return new bizagi.rendering.smartphone.geolocation(renderParams);\n    }\n\n    if (type == \"collectionnavigator\") {\n      return new bizagi.rendering.smartphone.collectionnavigator(renderParams);\n    }\n\n    if (type == \"activityCheckList\") {\n      return new bizagi.rendering.smartphone.activityCheckList(renderParams);\n    }\n\n    // Check layout renders (starts with \"layout\")\n    if (type.indexOf(\"layout\") === 0) {\n      return self.getLayoutRender(params);\n    }\n\n    // Check range renders (starts with \"range\")\n    if (type.indexOf(\"range\") === 0) {\n      return self.getRangeRender(params);\n    }\n\n    if (type == \"mobiletext\") {\n      return new bizagi.rendering.smartphone.specific_text(renderParams);\n    }\n\n    // Deprecated control\n    if (type == \"letter\")\n    return new bizagi.rendering.smartphone.letter(renderParams);\n\n    if (/^signature$/i.test(type)) {\n      return new bizagi.rendering.smartphone.handSignature(renderParams);\n    }\n\n    if (/^readonly$/i.test(type)) {\n      return new bizagi.rendering.smartphone.readonly(renderParams);\n    }\n\n    // No type supported\n    //bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    //return null;\n\n    return this._super(params);\n  },\n\n  /**\r\n     * Returns the appropiatelayout render based on the type   \r\n     */\n  getLayoutRender: function getLayoutRender(params) {\n    var type = params.type;\n    var renderParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"layoutImage\")\n    return new bizagi.rendering.smartphone.layoutImage(renderParams);\n\n    if (type == \"layoutLink\")\n    return new bizagi.rendering.smartphone.layoutLink(renderParams);\n\n    if (type == \"layoutLabel\")\n    return new bizagi.rendering.smartphone.layoutLabel(renderParams);\n\n    if (type == \"layoutText\")\n    return new bizagi.rendering.smartphone.layoutText(renderParams);\n\n    if (type == 'layoutDateTime')\n    return new bizagi.rendering.smartphone.layoutDateTime(renderParams);\n\n    if (type == \"layoutNumber\")\n    return new bizagi.rendering.smartphone.layoutNumber(renderParams);\n\n    if (type == \"layoutMoney\")\n    return new bizagi.rendering.smartphone.layoutMoney(renderParams);\n\n    if (type == \"layoutPlaceholder\")\n    return new bizagi.rendering.smartphone.layoutPlaceholder(renderParams);\n\n    if (type == \"layoutBoolean\")\n    return new bizagi.rendering.smartphone.layoutBoolean(renderParams);\n\n    if (type == \"layoutUpload\")\n    return new bizagi.rendering.smartphone.layoutUpload(renderParams);\n\n    return this._super(params);\n  },\n\n  /**\r\n      * Returns the appropiate search render based on the type     \r\n      */\n  getRangeRender: function getRangeRender(params) {\n    var type = params.type;\n    var renderParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type === \"rangeDate\")\n    return new bizagi.rendering.smartphone.rangeDate(renderParams);\n\n    if (type === \"rangeMoney\")\n    return new bizagi.rendering.smartphone.rangeMoney(renderParams);\n\n    if (type === \"rangeNumber\")\n    return new bizagi.rendering.smartphone.rangeNumber(renderParams);\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", params.data, \"error\");\n    return null;\n  },\n\n  /**\r\n      * Returns the appropiate search render based on the type     \r\n      */\n  getSearchRender: function getSearchRender(params) {\n    var type = params.type;\n    var data = params.data;\n    var searchParams = $.extend(params, {\n      renderFactory: this,\n      dataService: params.dataService || this.dataService });\n\n\n    type = type.replace(/smartphone/, '');\n\n    if (type == \"searchText\") {\n      var isExtended = bizagi.util.parseBoolean(data.properties.isExtended) || false;\n\n      // Creates one extended render\n      if (isExtended)\n      return new bizagi.rendering.smartphone.extendedText(searchParams);\n\n      // Creates one normal text render\n      return new bizagi.rendering.smartphone.text(searchParams);\n    }\n\n    if (type == \"searchBoolean\") {\n      var display = data.properties.display || \"option\";\n\n      // Creates one check render\n      if (display == \"check\")\n      return new bizagi.rendering.smartphone.check(searchParams);\n\n      // Creates one yes-no render\n      return new bizagi.rendering.smartphone.yesno(searchParams);\n    }\n\n    if (type == \"searchNumber\") {\n      // Creates a Scientific Notation render\n      if (data.properties.dataType == 29)\n      return new bizagi.rendering.smartphone.numberScientificNotation(searchParams);\n\n      return new bizagi.rendering.smartphone.number(searchParams);\n    }\n\n    if (type == \"searchMoney\")\n    return new bizagi.rendering.smartphone.money(searchParams);\n\n    if (type == \"searchDate\")\n    return new bizagi.rendering.smartphone.date(searchParams);\n\n    if (type == \"searchCombo\")\n    return new bizagi.rendering.smartphone.combo(searchParams);\n\n    if (type == \"searchSuggest\")\n    return new bizagi.rendering.smartphone.search(searchParams);\n\n    if (type == \"searchLabel\")\n    return new bizagi.rendering.smartphone.label(searchParams);\n\n    // No type supported\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  } });"]}