{"version":3,"sources":["jquery/workportalflat/common/services/bizagi.workportal.services.endPoints.js","jquery/workportalflat/common/services/bizagi.workportal.services.service.js","jquery/workportalflat/common/services/bizagi.workportal.services.routing.js","jquery/workportal/js/base/command/bizagi.workportal.command.security.js","jquery/workportalflat/common/webpart/bizagi.framework.homeportal.js","jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/offline/js/services/database/bizagi.clientdb.js","jquery/common/bizagi/js/services/bizagi.template.services.service.kendo.js","jquery/workportalflat/common/bizagi.workportal.loader.override.js","jquery/workportalflat/common/bizagi.workportal.util.js","jquery/workportalflat/common/tablet/js/bizagi.workportal.util.tablet.js","jquery/workportalflat/common/bizagi.workportal.webpart.controllers.controller.js","jquery/workportalflat/common/services/bizagi.workportal.services.context.js","jquery/workportalflat/common/bizagi.workportal.device.factory.js","jquery/workportalflat/common/bizagi.workportal.webparts.facade.js","jquery/workportalflat/common/tablet/js/bizagi.workportal.webparts.tablet.facade.js","jquery/workportalflat/common/webpart/bizagi.workportal.webpart.helper.js","jquery/workportalflat/common/webpart/bizagi.workportal.webparts.webpart.js","jquery/workportalflat/common/webpart/bizagi.workportal.render.webparts.webpart.js","jquery/workportalflat/common/tablet/js/bizagi.framework.tablet.homeportal.js","jquery/reporting/bizagi.reporting.definition.js","jquery/workportalflat/common/webpart/commands/bizagi.workportal.command.search.js","jquery/workportalflat/common/webpart/componentservices/actionsEvents/bizagi.component.actionsEvents.js","jquery/workportalflat/common/webpart/componentservices/users/bizagi.component.caseUsers.js","jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/offline/js/services/bizagi.render.services.service.offline.js","jquery/offline/js/services/bizagi.file.services.service.offline.js","jquery/offline/js/services/bizagi.sync.services.service.offline.js","jquery/offline/js/services/bizagi.grid.services.service.offline.js","jquery/offline/js/services/bizagi.form.services.service.offline.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/offline/js/services/database/bizagi.clientdb.cases.js","jquery/offline/js/services/database/bizagi.clientdb.forms.js","jquery/offline/js/services/database/bizagi.clientdb.fetchWorker.js","jquery/offline.old/js/services/database/bizagi.clientdb.js","jquery/offline.old/js/services/database/bizagi.clientdb.fetchWorker.js","jquery/offline/js/services/bizagi.workportal.services.service.offline.js","jquery/bizagidiagnostics/mobile/js/services/bizagi.workportal.services.service.diagnostics.js","jquery/offline/js/services/database/bizagi.clientdb.syncErrors.js","jquery/offline/js/services/database/bizagi.clientdb.pullWorker.js","jquery/offline.old/js/services/database/bizagi.clientdb.cases.js","jquery/offline.old/js/services/database/bizagi.clientdb.forms.js","jquery/offline.old/js/services/database/bizagi.clientdb.pullWorker.js","jquery/offline.old/js/services/bizagi.workportal.services.service.offline.js","jquery/offline/js/services/bizagi.workportal.services.routing.offline.js","jquery/bizagidiagnostics/mobile/js/database/bizagi.workportal.diagnostics.db.js","jquery/bizagidiagnostics/mobile/js/database/bizagi.workportal.diagnostics.db.errors.js","jquery/bizagidiagnostics/mobile/js/services/bizagi.workportal.services.service.diagnostics.event.observer.js","jquery/bizagidiagnostics/mobile/js/services/bizagi.workportal.services.service.diagnostics.error.observer.js"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","$","Class","extend","customTemplateFile","bizagi","loader","getResource","detectDevice","cachedFiles","cachedTemplates","customTemplates","init","localization","this","cssRegex","loadingFileDeferred","loadCustomTemplates","self","defer","Deferred","when","getTemplateFile","done","response","temp","html","responseParts","each","i","responsePart","attr","resolve","promise","getTemplate","template","id","isCustomTemplate","replace","enableCustomizations","hash","getHash","environment","internalGetTemplate","pipe","resolvedTemplate","getTemplateForRelease","getTemplateWidget","then","getTemplateWebpart","url","containsHash","getUrlWithoutHashes","processAndReturnTemplate","loadTemplateFileForRelease","ajax","dataType","ready","index","valueTemplate","translatedTemplate","reject","JSON","parse","hasOwnProperty","translate","cachedTemplate","getTemplatePart","templateUrl","loadingTemplatePartExecution","loadingTemplatePart","BIZAGI_ENVIRONMENT","length","console","warn","matches","match","cssFile","loadFile","src","type","outerHTML","indexOf","substring","override","enableMSF","jQuery","fn","fastEmpty","kendoTmplEmpty","fasttmpl","tmpl","data","kendoTmpl","cacheTemplate","cacheKendoTemplate","children","remove","element","hasClass","loadingMessage","kendo","useWithBlock","tempTmpl","trim","kendoTmpls","templates","services","service","loadedWebparts","loaderOverride","steal","window","registerMobileWebpart","webpartName","webparts","map","name","class","devices","location","js","css","initialized","initializing","loadingDeferred","bind","keys","origRequest","request","options","success","error","arguments","device","prefix","useAbsolutePath","basePath","getLocationPrefix","build","resources","completed","loaded","loading","executing","text","stringify","util","context","smartphone","tablet","mobility","startLoading","start","stopLoading","stop","resourceKey","fallback","initWebpartOld","initWebpart","webpart","callback","log","isDate","state","slash","split","Date","getYear","e","setContext","params","reset","getTimeAgo","commentTime","timeago","getGroupedData","date","groupedData","actualDate","actualYear","getFullYear","actualMonth","getMonth","actualDay","getDate","tmpDate","tmpMonth","tmpYear","tmpDay","dateFormatter","formatDate","status","getTaskStatus","solutionDate","formatDataType","replaceLineBreak","formatBoolean","formatMonetaryCell","formatDecimalCell","formatDateTime","toString","newDate","getHours","toLowerCase","getMinutes","formatMoney","BIZAGI_DEFAULT_CURRENCY_INFO","formatDecimal","format","formatCurrency","syntaxHighlight","json","cls","test","b64EncodeUnicode","string","btoa","encodeURIComponent","p1","String","fromCharCode","queryString","startkendo","kendoMobileApplication","mobile","Application","transition","skin","initial","ui","progress","started","bizagiNavigate","t","navigate","workportalFacade","dataService","container","document","componentContainers","workportal","controllers","instances","controller","getWorkportal","publish","eventName","triggerHandler","subscribe","subscribeEvent","subscribeOneTime","one","unsubscribe","unbind","render","showMessageBox","renderContent","postRender","getContent","content","defaultValue","endPoints","getEndPoints","proxyPrefix","isEmpty","getUrl","setProxyPrefix","_endPoints","user-handler","process-handler","query-handler","case-handler","query-form","query-form-edit","query-form-delete","query-form-delete-cube","favorites-handler","file-handler","login-handler","login-handlerv10","logoff-handler","logoff-handlerv1","authorization-handler-getMenuAuthorization","authorization-handler-isCaseCreationAuthorized","case-handler-getCaseSummary","case-handler-releaseActivity","case-handler-getCasesList","case-handler-getActivityList","offline-getProcessTree","offline-tasks","offline-getForms","offline-sendForm","case-handler-getCaseTasks","case-handler-getCaseEvents","case-handler-getCaseSubprocesses","case-handler-getTaskAssignees","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getAsynchExecutionState","case-handler-addNewCase","case-handler-startProcess","handler-execute-action-start","case-handler-supportedLogTypes","case-handler-getActivityLog","case-handler-getActivityDetailLog","case-handler-getEntityLog","case-handler-getEntityDetailLog","case-handler-getUserLog","case-handler-getUserDetailLog","case-handler-getAdminLog","case-handler-getCaseFormsRenderVersion","case-handler-validateHasStartForm","favorites-handler-saveFavorite","favorites-handler-deleteFavorite","process-getIcon","collections-getIcon","bamAnalytics-handler-getAnalisysQueries","bamAnalytics-handler-updateQuery","inbox-handler-getInboxSummary","inbox-handler-getFullInboxSummary","MessageHandler-NewComment","MessageHandler-GetComments","MessageHandler-SetCategoryToComment","MessageHandler-RemoveComment","MessageHandler-ReplyComment","MessageHandler-RemoveReply","MessageHandler-GetCategoryColors","MessageHandler-RenameCategoryColor","MessageHandler-CountNewComments","process-handler-getAllProcesses","process-handler-getFavourites","process-handler-getFavouriteCases","process-handler-getCustomizedColumnsData","process-handler-getCategory","process-handler-getRecentProcesses","process-handler-getCustomizedColumnsDataInfo","process-handler-getOrganizations","process-handler-getOrganizationsByUser","smartinbox-entity-values","smartinbox-getAllInbox","smartinbox-user-tasks","smartinbox-user-tasks-process","process-handler-getMyStuff","process-handler-getIdCasesOfProcessEntities","templates-handler-getCollectionData","data-navigation-handler-collection","data-navigation-handler-entity","data-navigation-handler-entity-filters","action-handler-getProcessAddAction","my-search-getSearchLists","my-search-getFilters","my-search-getFiltersData","my-search-getData","templates-handler-getVirtualCollectionData","templates-handler-getMultipleActions","process-handler-getMapping","process-handler-getForm","process-handler-startform","process-handler-rule","process-action-execute","process-handler-getActivitiesData","process-handler-getPendingsData","entities-handler-getActions","entities-handler-getUsersAndEvents","entities-handler-getUsers","entities-handler-getEvents","entities-handler-getUsersImages","entities-handler-getShotCuts","query-handler-getqueries","query-handler-getQueryForm","user-handler-getCurrentUser","old-render","Reports","reports-handler-deleteQueries","folders-handler-getUserQueries","folders-associate-deleteSmartFolder","folders-handler","folders-associate","smartfolders-integration","AlarmAdmin","AnalyticsProcess","AnalyticsSensor","AnalyticsTask","AsynchronousWorkitemRetries","AuthenticationLogQuery","BAMProcess","BAMTask","BusinessPolicies","CaseAdmin","adminReassignCases","asyncECMUpload","CasesMonitor","Closed","CurrentUser","EncryptionAdmin","MobileUpdatesAdmin","EntityAdmin","LocationResources","NewCase","Pending","Profiles","Search","UserAdmin","UserDefaultAssignation","UserPendingRequests","ListPreferences","UserPreferencesUrl","GRDimensionAdmin","Licenses","AnalysisQueries","DocumentTemplates","ProcessAdmin","ResourceBAM","WorkPortalVersion","entities-administration","theme-handler-getLogoImagePath","logout","logoutDotNet","authenticationConfig","logout-oauth2","FederateLogoffUrl","oauth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo","massive-activity-assignments-getCasesByOrganization","massive-activity-assignments-reassignCases","massive-activity-assignments-searchUsers","async-ecm-upload-baseService","domains","getCurrentTheme","admin-getAuthenticationLog","admin-getAuthenticationDomains","admin-getAuthenticationEventsTypes","admin-getAuthenticationEventSubTypes","admin-EncryptString","admin-UserPendingRequests","admin-UserAuthenticationInfo","admin-updateUserAuthenticationInfo","admin-generateRandomPassword","admin-GenerateDataToSendByEmail","admin-sendEmail","admin-getApplicationList","admin-getApplicationProcesses","admin-getProcessVersion","admin-getProcessTasks","admin-getTaskAlarms","admin-getLapseMode","admin-getRecurrMode","admin-getScheduleType","admin-getBossList","admin-addAlarm","admin-editAlarm","admin-deleteAlarm","admin-alarmRecipients","admin-deleteAlarmRecipients","admin-recipientToAlarm","admin-enableAlarm","admin-getCategoriesList","admin-getCasesList","admin-abortItems","admin-reassignItems","admin-getDefaultAssignationUserToAllProcess","admin-getDefaultAssignationUserToProcess","admin-setDefaultAssignationUserToProcess","admin-getProfilesTypes","admin-searchProfiles","admin-getUsersByProfile","admin-removeUserFromProfile","admin-addUserToProfile","admin-async-activities-get-activities","admin-async-activities-get-retry-now","admin-async-activities-get-activities-by-task","admin-async-activities-enable-execution","admin-async-activities-enable-multiple","admin-async-activities-async-execution","admin-async-activities-async-execution-log","admin-Licenses","admin-GetDimensions","admin-EditDimension","admin-CreateAdministrableDimension","admin-DeleteDimension","admin-EntityPathChildNodesAction","admin-GetActiveWFClasses","admin-document-templates-storeDocumentTemplates","admin-document-templates-restoreDocumentTemplates","admin-document-templates-uploadDocumentTemplate","admin-processes-workflowClasses","admin-processes-tasksByWorkflow","admin-processes-modifyProcessDuration","admin-processes-modifyTaskDuration","admin-language-resource","admin-language-languages","bam-resourcemonitor-myteam","reports-analysisquery","reports-analysisquery-update","reports-analysisquery-delete","processviewer-processdefinition","processviewer-processgraphicinfo","mobile-getLastUpdate","discussion-case","discussion-case-v1","get-users","new-discussion","count-comments","comment-case","new-comment","new-comment-attach","get-list-files","get-list-files-v1","project-resource-action","thumbnail-file","get-attachment","get-mobile-attachment","project-files-upload","count-files","count-files-v1","remove-comment","time-schemas-effectiveduration","getFeatureObject","BA_CONTEXT_PARAMETER_PREFIX","ENTITIES_QUERY_PAGE_SIZE","normalizeUrl","RPproxyPrefix","sharepointProxyPrefix","serviceLocator","pageSize","deviceType","isSmartphoneDevice","deviceEnum","isTabletDevice","desktop","deviceCode","getDeviceCode","BIZAGI_INBOX_ROWS_PER_PAGE","isNumeric","activeForm","undefined","configureGlobalHandlers","endPoint","concat","getOverrides","overrides","valueUppercase","toUpperCase","parseBoolean","read","authenticatedUser","urlSend","userName","BIZAGI_USER","password","BIZAGI_PASSWORD","domain","BIZAGI_DOMAIN","logoutUser","logOffUser","getCurrentUser","getInboxSummary","getAllProcesses","taskState","onlyFavorites","myActivities","myPendings","smartfoldersParameters","isMobile","skipAggrupate","includeAllProcessesItem","responseData","categories","allProcesses","allCases","path","category","isFavorite","guidFavorite","idworkflow","guidWFClass","count","workflows","push","workflow","Number","getUserWorkportalPreferences","_defer","_userPreferences","getPreferencesWorkportalCurrentUser","tryCatch","storeMobileFeatures","userPreferences","fail","getUserPreferences","preference","mobFeatures","getMobileFeatures","localStorage","localStoragePreferences","getLastProcessInboxWorkflow","lastProcessInbox","getLastProcessInboxProcessInfo","validateFeatureSupport","isMobileInboxByProcessSupported","idWorkflow","setLastProcessInbox","processInfoName","inputtray","mobileDevice","getAllSmartInbox","processesData","smartinboxes","idWorkFlowResult","smartInboxId","_preferDefaultOpenInbox","parseInt","defaultOpenInboxWorkflowId","_preferDefaultOpenSmartInbox","defaultOpenInboxSmartInboxId","_hasPreferDefaultOpenInbox","_hasPreferDefaultOpenSmartInbox","workflowFound","first","smartinboxFound","smartinbox","getFavourites","getMyStuff","icon","getFavouriteCases","page","getCasesList","numberOfFields","idWfClass","elementToHtml","overdue","today","tomorrow","upcoming","totalPages","lengthData","elements","counter","tmpElement","tmpdate","getCasesListBeta","getMobileCasesList","adapterDataOfActivitiesToTemplate","getMobileActivities","resp","row","rows","field","tempElement","el","j","headers","fieldName","displayName","serializeActivity","syncErrors","appendActivityElementSyncError","appendActivityRowsSyncError","currentPage","advanceSearch","urlMobile","radNumber","statusFunction","defineActivityStateByTaskState","defineActivityStateByDate","taskstate","tmpEndDate","getTime","endDate","idworkitem","idwfclass","adapterServerResponseTemplateBindingObject","serverResponse","activityDate","now","group","shortEndDate","isEvent","dataChangeset","creatorFullName","caseSyncError","syncError","hasSyncError","idcase","syncerror","hassyncerror","getCurrentActivities","processActivitiesResponse","highlight","process_filter","processes","highlightedNumber","highlightsString","find","processname","active","expresion","RegExp","offset","getDiscussionCase","globalParent","contentType","editDiscussion","update","getUsersDiscussion","getEffectiveDuration","getUsersData","getSummaryCaseTaskOptions","idWorkitem","idCase","createNewDiscussion","create","createNewComment","updateProjectFile","createProjectFile","getFilesCount","getCommentCase","getCommentsByParent","getFilesList","deleteFile","destroy","getFilesThumbnail","getAttachment","guidAttachment","idAttachment","getMobileAttachment","getAllAdministrableEntities","action","kind","result","entities","item","getEntitiesList","getCasesByWorkflow","param","k","v","keyvalue","radnumber","cases","newFieldsValue","fields","fieldsKey","fieldsValue","isRadNumber","Value","DisplayName","workitems","getOrganizationsList","getOrganizationsByUserList","getCustomizedColumnsData","orderFieldName","orderType","order","idTask","getCustomizedColumnsDataBeta","columnTitle","lstIdCases","noResults","message","getCategories","idCategory","idApp","groupByApp","getRecentProcesses","getCaseSummary","eventAsTasks","onlyUserWorkItems","serviceType","getCaseAssignees","getCaseTasks","getCaseEvents","getCaseSubprocesses","getCaseFormsRenderVersion","getCaseFormsRenderVersionDataContent","getTaskAssignees","getWorkitems","fromTask","fromWorkItemId","getQueries","hashQueries","idElement","processQueries","query","queries","idParent","nodes","createNewCase","caseData","idOrganization","validateHasStartForm","processId","batchRequest","startProcess","idProcess","entityMapping","mapping","idParentCase","parseJSON","responseText","isVersionSupported","oldParams","oldVersion","actionCreateCase","guidProcess","parentCaseId","getFirstParentPlan","searchCases","h_action","onlyUserCases","queryCases","filter","outputxpath","queryEntities","idEntity","getMenuAuthorization","isCaseCreationAuthorized","getAsynchExecutionState","idAsynchWorkitem","supportedLogTypes","getActivityLog","orden","sort","idActualPage","getActivityDetailLog","idWorkItemFrom","getEntityLog","getEntityDetailLog","userFullName","attribDisplayName","getUserLog","getUserDetailLog","idUser","entDisplayName","getAdminLog","addFavorite","idObject","favoriteType","delFavorite","summaryAssigness","def","baseAssignees","assignees","assigneesLength","assigneesFix","showAssignees","events","activities","assigneesEvents","assigneesActivities","assigneesEventsList","assigneesActivitiesList","Name","summarySubProcess","subprocess","len","n","summaryCaseEvents","summaryCaseDetails","getCaseSummaryDataContent","currentState","dataCurrentStateLength","showEvents","countEvents","showParentProcess","parentProcess","parentDisplayName","isClosedForAllUsers","isClosed","isOpen","countAssigness","showSubProcess","countSubProcesses","showForm","hasGlobalForm","allowsReassign","idWorkItem","currentStateTypes","m","assignToCurrentUser","showActivities","releaseActivity","summaryActivities","icoTaskState","process","createdBy","createdByName","createdByUserName","caseDescription","processPath","showWorkOnIt","getSmartFolders","idFolder","searchFolders","deleteSmartFolder","idSmartFolder","getFolders","folders","childs","getCasesByFolder","cache","makeFolder","folderName","idParentFolder","updateFolder","associateCaseToFolder","idCustomFolder","dissasociateCaseFromFolder","deleteFolder","getFile","uploadId","entityId","entityKey","pathToBase","getComments","encodeURI","idColorCategory","pag","pagSize","picture","comments","users","user","Id","Picture","makeNewComment","comment","makeNewReply","idComment","Replies","removeMobileComment","removeComment","removeReply","idReply","renameCommentCategory","colorName","setCommentCategory","getCommentsCategories","getNewComments","getAnalisysQueries","updateQueries","idQuery","queryName","queryDescription","deleteQueries","queryId","QueryId","getConfiguration","sessionStorage","removeItem","javaLogout","reload","logoutMobile","logoutData","sourceLogout","removeLastProcessInbox","isCordovaSupported","redirectErrorPage","href","authenticationType","logOffURL","federationLogoutBindingProtocol","authenticationSubType","always","res","federateLogoffUrl","open","write","close","nativeAjax","getPathUrl","jsonResponse","samlUrlRedirect","decodeURI","iframe","createElement","getElementsByTagName","appendChild","on","isIE8","contentWindow","body","eval","logoutUrl","callbackUrl","homeUrl","loginPage","getOrganizationInfo","getCasesByOrganization","roles","skills","locations","reassignCases","searchUsers","fullName","getDomainList","getEcmAllScheduledJobs","retryECMPendingScheduledJob","getWorkPortalVersion","version","productBuild","getAuthenticationLogData","getAuthenticationLogResult","dtFrom","dtTo","eventSubType","eventType","encryptString","entry","userPendingRequests","userAuthenticationInfo","updateUserAuthenticationInfo","enable","expired","locked","generateRandomPassword","generateDataToSendByEmail","sendEmail","emailTo","subject","getApplicationCategoriesList","filterStartEvent","getAdminCasesList","getApplicationProcesses","getProcessVersion","getProcessTasks","getTaskAlarms","getLapseMode","getRecurrMode","getScheduleType","getBossList","addAlarm","editAlarm","deleteAlarm","getAlarmRecipients","addRecipientToAlarm","deleteRecipientsFromAlarm","enableAlarm","abortReassignItems","asyncActivitiesServices","getDefaultAssignationUserToAllProcess","serviceAction","getDefaultAssignationUserToProcess","idWFClass","setDefaultAssignationUserToProcess","getProcessIcon","getCollectionIcon","collectionId","getProfilesTypes","searchProfiles","getUsersByProfile","removeUserFromProfile","addUserToProfile","licenses","getDimensions","editDimension","entityPath","description","createAdministrableDimension","deleteDimension","administrable","entityPathChildNodesAction","nodeType","idNode","nodeDisplayPath","nodePath","getActiveWFClasses","storeDocumentTemplates","restoreDocumentTemplates","Guid","getWorkFlowClasses","getTaskByWorkFlow","modifyProcessDuration","duration","modifyTaskDuration","getDataForMyTeam","getReporstAnalysisQuery","updateReportData","deleteReportData","getStoreLanguageTemplates","justActives","getLanguageTemplate","cultureName","processDefinition","graphicInfo","getLastUpdateByMobile","getCollectionData","idFact","filters","Array","isArray","getVirtualCollectionData","guidVirtualCollection","getSearchData","guidSearch","calculateFilters","serializeEntityData","getCollectionEntityData","templateType","referenceType","surrogateKey","defaultFilterApplied","reference","guidEntityCurrent","xpath","getFiltersEntityData","getProcessAddAction","getMultipleActions","getMapping","getForm","hasStartForm","guid","executeAction","surrogatedKey","ruleId","actionRule","getActivitiesData","pagsize","getPendingsData","getActionsData","getUsersAndEvents","idCases","getUsers","caseId","getEvents","getUsersImages","userIds","width","height","square","getPreferencesCurrentUser","getShortCuts","getSearchLists","getIdCasesOfProcessEntities","ids","server","lessThanOrEqualsTo","getQueryForm","defineFilterObject","filterObject","properties","rangeQuery","searchType","min","max","typeSearch","values","setValues","clone","isDefaultFilter","defaultFilter","val","isNaN","getPlan","getActivities","updatePlan","putExecutePlan","deletePlan","closePlan","getWorkitemsPlan","getTransitionsByPlan","editActivityPlan","activity","items","idPlan","getPlanByParent","getItemsByActivity","getPlanParent","serializedData","_buildNewObject","header","newObject","guidEntity","timestamp","columns","rowData","kRow","iCell","cells","kReturnObject","getCardViewCustomizedColumns","sortData","getLastProcessInboxSort","sortOrder","sortDirection","sortFieldName","isMobileDevice","smartInboxGuid","liveFilterData","smartInboxFilter","encodeLiveFilter","ajaxParams","avoidLoader","setLastProcessInboxProcessColumns","includeSyncErrors","getInboxSyncErrors","localSyncErrors","serializeFilter","CryptoJS","r","lib","o","Base","mixIn","$super","apply","s","WordArray","words","sigBytes","a","clamp","ceil","call","slice","random","c","enc","Hex","join","substr","f","Latin1","charCodeAt","h","Utf8","decodeURIComponent","escape","Error","unescape","u","BufferedBlockAlgorithm","_data","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","splice","Hasher","cfg","_doReset","finalize","_doFinalize","_createHelper","_createHmacHelper","p","HMAC","algo","Math","Base64","_map","charAt","abs","sin","MD5","_hash","d","l","y","_","g","B","x","S","z","D","w","C","floor","HmacMD5","EvpKDF","keySize","hasher","iterations","compute","Cipher","createEncryptor","_ENC_XFORM_MODE","createDecryptor","_DEC_XFORM_MODE","_xformMode","_key","ivSize","encrypt","decrypt","StreamCipher","mode","_iv","_prevBlock","BlockCipherMode","Encryptor","Decryptor","_cipher","processBlock","encryptBlock","decryptBlock","CBC","pad","Pkcs7","unpad","BlockCipher","padding","iv","_mode","CipherParams","formatter","OpenSSL","ciphertext","salt","SerializableCipher","algorithm","_parse","kdf","execute","PasswordBasedCipher","AES","_nRounds","_keySchedule","_invKeySchedule","_doCryptBlock","encode","encoded","allProcessItem","orderValue","unshift","isInboxSystemHeaderSortable","viewType","headersEnabled","wiestimatedsolutiondate","isfavorite","currenttask","wfclsdisplayname","disableProcessColumn","isSmartInbox","fieldFilterName","isInboxHeaderASystemColumn","taskstateColor","cascreationdate","cassolutiondate","taskid","atrisktime","currentuser","currentfullname","guidfavorite","creatorfullname","validateCustomColumn","maxColumnsAllowedOnView","columnsAddedCount","isValid","selectedColumnsCount","isCustomColumn","off","form","getSpecificSmartInbox","settingName","owner","getAllProcessesSmartInbox","getAllCustomizedColumnsSmartInbox","createSmartInbox","updateSmartInbox","model","deleteSmartInbox","shareSmartInbox","getEntityValuesForInboxFilter","entityGuid","getUserTasksForInboxFilter","callServiceWithNetworkRetries","serviceInvocation","pArguments","maxRetries","delayBetweenRetry","currentRetry","currentDeferred","setTimeout","getAndSaveMobileFeaturesFromBizagiConfig","validateIfSaveMobileFeaturesIsEnabled","configuration","features","BIZAGI_WORKPORTAL_WIDGET_START_FORM","args","modules","oldRender","async","activitySelector","renderVersion","resetRouteInformation","route","module","moduleParams","setRenderParams","getRenderParams","_renderParams","renderParams","formsRenderVersion","referrer","isComplex","onClose","isOfflineForm","offlineType","skipSubprocessGlobalForm","BIZAGI_SETTINGS","getRoute","getRenderVersion","getWorkItems","workItems","hasWorkItems","includeSyncErrorIntoModuleparams","setRenderModuleName","getRenderModuleName","searchIdTask","idWorkFlow","mobileAccess","forceOffline","workitemstate","getSyncError","listAsyncWorkItems","checkAsyncWorkItems","msgTask","routeToMessageForm","routeToGlobalForm","routeToGlobalFormWithoutData","workItemIndex","workitemCounter","isAsynch","checkProcess","subProcesses","checkWorkItems","xhr","errorType","renderName","widgetName","workItemsList","workItemToSearch","idCaseForGlobalForm","urlTemplate","printf","withOutGlobalForm","messageForm","formsVersion","isOfflineErrorsViewSupported","getTaskSyncError","idEdited","isOfflineErrorMode","rawData","getSecurity","security","jsonSecurityList","menuSecurity","currentUser","associatedStakeholders","permissions","convertSecurityData","authMenu","permsMenu","getRecursivePerms","perms","checkSecurityPerm","deferred","currentMenuSecurity","getRawData","cachedFacade","getWorkportalFacade","initializeTemplates","facade","initAsyncStuff","getDataService","currentInboxView","deviceFactory","factory","routing","search","getQueryString","isConfiguredFromHash","defaultParams","createWebpart","executeWebpart","creating","doc","ownerDocument","canvas","processWebpart","webpartConfiguration","testWebpartConfiguration","append","executionDeferred","webpartController","deferTemplates","loadWebpart","getWebpart","getMainController","mainController","processOfflineData","deviceFacade","executeWebparts","splitView","hide","isNativePluginSupported","isiOSTabletDevice","isiOSSmartphoneDevice","fetchOfflineData","online","isOfflineFormsV2Supported","getOutboxCasesCount","bizagiapp","openSyncDialog","pushOfflineData","render_module","setup","getWidgetImplementation","widget","getMobileFeaturesFromBizagiConfig","setMobileMetaTags","setMobileIcons","homePortalFramework","homeportalFramework","command","templateService","appendTo","rel","loadTemplate","templateDestination","loadTemplateWebpart","resolvedRemplate","originalAlias","alias","webpartImplementation","_hasConstructorName","constructorName","dynamicFunction","stringBuilder","dynamic","isAuthorized","autorization","noExecuteWebparts","_canExecuteWebparts","loadModule","err","defaultLogout","userProperty","userProperties","startedOffline","sUserProperties","startpage","userstartpage","sortMenuItemsByStartPage","loadReleaseTemplates","getHomePortalConstructorName","loadMeSection","meSection","debug","waits","onError","waitingTime","_isStakeholder","_automaticOrMe","_changingView","actualChanging","isChangingView","_isChangingView","_loadMe","homePortalLayout","homePortalLayoutDashboard","homePortalLayoutTaskFeed","homePortalLayoutComplement","homePortalLayoutSyncErrors","hasStakeholders","_startedOffline","validateUserInformation","_needStakeholderInfo","firstConnectionDone","executeOnFirstOnline","_startedOnline","_firstConDone","_firstConnectionDone","_needWait","_firstConnectionDefer","bizagiModule","logoutPage","getFileImage","files","getEmptyFile","isWebpartInIFrame","top","getFailServerErrorDeferred","b","whenCreated","fullname","whenExecuted","BIZAGI_WORKPORTAL_WEBPART_ROUTING","BIZAGI_WORKPORTAL_WEBPART_RENDER","BIZAGI_WORKPORTAL_WEBPART_ASYNC","BIZAGI_WORKPORTAL_WEBPART_OLDRENDERINTEGRATION","BIZAGI_TAP_EVENT","authorizationRole","_super","helper","pane","project","namespace","isVisible","adjustButtonsToContent","remoteServer","postmessageSocket","postmessage","destination","parent","origin","receive","msg","iframeidentifier","BIZAGI_IFRAME_IDENTIFIER","event","canHide","shortName","webPartDestine","iframeclosemsg","send","showCasesMSG","startReceiving","sendDimensionsiFrame","perm","mandatorysend","iframeDimentions","iframeName","iframeHeight","iframeWidth","notFireToIframe","refresh","contentElement","empty","newContent","manageError","canvasError","errorMsg","endWaiting","hideParent","show","getHomeportalFrameworkIntance","initialParams","navigator","accumulatedContext","navigateFromRender","_homeportalShow","configureHandler","homePortalNavigate","proxy","homePortalViewShow","homePortalViewInit","homePortalViewHide","drawerBeforeShow","loadComponents","component","components","wp","position","$canvas","func","loadComponentTemplate","templateName","wpLayout","direction","homePortalLayoutPositions","where","openDrawer","what","setContextFromRender","showDrawer","closeDrawers","selector","preventNavigate","navigateToRenderTemplates","title","view","isAndroidSmartphoneDevice","_back","notifier","add","drawer","refreshCurrentStatus","scroller","errorsViewTitle","_cleanContext","getActionsContext","actionsContext","surrogateKeyToMapping","addContext","extendCurrentContext","popContext","pop","entityType","trigger","menuHome","layout","dashBoard","reportsChart","loadForm","renderTemplates","caseTemplates","caseTemplatesOptions","stakeHolder","shortCut","searchesList","stuff","req","viewRequirements","_viewTaskFeedMode","homePortalWebpart","menuWebpart","taskFeedLayout","leftPaneViewShown","VIEW_TASKFEED_MODE","CARDS","LIST","viewToShow","_res","_default","taskFeed","summaryItem","getMenuConstructorName","getSummaryItemConstructorName","_backRenderTemplates","_collapseHomePortalPane","collapsePanes","navParams","sender","_openLeftPane","preventDefault","showNewCase","changeView","showSyncPanel","showMenu","updateDataList","reportsChartEndLeftPanel","navLength","history","getKendoMobilePane","reportsChartStartLeftPanel","getMenuWebpartInstance","_leftPanel","_action","toggle","leftDestination","leftContent","expandPanes","homePortalLayoutInit","_view","_newView","_getSetLocalStorage","defaultVal","_actualValue","getItem","_setValue","setItem","isMobileInboxCardViewSupported","instance","showModal","_isReady","menuWebpartInstance","_newInstance","isCardsLayout","reporting","defaultReport","info","reportSet","reports","bamprocessloadanalysis","resource","bamprocessworkinprogress","bamtasksworkinprogress","bamtaskloadanalysis","analyticsprocesscycletime","analyticsprocessdurationhistogram","analyticsprocessactivity","analyticsprocessactivationranking","analyticsprocessfrequentspaths","analyticstaskcycletime","callBack","bamresourcemonitorworkinprogress","bamresourcemonitorworkinprogressuser","bamresourcemonitorworkinprogressteam","sensors","SEARCH_PAGE_SIZE","SEARCH_DELAY","enableOfflineForm","hasOfflineFormsEnabled","searchList","inputTray","referrerParams","isQuickSearchEnabled","loadDataListBeta","loadDataList","solutionDateElement","resultElement","elementLength","dateValue","processName","dataRowWorkItems","counterCase","grouped","getCaseData","dataItem","promises","entity","getActions","actions","startForm","entityName","getCommomActions","selectedItems","tempActions","shift","reduce","every","multiplicity","actionAgreesRules","executeActionSingleData","executeChangeCaseEvent","processEvent","actionType","isMultiInstance","processAction","summary","sticky","class_name","refreshTemplate","entitySurrogateKey","isBatch","readonlyform","showConfirmation","showErrorMessage","executeActionMultipleData","surrogatedKeys","processBatchCreationAction","messageSummary","confirmation","dirty_message","success_summary","actionParams","itemSelected","processAddAction","addAction","xpathContext","actionParam","createParams","notification","formGuid","showConfirmationBox","label","executeRuleAction","promiseData","eventParams","userDataPromise","initials","_getInitials","_getUniqueUsers","merge","_canWorkOnIt","names","uniqueUsers","isAssignee","assigneesUsers","canWorkOnIt","renderHandlerPathRest","form-get-data","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","render-query-getUsersList","case-handler-getCaseSummaryByGuid","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersList-ForXpathIdBossUser","admin-getUsersList-ForXpathIdDelegate","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-sendUserEmail","alert","BA_ACTION_PARAMETER_PREFIX","BA_PAGE_CACHE","BA_MULTIACTION_WITH_LIMIT_NUMBER","BA_MULTIACTION_WITH_LIMIT_QUEUE","multiactionService","multiactionservice","multiactionServiceWithLimit","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","multiaction","multiactionWithLimit","metadataECMMultiaction","getFormData","idForm","idRender","requestedForm","recordXPath","summaryForm","idPageCache","contextType","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","prepare","chrono","initAndStart","stopAndLog","transformGridDataToReadOnly","allowAdd","allowDelete","allowEdit","allowGrouping","allowMore","allowSearch","getSearchFormData","idSearchForm","processDataValues","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","beforeSend","renderingService","newName","isEmptyObject","getPropertyData","extra","property","sessionId","guidentity","pxpath","prows","ppage","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","multiactionConnection","getData","term","getCollapseData","collapseState","getGridData","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","getUploadFileUrl","fileId","verifyPathToBase","downloadFile","fileUrl","queue","processData","binary_file","readFileAsJSON","getResponseHeader","media","byteArrayToBlob","stringToByteArray","reader","FileReader","onloadend","readAsText","binary","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","refreshControl","refreshGridCell","column","typeRender","executeRule","rule","executeInterface","executeSAPConnector","guidsap","executeConnector","guidConnector","executePipeline","pipeline","generateDocumentTemplate","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","getCaseNumber","getGridExportUrl","exportType","to","selected","invalidatePageCache","getUsersList","getUsersListFromQueryForm","getUsersListFromPreferences","getUsersListForXpathIdBossUser","getUsersListForXpathIdDelegate","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","sendUserEmail","eMailTo","forcePersonalizedColumns","templateGuid","isDefaultTemplate","getStartForm","guidprocess","mappingstakeholders","editActionForm","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","getParents","node","parents","fillTree","list","getChildren","child","hasConstructor","guidObject","guidConstructor","getEntityImage64","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","isMashupContext","replaceAll","database","gridService","grid","renderDataService","fileService","file","syncService","sync","formService","getFileService","getSyncService","getGridService","getFormService","alreadyMarkedAsActive","getNativeFormData","getFormDataFromNative","mergeForm","isEdited","getTaskData","syncStatus","formPromise","getTaskForm","mergeDataDocument","complexData","object","mergedForm","getCase","getOfflineImage","fileType","getActivityImage","getStartDataImage","getOfflineActivityDataImage","fileFormat","getActivityDataImage","saveOfflineImage","image","operationType","saveActivityFormImage","saveActivityDataImage","saveStartDataImage","saveOfflineFile","mimeType","saveActivityFormFile","saveActivityDataFile","saveStartDataFile","getOfflineFile","getActivityFile","getStartDataFile","getOfflineActivityDataFile","getActivityDataFile","caseInfo","saveNativeFormInfo","sanityDataForSaveInDB","saveTaskData","saveStartData","deferreds","nativesaveStartData","saveFormData","removeStartCaseSyncError","updatedStartCase","startCase","syncDetails","saveStartCase","removeTaskCaseSyncError","updatedTaskCase","offlineId","getTask","taskCase","saveTask","taskData","retry_h_actions","parseServiceError","callbackArguments","stringError","internalError","parsingError","loaders","isLoading","setLoading","internalBuildOfflineFileLoadingKey","clearLoading","EMPTY_IMAGE","control","buildOfflineFileLoadingKey","getFormContainer","getParams","downloadFormImages","imageControls","filterXpathsByTypeMap","columnImage","signature","forEach","imageControl","buildOfflineImageId","localFiles","downloadImage","isVersion2OrSuperior","compatibilityVersion","getPropertyDataParams","renderId","pageCacheId","downloadImageVersion2","downloadImageVersion1","getUploadFileUrlParams","bulkDownload","ensureImageIsPersistedLocally","getOfflineImageParams","loadImageFromForm","invokeAgain","db","AttachmentType","Blob","blob","sleepFor","base64Image","saveParams","downloadFormFiles","upload","columnUpload","downloadFilesInUploadControl","convertUploadOnlineValueInOfflineValue","uploadControl","singleFileValue","fullXpath","downloadSingleFile","downloadBinaryFile","binaryFile","getFileUrlParams","uploadFormImages","imageValues","uploadImage","uploadFormGridImages","imagesByRow","entityMap","rowKeys","imagesKeys","imageInfo","isNew","newKey","gridXpath","buildCellXpathFilter","columnXpath","uploadParams","addParams","buildAddParamsForUpload","uploadFileName","randomNumber","uploadKey","uploadAddUrl","FormData","isSignature","b64toBlob","uploadAndDeleteFormFiles","uploadValues","uploadControlValue","uploadAndDeleteFiles","uploadFormGridFiles","filesByRow","filesKeys","fileInfo","deleteActions","fileMimeType","uploadFile","deleteParams","deleteAction","attachmentId","blobFile","uploadFileParams","uploadBinaryFile","getFileParams","isStartForm","isEmptyValue","getOfflineImageName","forceChange","changeOfflineImageName","imageName","resolveBlobFromPath","blobPromise","isAndroidDevice","getImagePath","normalizeIOSFilePath","errorHandler","resolveLocalFileSystemURL","fileEntry","readAsArrayBuffer","BIZAGI_SESSION_NAME","queueID","encodeXpath","logKey","syncTraces","getCurrentSyncStep","currentStep","setCurrentSyncStep","step","stepParameters","trace","traceAlreadyAdded","steps","addSyncStepResponse","stepName","stepResponse","stepObject","addCurrentSyncStepResponse","clearTrace","printTrace","traceLogKey","stepIndex","printAndClearTrace","syncOfflineStartCase","loadFormParams","separateComplexControls","separatedCaseData","formId","performSyncOfflineCase","performSyncResponse","updateSyncStatusError","syncOfflineTaskCase","sData","gridActions","collectedFormActions","gridPromises","createCheckpoint","checkpointResponse","processGridRecords","gridActionsResponse","parseGridAdditionsResponse","processUploads","processMultiAction","processMultiactionresponse","lastAction","collectedActions","gridValues","grids","uploadGridData","bizAdditions","bizDeletions","gridVallues","IdEntity","uploadPromises","images","uploads","bizImages","bizFiles","syncActionTagResponse","multiactionResponse","commitResponse","wasActionPerformed","syncAction","getSyncAction","isNextAction","includes","prepareMultiActionData","wasMultiActionPerformed","performCommit","deleteOfflineCase","DataChangesetVersion","containsNext","grep","cleanTaskDataActions","isRetry","performRollback","multiActionData","convertStartFormDataToStandardFormat","submitDataDone","replaceGridChangesWithAddedRows","buttonActions","addButtonActions","trySaveorTryNextAction","addTrySaveOrTryNextAction","oldKey","addedKey","oldXpath","newXpath","button_actions","h_actions","submitDataAction","tag","h_action_item","submitDoneBefore","deleteCase","deleteCaseResponse","updateCaseSyncStatus","updateSyncStatusResponse","updateTaskIsEdited","updateIsEditedResponse","deleteTaskDataParams","deleteAttachments","deleteTaskData","deleteTaskDataResponse","deleteTaskForm","deleteTaskFormResponse","deleteTask","deleteTaskIfNextResponse","deleteError","details","rollbackResponse","cleanTaskDataActionsResponse","openOfflineTask","openOfflineTaskResponse","identifier","syncErrorDetails","buildSyncErrorObject","syncErrorType","performActionObject","singleError","messages","actionResponse","gridsData","promisesResponse","currentGridData","processNewRecords","processDeletedRecords","processImages","processFiles","newRecords","gridNewRecords","creationTimestamp","newRecord","offlineFiles","deletedRecords","getServerTaskForm","hasEntryPipeline","wasPipelineExecuted","executeOfflineEntryPipelineAndReloadForm","pipelineExecutionResponse","getFileAttachmentsFromLocalTaskForm","deleteNextButton","filePromises","imagePromises","downloadAttachmentsPromises","resolvedForm","executeOfflineEntryPipeline","formProperties","hasFormEntryPipeline","loadExecution","getFormDataResponse","localAttachments","downloadOfflineStartForm","isTaskForm","buttons","addFormDefaultButtons","lastSynchronization","saveStartForm","downloadOfflineTaskForm","saveTaskForm","isSingleSync","formNotificationParams","wasFormDownloaded","button","caption","verifyFormEntryPipeline","limit","batch","batchTimer","maxNumberOfActions","deferredBatchExecuting","disabledRequests","circularDependencies","replicateServiceMethods","getService","proxyMethod","method","parameters","originalPrepare","makeCircularDependenciesError","messageTmpl","dependencyFrom","dependencyTo","detectCircularDependencies","addNode","clearTimeout","batchTimeout","singleAction","resolveDependencies","multiactionError","fire","rejectDeferreds","responses","errorMessage","finalResponse","disableRequests","validateIfBatchIsExecuting","readQueryString","disabledb","globalId","BIZAGI_PROXY_PREFIX","createDatabases","_destroy","deleteDatabases","globalIdHash","hashCode","dbRecentProcesses","PouchDB","auto_compaction","dbProcessesHierarchy","dbStartForms","dbStartData","dbActivities","dbActivityForms","dbActivityData","dbProcessColumns","databases","databasesDeleted","restartDatabases","getHierarchyObjects","objects","lastIndexOf","getAllOpenCases","closed","emit","STOREOBJECTNAME","toISOString","offlineCase","_id","creationDate","categoryName","uniqueID","colorState","State","TaskName","get","documentId","deleteDocument","getDocument","processesHierarchyDoc","groupCategory","getGroup","totalApps","tempCategories","subCategories","appId","cat","allDocs","include_docs","total_rows","localCase","DataType","activeProcessesQueryFun","executeQueryPromise","executeQuery","queryResponse","responseRows","casesCount","queryErr","getOutboxCases","attachments","toJqueryPromise","getOutboxTaskCases","getOutboxTaskCasesFilteredBySyncStatus","pSyncStatus","includeDocs","queryMap","emitValue","filterParameters","existantCase","queryFun","getCustomizedColumnsNewData","isAborted","recentProcesses","saveOfflineTasks","tasksMap","saveQueue","bizagiQueue","currentTask","atRiskTime","systemColumns","wfClassDisplayName","saveOrUpdateTask","saveDocument","internalTaskId","currentDocument","saveError","saveProcessCustomColumnsHeaders","workflowId","saveSmartInboxCustomColumnsHeaders","getProcessCustomColumnsHeaders","processErr","systemErr","getSmartInboxCustomColumnsHeaders","generateSortedCasesQuery","openStatus","queryAcrossCustomColums","customColumnsType","filterStatement","emitStatement","argumentsObject","appendStatement","caseIdFilterStatement","Function","currentStatement","newStatement","operator","getCustomColumnsData","generatedQuery","queryExecutionPromise","queryRows","responseItem","headerObject","varSymbol","evalError","objetKeyForFieldName","customColumns","processColumns","smartInboxColumns","applicationColumns","isDraft","queryError","updateTaskWorkItemCustomColumnsByType","customColumnsValues","customColumnProperty","cleanOfflineTasks","getOfflineCases","getLocalActivities","currentRow","docId","updateSyncAttribute","saveResp","validateLocalDataForTaskExists","offlineTaskId","localActivityData","getLocalActivityError","closeOfflineTask","updateTaskDatachangeset","dataChangesetOverride","isEditedOverride","saveAvailableSmartInboxes","docHierarchy","saveAvailableOfflineSmartInboxes","markSmartInboxAsAvailableOffline","getAvailableOfflineSmartInboxes","getAvailableSmartInboxes","taskObject","casesMap","getSyncErrorsList","errors","startCasesResponse","startErrors","serializeError","tasksCasesResponse","tasksErrors","errortype","synctimestamp","activityduedate","offlinetype","isdraft","fillForm","setRenderGridValues","setRenderValues","prop","cause","setDataType","binaryValue","hasSyncErrors","storedDataRows","records","total","lengthColumns","tmpEditAndVisible","lengthRows","idRow","tempRow","col","changes","mergedRow","visible","getSummary","activityCaseId","saveAttachment","dataResult","offlineValue","fileExtension","getFileExtension","getMIMETypeByExtension","updatePromise","resultSave","errorSave","updateTaskForm","localForm","_attachments","mergeTaskAction","oldAction","newAction","mergeObject","depth","reduceLocalGridDeletions","unifiedActions","actionKey","currentAction","canAddActionInList","dataUpdated","performSaveTaskData","dataToSave","saveResult","markTaskPromise","markTaskEdited","markResponse","markError","actionList","actionStored","h_idRender","mergePromise","mergeRes","mergeError","updateResponse","updateErr","getErr","currentTaskData","deletePromise","emptyTaskData","deleteResponse","getDocError","mergeData","filterXpathsByType","xpaths","extractXpathFromRenderProperties","renderProperties","extractRenderElements","typeMap","filteredColumns","renderColumn","datafill","nativeSaveFormInfo","querydisable","pull","getTasksBeforePushPromise","getOfflineTasks","syncOfflineCases","getOfflineTasksError","argument","synchronizing","pushInProgressPromise","syncCasesQueue","syncStarts","syncOfflineStartCases","syncTasks","syncOfflineTaskCases","startToSync","tasksToSync","syncInProgressParams","tasks","parseSyncError","syncSingleOfflineTaskCase","syncCaseParams","generateSyncCasePromise","pushResult","downloadFormAgainPromise","shouldDownloadFormAgain","localTaskForm","shouldRefresh","downloadResult","syncTaskError","internalSyncError","errorResponse","_internalSyncError","syncSingleOfflineStartCase","newCase","syncResponse","syncCaseError","synchCasesQueue","itemId","maxOfflineCases","secondsBeforeAllowFetchAgain","tasksSyncDelta","startSyncDelta","fetchInProgress","triggerOfflineSyncEvent","synchronizeDownloadOfflineState","fetch","timeBeforeFetch","executeFetch","fetchInProgressPromise","downloadStartFormsPromise","downloadTaskFormsPromise","getOfflineTasksProm","getOfflineProcessesProm","getOfflineProcessesHierarchy","formsToDownloadCountPromise","offlineWorkAvailable","offlineProcessesHierarchy","offlineTasksResponse","offlineProcessesList","getProcessesListFromHierarchy","serializedOfflineActivities","serializeActivities","getTasksToDownload","getStartFormsToDownload","tasksToDownloadResponse","startFormsToDownload","processTasksToFetchForms","fetchStartForms","getTasksToDownloadErr","getStartFormsToDownloadErr","startFormsSyncNeededError","offlineTasksError","lastFetch","startResult","tasksResult","getRecentOfflineProcesses","recentProcceses","saveRecentProcesses","offlineProcessTree","processesList","saveProcessesHierarchy","downloadStartForms","getProcessesFromCategory","isProcess","hasOfflineForm","checksQueue","processesToDownload","checkProm","checkIfStartFormNeedsSync","isSyncNeeded","isHardRefreshNeeded","isFirstDayDownload","lastSync","currentTime","getSyncTimeStamp","downloadFormsQueue","formsSuccessCount","formsFailedCount","downloadProm","checkIfDownloadStartFormsEnds","elementsMap","tempElementOriginalValues","isoffline","internalId","serverActivities","localCases","itemsToDownload","itemsCount","servTaskId","servTask","matchingLocalTask","taskFormNeedsRefresh","syncDelda","serverTask","localTask","timeBeforeNextHardRefresh","updateIsRequired","hardRefreshIsRequired","lastFullSync","serverTasks","tasksToDownload","queueReadyToProcess","processOfflineFormsQueue","tasksSuccessfulCount","tasksFailedCount","tasksToDownloadCount","checkIfDownloadTaskFormsEnds","localActivitiesProm","localActivities","localActivityInternalId","deleteLocalDataIfActivityWasNotWorked","saveResponse","downloadOfflineCustomizedColumns","downloadTaskParams","processFormProm","updateActivityDatachangesetAndSyncTimestamp","localDataExists","deleteFullActivityData","deleteActivity","deleteActivityForm","deleteActivityError","deleteFormError","deleteFullActivityDataError","technicalNote","validateLocalDataError","hierarchy","dbProcessRecent","dbProcessHierarchy","dbForms","dbCases","old","syncronized","put","idWf","gId","saveFormInfo","tempDataColumn","lengthCols","assigned","array_cases","objToSend","rta","pivot","rowPos","cellPos","cell","processesHierarchy","dataCategory","dataRecents","processesHierarchyTofetchForms","data1","data2","data3","changeset","getItemLocalStorage","callSyncForms","changeSet","prom","changeSetType","saveProcessesHierarchyTofetchForms","saveProcessInHierarchy","setItemLocalStorage","wfClass","globalid","workFlow","_rev","docRecent","shouldSynchronize","oldOfflineServicesAlreadyEnabled","configureOfflineEvents","fetchWorker","pullWorker","configureOfflineHandlers","configurePushCaseHandler","getNativeComponent","offlineModuleReady","getOfflineCategoriesHandler","getRecentProcessesHandler","createStartFormHandler","getOfflineCasesHandler","getOfflineWorkitemsHandler","pushOfflineDataHandler","cleanDatabasesHandler","getSyncErrorsListHandler","getInboxSyncErrorsHandler","retrySyncSingleOfflineCaseNative","tryPushOfflineCaseHandler","connection","Connection","NONE","queryoffline","onlineServicesHandler","offlineServicesHandler","addEventListener","setOfflineCategories","defaultErrorHandler","setOfflineRecentProcesses","openCreatedStartForm","inboxType","setOfflineInboxCases","deleteOfflineCaseHandler","offlineCaseDeleted","showTaskFeed","syncSingleOfflineCase","IdCase","networkErrorMsg","lastOnlineTimestamp","returnOnlineStatus","setOfflineSyncErrorList","setOfflineInboxSyncErrors","lastConfiguration","getLastProcessInbox","processInfo","saveWorkInProgress","outboxCasesCount","showSyncMessage","notAnError","delegateUserName","idDelegateUser","groupSeparator","language","decimalSeparator","decimalDigits","symbol","ShortDateFormat","TimeFormat","LongDateFormat","twoDigitYearMax","twoDigitYearMaxDelta","uploadMaxFileSize","isMultiOrganization","createDefaultCategories","isMobileSmartInboxEnabled","availableSmartInboxes","offline","getCasesByWorkflowForInboxOffline","getCasesByWorkflowForOtherTrays","getCustomizedColumnsDataTasks","headersType","headersResponse","getOfflineCasesParams","parseCustomizedColumnDataTaskResponse","currTask","isValidRadNumber","buildCaseData","dataFields","defaultSystemHeaders","buildDefaultSystemHeaders","casenumberdisplayname","task","Cases","AnalysisReports","Admin","CurrentUserAdministration","LogOut","SmartFolders","CustomFolders","BizagiQueries","StateLog","PrintableVersion","enableDefaultMethod","inboxSummary","Red","Yellow","Green","Black","All","getNativeWorkItems","getCasesListBetaForInbox","getCasesListBetaForDraftsOrOutBox","getCasesListBetaForOtherTrays","taskFeedData","getTaskFeedData","getLastSelectionCustomColumns","processColumnsInfo","originalEndDate","getTaskFeedStatus","recentProcess","isObjectEmpty","removeOnlineItems","serializeOfflineCustomizedColumns","activityObject","headerIndex","deserializeOfflineCustomizedColumns","rowObject","rowIndex","activityRow","addEvalPropertyToOfflineHeaders","onlineToOfflineMapping","currentHeader","getOfflineSystemHeaders","totalRecords","headersErr","rowsErr","lastProcessInfo","getCustomColumnsParams","updatesQueue","filterSystemHeaders","activityCustomColumns","updateCustomColumnsPromise","getMobileOfflineActivities","isActivityAlreadyDownloaded","isAlreadyDownloaded","getCaseParams","casesListResponse","offlineActivityId","serverActivity","isOnDemand","updateCustomColumns","customColumnsActivites","updateCustomColumnsQueue","updateCustomColumsPromise","downloadActivityOnDemand","isTaskFormAlreadyDownloaded","isFormAlreadyDownloaded","shouldDownloadForm","downloadStartFormOnDemand","isStartFormAlreadyDownloaded","isFormDownloaded","isValidResource","synchronizationFinished","showNotification","systemHeaders","updateSyncErrorsStatus","errorsList","activeElement","blur","infoCase","showMobileToast","enableOfflineEvents","pushStatus","v2Param","synObject","pullObject","awCaseCreationContext","offlineAction","routeWithoutData","diagnostics","dbErrors","deletedDatabasesCount","destroyCallback","currentDatabase","getError","getErrorsList","maxErrors","getErrorsQuery","queryArgs","conflicts","descending","queryRes","DIAGNOSTICS_COMPONENT_NAME","DIAGNOSTICS_SYNC_AJAX_PARAMS","TYPE","DATATYPE","DIAGNOSTICS_PACKAGE_MAX_ERRORS","DIAGNOSTICS_PACKAGE_SYNC_INTERVAL","DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB","DIAGNOSTICS_PACKAGE_MAX_RETRY","diagnosticsServiceEnabled","isMobileErrorTracesEnabled","configureDiagnosticsHandlers","setDiagnosticsDefaultData","lastSyncDatetime","diagnosticstErrorsDb","getDiagnosticsDatabaseInstance","setInterval","syncDiagnosticsError","addDiagnosticsError","line","stackTrace","newError","createDiagnosticsErrorInstance","saveDiagnosticsErrorInDatabase","validateDiagnosticsError","escapeHtml","componentType","getCurrentDiagnosticsEventComponentType","queueEvents","getCurrentDiagnosticsEventsQueue","queueHTTP","getCurrentDiagnosticsHttpQueue","userAgent","getCurrentDatetime","getCurrentDatetimestamp","retryCount","mobileHttpQueue","getDataservice","getQueueListEvents","listEvents","lastEvent","bizagiWorkportal","getDiagnosticsErrorInDatabase","errorId","deleteDiagnosticsErrorInDatabase","deleteDiagnosticsErrorListInDatabase","errorPackageList","deletePromisesArray","Message","updateOrDeleteDiagnosticsErrorInDatabase","errorPackage","updateError","updateOrDeleteDiagnosticsErrorListInDatabase","getCurrentDiagnosticsErrorList","currentErrorList","getDiagnosticsPackageErrors","sendDiagnosticsErrorPackage","getDiagnosticsSystemErrorURL","packageSize","packageErrors","currentError","systemErrorInstance","DateTime","Username","Source","Title","requestSize","getSizeJsonObjectInMegaBytes","dataServiceInstance","syncSystemErrorPromise","errorRest","DIAGNOSTICS_OBSERVER_COMPONENT_NAME","DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED","DIAGNOSTICS_OBSERVER_MAX_EVENTS_IN_QUEUE","DIAGNOSTICS_OBSERVER_MAX_PATH_EVENT","DIAGNOSTICS_OBSERVER_OBSERVER_OPTIONS","attributes","childList","characterData","subtree","DIAGNOSTICS_OBSERVER_MAX_SIZE_HTML_EVENT_MB","DIAGNOSTICS_OBSERVER_COMPONENT_TYPES","FORM","DISCUSSIONS","ACTION_SHEET","FILES","MAIN_MENU","SUMMARY_CASE","setDiagnosticsObserverDefaultData","configureDiagnosticsObserverHandlers","diagnosticsObserverEventsQueue","MutationObserver","WebKitMutationObserver","MozMutationObserver","setTouchEndObserver","eventsObserver","ontouchend","addDiagnosticsObsercerEvent","getEventObject","observe","composedPath","getDiagnosticsElementComponentType","dateTime","srcElement","getDiagnosticsElementPath","sourcePath","pathList","parentProperties","validateElement","validateDiagnosticsIfContainsElement","getDiagnosticsElementComponentTypeByClass","getDiagnosticsElementComponentTypeById","validateDiagnosticsKendoView","getLastProcessInboxInputTray","DIAGNOSTICS_WAIT_APPLICATION_STARTED","configureDiagnosticsErrorObserverHandlers","onerror","sendDiagnosticsError","getErrorsInAjaxImplementation","dataserviceInstance","getJqueryAjax","ajaxInstance","mobileHttpErrorsQueue"],"mappings":"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","sourcesContent":["function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;} /*\r\n                                                                                                                                                                                                           *   Name: BizAgi Services WorkPortal End Points\r\n                                                                                                                                                                                                           *   Author: Diego Parra (based on Edward Morales version)\r\n                                                                                                                                                                                                           *   Comments:\r\n                                                                                                                                                                                                           *   -   This script defines all the end-points used to retrieve ajax stuff\r\n                                                                                                                                                                                                           *   -   All urls must be relative to the base application\r\n                                                                                                                                                                                                           */\n\n// Create or define namespace\nbizagi.workportal = typeof bizagi.workportal !== \"undefined\" ? bizagi.workportal : {};\nbizagi.workportal.services = typeof bizagi.workportal.services !== \"undefined\" ? bizagi.workportal.services : {};\nbizagi.workportal.services.endPoints = [];\n\n// Creates a endpoint hash factory to resolve custom requirements\nbizagi.workportal.services.getEndPoints = function (params) {\n  // Default workportal end-points\n  if (params.context == \"workportal\") {var _endPoints;\n    var endPoints = (_endPoints = {\n      \"user-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx\",\n      \"process-handler\": params.proxyPrefix + \"RestServices/ProcessHandler.ashx\",\n      \"query-handler\": params.proxyPrefix + \"Rest/Handlers/Query\",\n      \"case-handler\": params.proxyPrefix + \"RestServices/CaseHandler.ashx\",\n      \"query-form\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\n      \"query-form-edit\": params.proxyPrefix + \"App/ListaDetalle/SaveQuery.aspx\",\n      \"query-form-delete\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\n      \"query-form-delete-cube\": params.proxyPrefix + \"Rest/Queries/Cubes/{idCube}\",\n      \"favorites-handler\": params.proxyPrefix + \"RestServices/FavoritesHandler.ashx\",\n      \"file-handler\": params.proxyPrefix + \"RestServices/EntityHandler.ashx\",\n      \"login-handler\": params.proxyPrefix + \"Rest/Users/UserAuthentication\",\n      \"login-handlerv10\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}\",\n      \"logoff-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=logOff\",\n      \"logoff-handlerv1\": params.proxyPrefix + \"Rest/Users/LogOff\",\n\n      // Rest Services\n      \"authorization-handler-getMenuAuthorization\": params.proxyPrefix + \"Rest/Authorization/MenuAuthorization\",\n      \"authorization-handler-isCaseCreationAuthorized\": params.proxyPrefix + \"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized\",\n      \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/Summary\",\n\n      //ReleaseActivityResponse\n      \"case-handler-releaseActivity\": params.proxyPrefix + \"Rest/Cases/{idCase}/ReleaseActivity\",\n\n      //mobile beta services\n      \"case-handler-getCasesList\": params.proxyPrefix + \"Rest/Processes/SearchCases\",\n      \"case-handler-getActivityList\": params.proxyPrefix + \"Api/Cases/Activities\",\n\n      // Services to Offline capability\n      \"offline-getProcessTree\": params.proxyPrefix + \"Rest/Processes/OfflineProcessTree\",\n\n      //\"offline-getForms\": params.proxyPrefix + \"Rest/Handlers/Render\",\n      \"offline-tasks\": params.proxyPrefix + \"Api/Cases/GetOfflineTasks\",\n      \"offline-getForms\": params.proxyPrefix + \"Rest/RenderForm/offlineForms\",\n      \"offline-sendForm\": params.proxyPrefix + \"Rest/Cases/SaveAsynchWorkItemOffLine\",\n\n      // StartProcess\n      \"case-handler-getCaseTasks\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks\",\n      \"case-handler-getCaseEvents\": params.proxyPrefix + \"Rest/Cases/{idCase}/Events\",\n      \"case-handler-getCaseSubprocesses\": params.proxyPrefix + \"Rest/Cases/{idCase}/Subprocesses\",\n      \"case-handler-getTaskAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees\",\n      \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\",\n      \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\n      \"case-handler-getAsynchExecutionState\": params.proxyPrefix + \"Rest/Cases/{idCase}/AsynchExecutionState\",\n      \"case-handler-addNewCase\": params.proxyPrefix + \"Rest/Cases\",\n      \"case-handler-startProcess\": params.proxyPrefix + \"Rest/Processes/StartProcess/{idProcess}\",\n      \"handler-execute-action-start\": params.proxyPrefix + \"Api/Cases/{processId}/Start\",\n      \"case-handler-supportedLogTypes\": params.proxyPrefix + \"Rest/Cases/SupportedLogsTypes\",\n      \"case-handler-getActivityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/ActivityLog\",\n      \"case-handler-getActivityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idWorkItemFrom}/ActivityDetailLog\",\n      \"case-handler-getEntityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityLog\",\n      \"case-handler-getEntityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityDetailLog\",\n      \"case-handler-getUserLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/UserLog\",\n      \"case-handler-getUserDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idUser}/UserDetailLog\",\n      \"case-handler-getAdminLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/AdminLog\",\n      \"case-handler-getCaseFormsRenderVersion\": params.proxyPrefix + \"Rest/Cases/{idCase}/FormsRenderVersion\",\n      \"case-handler-validateHasStartForm\": params.proxyPrefix + \"Api/Processes/{processId}/StartContext\",\n\n      //Favorites Restful\n      \"favorites-handler-saveFavorite\": params.proxyPrefix + \"Rest/Favorites\",\n      \"favorites-handler-deleteFavorite\": params.proxyPrefix + \"Rest/Favorites/{guidFavorite}\",\n\n      //ICONS && IMAGES\n      \"process-getIcon\": params.proxyPrefix + \"Api/Processes/{processId}/Icon\",\n      \"collections-getIcon\": params.proxyPrefix + \"Api/CurrentUser/Collections/{collectionId}/Icon\",\n\n      //BAMAnalytics Restful\n      \"bamAnalytics-handler-getAnalisysQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/AnalisysQueries\",\n      \"bamAnalytics-handler-updateQuery\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/Ids/{idQuery}\",\n\n      //Inbox Restful\n      \"inbox-handler-getInboxSummary\": params.proxyPrefix + \"Rest/Inbox/Summary\",\n      \"inbox-handler-getFullInboxSummary\": params.proxyPrefix + \"Rest/Inbox/FullSummary\",\n\n      //Messages Restful\n      \"MessageHandler-NewComment\": params.proxyPrefix + \"Rest/Cases/Comments\",\n      \"MessageHandler-GetComments\": params.proxyPrefix + \"Rest/Cases/Comments\",\n      \"MessageHandler-SetCategoryToComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\n      \"MessageHandler-RemoveComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\n      \"MessageHandler-ReplyComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies\",\n      \"MessageHandler-RemoveReply\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies/{idReply}\",\n      \"MessageHandler-GetCategoryColors\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors\",\n      \"MessageHandler-RenameCategoryColor\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors/{idColorCategory}\",\n      \"MessageHandler-CountNewComments\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/NewComments/Count\",\n\n      //Processes Restful\n      \"process-handler-getAllProcesses\": params.proxyPrefix + \"Rest/Processes\",\n      \"process-handler-getFavourites\": params.proxyPrefix + \"Rest/Home/MyFavorites/Count\",\n      \"process-handler-getFavouriteCases\": params.proxyPrefix + \"Rest/Home/MyFavorites\",\n      \"process-handler-getCustomizedColumnsData\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsData\",\n      \"process-handler-getCategory\": params.proxyPrefix + \"Rest/Processes/Categories\",\n      \"process-handler-getRecentProcesses\": params.proxyPrefix + \"Rest/Processes/RecentProcesses\",\n      \"process-handler-getCustomizedColumnsDataInfo\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsDataInfo\",\n      \"process-handler-getOrganizations\": params.proxyPrefix + \"Rest/Profile/Organizations\",\n      \"process-handler-getOrganizationsByUser\": params.proxyPrefix + \"Rest/Profile/OrganizationsByUser\",\n\n      //SmartInbox\n      \"smartinbox-entity-values\": params.proxyPrefix + \"api/SmartInbox/Detail/EntityValues/{entityGuid}\",\n      \"smartinbox-getAllInbox\": params.proxyPrefix + \"api/SmartInbox/All\",\n      \"smartinbox-user-tasks\": params.proxyPrefix + \"api/SmartInbox/Detail/UserTasks/{smartInboxId}\",\n      \"smartinbox-user-tasks-process\": params.proxyPrefix + \"api/SmartInbox/Detail/UserTasks/ByProcess/{workflowId}\",\n\n      //workportal\n      \"process-handler-getMyStuff\": params.proxyPrefix + \"Api/CurrentUser/Collections\",\n      \"process-handler-getIdCasesOfProcessEntities\": params.proxyPrefix + \"Api/Entities/Cases\",\n      \"templates-handler-getCollectionData\": params.proxyPrefix + \"Api/Collection/{idFact}/Data\",\n      //\"data-navigation-handler\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Data/{surrogateKeyLeftEntity}\",\n      \"data-navigation-handler-collection\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}\",\n      \"data-navigation-handler-entity\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}\",\n      \"data-navigation-handler-entity-filters\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}\",\n\n      //\"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Collection/{guidFact}/Actions\",\n      \"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions\",\n\n      //My Searches\n      'my-search-getSearchLists': params.proxyPrefix + \"Api/CurrentUser/Searches\",\n      'my-search-getFilters': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Filters\",\n      'my-search-getFiltersData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/FilterData\",\n      'my-search-getData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Data\",\n\n      \"templates-handler-getVirtualCollectionData\": params.proxyPrefix + \"Api/Collection/{guidVirtualCollection}/VirtualData\",\n      \"templates-handler-getMultipleActions\": params.proxyPrefix + \"Rest/Entities/multipleInstancesActions\",\n\n      \"process-handler-getMapping\": params.proxyPrefix + \"Rest/Entities/Mapping\",\n      \"process-handler-getForm\": params.proxyPrefix + \"Rest/Handlers/Render\",\n      \"process-handler-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      //\"process-handler-rule\": params.proxyPrefix + \"Rest/Action/Rule\",\n      \"process-handler-rule\": params.proxyPrefix + \"Api/Rules/{ruleId}/Execute\",\n      //\"process-action-execute\" : params.proxyPrefix + \"Api/Action/Execute\",\n      \"process-action-execute\": params.proxyPrefix + \"Api/Rules/{ruleId}/ExecuteMultiple\",\n      \"process-handler-getActivitiesData\": params.proxyPrefix + \"Api/Processes/CasesData/MyActivities\",\n      \"process-handler-getPendingsData\": params.proxyPrefix + \"Api/Processes/CasesData/MyPendings\",\n\n      //\"entities-handler-getActions\" : params.proxyPrefix + \"Rest/Entities/Actions\",\n      \"entities-handler-getActions\": params.proxyPrefix + \"Api/Entities/{guidEntity}/{surrogateKey}/actions\",\n      \"entities-handler-getUsersAndEvents\": params.proxyPrefix + \"Rest/Processes/CasesData/UsersAndEvents\",\n      \"entities-handler-getUsers\": params.proxyPrefix + \"Api/Cases/{caseId}/Users\",\n      \"entities-handler-getEvents\": params.proxyPrefix + \"Api/Cases/{caseId}/CurrentEvents\",\n      \"entities-handler-getUsersImages\": params.proxyPrefix + \"Rest/Users/UserPictures\",\n      \"entities-handler-getShotCuts\": params.proxyPrefix + \"Api/CurrentUser/Shortcuts\",\n\n      //Queries Restful\n      \"query-handler-getqueries\": params.proxyPrefix + \"Rest/Queries\",\n      \"query-handler-getQueryForm\": params.proxyPrefix + \"Rest/Handlers/Render\",\n\n      //Users Restful\n      \"user-handler-getCurrentUser\": params.proxyPrefix + \"Rest/Users/CurrentUser\",\n\n      // Old render integration, readonly\n      \"old-render\": params.proxyPrefix + \"App/ListaDetalle/Detalle.aspx\",\n\n      //Service locator for reports\n      \"Reports\": params.proxyPrefix + \"RestServices/BAMAnalyticsHandler.ashx\",\n      \"reports-handler-deleteQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/{QueryId}\",\n\n      //Service locator for bizagi folders\n      \"folders-handler-getUserQueries\": params.proxyPrefix + \"Rest/SmartFolders\",\n      \"folders-associate-deleteSmartFolder\": params.proxyPrefix + \"Rest/SmartFolders/{idSmartFolder}\",\n      \"folders-handler\": params.proxyPrefix + \"RestServices/SmartFoldersHandler.ashx\",\n      \"folders-associate\": params.proxyPrefix + \"App/Ajax/AJAXGateway.aspx\",\n      \"smartfolders-integration\": params.proxyPrefix + \"App/WorkPortal/ConfigureFilteredFolder.aspx\",\n\n      //Service locator for menu\n      \"AlarmAdmin\": params.proxyPrefix + \"App/Admin/AlarmsAdmin.aspx\",\n      \"AnalyticsProcess\": params.proxyPrefix + \"App/Cockpit/AnalyticsProcess.aspx\",\n      \"AnalyticsSensor\": params.proxyPrefix + \"App/Cockpit/AnalyticsSensor.aspx\",\n      \"AnalyticsTask\": params.proxyPrefix + \"App/Cockpit/AnalyticsTask.aspx\",\n      \"AsynchronousWorkitemRetries\": params.proxyPrefix + \"App/Admin/AsynchDisabledWorkitems.aspx\",\n      \"AuthenticationLogQuery\": params.proxyPrefix + \"App/Admin/AuthLogQuery.aspx\",\n      \"BAMProcess\": params.proxyPrefix + \"App/Cockpit/BAMProcess.aspx\",\n      \"BAMTask\": params.proxyPrefix + \"App/Cockpit/BAMTask.aspx\",\n      \"BusinessPolicies\": params.proxyPrefix + \"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx\",\n      \"CaseAdmin\": params.proxyPrefix + \"App/Admin/CaseSearch.aspx\",\n      \"adminReassignCases\": \"CaseAdmin\", // Open workportal module called 'adminCases'\n      \"asyncECMUpload\": \"asyncECMUpload\", // Open workportal module called 'asyncECMUpload'\n      \"CasesMonitor\": params.proxyPrefix + \"App/Admin/CasesMonitor.aspx\",\n      \"Closed\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed\",\n      \"CurrentUser\": params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\n      \"EncryptionAdmin\": params.proxyPrefix + \"App/Admin/Encrypt.aspx\",\n      \"MobileUpdatesAdmin\": params.proxyPrefix + \"App/MobileUpdates/default.aspx\",\n      \"EntityAdmin\": params.proxyPrefix + \"App/Admin/Entity.aspx\",\n      \"LocationResources\": params.proxyPrefix + \"App/Admin/AdminLocResources.aspx\",\n      \"NewCase\": params.proxyPrefix + \"App/Radicar/application.aspx\",\n      \"Pending\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running\",\n      \"Profiles\": params.proxyPrefix + \"App/Admin/ProfilesAdminSearch.aspx\",\n      \"Search\": params.proxyPrefix + \"App/ListaDetalle/Search.aspx\",\n      \"UserAdmin\": params.proxyPrefix + \"App/Admin/ListUsers.aspx\",\n      \"UserDefaultAssignation\": params.proxyPrefix + \"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1\",\n      \"UserPendingRequests\": params.proxyPrefix + \"App/Admin/UserPendingRequests.aspx\",\n      \"ListPreferences\": bizagi.UserPreferencesUrl !== \"\" ? params.proxyPrefix + bizagi.UserPreferencesUrl : params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\n      \"GRDimensionAdmin\": params.proxyPrefix + \"App/Cockpit/DimensionEdit.aspx\",\n      \"Licenses\": params.proxyPrefix + \"App/Admin/Licenses.aspx\",\n      \"AnalysisQueries\": params.proxyPrefix + \"App/Inicio/WPAnalysisQuery.aspx\",\n      \"DocumentTemplates\": params.proxyPrefix + \"App/Admin/AdminDocumentTemplates.aspx\",\n      \"ProcessAdmin\": params.proxyPrefix + \"App/Admin/AdminProcess.aspx\",\n      \"ResourceBAM\": params.proxyPrefix + \"App/Cockpit/BAMResourceMonitor.aspx\",\n      \"WorkPortalVersion\": params.proxyPrefix + \"Rest/Util/Version\",\n\n      // entities administration\n      \"entities-administration\": \"RestServices/EntityHandler.ashx\",\n\n      //Theme Rest Service Handler\n      \"theme-handler-getLogoImagePath\": params.proxyPrefix + \"Rest/Theme/LogoImage\",\n\n      // Logout Service, already implemented on java environment\n      \"logout\": params.proxyPrefix + \"Rest/Authentication/logout\",\n      \"logoutDotNet\": params.proxyPrefix + \"App/Inicio/LogOff.aspx\",\n      \"authenticationConfig\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\n      \"logout-oauth2\": params.proxyPrefix + \"Api/Authentication/OAuth2/IdentityProvider/Server/Logout\",\n      \"FederateLogoffUrl\": params.proxyPrefix + \"Api/Authentication/FederateLogoffUrl\",\n      \"oauth2AuthenticationConfig\": params.proxyPrefix + \"Api/Authentication/OAuth2/OAuth2AuthenticationConfig\",\n\n      //Massive Activity Asigments\n      \"massive-activity-assignments-getOrganizationInfo\": params.proxyPrefix + \"Rest/Users/OrganizationInfo\",\n      \"massive-activity-assignments-getCasesByOrganization\": params.proxyPrefix + \"Rest/Queries/GetCasesByOrganization\",\n      \"massive-activity-assignments-reassignCases\": params.proxyPrefix + \"Rest/Cases/ReassignCases\",\n      \"massive-activity-assignments-searchUsers\": params.proxyPrefix + \"Rest/Users/\",\n\n      //Asynchronous ECM Upload\n      \"async-ecm-upload-baseService\": params.proxyPrefix + \"Rest/Handlers/Metadata\",\n\n      // Workportal\n      \"domains\": params.proxyPrefix + \"Rest/Authentication/Domains\",\n\n      // Theme Builder\n      //\"ThemeBuilder\": params.proxyPrefix + \"ThemeBuilder/index.html?language=\" + bizagi.localization.language,\n      \"getCurrentTheme\": params.proxyPrefix + \"Api/Theme/Current\",\n\n      //Frankenstein\n      \"admin-getAuthenticationLog\": params.proxyPrefix + \"Rest/Users/AuthLog\",\n      \"admin-getAuthenticationDomains\": params.proxyPrefix + \"Rest/Users/Domains\",\n      \"admin-getAuthenticationEventsTypes\": params.proxyPrefix + \"Rest/Users/EventTypes\",\n      \"admin-getAuthenticationEventSubTypes\": params.proxyPrefix + \"Rest/Users/EventSubTypes\",\n      \"admin-EncryptString\": params.proxyPrefix + \"Rest/Util/EncryptString\",\n      \"admin-UserPendingRequests\": params.proxyPrefix + \"Rest/Users/UserPendingRequests\",\n      \"admin-UserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UserAuthenticationInfo\",\n      \"admin-updateUserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UpdateUserAuthenticationInfo\",\n      \"admin-generateRandomPassword\": params.proxyPrefix + \"Rest/Util/GenerateRandomPassword\",\n      \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\n      \"admin-sendEmail\": params.proxyPrefix + \"Rest/Util/SendEmail/\",\n      \"admin-getApplicationList\": params.proxyPrefix + \"Rest/Application\",\n      \"admin-getApplicationProcesses\": params.proxyPrefix + \"Rest/Application/{idApp}/Process\",\n      \"admin-getProcessVersion\": params.proxyPrefix + \"Rest/Processes/Version\",\n      \"admin-getProcessTasks\": params.proxyPrefix + \"Rest/Processes/Version/{version}/Tasks\",\n\n      //servicios alarmas\n      \"admin-getTaskAlarms\": params.proxyPrefix + \"Rest/Alarm/TaskAlarms\",\n      \"admin-getLapseMode\": params.proxyPrefix + \"Rest/Alarm/LapseMode\",\n      \"admin-getRecurrMode\": params.proxyPrefix + \"Rest/Alarm/RecurrMode\",\n      \"admin-getScheduleType\": params.proxyPrefix + \"Rest/Alarm/ScheduleType\",\n      \"admin-getBossList\": params.proxyPrefix + \"Rest/Alarm/Boss\",\n      \"admin-addAlarm\": params.proxyPrefix + \"Rest/Alarm\",\n      \"admin-editAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}\",\n      \"admin-deleteAlarm\": params.proxyPrefix + \"Rest/Alarm\",\n      \"admin-alarmRecipients\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient\",\n      \"admin-deleteAlarmRecipients\": params.proxyPrefix + \"Rest/Alarm/Recipient\",\n      \"admin-recipientToAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}\",\n      \"admin-enableAlarm\": params.proxyPrefix + \"Rest/Alarm/Task/{idTask}/ToggleAlarm\",\n      \"admin-getCategoriesList\": params.proxyPrefix + \"Rest/Application/Category\",\n      \"admin-getCasesList\": params.proxyPrefix + \"Rest/Queries/SearchCases\",\n      \"admin-abortItems\": params.proxyPrefix + \"Rest/Cases/Abort\",\n      \"admin-reassignItems\": params.proxyPrefix + \"Rest/Cases/Reassign\",\n      \"admin-getDefaultAssignationUserToAllProcess\": params.proxyPrefix + \"Rest/Users/{serviceAction}/\",\n      \"admin-getDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\n      \"admin-setDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\n      \"admin-getProfilesTypes\": params.proxyPrefix + \"Rest/Profile/Types\",\n      \"admin-searchProfiles\": params.proxyPrefix + \"Rest/Profile\",\n      \"admin-getUsersByProfile\": params.proxyPrefix + \"Rest/Users/Profile/{type}/{id}\",\n      \"admin-removeUserFromProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\n      \"admin-addUserToProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\n      \"admin-async-activities-get-activities\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities\",\n      \"admin-async-activities-get-retry-now\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/RetryNow\",\n      \"admin-async-activities-get-activities-by-task\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities/Task\",\n      \"admin-async-activities-enable-execution\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Enable\",\n      \"admin-async-activities-enable-multiple\": params.proxyPrefix + \"Rest/Cases/Asynchronous/EnableMultiple\",\n      \"admin-async-activities-async-execution\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution\",\n      \"admin-async-activities-async-execution-log\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/AsynchExecutionLog\",\n      \"admin-Licenses\": params.proxyPrefix + \"Rest/Licenses\",\n      \"admin-GetDimensions\": params.proxyPrefix + \"Rest/Dimensions\",\n      \"admin-EditDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}\",\n      \"admin-CreateAdministrableDimension\": params.proxyPrefix + \"Rest/Dimensions/Administrable\",\n      \"admin-DeleteDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}?isAdministrable={administrable}\",\n      \"admin-EntityPathChildNodesAction\": params.proxyPrefix + \"Rest/Dimensions/EntityChildNodes\",\n      \"admin-GetActiveWFClasses\": params.proxyPrefix + \"Rest/Dimensions/ActiveProcess\",\n      \"admin-document-templates-storeDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/StoreDocumentTemplates\",\n      \"admin-document-templates-restoreDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/RestoreDocumentTemplate\",\n      \"admin-document-templates-uploadDocumentTemplate\": params.proxyPrefix + \"Rest/DocumentTemplates/UploadDocumentTemplate\",\n      \"admin-processes-workflowClasses\": params.proxyPrefix + \"Rest/Processes/WorkflowClasses\",\n      \"admin-processes-tasksByWorkflow\": params.proxyPrefix + \"Rest/Processes/TasksByWorkflow\",\n      \"admin-processes-modifyProcessDuration\": params.proxyPrefix + \"Rest/Processes/{idWorkflow}/Duration/\",\n      \"admin-processes-modifyTaskDuration\": params.proxyPrefix + \"Rest/Processes/Task/{idTask}/Duration/\",\n      \"admin-language-resource\": params.proxyPrefix + \"Rest/Multilanguage/Resource\",\n      \"admin-language-languages\": params.proxyPrefix + \"Rest/Multilanguage/Languages\",\n      \"bam-resourcemonitor-myteam\": params.proxyPrefix + \"Rest/Reports/BAM/Resources/MyTeam\",\n      \"reports-analysisquery\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\n      \"reports-analysisquery-update\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\n      \"reports-analysisquery-delete\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\n      \"processviewer-processdefinition\": params.proxyPrefix + \"Rest/Reports/Components/ProcessDefinition\",\n      \"processviewer-processgraphicinfo\": params.proxyPrefix + \"Rest/Reports/Components/ProcessGraphicInfo\",\n\n      // Mobile Updates\n      \"mobile-getLastUpdate\": params.proxyPrefix + \"Rest/Util/mobileUpdates\",\n\n      //discussionCase\n      \"discussion-case\": params.proxyPrefix + \"Api/CaseResource/Discussion?globalParent={globalParent}\",\n      \"discussion-case-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/Discussion\",\n      \"get-users\": params.proxyPrefix + \"Rest/Users/UserPictures\",\n      \"new-discussion\": params.proxyPrefix + \"Api/CaseResource/Discussion\",\n      \"count-comments\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment/Count\",\n      \"comment-case\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment\",\n      \"new-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\n      \"new-comment-attach\": params.proxyPrefix + \"Api/CaseResource/Attachment\",\n      \"get-list-files\": params.proxyPrefix + \"Api/CaseResource/File?globalParent={globalParent}\",\n      \"get-list-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File\",\n      \"project-resource-action\": params.proxyPrefix + \"Api/CaseResource/{typeResource}\",\n      \"thumbnail-file\": params.proxyPrefix + \"Api/CaseResource/File/Thumbnails?globalParent={globalParent}\",\n      \"get-attachment\": params.proxyPrefix + \"Api/CaseResource/Attachment/{idAttachment}\",\n      \"get-mobile-attachment\": params.proxyPrefix + \"Api/CaseResource/Mobile/Attachment/{idAttachment}\",\n\n      //Files and Attachments\n      \"project-files-upload\": params.proxyPrefix + \"Api/CaseResource/File\",\n      \"count-files\": params.proxyPrefix + \"Api/CaseResource/File/Count?globalParent={globalParent}\",\n      \"count-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File/Count\",\n      \"remove-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\n\n      //Mobile CaseSummary\n      \"time-schemas-effectiveduration\": params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\" }, _defineProperty(_endPoints, \"case-handler-getCaseAssignees\",\n    params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\"), _defineProperty(_endPoints,\n    \"project-users-get\", params.proxyPrefix + \"Rest/Users/UserPictures\"), _defineProperty(_endPoints,\n    \"case-summary-task-options\", params.proxyPrefix + \"Rest/Cases/WorkItems/{idWorkitem}/TaskOptions?idCase={idCase}\"), _defineProperty(_endPoints,\n\n    \"project-plan-get\", params.proxyPrefix + \"Api/Plans/{idPlan}\"), _defineProperty(_endPoints,\n    \"project-plan-activities\", params.proxyPrefix + \"Api/Plans/{idPlan}/Activities\"), _defineProperty(_endPoints,\n    \"project-plan-workitems\", params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItems\"), _defineProperty(_endPoints,\n    \"project-plan-transitions-get\", params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/Transitions\"), _defineProperty(_endPoints,\n    \"project-plan-activity-edit\", params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/{id}\"), _defineProperty(_endPoints,\n    \"project-plan-get-by-parent\", params.proxyPrefix + \"Api/Plans?parentWorkItem={parentWorkItem}\"), _defineProperty(_endPoints,\n    \"project-plan-parent\", params.proxyPrefix + \"Api/Plans/{idPlan}/ParentCase\"), _defineProperty(_endPoints,\n    \"project-plan-update\", params.proxyPrefix + \"Api/Plans/{idPlan}\"), _defineProperty(_endPoints,\n    \"project-plan-execute\", params.proxyPrefix + \"Api/Plans/Execute\"), _defineProperty(_endPoints,\n    \"project-plan-close\", params.proxyPrefix + \"Api/Plans/Close\"), _defineProperty(_endPoints,\n    \"project-plan-delete\", params.proxyPrefix + \"Api/Plans/{idPlan}\"), _defineProperty(_endPoints,\n    \"project-plan-first-parent-plan\", params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlan\"), _defineProperty(_endPoints,\n\n\n    \"PreferencesWorkportalCurrentUser\", params.proxyPrefix + \"Api/Users/Data/WindowPreferences\"), _defineProperty(_endPoints,\n\n\n    \"diagnostics-sync-system-error\", params.proxyPrefix + \"api/ErrorLogs/Import\"), _endPoints);\n\n\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n\n      endPoints[\"user-handler-getCurrentUser\"] = params.proxyPrefix + \"Rest/Users/CurrentUserGuid\";\n      endPoints[\"get-users\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\n      endPoints[\"entities-handler-getUsersImages\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\n      endPoints[\"project-users-get\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\n\n      endPoints[\"entities-handler-getUsers\"] = params.proxyPrefix + \"Api/Cases/{caseId}/UsersGuid\";\n      //endPoints[\"case-handler-getWorkItems\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItemsGuid\";\n      endPoints[\"case-handler-getCaseSummary\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\";\n      endPoints[\"case-handler-getCaseAssignees\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\";\n\n      endPoints[\"discussion-case\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid?globalParent={globalParent}\";\n      //endPoints[\"discussion-case-v1\"] = params.proxyPrefix + \"Api/CaseResource/{globalParent}/DiscussionGuid\";\n      endPoints[\"new-discussion\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid\";\n\n      endPoints[\"comment-case\"] = params.proxyPrefix + \"Api/CaseResource/{idParent}/CommentGuid\";\n      endPoints[\"new-comment\"] = params.proxyPrefix + \"Api/CaseResource/CommentGuid\";\n\n      endPoints[\"project-files-upload\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid\";\n      endPoints[\"get-list-files\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid?globalParent={globalParent}\";\n\n      //Mobile case summary\n      endPoints[\"time-schemas-effectiveduration\"] = params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDurationGuid?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\";\n      //Mobile plans\n      endPoints[\"project-plan-get\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\n      endPoints[\"project-plan-update\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\n      endPoints[\"project-plan-activities\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid\";\n      endPoints[\"project-plan-workitems\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItemsGuid\";\n      endPoints[\"project-plan-first-parent-plan\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlanGuid\";\n      endPoints[\"project-plan-activity-edit\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid/{id}\";\n\n    }\n\n    return endPoints;\n  }\n  return {};\n};","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra (based on Edward Morales version)\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to workportal REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n$.Class.extend(\"bizagi.workportal.services.service\", {\n  // Statics\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  ENTITIES_QUERY_PAGE_SIZE: 10 },\n{\n  /*\r\n   *   Constructor\r\n   */\n  init: function init(params) {\n    var self = this;\n    params = _typeof(params) == \"object\" ? params : {};\n    params.context = !bizagi.util.isEmpty(params.context) ? params.context : \"workportal\";\n\n    params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    params.proxyPrefix = this.normalizeUrl(params.proxyPrefix);\n    bizagi.RPproxyPrefix = params.proxyPrefix;\n\n\n    params.sharepointProxyPrefix = !bizagi.util.isEmpty(params.sharepointProxyPrefix) ? params.sharepointProxyPrefix : \"\";\n    params.sharepointProxyPrefix = this.normalizeUrl(params.sharepointProxyPrefix);\n\n    this.serviceLocator = new bizagi.workportal.services.context(params);\n\n    // Define default value of number of records to show\n    this.pageSize = 10;\n\n    this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone : bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet : bizagi.deviceEnum.desktop);\n    this.deviceCode = bizagi.util.getDeviceCode();\n\n    // Get override for pageSize, use BIZAGI_INBOX_ROWS_PER_PAGE constant within config file\n    if (typeof BIZAGI_INBOX_ROWS_PER_PAGE !== \"undefined\") {\n      this.pageSize = $.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE) ? BIZAGI_INBOX_ROWS_PER_PAGE : this.pageSize;\n    }\n    this.activeForm = undefined;\n\n    this.configureGlobalHandlers();\n  },\n\n  /**\r\n      * This method will return the url defined as endPoint using the parameter 'endPoint' name\r\n      */\n  getUrl: function getUrl(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(params.endPoint);\n    return url;\n  },\n  /**\r\n      * This method will return the url normalized\r\n      */\n  normalizeUrl: function normalizeUrl(url) {\n    if (url !== \"\") {\n      if (url[url.length - 1] != \"/\") {\n        url = url.concat(\"/\");\n      }\n\n      if (url.indexOf(\"http://\") == -1 && url.indexOf(\"https://\") == -1) {\n        url = \"http://\" + url;\n      }\n    }\n    return url;\n  },\n\n  /**\r\n      * This service get all overrides keys within configuration project\r\n      *\r\n      * @return {json}\r\n      */\n  getOverrides: function getOverrides() {\n    var self = this;\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"overrides\") }).\n    pipe(function (overrides) {\n      overrides = overrides || {};\n\n      $.each(overrides, function (key, value) {\n        var valueUppercase = value.toUpperCase();\n        if (valueUppercase == \"TRUE\" || valueUppercase == \"FALSE\") {\n          overrides[key] = bizagi.util.parseBoolean(value);\n        }\n      });\n\n      return overrides;\n    });\n  },\n\n  /**\r\n      * This service get json of theme definition\r\n      *@return {json} theme definition\r\n      */\n  getCurrentTheme: function getCurrentTheme() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('getCurrentTheme');\n\n    return $.read(url);\n  },\n\n  /**\r\n      * This method will return the response of the user information login is correct\r\n      * this method is use for native smartphone\r\n      **/\n  authenticatedUser: function authenticatedUser(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl(\"login-handler\");\n\n    return $.read({\n      url: urlSend,\n      data: {\n        \"userName\": BIZAGI_USER,\n        \"password\": BIZAGI_PASSWORD,\n        \"domain\": BIZAGI_DOMAIN } }).\n\n    pipe(\n    function (response) {\n      return response;\n    },\n    function (data) {\n      urlSend = self.serviceLocator.getUrl('login-handlerv10');\n      urlSend = urlSend.replace('{0}', BIZAGI_USER || '');\n      urlSend = urlSend.replace('{1}', BIZAGI_PASSWORD || '');\n      urlSend = urlSend.replace('{2}', BIZAGI_DOMAIN || '');\n      return $.ajax({\n        url: urlSend,\n        type: 'GET',\n        dataType: 'json' });\n\n    });\n\n  },\n\n  /**\r\n      *\r\n      * this method is use for native smartphone\r\n      **/\n  logoutUser: function logoutUser(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl('logoff-handlerv1');\n    return $.read({\n      url: urlSend });\n\n  },\n  /*\r\n      *   Logoff the current user\r\n      */\n  logOffUser: function logOffUser(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl(\"logoff-handler\");\n    return $.read({\n      url: urlSend });\n\n  },\n  /*\r\n      *   Gets the current working user\r\n      */\n  getCurrentUser: function getCurrentUser(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"user-handler-getCurrentUser\"));\n  },\n  /*\r\n      *   Gets the inbox summary for the current logged user\r\n      *   Returns a promise of the data being retrieved\r\n      */\n  getInboxSummary: function getInboxSummary(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"inbox-handler-getInboxSummary\")).\n    pipe(function (response) {\n      // Extract inboxSummary property\n      return response[\"inboxSummary\"];\n    });\n  },\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getAllProcesses: function getAllProcesses(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl('process-handler-getAllProcesses');\n\n    if (params.taskState != undefined) {\n      data['taskState'] = params.taskState;\n    }\n\n    if (params.onlyFavorites != undefined && params.onlyFavorites != '') {\n      data['onlyFavorites'] = params.onlyFavorites;\n    }\n\n    if (params.myActivities != undefined && params.myActivities != \"\") {\n      data[\"myActivities\"] = params.myActivities;\n    }\n\n    if (params.myPendings != undefined && params.myPendings != \"\") {\n      data[\"myPendings\"] = params.myPendings;\n    }\n\n    if (params.smartfoldersParameters) {\n      url = url + '?' + params.smartfoldersParameters;\n    }\n\n    if (bizagi.isMobile()) {\n      data['mobileDevice'] = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      // !! (double Not) (bang bang) <-- For Boolean Type Casting http://jibbering.com/faq/notes/type-conversion/#tcBool\n      if (!!params.skipAggrupate) {\n        self.includeAllProcessesItem(response);\n        return response;\n      }\n\n      // Aggrupate workflows by categories\n      var responseData = {};\n      var categories = {};\n      var allProcesses = bizagi.localization.getResource('workportal-widget-inbox-all-processes');\n      var allCases = {\n        name: bizagi.localization.getResource('workportal-widget-inbox-all-cases'),\n        path: '',\n        category: allProcesses,\n        isFavorite: params.onlyFavorites || false,\n        guidFavorite: '',\n        idworkflow: '',\n        guidWFClass: '',\n        count: 0 };\n\n\n      // Create a default category\n      categories[allProcesses] = [];\n      categories[allProcesses].workflows = [];\n      categories[allProcesses].workflows.push(allCases);\n      if (response.workflows) {\n        $.each(response.workflows.workflow, function (i, workflow) {\n          // Creates the category if it doesn't exist\n          if (!categories[workflow.category]) {\n            categories[workflow.category] = [];\n            categories[workflow.category].workflows = [];\n          }\n\n          // Push the workflow\n          categories[workflow.category].workflows.push(workflow);\n\n          // Sum the cases count\n          //  if (bizagi.util.isEmpty(params.onlyFavorites) || params.onlyFavorites == false) {\n          allCases.count += Number(workflow.count);\n          // }\n        });\n      }\n\n      // Build result array once grouped\n      responseData.categories = [];\n      for (key in categories) {\n        responseData.categories.push({\n          name: key,\n          workflows: categories[key].workflows });\n\n      }\n\n      return responseData;\n    });\n  },\n\n  /**\r\n      * do request if the preferences have not been load, else resolve with preferences\r\n      */\n  getUserWorkportalPreferences: function getUserWorkportalPreferences() {\n    var self = this,\n    _defer = new $.Deferred(),\n    _thePreferencesAreSaved = self._userPreferences !== undefined,\n    _doRequest = function _doRequest() {\n      self.getPreferencesWorkportalCurrentUser().done(function (response) {\n        self._userPreferences = bizagi.util.tryCatch(\n        function () {return response.workportal;},\n        {});\n\n\n        // ::ALERT:: This code is from workportal user preferences page settings\n        bizagi.util.storeMobileFeatures({ userPreferences: self._userPreferences });\n\n        _defer.resolve(self._userPreferences);\n      }).fail(function (params) {\n        console.error(params);\n        _defer.resolve({});\n      });\n    };\n\n    _thePreferencesAreSaved ? _defer.resolve(self._userPreferences) : _doRequest();\n    return _defer;\n  },\n\n  /**\r\n      * return all preferences or the specific preference if is set\r\n      */\n  getUserPreferences: function getUserPreferences(preference) {\n    var self = this;\n\n    // Get mobile features from workportal\n    var mobFeatures = bizagi.util.getMobileFeatures();\n\n    // for read local information\n    var localStorage = mobFeatures ? mobFeatures : {};\n    var localStoragePreferences = localStorage.userPreferences ? localStorage.userPreferences : {};\n\n    // Set user preference for result\n    var userPreferences = self._userPreferences || localStoragePreferences;\n\n    // return object or property\n    return preference === undefined ? userPreferences : userPreferences[preference];\n  },\n\n  /**\r\n      * get last process inbox workflow\r\n      * @return {workflow} \r\n      */\n  getLastProcessInboxWorkflow: function getLastProcessInboxWorkflow() {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // localstorage\n    var lastProcessInbox = bizagi.util.getLastProcessInboxProcessInfo();\n\n    if (bizagi.util.validateFeatureSupport(\"defaultInboxEnabled\") == false || bizagi.util.isMobileInboxByProcessSupported() == false) {\n      if (lastProcessInbox.idWorkflow != -1)\n      bizagi.util.setLastProcessInbox(lastProcessInbox.processInfoName, lastProcessInbox.idWorkflow);\n      defer.resolve(lastProcessInbox);\n    } else\n    {\n      // Last Open Inbox -> Default Open Inbox -> All processes\n      $.when(\n      self.getUserWorkportalPreferences(),\n      self.getAllProcesses({\n        taskState: \"all\",\n        onlyFavorites: false,\n        inputtray: \"inbox\",\n        skipAggrupate: true,\n        mobileDevice: true }),\n\n      self.getAllSmartInbox()).\n      then(function (userPreferences, processesData, smartinboxes) {\n        // Preferences result\n        var idWorkFlowResult = lastProcessInbox.idWorkflow,\n        smartInboxId = lastProcessInbox.smartInboxId,\n        _preferDefaultOpenInbox = parseInt(userPreferences.defaultOpenInboxWorkflowId),\n        _preferDefaultOpenSmartInbox = userPreferences.defaultOpenInboxSmartInboxId,\n        _hasPreferDefaultOpenInbox = _preferDefaultOpenInbox > 0,\n        _hasPreferDefaultOpenSmartInbox = !bizagi.util.isEmpty(_preferDefaultOpenSmartInbox);\n\n        // First way ask by last Open Inbox\n        if (idWorkFlowResult == -1 && _hasPreferDefaultOpenInbox && bizagi.util.isEmpty(smartInboxId)) {\n          idWorkFlowResult = _preferDefaultOpenInbox;\n          smartInboxId = null;\n        } else if (bizagi.util.isEmpty(smartInboxId) && _hasPreferDefaultOpenSmartInbox && idWorkFlowResult == -1) {\n          smartInboxId = _preferDefaultOpenSmartInbox;\n          idWorkFlowResult = -1;\n        }\n\n        if (processesData && processesData.workflows && idWorkFlowResult != -1)\n        {\n          // search processName by workflowId\n          var workflowFound = $.first(processesData.workflows.workflow, function (workflow) {return workflow.idworkflow == idWorkFlowResult;});\n          if (workflowFound) {\n            bizagi.util.setLastProcessInbox(workflowFound.name, idWorkFlowResult);\n          } else {\n            bizagi.util.setLastProcessInbox(null, -1);\n          }\n\n        } else if (smartinboxes && smartinboxes.length > 0 && !bizagi.util.isEmpty(smartInboxId)) {\n          // search smartinbox by id\n          var smartinboxFound = $.first(smartinboxes, function (smartinbox) {return smartinbox.id == smartInboxId;});\n          if (smartinboxFound) {\n            bizagi.util.setLastProcessInbox(smartinboxFound.name, -1, smartInboxId);\n          } else {\n            bizagi.util.setLastProcessInbox(null, -1);\n          }\n        }\n\n        // get info from local storage\n        defer.resolve(bizagi.util.getLastProcessInboxProcessInfo());\n\n      }).fail(function () {\n        defer.reject('Error in bizagi.workportal.services.service.getLastProcessInboxWorkflow');\n      });\n\n    }\n\n    return defer.promise();\n  },\n\n  /*\r\n      *   Return my favourites count\r\n      */\n  getFavourites: function getFavourites() {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getFavourites\");\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Return my favourites count\r\n      */\n  getMyStuff: function getMyStuff(params) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getMyStuff\");\n\n    if (typeof params.icon !== \"undefined\" && params.icon) {\n      data.icon = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data);\n  },\n  /*\r\n      *   Return my favourites cases\r\n      */\n  getFavouriteCases: function getFavouriteCases(params) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getFavouriteCases\");\n\n    data[\"pageSize\"] = params.pageSize || self.pageSize;\n    data[\"page\"] = params.page || 1;\n\n    if (bizagi.isMobile()) {\n      data[\"mobileDevice\"] = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Return all the available cases in bizagi and thinking for mobile response\r\n      */\n  getCasesList: function getCasesList(params) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\n\n    params = params || {};\n\n    data[\"pageSize\"] = params.pageSize || 10;\n    data[\"page\"] = params.page || 1;\n    data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\n    data[\"idWfClass\"] = params.idWfClass || \"-1\";\n\n    return $.read(url, data).\n    pipe(function (response) {\n      var elementToHtml = {\n        overdue: [],\n        today: [],\n        tomorrow: [],\n        upcoming: [],\n        page: response.page,\n        totalPages: response.totalPages };\n\n      var actualDate = new Date();\n      var actualMonth = actualDate.getMonth();\n      var actualDay = actualDate.getDate();\n      var actualYear = actualDate.getYear();\n      var lengthData = typeof response.elements !== \"undefined\" ? response.elements.length : 0;\n\n      for (var counter = 0; lengthData > counter; counter++) {\n        var tmpElement = response.elements[counter];\n        var tmpdate = new Date(tmpElement[3]);\n        var tmpDay = tmpdate.getDate();\n        var tmpMonth = tmpdate.getMonth();\n        var tmpYear = tmpdate.getYear();\n\n        if (actualDay > tmpDay || actualMonth > tmpMonth || actualYear > tmpYear) {\n          tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\n          elementToHtml.overdue.push(tmpElement);\n        } else {\n          if (actualDay == tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\n            elementToHtml.today.push(tmpElement);\n\n          } else if (actualDay + 1 == tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\n            elementToHtml.tomorrow.push(tmpElement);\n\n          } else {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\n            elementToHtml.upcoming.push(tmpElement);\n          }\n        }\n      }\n      return elementToHtml;\n    });\n\n  },\n\n  /*\r\n      *   Return all the available cases in bizagi and thinking for mobile response\r\n      */\n  getCasesListBeta: function getCasesListBeta(params) {\n    var self = this;\n    return self.getMobileCasesList(params).then(function (response) {\n      return self.adapterDataOfActivitiesToTemplate(response);\n    });\n  },\n\n  getMobileCasesList: function getMobileCasesList(params) {\n    var self = this;\n    var data = {};\n\n    params = params || {};\n\n    //if server version is less than server version where the new service was implemented, then call last version of service\n    if (!bizagi.util.validateFeatureSupport(\"advancedSearch\")) {\n      var urlMobile = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\n      if (typeof params.radNumber !== \"undefined\") {\n        data[\"radNumber\"] = params.radNumber;\n      }\n      data[\"pageSize\"] = params.pageSize || 10;\n      data[\"page\"] = params.page || 1;\n      data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\n      data[\"idWfClass\"] = params.idWfClass || \"-1\";\n      return $.read(urlMobile, data);\n    } else\n    {\n      return $.when(self.getMobileActivities(params)).then(function (resp) {\n        var response = { elements: [], rows: [] };\n        var row,i = -1;\n        while (row = resp.rows[++i]) {\n          var tempElement = {},el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\", \"\", \"\"];\n          var field,j = -1;\n          while (field = resp.headers[++j]) {\n            tempElement[field.fieldName.toLowerCase()] = {\n              \"displayName\": field.displayName,\n              \"value\": row[j] };\n\n            self.serializeActivity(el, field.fieldName.toLowerCase(), tempElement[field.fieldName.toLowerCase()]);\n          }\n\n          if (resp.syncErrors) {\n            self.appendActivityElementSyncError(el, resp.syncErrors);\n            self.appendActivityRowsSyncError(tempElement, resp.syncErrors);\n          }\n\n          response.elements.push(el);\n          response.rows.push(tempElement);\n        }\n        return {\n          \"page\": resp.page || resp.currentPage,\n          \"totalPages\": resp.totalPages,\n          \"elements\": response.elements,\n          \"rows\": response.rows,\n          \"advanceSearch\": true };\n\n      });;\n    }\n  },\n\n  /**\r\n      * Calc some activity properties to map easier on template \r\n      * @param {Any} serverResponse \r\n      */\n  adapterDataOfActivitiesToTemplate: function adapterDataOfActivitiesToTemplate(response) {\n    var self = this;\n    var groupedData = {\n      elements: [],\n      page: response.page,\n      totalPages: response.totalPages,\n      advanceSearch: response.advanceSearch || false,\n      headers: response.headers,\n      rows: response.rows };\n\n\n    var actualDate = new Date();\n    var statusFunction = response.advanceSearch ? self.defineActivityStateByTaskState : self.defineActivityStateByDate;\n\n    for (var counter = 0; response.elements.length > counter; counter++) {\n      var tmpElement = response.elements[counter];\n      var status = {};\n\n      status = statusFunction(tmpElement[3], tmpElement.taskstate);\n\n      // Time to atRiskTimeDelta\n      if (tmpElement.length >= 10 && parseInt(tmpElement[11], 10) > 0) {\n        var tmpEndDate = new Date(tmpElement[3]);\n\n        if (actualDate.getTime() > tmpEndDate.getTime()) {\n          status.state = \"red\";\n        } else {\n          if (actualDate.getTime() > tmpEndDate.getTime() - parseInt(tmpElement[11], 10) * 60000) {\n            status.state = \"yellow\";\n          } else {\n            status.state = \"green\";\n          }\n        }\n      }\n\n      groupedData.elements.push($.extend({}, tmpElement, status, {\n        \"endDate\": tmpElement[3],\n        \"idworkitem\": tmpElement[1],\n        \"idwfclass\": !bizagi.util.validateFeatureSupport(\"advancedSearch\") ? tmpElement[7] : tmpElement[10] }));\n\n    }\n    return groupedData;\n  },\n\n  /**\r\n      * Return compatible object for Template binding \r\n      * @param {Any} serverResponse \r\n      */\n  adapterServerResponseTemplateBindingObject: function adapterServerResponseTemplateBindingObject(serverResponse) {\n    var self = this;\n    var response = { elements: [], rows: [] };\n    var row,i = -1;\n    while (row = serverResponse.rows[++i]) {\n      var tempElement = {},el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\", \"\", \"\"];\n      var field,j = -1;\n\n      while (field = serverResponse.headers[++j]) {\n\n        tempElement[field.fieldName.toLowerCase()] = {\n          \"displayName\": field.displayName,\n          \"value\": row[j] };\n\n        self.serializeActivity(el, field.fieldName.toLowerCase(), tempElement[field.fieldName.toLowerCase()]);\n      }\n\n      if (serverResponse.syncErrors) {\n        self.appendActivityElementSyncError(el, serverResponse.syncErrors);\n        self.appendActivityRowsSyncError(tempElement, serverResponse.syncErrors);\n      }\n\n      response.elements.push(el);\n      response.rows.push(tempElement);\n    }\n    return {\n      \"page\": serverResponse.page || serverResponse.currentPage,\n      \"totalPages\": serverResponse.totalPages,\n      \"elements\": response.elements,\n      \"rows\": response.rows,\n      \"advanceSearch\": true,\n      \"headers\": serverResponse.headers };\n\n  },\n\n  /**\r\n      * Returns the activity status based on the end date and the risk\r\n      * @param {String} endDate ISO representation of a date\r\n      * @returns {{}}\r\n      */\n  defineActivityStateByDate: function defineActivityStateByDate(endDate) {\n    var status = {};\n\n    if (endDate) {\n      var activityDate = new Date(endDate);\n      var now = new Date();\n      var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      var second = 1000;\n      var minute = 60 * second;\n      var day = 24 * 60 * minute;\n\n      // Before today\n      if (activityDate.getTime() < today.getTime()) {\n        status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\", type: \"overdue\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n      }\n      // Today but before now\n      else if (activityDate.getTime() < now.getTime() + minute) {\n          status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"red\", type: \"today\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n        }\n        // Today but after now\n        else if (activityDate.getTime() < today.getTime() + day) {\n            status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"yellow\", type: \"today\", icon: \"ontime\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n          }\n          // Tomorrow\n          else if (activityDate.getTime() < today.getTime() + 2 * day) {\n              status = { group: \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\"), state: \"green\", type: \"tomorrow\", icon: \"upcoming\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n            }\n            // After tomorrow\n            else {\n                status = { group: \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\"), state: \"green\", type: \"upcoming\", icon: \"upcoming\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n              }\n    } else {\n      status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\", type: \"overdue\", shortEndDate: \"--\", icon: \"overdue\" };\n    }\n\n    return status;\n  },\n\n  /**\r\n      * Returns the activity status based on the taskstate property\r\n      * @param {String} endDate ISO representation of a date\r\n      * @param {String} taskstate Color name\r\n      * @returns {{}}\r\n      */\n  defineActivityStateByTaskState: function defineActivityStateByTaskState(endDate, taskstate) {\n    var status = {\n      group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"),\n      state: taskstate,\n      type: \"overdue\",\n      shortEndDate: \"--\",\n      icon: \"overdue\" };\n\n\n    if (endDate && taskstate) {\n      var activityDate = new Date(endDate);\n      var now = new Date();\n      var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      var second = 1000;\n      var minute = 60 * second;\n      var day = 24 * 60 * minute;\n\n      status = {\n        group: \"\",\n        state: taskstate,\n        type: \"\",\n        icon: \"\",\n        shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n\n      // Before today\n      if (activityDate.getTime() < today.getTime()) {\n        status.group = \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n        status.type = \"overdue\";\n      }\n      // Today\n      else if (activityDate.getTime() < today.getTime() + day) {\n          status.group = \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\");\n          status.type = \"today\";\n        }\n        // Tomorrow\n        else if (activityDate.getTime() < today.getTime() + 2 * day) {\n            status.group = \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n            status.type = \"tomorrow\";\n          }\n          // After tomorrow\n          else {\n              status.group = \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n              status.type = \"upcoming\";\n            }\n\n      switch (taskstate) {\n        case \"green\":\n          status.icon = \"upcoming\";\n          break;\n        case \"yellow\":\n          status.icon = \"ontime\";\n          break;\n        case \"red\":\n        default:\n          status.icon = \"overdue\";\n          break;}\n\n    }\n    return status;\n  },\n\n  serializeActivity: function serializeActivity(el, fieldName, element) {\n    switch (fieldName) {\n      case \"radnumber\":\n        el[6].push([element.displayName, element.value]);\n        el.radNumber = element.value;\n        break;\n      //Proceso\n      case \"wfclsdisplayname\":\n        el[4] = element.value != null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-activity-plan\");\n        break;\n      //Actividad\n      case \"currenttask\":\n        el[5] = element.value != null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-casedashboard-activity\");\n        break;\n      //Fecha creacin caso\n      case \"cascreationdate\":\n        el[12] = element.value;\n        break;\n      // Actividad vence en\n      case \"wiestimatedsolutiondate\":\n        el[3] = element.value;\n        break;\n      //Fecha Solucin caso\n      case \"cassolutiondate\":\n        //el[6] = [\"\"];\n        break;\n      // Id de caso\n      case \"idcase\":\n        el[0] = element.value;\n        break;\n      // idWorkItem\n      case \"idworkitem\":\n        el[1] = element.value.toString();\n        break;\n      //Fecha de entrada al estado\n      case \"wientrydate\":\n        //el[6] = [\"\"];\n        break;\n      case \"taskid\":\n        el[2] = element.value;\n        break;\n      case \"taskstate\":\n        el.taskstate = element.value ? (\"\" + element.value).toLowerCase() : \"\";\n        break;\n      //idWorkflow\"\n      case \"idwfclass\":\n        el[10] = el.idwfclass = element.value;\n        break;\n      //Is Favorite\n      case \"isfavorite\":\n        el[9] = element.value;\n        break;\n      case \"atrisktime\":\n        el[11] = element.value;\n        break;\n      case \"guidfavorite\":\n        el[8] = element.value;\n        break;\n      case \"isevent\":\n        el.isEvent = element.value;\n        break;\n      case \"datachangesetversion\":\n        el.dataChangeset = element.value;\n        break;\n      case \"creatorfullname\":\n        el.creatorFullName = element.value;\n        break;}\n\n  },\n\n  /**\r\n      * Assign the sync error to element passed by parameter\r\n      * @param {} element The array element that represent an activity\r\n      * @param {*} syncErrors The sync errors map\r\n      */\n  appendActivityElementSyncError: function appendActivityElementSyncError(element, syncErrors) {\n    var offlineId = element[0] + \"-\" + element[1];\n    var caseSyncError = syncErrors[offlineId];\n    if (caseSyncError) {\n      element.syncError = caseSyncError;\n      element.hasSyncError = true;\n    }\n  },\n\n  /**\r\n      * Assign the sync error to element passed by parameter\r\n      * @param {*} row The object that represent an activity\r\n      * @param {*} syncErrors The sync errors map\r\n      */\n  appendActivityRowsSyncError: function appendActivityRowsSyncError(row, syncErrors) {\n    var offlineId = row.idcase.value + \"-\" + row.idworkitem.value;\n    var caseSyncError = syncErrors[offlineId];\n    if (caseSyncError) {\n      row.syncerror = {\n        displayName: \"syncError\",\n        value: caseSyncError };\n\n      row.hassyncerror = {\n        displayName: \"hasSyncError\",\n        value: true };\n\n    }\n  },\n\n  /**\r\n      * Obtiene la lista de actividades para el usuario actual con filtros\r\n      * Version: 2, Llamado al servicio con todas las prestaciones de filtrado\r\n      */\n  getCurrentActivities: function getCurrentActivities(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[\"page\"] = params.page || 1;\n    data[\"pageSize\"] = params.pageSize || 10;\n\n    if (typeof params.radNumber !== \"undefined\") {\n      data[\"radNumber\"] = params.radNumber;\n    }\n\n    var url = self.serviceLocator.getUrl('case-handler-getActivityList');\n    return $.read(url, data).then(function (resp) {\n      return self.processActivitiesResponse(resp);\n    });\n  },\n\n  processActivitiesResponse: function processActivitiesResponse(resp, highlight, process_filter) {\n    var self = this;\n    var row;\n    var i = -1;\n\n    resp.elements = [];\n    resp.processes = [];\n\n    while (row = resp.rows[++i]) {\n      var tempElement = {};\n      var field,j = -1;\n      while (field = resp.headers[++j]) {\n        tempElement[\"o_\" + field.fieldName.toLowerCase()] = { \"displayName\": field.displayName, \"value\": row[j] };\n        tempElement[field.fieldName.toLowerCase()] = row[j];\n      }\n      $.extend(tempElement, self.defineActivityStateByDate(tempElement[\"wiestimatedsolutiondate\"]), { highlightedNumber: self.highlightsString(tempElement[\"radnumber\"], highlight) });\n      resp.elements.push(tempElement);\n\n      var process = resp.processes.find(function (el) {\n        return el.processname == tempElement[\"wfclsdisplayname\"];\n      });\n\n      if (typeof process === \"undefined\") {\n        resp.processes.push({\n          processname: tempElement[\"wfclsdisplayname\"],\n          idwfclass: tempElement[\"idwfclass\"],\n          active: process_filter || false ? \"active\" : \"\" });\n\n      }\n    }\n    return resp;\n  },\n\n  highlightsString: function highlightsString(string, highlight) {\n    if (typeof string !== \"string\" || typeof highlight !== \"string\") {\n      return string;\n    }\n\n    var expresion = new RegExp(highlight, \"gi\");\n    return string.replace(expresion, function (match, offset) {\n      return \"<strong>\" + match + \"</strong>\";\n    });\n  },\n\n  getDiscussionCase: function getDiscussionCase(params) {\n    var self = this;\n    var data = data || {};\n    data['globalParent'] = params.globalParent;\n    var url = bizagi.util.validateFeatureSupport(\"discussionCase\") ? self.serviceLocator.getUrl('discussion-case') : self.serviceLocator.getUrl('discussion-case-v1');\n\n    return $.read({\n      url: url,\n      data: data,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  editDiscussion: function editDiscussion(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"new-discussion\");\n    return $.update({\n      url: url,\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getUsersDiscussion: function getUsersDiscussion(params) {\n    var self = this;\n    var data = data || {};\n    data[\"userIds\"] = params;\n    data[\"width\"] = 50;\n    data[\"height\"] = 50;\n    var url = self.serviceLocator.getUrl(\"get-users\");\n\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n      return $.ajax({\n        url: url,\n        data: data,\n        type: \"POST\",\n        dataType: \"json\" });\n\n    } else {\n      return $.read(url, data).\n      pipe(function (response) {\n        return response;\n      });\n    }\n  },\n\n  getEffectiveDuration: function getEffectiveDuration(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"time-schemas-effectiveduration\");\n\n    return $.read({\n      url: url,\n      data: data,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getUsersData: function getUsersData(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-users-get\");\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n      return $.ajax({\n        url: url,\n        data: data,\n        type: \"POST\",\n        dataType: \"json\" });\n\n    } else {\n      return $.read({\n        url: url,\n        data: data,\n        dataType: \"json\" });\n\n    }\n\n\n  },\n\n  getSummaryCaseTaskOptions: function getSummaryCaseTaskOptions(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"case-summary-task-options\");\n\n    params = params || {};\n\n    // Required params: idWorkitem\n    return $.read(url, {\n      idWorkitem: params.idWorkitem,\n      idCase: params.idCase });\n\n  },\n\n  createNewDiscussion: function createNewDiscussion(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"new-discussion\");\n\n    params = params || {};\n\n    return $.create({\n      url: url,\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  createNewComment: function createNewComment(params) {\n    var self = this;\n    params = params || {};\n    var data = params.data || {};\n    var url = self.serviceLocator.getUrl(\"new-comment\");\n\n    return $.create({\n      url: url.replace(\"{typeResource}\", \"Comment\"),\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * Update Project File\r\n      */\n  updateProjectFile: function updateProjectFile(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-files-upload\");\n\n    return $.update({\n      url: url,\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * Update Project File\r\n      */\n  createProjectFile: function createProjectFile(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-files-upload\");\n\n    return $.create({\n      url: url,\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * Count the files number\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getFilesCount: function getFilesCount(params) {\n    var self = this;\n    params = params || {};\n    var url = bizagi.util.validateFeatureSupport(\"filesCount\") ? self.serviceLocator.getUrl(\"count-files\") : self.serviceLocator.getUrl(\"count-files-v1\");\n\n    return $.read({\n      url: url,\n      data: params,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getCommentCase: function getCommentCase(data) {\n    var self = this;\n    data = data || {};\n\n    var url = self.serviceLocator.getUrl(\"comment-case\");\n\n    return $.read({\n      url: url,\n      data: data,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getCommentsByParent: function getCommentsByParent(params) {\n    var self = this;\n    params = params || {};\n    var url = self.serviceLocator.getUrl(\"count-comments\");\n\n    return $.read({\n      url: url,\n      data: params,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getFilesList: function getFilesList(params) {\n    var self = this;\n    var url = bizagi.util.validateFeatureSupport(\"filesList\") ? self.serviceLocator.getUrl(\"get-list-files\") : self.serviceLocator.getUrl(\"get-list-files-v1\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  deleteFile: function deleteFile(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-resource-action\");\n    return $.destroy({\n      url: url.replace(\"{typeResource}\", \"Attachment\"),\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getFilesThumbnail: function getFilesThumbnail(data) {\n    var self = this;\n    data = data || {};\n    var url = self.serviceLocator.getUrl(\"thumbnail-file\");\n\n    return $.read({\n      url: url,\n      data: data,\n      dataType: \"json\",\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getAttachment: function getAttachment(guidAttachment) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"get-attachment\");\n    url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\n    return url;\n  },\n\n  getMobileAttachment: function getMobileAttachment(guidAttachment) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"get-mobile-attachment\");\n    url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\n    return url + \"?sessionId=\";\n  },\n\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getAllAdministrableEntities: function getAllAdministrableEntities(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data[\"action\"] = \"entitiesList\";\n    data[\"kind\"] = \"administrable\";\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"entities-administration\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" }).\n    pipe(function (data) {\n      var result = {\n        entities: [] };\n\n      $.each(data, function (i, item) {\n        result.entities.push(item);\n      });\n      return result;\n    });\n  },\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getEntitiesList: function getEntitiesList(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    params[\"action\"] = \"entitiesList\";\n    params[\"kind\"] = \"entitiesData\";\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"entities-administration\"),\n      data: params,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *   Returns all the cases for the current user filtered by a workflow\r\n      */\n  getCasesByWorkflow: function getCasesByWorkflow(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsDataInfo');\n\n\n    // Required params\n    if (!bizagi.util.isEmpty(params.taskState))\n    data['taskState'] = params.taskState;\n    if (!bizagi.util.isEmpty(params.smartInboxId))\n    data['smartInboxGuid'] = params.smartInboxId;else\n    if (!bizagi.util.isEmpty(params.idWorkflow))\n    data['idWorkflow'] = params.idWorkflow;\n\n    // Special case to search all favorite cases for all processes\n    if (params.onlyFavorites == true) {\n      data['onlyFavorites'] = true;\n      data['taskState'] = 'all';\n    }\n\n    // Optional params\n    data['pageSize'] = params.pageSize || self.pageSize;\n    data['page'] = params.page || 1;\n\n    if (bizagi.isMobile()) {\n      data['mobileDevice'] = true;\n    }\n\n    if (params.smartfoldersParameters) {\n      var param = params.smartfoldersParameters.split('&');\n      $.each(param, function (k, v) {\n        var keyvalue = v.split('=');\n        data[keyvalue[0]] = keyvalue[1];\n      });\n    }\n\n    if (params.radnumber || params.radNumber) {\n      data['radNumber'] = params.radNumber ? params.radNumber : params.radnumber;\n    }\n\n    if ((params.idcase || params.idCase) && bizagi.util.isNumeric(params.idcase || params.idCase)) {\n      data['idCase'] = params.idCase ? params.idCase : params.idcase;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      $.each(response.cases.rows, function (key, value) {\n        var newFieldsValue = [];\n\n        //  Set id of case to radnumber\n        response.cases.rows[key]['radnumber'] = value.id;\n        $.each(value.fields, function (fieldsKey, fieldsValue) {\n          // when delete element from fields array, each function lose key value\n          if (fieldsValue != undefined) {\n            // Radnumber\n            try {\n              if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == 'true') {\n                response.cases.rows[key]['radnumber'] = fieldsValue.Value;\n                response.cases.rows[key]['casenumberdisplayname'] = fieldsValue.DisplayName;\n              } else if (fieldsValue.workitems != undefined) {\n                response.cases.rows[key]['workitems'] = fieldsValue.workitems;\n              } else {\n                newFieldsValue.push(fieldsValue);\n              }\n            } catch (e) {}\n          }\n        });\n\n        // Update Fields\n        response.cases.rows[key]['fields'] = newFieldsValue;\n      });\n      return response.cases;\n    });\n  },\n  /*\r\n      *   Returns the Organization List\r\n      */\n  getOrganizationsList: function getOrganizationsList() {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('process-handler-getOrganizations');\n    var data = {};\n    data['type'] = 12;\n    data['name'] = '';\n\n    return $.read(url, data);\n  },\n  getOrganizationsByUserList: function getOrganizationsByUserList() {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"process-handler-getOrganizationsByUser\");\n\n    return $.read(url, {});\n  },\n  /*\r\n      *   Returns the data for the inbox grid view\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getCustomizedColumnsData\");\n    data[\"pageSize\"] = params.pageSize || self.pageSize;\n    data[\"page\"] = params.page || 1;\n\n    // data for sort columns\n    data[\"orderFieldName\"] = params.orderFieldName || \"\";\n    data[\"orderType\"] = params.orderType || \"0\";\n    data[\"order\"] = params.order || \"\";\n\n    if (bizagi.isMobile()) {\n      data[\"mobileDevice\"] = true;\n    }\n\n    // Fixes stuff\n    // TODO: this must be fixed in the server\n    params.taskState = params.taskState || 'all';\n    if (params.taskState.toString().toLowerCase() === '')\n    params.taskState = 'all';\n    if (params.taskState.toString().toLowerCase() === 'red')\n    params.taskState = 'Red';\n    if (params.taskState.toString().toLowerCase() === 'yellow')\n    params.taskState = 'Yellow';\n    if (params.taskState.toString().toLowerCase() === 'green')\n    params.taskState = 'Green';\n\n    data.taskState = params.taskState;\n    // Required params\n    if (!bizagi.util.isEmpty(params.idWorkflow)) {\n      data['idWorkflow'] = params.idWorkflow;\n    }\n    if (!bizagi.util.isEmpty(params.idTask)) {\n      data['idTask'] = params.idTask;\n    }\n\n    if (!bizagi.util.isEmpty(params.radNumber)) {\n      data['radNumber'] = params.radNumber;\n    }\n\n    // Special case to search all favorite cases for all processes\n    if (params.onlyFavorites == true) {\n      data['onlyFavorites'] = true;\n      data['taskState'] = 'all';\n    }\n\n    if (params.smartfoldersParameters) {\n      var param = params.smartfoldersParameters.split('&');\n      $.each(param, function (k, v) {\n        var keyvalue = v.split('=');\n        data[keyvalue[0]] = keyvalue[1];\n      });\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data);\n  },\n\n  /*\r\n      *   Returns the data for the inbox grid view\r\n      */\n  getCustomizedColumnsDataBeta: function getCustomizedColumnsDataBeta(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsData');\n\n    data['pageSize'] = params.pageSize || self.pageSize;\n    data['page'] = params.page || 1;\n\n    // data for sort columns\n    data['orderFieldName'] = params.orderFieldName || '';\n    data['orderType'] = params.orderType || '0';\n    data['order'] = params.order || '';\n    data['mobileDevice'] = bizagi.isMobile() ? true : false;\n\n    // Fixes stuff\n    // TODO: this must be fixed in the server\n    params.taskState = params.taskState || 'all';\n    if (params.taskState.toString().toLowerCase() === '')\n    params.taskState = 'all';\n    if (params.taskState.toString().toLowerCase() === 'red')\n    params.taskState = 'Red';\n    if (params.taskState.toString().toLowerCase() === 'yellow')\n    params.taskState = 'Yellow';\n    if (params.taskState.toString().toLowerCase() === 'green')\n    params.taskState = 'Green';\n\n    data.taskState = params.taskState;\n    // Required params\n    if (!bizagi.util.isEmpty(params.idWorkflow)) {\n      data['idWorkflow'] = params.idWorkflow;\n    }\n    if (!bizagi.util.isEmpty(params.idTask)) {\n      data['idTask'] = params.idTask;\n    }\n\n    if (!bizagi.util.isEmpty(params.radNumber)) {\n      data['radNumber'] = params.radNumber;\n    }\n\n    // Special case to search all favorite cases for all processes\n    if (params.onlyFavorites == true) {\n      data['onlyFavorites'] = true;\n      data['taskState'] = 'all';\n    }\n\n    if (params.smartfoldersParameters) {\n      var param = params.smartfoldersParameters.split('&');\n      $.each(param, function (k, v) {\n        var keyvalue = v.split('=');\n        data[keyvalue[0]] = keyvalue[1];\n      });\n    }\n\n    // Call ajax and returns promise\n    //return $.read(url, data);\n    return $.read(url, data).\n    pipe(function (response) {\n\n      var groupedData = {\n        columnTitle: [],\n        lstIdCases: [],\n        elements: [],\n        page: response.page,\n        totalPages: response.totalPages };\n\n\n      var actualDate = new Date();\n      var actualMonth = actualDate.getMonth();\n      var actualDay = actualDate.getDate();\n      var actualYear = actualDate.getYear();\n\n      groupedData.columnTitle = response.cases.columnTitle;\n      groupedData.lstIdCases = response.cases.lstIdCases;\n      groupedData.page = response.cases.page;\n      groupedData.totalPages = response.cases.totalPages;\n\n      for (var counter = 0, length = response.cases.rows.length; counter < length; counter++) {\n        var tmpElement = response.cases.rows[counter];\n\n        var tmpdate = new Date(tmpElement.fields[3]);\n        var tmpDay = tmpdate.getDate();\n        var tmpMonth = tmpdate.getMonth();\n        var tmpYear = tmpdate.getYear();\n\n        if (actualDay > tmpDay || actualMonth > tmpMonth || actualYear > tmpYear) {\n          tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM'); // 'dd MMM hh:mm'\n          groupedData.elements.push($.extend({}, tmpElement, { 'group': 'overdue' }));\n\n        } else {\n          if (actualDay == tmpDay) {\n            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\n            groupedData.elements.push($.extend({}, tmpElement, { 'group': 'today' }));\n\n          } else if (actualDay + 1 == tmpDay) {\n            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\n            groupedData.elements.push($.extend({}, tmpElement, { 'group': 'tomorrow' }));\n\n          } else {\n            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM');\n            groupedData.elements.push($.extend({}, tmpElement, { 'group': 'upcoming' }));\n          }\n        }\n      }\n\n      // No data items\n      if (typeof groupedData.elements === 'undefined' || typeof groupedData.elements !== 'undefined' && groupedData.elements.length === 0) {\n        groupedData.elements.push({ noResults: true, message: bizagi.localization.getResource('workportal-menu-search-found-no-cases') });\n      }\n\n      return groupedData;\n    });\n  },\n  /*\r\n      *   Returns the available categories filtered by a parent category\r\n      *   If not parent category is sent, it will return the base categories\r\n      */\n  getCategories: function getCategories(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    // Required params\n    if (params.idCategory)\n    data['idCategory'] = params.idCategory;\n    if (params.idApp)\n    data['idApp'] = params.idApp;\n\n    if (bizagi.isMobile()) {\n      data['mobileDevice'] = true;\n    }\n\n\n    data['groupByApp'] = params.groupByApp || false;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('process-handler-getCategory'), data);\n  },\n  /*\r\n      *   Returns the recent process\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    params = params || {};\n    params.mobileDevice = bizagi.isMobile() || \"false\";\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('process-handler-getRecentProcesses'), params);\n  },\n\n  /*\r\n      *   Returns the summary for a case\r\n      */\n  getCaseSummary: function getCaseSummary(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getCaseSummary'),\n      data: {\n        idCase: params.idCase,\n        eventAsTasks: params.eventAsTasks || \"false\",\n        onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\n        mobileDevice: bizagi.isMobile() || \"false\" },\n\n      serviceType: \"GETSUMMARY\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /*\r\n      *   Returns the assigness for a case (all users assigned to any task of this case)\r\n      */\n  getCaseAssignees: function getCaseAssignees(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(self.serviceLocator.getUrl('case-handler-getCaseAssignees'), {\n      idCase: params.idCase }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /*\r\n      *   Returns all the tasks belonging to a process, aditionally return if it has an active workitem or not\r\n      */\n  getCaseTasks: function getCaseTasks(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getCaseTasks'), {\n      idCase: params.idCase });\n\n\n  },\n  /*\r\n      *   Returns all the events available for a case\r\n      */\n  getCaseEvents: function getCaseEvents(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getCaseEvents'),\n      data: {\n        idCase: params.idCase },\n\n      serviceType: 'GETEVENTS' }).\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns all the available subprocesses for a case\r\n      */\n  getCaseSubprocesses: function getCaseSubprocesses(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getCaseSubprocesses'),\n      data: {\n        idCase: params.idCase },\n\n      serviceType: 'GETSUBPROCESSES' }).\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns forms render version for a case\r\n      */\n  getCaseFormsRenderVersion: function getCaseFormsRenderVersion(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getCaseFormsRenderVersion'), {\n      idCase: params.idCase });\n\n\n  },\n  /**\r\n      *  Get json from forms render version service\r\n      */\n  getCaseFormsRenderVersionDataContent: function getCaseFormsRenderVersionDataContent(options) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(self.getCaseFormsRenderVersion(options)).\n    done(function (data) {\n      // return json content\n      defer.resolve(data);\n    });\n    return defer.promise();\n  },\n  /*\r\n      *   Returns all the assignees belonging to a workitem (case - task combination)\r\n      */\n  getTaskAssignees: function getTaskAssignees(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase, idTask\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getTaskAssignees'), {\n      idCase: params.idCase,\n      idTask: params.idTask });\n\n\n  },\n  /*\r\n      *   Returns the available workitems for a case (Routing service)\r\n      */\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    var data = {};\n\n    params = params || {};\n\n    data.idCase = params.idCase;\n    data.fromTask = params.fromTask;\n    data.fromWorkItemId = params.fromWorkItemId;\n    data.mobileDevice = bizagi.isMobile();\n\n    params.eventAsTasks ? data.eventAsTasks = params.eventAsTasks : \"\";\n\n    if (typeof params.onlyUserWorkItems !== \"undefined\") {\n      data.onlyUserWorkItems = params.onlyUserWorkItems;\n    }\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getWorkItems'),\n      data: data,\n      serviceType: 'GETWORKITEMS' });\n\n  },\n  /*\r\n      *   Returns the available workitems for a case (Routing service)\r\n      */\n  getQueries: function getQueries(params) {\n    var self = this;\n\n    if (self.hashQueries && params.idElement) {\n      return self.hashQueries[params.idElement];\n    } else {\n      var defer = new $.Deferred();\n\n      // Call ajax and returns promise\n      $.read(self.serviceLocator.getUrl('query-handler-getqueries')).\n      done(function (response) {\n        self.hashQueries = {};\n        self.hashQueries[0] = {};\n\n        // Process the full response converting it into small entries inside a hashtable\n        self.processQueries(response.query);\n        defer.resolve(self.hashQueries['-1']);\n      });\n      return defer.promise();\n    }\n  },\n  /*\r\n      *   Creates a hash of queries to simulate each category request\r\n      */\n  processQueries: function processQueries(queries) {\n    var self = this;\n    $.each(queries, function (i, query) {\n      if (!self.hashQueries[query.idParent]) {\n        self.hashQueries[query.idParent] = [];\n      }\n      self.hashQueries[query.idParent].push(query);\n      if (query.nodes) {\n        self.processQueries(query.nodes);\n      } else {\n        query.nodes = {};\n      }\n    });\n  },\n  /*\r\n      *   Creates a new case in BizAgi\r\n      */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.create({\n      url: self.serviceLocator.getUrl('case-handler-addNewCase'),\n      data: {\n        idWfClass: params.idWfClass,\n        caseData: params.caseData ? JSON.stringify(params.caseData) : null,\n        idOrganization: params.idOrganization ? params.idOrganization : null },\n\n      serviceType: 'NEWCASE' });\n\n  },\n\n  /*\r\n      * La idea con este servicio es por ahora quitar el hatStartForm del servicio de Shortcuts y de acciones\r\n      * retorna si tiene forma de inicio y el guid de la entidad de proceso\r\n      */\n  validateHasStartForm: function validateHasStartForm(params) {\n    var self = this;\n    var data = {\n      processId: params.processId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"case-handler-validateHasStartForm\"),\n      data: data,\n      batchRequest: true });\n\n  },\n\n\n  /*\r\n      *   Start process in Bizagi\r\n      */\n  startProcess: function startProcess(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {\n      idProcess: params.idProcess,\n      entityMapping: params.mapping ? JSON.stringify(params.mapping) : {} };\n\n\n    if (typeof params.idParentCase !== \"undefined\") {\n      data.idParentCase = params.idParentCase;\n    }\n\n    var defer = $.Deferred();\n\n    $.create({\n      url: self.serviceLocator.getUrl(\"case-handler-startProcess\"),\n      data: data,\n      serviceType: \"STARTPROCESS\" }).\n    fail(function (error) {\n      var response = $.parseJSON(error.responseText);\n      if (response.status === \"error\" && !bizagi.util.isVersionSupported()) {\n        var oldParams = {\n          idWfClass: params.idProcess || params.idWfClass,\n          idOrganization: params.idOrganization || null };\n\n\n        self.createNewCase(oldParams).\n        then(function (result) {\n          result.oldVersion = true;\n\n          defer.resolve(result);\n        }).fail(function (error) {\n          defer.reject(error);\n        });\n      } else {\n        defer.reject(error);\n      }\n    }).done(function (data) {\n      defer.resolve(data);\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n      *   Start process in BizAgi\r\n      */\n  actionCreateCase: function actionCreateCase(params) {\n    var self = this;\n    var data = {\n      processId: typeof params.idProcess !== \"undefined\" ? params.idProcess : params.guidProcess };\n\n    // When the proccess is a shortcut it does not have mapping and parentCaseId,\n    // but when the process is not a shortcut, it has a context, so it comes with mapping and parentCaseId\n    if (typeof params.parentCaseId !== \"undefined\") {\n      data.parentCaseId = params.parentCaseId;\n    }\n    if (typeof params.mapping !== \"undefined\") {\n      data.entityMapping = params.mapping ? JSON.stringify(params.mapping) : {};\n    }\n\n    return $.create({\n      url: self.serviceLocator.getUrl(\"handler-execute-action-start\"),\n      data: data,\n      serviceType: \"STARTPROCESS\" });\n\n  },\n\n  /**\r\n      * Get the first parent plan on not contextualizeds plans\r\n      * */\n  getFirstParentPlan: function getFirstParentPlan(data) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"project-plan-first-parent-plan\");\n    var defer = $.Deferred();\n    $.when($.read({\n      url: url,\n      data: data,\n      dataType: \"json\" })).\n    done(function (response) {\n      defer.resolve(response);\n    }).fail(function () {\n      defer.resolve(null);\n    });\n    return defer.promise();\n  },\n  /*\r\n      *   Search cases with radNumber\r\n      */\n  searchCases: function searchCases(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    data['h_action'] = 'SEARCHCASES';\n    data['onlyUserCases'] = false;\n    data['active'] = false;\n    data['page'] = params.page || 1;\n    if (params.radNumber)\n    data['radNumber'] = $.trim(params.radNumber);\n    data['pageSize'] = params.pageSize || self.pageSize;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('query-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Search cases with radNumber\r\n      */\n  queryCases: function queryCases(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    data.h_action = 'QUERYCASES';\n    data.onlyUserCases = params.onlyUserCases || false;\n    data.active = params.active && true;\n    data.page = params.page || 1;\n    if (params.radNumber)\n    data.radNumber = $.trim(params.radNumber);\n    data.pageSize = params.pageSize || self.pageSize;\n\n    data.filter = params.filter;\n    data.outputxpath = params.outputxpath;\n\n    // data for sort columns\n    data.orderFieldName = params.orderFieldName || '';\n    data.orderType = params.orderType == 'asc' || params.orderType == 1 ? 1 : 0;\n    data.order = params.order || '';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('query-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Search entities service\r\n      */\n  queryEntities: function queryEntities(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    data.h_action = 'QUERYENTITIES';\n    data.page = params.page || 1;\n    data.pageSize = self.Class.ENTITIES_QUERY_PAGE_SIZE;\n\n    // Query parameters\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + 'idEnt'] = params.idEntity;\n    data.filter = params.filter;\n    data.outputxpath = params.outputxpath;\n\n    // Data to sort columns\n    data.orderFieldName = params.orderFieldName || '';\n    data.orderType = params.orderType || '';\n    data.order = params.order || '';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('query-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *  Get Menu Authorization\r\n      */\n  getMenuAuthorization: function getMenuAuthorization() {\n    var self = this;\n\n    return $.read(\n    self.serviceLocator.getUrl('authorization-handler-getMenuAuthorization'));\n\n  },\n  /*\r\n      *  The user have permissions to excecute this Case\r\n      */\n  isCaseCreationAuthorized: function isCaseCreationAuthorized(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl('authorization-handler-isCaseCreationAuthorized');\n    urlSend = urlSend.replace('{0}', params.idWfClass || '');\n\n    return $.read({\n      url: urlSend //,\n      //data: { 'idWfClass': params.idWfClass }\n      //data: { 'userName': BIZAGI_USER, 'password': BIZAGI_PASSWORD, 'domain': BIZAGI_DOMAIN }\n    });\n  },\n  /*\r\n      *   Returns the execution state of an async workitem\r\n      */\n  getAsynchExecutionState: function getAsynchExecutionState(params) {\n    var self = this;\n    var idAsynchWorkitem;\n    params = params || {};\n\n    if (params.idCase != -1) {\n      return $.read({\n        url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\n        data: {\n          idCase: params.idCase,\n          idAsynchWorkitem: params.idAsynchWorkitem },\n\n        serviceType: \"ASYNCHEXECUTION\" });\n\n    } else {\n      return $.read({\n        url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\n        data: {\n          idCase: params.idCase,\n          idAsynchWorkitem: params.idAsynchWorkitem },\n\n        serviceType: \"ASYNCHEXECUTION\" });\n\n    }\n  },\n\n  /*\r\n      *  Returns the supported log types\r\n      */\n  supportedLogTypes: function supportedLogTypes() {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('case-handler-supportedLogTypes'));\n  },\n  /*\r\n      *   Returns the Activity Log for a case\r\n      */\n  getActivityLog: function getActivityLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getActivityLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Activity Detail Log for a case\r\n      */\n  getActivityDetailLog: function getActivityDetailLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idWorkItemFrom\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getActivityDetailLog'), {\n      idCase: params.idCase,\n      idWorkItemFrom: params.idWorkItemFrom,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Entity Log for a case\r\n      */\n  getEntityLog: function getEntityLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getEntityLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Entity Detail Log for a case\r\n      */\n  getEntityDetailLog: function getEntityDetailLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getEntityDetailLog'), {\n      idCase: params.idCase,\n      idEntity: params.idEntity || -1,\n      userFullName: params.userFullName || '',\n      attribDisplayName: params.attribDisplayName || '',\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the User Log for a case\r\n      */\n  getUserLog: function getUserLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getUserLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the User Detail Log for a case\r\n      */\n  getUserDetailLog: function getUserDetailLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase , idUser\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getUserDetailLog'), {\n      idCase: params.idCase,\n      idUser: params.idUser,\n      entDisplayName: params.entDisplayName || '',\n      attribDisplayName: params.attribDisplayName || '',\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Admin Log for a case\r\n      */\n  getAdminLog: function getAdminLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getAdminLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Adds a New Favorite\r\n      */\n  addFavorite: function addFavorite(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n\n    return $.create(\n    self.serviceLocator.getUrl('favorites-handler-saveFavorite'), {\n      idObject: params.idObject,\n      favoriteType: params.favoriteType }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Favorites service\r\n      */\n  delFavorite: function delFavorite(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n\n    // Required params: guidFavorite\n    return $.destroy(\n    self.serviceLocator.getUrl('favorites-handler-deleteFavorite'), {\n      guidFavorite: params.idObject }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  // Data Transformations for Summary Widget\n  /*\r\n   * Render Assigness\r\n   */\n  summaryAssigness: function summaryAssigness(options) {\n    var self = this;\n    var def = new $.Deferred();\n    var idCase = options.idCase || \"\";\n\n    $.when(\n    self.getCaseAssignees({\n      idCase: idCase })).\n\n    done(function (baseAssignees) {\n\n      var assignees = baseAssignees.assignees || [];\n      var assigneesLength = assignees.length;\n      var assigneesFix = {\n        showAssignees: bizagi.override.showAssignees && assignees.length > 0 ? true : false,\n        assignees: {},\n        events: \"\",\n        activities: \"\" };\n\n\n      var assigneesEvents = \"\";\n      var assigneesActivities = \"\";\n      var assigneesEventsList = [];\n      var assigneesActivitiesList = [];\n\n      for (var i = 0; i < assigneesLength; i++) {\n        if (bizagi.util.parseBoolean(assignees[i].isEvent)) {\n          if (assigneesEventsList.indexOf(assignees[i].idUser) == -1) {\n            assigneesEventsList.push(assignees[i].idUser);\n            assigneesEvents += assignees[i].Name + \", \";\n          }\n        } else {\n          if (assigneesActivitiesList.indexOf(assignees[i].idUser) == -1) {\n            assigneesActivitiesList.push(assignees[i].idUser);\n            assigneesActivities += assignees[i].Name + \", \";\n          }\n        }\n      }\n      //join assignees to event and activities\n      assigneesFix.events = assigneesEvents.substring(0, assigneesEvents.length - 2);\n      assigneesFix.activities = assigneesActivities.substring(0, assigneesActivities.length - 2);\n\n\n      def.resolve(assigneesFix);\n    });\n\n    return def.promise();\n  },\n  /*\r\n      * Render Assigness\r\n      */\n  summarySubProcess: function summarySubProcess(options) {\n    var self = this;\n    var def = $.Deferred();\n    var idCase = options.idCase || '';\n\n    $.when(\n    self.getCaseSubprocesses({\n      idCase: idCase })).\n\n    done(function (subprocess) {\n      subprocess['showSubProcess'] = subprocess['subProcesses'].length >= 1 ? true : false;\n      subprocess['showSubProcesColumns'] = subprocess['CustFields'][0] !== undefined && subprocess['CustFields'][0][0].length >= 1 ? true : false;\n\n      // Prepare json for subprocess\n      if (subprocess['showSubProcesColumns']) {\n        subprocess['subProcPersonalized'] = {};\n        var len;\n        for (var n = 0; n < subprocess['CustFields'].length; n++) {\n          len = 0;\n          for (var i = 0; i < subprocess['subProcesses'].length; i++) {\n            if (subprocess['subProcesses'][i]['idCustData'] == n) {\n              subprocess['subProcPersonalized'][n] = subprocess['subProcPersonalized'][n] || {};\n              subprocess['subProcPersonalized'][n]['subProcesses'] = subprocess['subProcPersonalized'][n]['subProcesses'] || {};\n              subprocess['subProcPersonalized'][n]['subProcesses'][len++] = subprocess['subProcesses'][i];\n            }\n          }\n\n          if (subprocess[\"subProcesses\"][n][\"idCustData\"] != -1 && subprocess[\"subProcPersonalized\"][n] != undefined) {\n            subprocess[\"subProcPersonalized\"][n][\"CustFields\"] = subprocess[\"CustFields\"][n];\n            subprocess[\"subProcPersonalized\"][n][\"idCase\"] = subprocess[\"idCase\"];\n          }\n        }\n      }\n\n      def.resolve(subprocess);\n    });\n\n    return def.promise();\n  },\n  /*\r\n      * Render Case Events\r\n      */\n  summaryCaseEvents: function summaryCaseEvents(options) {\n    var self = this;\n    var def = $.Deferred();\n    var idCase = options.idCase || '';\n\n    $.when(\n    self.getCaseEvents({\n      idCase: idCase })).\n\n    done(function (events) {\n      events['showEvents'] = events['events'].length >= 1 ? true : false;\n      def.resolve(events);\n    }).fail(function (error) {\n      def.reject();\n    });\n\n    return def.promise();\n  },\n  /*\r\n      * Render Details\r\n      * @param idWorkitem\r\n      */\n  summaryCaseDetails: function summaryCaseDetails(options) {\n    var self = this;\n    var def = new $.Deferred();\n    var idWorkitem = options.idWorkitem || 0;\n\n    $.when(\n    self.getCaseSummaryDataContent(options)).\n    done(function (data) {\n      data.currentState = data.currentState || [];\n      var dataCurrentStateLength = data.currentState.length;\n      // Show or hide tabs\n      data.showEvents = data.countEvents >= 1 ? true : false;\n      data.showParentProcess = data.idParentCase >= 1 ? true : false;\n      data.parentProcess = {\n        \"displayName\": data.parentDisplayName,\n        \"idCase\": data.idParentCase };\n\n\n      //data.isOpen: if request have onlyUserWorkItems = true, so verify workitems of current user\n      //data.isClosed: if request have onlyUserWorkItems = false, not verify workitems of current user\n      data.isClosedForAllUsers = bizagi.util.parseBoolean(data.isClosed);\n      data.isClosed = bizagi.util.parseBoolean(data.isOpen) ? false : true;\n      data.showAssignees = bizagi.override.showAssignees && data.countAssigness > 0 ? true : false;\n      data.showSubProcess = data.countSubProcesses > 0 ? true : false;\n      data.showForm = bizagi.util.parseBoolean(data.hasGlobalForm) ? true : false;\n      data.allowsReassign = \"false\";\n\n      for (i = 0; i < dataCurrentStateLength; i++) {\n        if (data.currentState[i].idWorkItem == idWorkitem) {\n          data.allowsReassign = data.currentState[i].allowsReassign;\n        }\n      }\n\n      // edit original data, no show events in activities tab\n      var currentStateTypes = [];\n      var m = 0; // counter for new activities array\n      for (i = 0; i < dataCurrentStateLength; i++) {\n        if (!bizagi.util.parseBoolean(data.currentState[i].isEvent) && bizagi.util.parseBoolean(data.\n        currentState[i].assignToCurrentUser) && data.currentState[i].idWorkItem != idWorkitem) {\n          currentStateTypes[m++] = data.currentState[i];\n        }\n      }\n\n      data.currentStateTypes = currentStateTypes;\n      data.showActivities = currentStateTypes.length > 0 ? true : false;\n\n      def.resolve(data);\n    });\n\n    return def.promise();\n  },\n\n  releaseActivity: function releaseActivity(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"case-handler-releaseActivity\");\n    url = url.replace(\"{idCase}\", params.idCase);\n    var data = {};\n    // Define data\n    if (params) {\n      data[\"idCase\"] = params.idCase;\n      data[\"idWorkItem\"] = params.idWorkItem;\n    }\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n\n  },\n  /**\r\n      *\r\n      * Segment Activities for summary in render module\r\n      * @param options {data,idWorkItem}\r\n      */\n  summaryActivities: function summaryActivities(options) {\n    var activities = {};\n    var data = options['data'] || {};\n    var idWorkItem = idWorkItem || options['idWorkitem'] || 0;\n\n    try {\n      activities['showActivities'] = data['currentStateTypes'].length >= 1 ? true : false;\n      activities['currentState'] = data['currentStateTypes'];\n      activities['globalIdWorkitem'] = idWorkItem;\n      activities['creationDate'] = data['creationDate'];\n    } catch (e) {}\n\n    return activities;\n  },\n  /**\r\n      *  Get json from cases service\r\n      */\n  getCaseSummaryDataContent: function getCaseSummaryDataContent(options) {\n    var self = this;\n    var promise = new $.Deferred();\n\n    $.when(self.getCaseSummary(options)).\n    done(function (data) {\n      // Completes data\n      data.taskState = self.icoTaskState;\n      data.process = data.process ? data.process : \"\";\n\n      if (data.createdBy) {\n        data.createdByName = data.createdBy.Name;\n        data.createdByUserName = data.createdBy.userName;\n        data.caseDescription = data.caseDescription == \"\" ? \"\" : data.caseDescription;\n        data.processPath = data.processPath.replace(/\\//g, \" > \") + data.process;\n        data.showWorkOnIt = true;\n      }\n\n      // return json content\n      promise.resolve(data);\n    });\n\n    return promise.promise();\n  },\n  /**\r\n      * Definition service for bizagi smart folders\r\n      *\r\n      * @param id optional with filter purpose\r\n      */\n  getSmartFolders: function getSmartFolders(id) {\n    var self = this;\n    var data = {};\n\n    data.idFolder = id || '';\n    // Call read and returns promise\n    return $.read(self.serviceLocator.getUrl('folders-handler-getUserQueries'), data).pipe(function (response) {\n      if (id == -1 || id == '') {\n        return response;\n      } else {\n        return self.searchFolders(id, response) || [];\n      }\n    });\n  },\n  /**\r\n      * Delete smart folder\r\n      * @param options {idSmartFolder,idUser}\r\n      */\n  deleteSmartFolder: function deleteSmartFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = '6';\n    options = options || {};\n\n    data.idSmartFolder = options.idSmartFolder || '';\n    data.idUser = options.idUser || '';\n\n    return $.destroy(self.serviceLocator.getUrl('folders-associate-deleteSmartFolder'), data);\n  },\n  /**\r\n      * Definition service for bizagi folders\r\n      *\r\n      * @param id optional with filter purpose\r\n      */\n  getFolders: function getFolders(id) {\n    var self = this;\n    var data = {};\n\n    data.action = 'getUserFolder';\n    data.idFolder = id || '';\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      type: 'POST',\n      data: data,\n      dataType: 'json' }).\n    pipe(function (response) {\n      if (id == '') {\n        var folders = {\n          folders: [{\n            name: bizagi.localization.getResource('workportal-widget-folders'),\n            id: '-1',\n            idParent: 0,\n            childs: response }] };\n\n\n        return folders;\n      } else if (id == -1) {\n        return response;\n      } else {\n        return self.searchFolders(id, response) || [];\n      }\n    });\n  },\n  searchFolders: function searchFolders(idFolder, data) {\n    for (var i = 0; i < data.folders.length; i++) {\n      var value = data.folders[i];\n      if (value.id == idFolder) {\n        return data.folders[i]['childs'];\n        break;\n      }\n    }\n    return undefined;\n  },\n  getCasesByFolder: function getCasesByFolder(query) {\n    query = query || '';\n\n    return $.ajax({\n      cache: true,\n      url: 'RestServices/' + query,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  makeFolder: function makeFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = 'CreateUpdateFolder';\n    data.folderName = options.folderName || 'No Name';\n\n    // Make folder under subcategory\n    if (options.idParentFolder != undefined && options.idParentFolder > 1) {\n      data.idParentFolder = options.idParentFolder;\n    }\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  updateFolder: function updateFolder(options) {\n    var self = this;\n    var data = {};\n    options = options || {};\n\n    data.action = 'CreateUpdateFolder';\n    // Define idFolder\n    data.idFolder = options.idFolder || '';\n\n    // Update name\n    if (options.folderName) {\n      data.folderName = options.folderName;\n    }\n\n    // Update path\n    if (options.idParentFolder) {\n      data.idParentFolder = options.idParentFolder;\n    }\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Associate cases to folders\r\n      *\r\n      * @param options {idcase,idCustomFolder}\r\n      */\n  associateCaseToFolder: function associateCaseToFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = '4';\n    options = options || {};\n\n    data.idCase = options.idCase || '';\n    data.idCustomFolder = options.idCustomFolder;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-associate'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      * Dissasociate cases to folder\r\n      *\r\n      * @param options {idFolder, idCase}\r\n      */\n  dissasociateCaseFromFolder: function dissasociateCaseFromFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = 'DeleteCaseFromFolder';\n    options = options || {};\n\n    data.idFolder = options.idFolder;\n    data.idCase = options.idCase;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Delete folder\r\n      * @param options {idCustomFolder}\r\n      */\n  deleteFolder: function deleteFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = '5';\n    options = options || {};\n\n    data.idCustomFolder = options.idCustomFolder || '';\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-associate'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Gets a file binary from the server\r\n      * @param options {fileId}\r\n      */\n  getFile: function getFile(options) {\n    var self = this;\n    var data = {};\n    var url = this.serviceLocator.getUrl('file-handler');\n    options = options || {};\n\n    data.action = 'getFileContent';\n    data.uploadId = options.uploadId || '';\n    data.entityId = options.entityId || '';\n    data.entityKey = options.entityKey || '';\n\n    return bizagi.services.ajax.pathToBase + url + '?' + jQuery.param(data);\n  },\n  /**\r\n      * Get Comments per case\r\n      * @param params {idCase=int&idColorCategory=int&pag=int&pagSize=int}\r\n      * @return json\r\n      */\n  getComments: function getComments(params) {\n    //params.idCase = params.idCase || 0;\n    var self = this;\n\n    params = params || {};\n\n    return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-GetComments')), {\n      idCase: params.idCase || '',\n      idColorCategory: typeof params.idColorCategory == 'number' ? params.idColorCategory : '',\n      pag: params.pag || 1,\n      pagSize: params.pagSize || 10 }).\n\n    pipe(function (result) {\n      var def = new $.Deferred();\n      var picture = 'iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC';\n      if (!result.comments) {\n        result.comments = [];\n      } else {\n        // Add CategoryColor for each comment\n        $.each(result.comments, function (key, value) {\n          if (!result.comments[key].hasOwnProperty('CategoryColor')) {\n            result.comments[key]['CategoryColor'] = '';\n          }\n        });\n      }\n      if (!result.users) {\n        $.when(self.getCurrentUser()).\n        done(function (user) {\n          result.users = [];\n          result.users.push({\n            Id: user.idUser,\n            Name: user.user,\n            DisplayName: user.userName,\n            Picture: picture });\n\n        });\n      } else {\n        $.each(result.users, function (key, value) {\n          // Add picture to all users\n          result.users[key]['Picture'] = result.users[key]['Picture'] === '' ? picture : result.users[key]['Picture'];\n        });\n      }\n      def.resolve(result);\n      return def.promise();\n    });\n  },\n  /**\r\n      * This function allow create new comment into the activity\r\n      *\r\n      * @param options {idCase,comment}\r\n      * @return json\r\n      */\n  makeNewComment: function makeNewComment(options) {\n    var self = this;\n    var picture = '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';\n    return $.create(self.serviceLocator.getUrl('MessageHandler-NewComment'), {\n      idCase: options.idCase || '',\n      comment: options.comment.replace(/\\n/g, '<br>') || '' }).\n\n    pipe(function (result) {\n      if (result.comments) {\n        var comments = [result.comments];\n        $.each(comments, function (key, value) {\n          // Add CategoryColor for each comment\n          comments[key]['CategoryColor'] = '';\n        });\n        result.comments = comments;\n      }\n\n      if (result.users) {\n        var users = [result.users];\n        $.each(users, function (key, value) {\n          // Add picture to all users\n          users[key]['Picture'] = users[key]['Picture'] == '' ? picture : users[key]['Picture'];\n        });\n        result.users = users;\n      }\n\n      return result;\n    });\n  },\n  /**\r\n      * This function allow create new replies into the comment\r\n      *\r\n      * @param options {idCase=int&idComment=int&comment=string}\r\n      * @return json\r\n      */\n  makeNewReply: function makeNewReply(options) {\n    var self = this;\n    var picture = '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';\n\n    options = options || {};\n\n    return $.create(self.serviceLocator.getUrl('MessageHandler-ReplyComment'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '',\n      comment: options.comment.replace(/\\n/g, '<br>') || '' }).\n\n    pipe(function (result) {\n      if (result.comments) {\n        result.Replies = [result.comments];\n      }\n\n      if (result.users) {\n        var users = [result.users];\n        $.each(users, function (key, value) {\n          // Add picture to all users\n          users[key]['Picture'] = users[key]['Picture'] == '' ? picture : users[key]['Picture'];\n        });\n        result.users = users;\n      }\n\n      return result;\n    });\n  },\n  /**\r\n      * Remove one comment from the list in mobiles\r\n      *\r\n      * @param options {content:{guid:\"...\"},attachmentsToDelete:[\"...\", \"...\", ...]};\r\n      * @return json {action:true|false, message:'if error, explain why'}\r\n      */\n  removeMobileComment: function removeMobileComment(options) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('remove-comment');\n\n    options = options || {};\n\n    return $.destroy({\n      url: url,\n      data: JSON.stringify(options),\n      dataType: \"json\",\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      * Remove one comment from the list\r\n      *\r\n      * @param options {idCase=int&idComment=int}\r\n      * @return json {action:true|false, message:'if error, explain why'}\r\n      */\n  removeComment: function removeComment(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveComment'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '' });\n\n  },\n  /**\r\n      * Remove one replies from the list\r\n      *\r\n      * @param options {idCase=int&idComment=int&idReply=int}\r\n      * @return json {action:true|false, message:'if error, explain why'}\r\n      */\n  removeReply: function removeReply(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveReply'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '',\n      idReply: options.idReply || '' });\n\n\n  },\n  /**\r\n      * Rename category\r\n      *\r\n      * @param options {idColorCategory=int&colorName=string}\r\n      * @return json\r\n      */\n  renameCommentCategory: function renameCommentCategory(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.update(self.serviceLocator.getUrl('MessageHandler-RenameCategoryColor'), {\n      idColorCategory: options.idColorCategory >= 0 ? options.idColorCategory : '',\n      colorName: options.colorName || '' });\n\n  },\n  /**\r\n      * @param options {idCase=int&idComment=int&idColorCategory={0-5}}\r\n      * return json\r\n      */\n  setCommentCategory: function setCommentCategory(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.update(self.serviceLocator.getUrl('MessageHandler-SetCategoryToComment'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '',\n      idColorCategory: typeof options.idColorCategory == 'number' ? options.idColorCategory : '' });\n\n  },\n  /**\r\n      * @return json Definition of all categories of message\r\n      */\n  getCommentsCategories: function getCommentsCategories() {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('MessageHandler-GetCategoryColors')).\n    pipe(function (result) {\n      if (result.length > 1 && result[0]['categories']) {\n        return result[0];\n      } else {\n        return result;\n      }\n    });\n  },\n  /**\r\n      * This service can be define number of new comments based on idComment\r\n      * @param json  options {idCase=int, idLastComment=int}\r\n      * @return int\r\n      */\n  getNewComments: function getNewComments(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-CountNewComments')), {\n      idCase: options.idCase || 0,\n      idComment: options.idComment || 0 });\n\n  },\n  /**\r\n      * Get all analisys queries\r\n      * @return json\r\n      */\n  getAnalisysQueries: function getAnalisysQueries() {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('bamAnalytics-handler-getAnalisysQueries'));\n  },\n  /**\r\n      * Update name and comment\r\n      *\r\n      * @param options json {queryName,queryDescription,idQuery }\r\n      * @return json  {response:true}\r\n      */\n  updateQueries: function updateQueries(options) {\n    var self = this;\n\n    return $.update(self.serviceLocator.getUrl('bamAnalytics-handler-updateQuery'), {\n      idQuery: options.idQuery >= 0 ? options.idQuery : '',\n      queryName: options.queryName || '',\n      queryDescription: options.queryDescription || '' });\n\n  },\n  /**\r\n      * Delete query\r\n      *\r\n      * @param queryId integer\r\n      * @return json  {response:true}\r\n      */\n  deleteQueries: function deleteQueries(queryId) {\n    var self = this;\n    var data = {};\n\n    data.action = '1612';\n    data.QueryId = queryId || '';\n\n    return $.destroy(self.serviceLocator.getUrl('reports-handler-deleteQueries'), data);\n  },\n\n  /**\r\n      * Get bizagi configuration\r\n      * @param {Function}   type    callback function when the file load is succed\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getConfiguration: function getConfiguration() {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"authenticationConfig\");\n\n    return $.read(url);\n  },\n\n  /**\r\n      * Logout Service\r\n      */\n  logout: function logout() {\n    var self = this;\n    // Remove session storage of authentication data\n    sessionStorage.removeItem('bizagiAuthentication');\n\n    //Call to the restfull service for domain list\n    try {\n      var javaLogout = $.create(self.serviceLocator.getUrl('logout'));\n\n      $.when(javaLogout).done(function () {\n        location.reload();\n      }).fail(function () {\n        bizagi.log('Error logging out');\n      });\n    } catch (e) {}\n  },\n\n  /**\r\n      * Logout from different types of services\r\n      * This method can reload the page after calling the logout service required\r\n      */\n  logoutMobile: function logoutMobile() {\n    var self = this;\n    var logoutData = { sourceLogout: \"user\" };\n\n    // Remove session storage of authentication data\n    sessionStorage.removeItem(\"bizagiAuthentication\");\n\n    // Remove last process inbox\n    bizagi.util.removeLastProcessInbox();\n\n    // Hybrid will use normal system\n    if (bizagi.util.isCordovaSupported()) {\n      var url = self.serviceLocator.getUrl(\"logout\");\n      return $.create(url);\n    } else {\n      // Call to the restfull service for domain list\n      try {\n\n        $.when(self.getConfiguration()).done(function (data) {\n          if (data.redirectErrorPage) {\n            window.location.href = data.redirectErrorPage;\n            return;\n          }\n\n          var authenticationType = data.authenticationType;\n          switch (authenticationType) {\n            case \"Federate\":\n              var logOffURL = data.logOffURL;\n              var federationLogoutBindingProtocol = data.federationLogoutBindingProtocol;\n              var authenticationSubType = data.authenticationSubType;\n              if (authenticationSubType === 'WSFederated') {\n                $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\n                  location.href = logOffURL;\n                }).fail(function () {\n                  bizagi.log(\"Error logging out\");\n                }).always(function () {\n                  location.href = data.logOffURL;\n                });\n              } else\n              if (authenticationSubType === 'Saml') {\n                var param = {};\n                $.when($.read(self.serviceLocator.getUrl(\"FederateLogoffUrl\"), param)).done(function (res) {\n                  if (res.federateLogoffUrl) {\n                    logOffURL = res.federateLogoffUrl;\n                  }\n\n                  $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\n                    if (federationLogoutBindingProtocol === 'POST') {\n                      window.document.open('text/html');\n                      window.document.write(logOffURL);\n                      window.document.close();\n                    } else\n                    {\n                      window.location.href = logOffURL;\n                    }\n                  }).fail(function () {\n                    bizagi.log(\"Error logging out\");\n                  }).always(function () {\n                  });\n\n                }).fail(function () {\n                  bizagi.log(\"Error logging out\");\n                }).always(function () {\n                });\n              }\n              break;\n            case \"SAML\":\n              loader.nativeAjax(loader.getPathUrl(self.serviceLocator.getUrl(\"logout\"), logoutData),\n              function (response) {\n                var jsonResponse = JSON.parse(response.responseText);\n\n                if (jsonResponse.logout === true) {\n                  if (typeof jsonResponse.samlUrlRedirect != \"undefined\") {\n                    var url = decodeURI(jsonResponse.samlUrlRedirect);\n                    var iframe = document.createElement(\"iframe\");\n\n                    document.getElementsByTagName(\"body\")[0].appendChild(iframe);\n\n                    $(iframe).on(\"load\", function () {\n                      var iframeContent = bizagi.util.isIE8() ?\n                      $(this.contentWindow.document.body) :\n                      $(this.contentWindow.eval(\"document.body\"));\n                      var rawResponse = iframeContent.text();\n\n                      location.reload();\n                    });\n\n                    iframe.src = url;\n\n                  } else {\n                    location.reload();\n                  }\n                } else {\n                  bizagi.log(\"Error logging out\");\n                }\n              });\n              break;\n            case \"OAuth2\":\n              $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\n                $.when($.read(self.serviceLocator.getUrl(\"oauth2AuthenticationConfig\"))).\n                done(function (response) {\n                  if (response.logoutUrl && response.logoutUrl != \"\") {\n                    var logoutUrl = response.logoutUrl;\n                    var callbackUrl = response.homeUrl;\n\n                    logoutUrl = logoutUrl.replace(/post_logout_redirect_uri=[^&]*/,\n                    \"post_logout_redirect_uri=\" + callbackUrl);\n                    location.href = logoutUrl;\n                  } else {\n                    location.reload();\n                  }\n\n                }).fail(function () {\n                  bizagi.log(\"Error logging out\");\n                });\n              }).fail(function () {\n                bizagi.log(\"Error logging out\");\n              });\n              break;\n            default:\n              //Normal\n              $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).\n              done(function () {\n                window.location = bizagi.services.ajax.loginPage;\n              }).fail(function () {\n                bizagi.log(\"Error logging out\");\n              });\n              break;}\n\n        }).fail(function (message) {\n          bizagi.log(message);\n        });\n      } catch (e) {\n        bizagi.log(e);\n      }\n    }\n  },\n\n  /**\r\n      * Services for Massive Activity Assignment\r\n      */\n\n  /*\r\n          * Obtain the organization info, such as roles, skills or locations. One of this options\r\n          * must be specified as a parameter\r\n          * @param object  {objectType=Roles|Skills|Locations}\r\n          * @return json\r\n          */\n  getOrganizationInfo: function getOrganizationInfo(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['objectType'] = params;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-getOrganizationInfo'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n      * @param object  {roles=(string),roles=(skills), locations=(string)}\r\n      * @return json\r\n      */\n  getCasesByOrganization: function getCasesByOrganization(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n\n    data['roles'] = params.roles ? '[' + params.roles.toString() + ']' : '[]';\n\n    data['skills'] = params.skills ? '[' + params.skills.toString() + ']' : '[]';\n\n    data['locations'] = params.locations ? '[' + params.locations.toString() + ']' : '[]';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-getCasesByOrganization'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n      * @param object  {user=[array], roles=(string),roles=(skills), locations=(string)}\r\n      */\n  reassignCases: function reassignCases(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['users'] = params.user ? '[' + params.user.toString() + ']' : '[]';\n    data['roles'] = params.roles ? '[' + params.roles.toString() + ']' : '[]';\n    data['skills'] = params.skills ? '[' + params.skills.toString() + ']' : '[]';\n    data['locations'] = params.locations ? '[' + params.locations.toString() + ']' : '[]';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-reassignCases'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      * Search the users inside the Organization, using parameters suchs as userName, full name, domain, roles, skills and locations\r\n      * All parameters are optional\r\n      * @param object  {userName=(string), fullName=(string), domain=(string), roles=(string),roles=(skills), locations=(string)}\r\n      * @return json\r\n      */\n  searchUsers: function searchUsers(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['userName'] = params.userName || '';\n\n    data['fullName'] = params.fullName || '';\n\n    data['domain'] = params.domain || '';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-searchUsers'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Get json with bizagi domains list\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getDomainList: function getDomainList() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('domains');\n\n    return $.read(url);\n  },\n  /**\r\n      * Services for Asynchronous ECM Upload\r\n      */\n\n  /* Get the ECM Pending Scheduled Jobs\r\n          * @return {deferred} ajax object with JSON content\r\n          */\n  getEcmAllScheduledJobs: function getEcmAllScheduledJobs() {\n    var self = this;\n\n    // Define data\n    var data = {};\n    data['action'] = 'getEcmAllScheduledJobs';\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\n  },\n  /* Retries an especific ECM Pending Scheduled Job\r\n      * @param object  {jobId=(string)} //The id of the job wich is going to be retried\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  retryECMPendingScheduledJob: function retryECMPendingScheduledJob(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    data['action'] = 'retryECMPendingScheduledJob';\n    data['idJob'] = params;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\n  },\n  /*\r\n      *   Returns the current workportal version\r\n      */\n  getWorkPortalVersion: function getWorkPortalVersion() {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('WorkPortalVersion'),\n      type: 'GET',\n      dataType: 'json' }).\n    always(function (data) {\n      // Compatibility with java version\n      data = data || {};\n\n      if (data.version == '') {\n        // Take the build version\n        data.version = bizagi.loader.productBuild || '';\n      }\n      return data;\n    });\n  },\n  /*\r\n      *   Returns the combo's data to authentication log depending of the params\r\n      */\n  getAuthenticationLogData: function getAuthenticationLogData(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    var url = '';\n\n    if (params['dataType'] == 'domains') {\n      url = 'admin-getAuthenticationDomains';\n    } else if (params['dataType'] == 'events') {\n      url = 'admin-getAuthenticationEventsTypes';\n    } else {\n      url = 'admin-getAuthenticationEventSubTypes';\n    }\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(url),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Get the search result of authentication log\r\n      */\n  getAuthenticationLogResult: function getAuthenticationLogResult(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['action'] = params.action;\n    data['domain'] = params.domain;\n    data['userName'] = params.userName;\n    data['dtFrom'] = params.dtFrom;\n    data['dtTo'] = params.dtTo;\n    data['eventSubType'] = params.eventSubType;\n    data['eventType'] = params.eventType;\n    data['pag'] = params.pag;\n    data['pagSize'] = params.pagSize;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-getAuthenticationLog'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Return the password encrypted\r\n      */\n  encryptString: function encryptString(params) {\n    var self = this;\n\n    var data = {};\n\n    // Define data\n    params = params || {};\n\n    data.entry = params.entry;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-EncryptString'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return the users requests\r\n      */\n  userPendingRequests: function userPendingRequests(params) {\n    var self = this;\n    var data = {\n      pag: params.pag,\n      pagSize: params.pagSize };\n\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"admin-UserPendingRequests\"), data);\n  },\n\n  /*\r\n      *   Return the User Authentication Info\r\n      */\n  userAuthenticationInfo: function userAuthenticationInfo(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('admin-UserAuthenticationInfo'), {\n      idUser: params.idUser });\n\n  },\n\n  /*\r\n      *   Return Update User Authentication Info\r\n      */\n  updateUserAuthenticationInfo: function updateUserAuthenticationInfo(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.create(self.serviceLocator.getUrl('admin-updateUserAuthenticationInfo'), {\n      idUser: params.idUser,\n      password: params.password,\n      enable: params.enable,\n      expired: params.expired,\n      locked: params.locked });\n\n  },\n\n  /*\r\n      *   Return generate Data To Send By Email\r\n      */\n  generateRandomPassword: function generateRandomPassword(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    params['action'] = 'generateRandomPassword';\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-generateRandomPassword'),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return generate Data To Send By Email\r\n      */\n  generateDataToSendByEmail: function generateDataToSendByEmail(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['action'] = 'GenerateDataToSendByEmail';\n    data['idUser'] = params.idUser;\n    data['password'] = params.password;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-GenerateDataToSendByEmail'),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n\n  },\n\n  /*\r\n      *   Return generate Send Mail\r\n      */\n  sendEmail: function sendEmail(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['action'] = 'sendEmail';\n    data['emailTo'] = params.emailTo;\n    data['subject'] = params.subject;\n    data['body'] = params.body;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-sendEmail'),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return Applications, Categories or processes list\r\n      */\n  getApplicationCategoriesList: function getApplicationCategoriesList(params) {\n    var self = this;\n    var data = {};\n    var url = '';\n\n    if (params.action == 'Applications') {\n      url = 'admin-getApplicationList';\n\n      // Call ajax and returns promise\n      return $.ajax({\n        url: self.serviceLocator.getUrl(url),\n        type: 'GET',\n        dataType: 'json' });\n\n    } else {\n      url = 'admin-getCategoriesList';\n      data.idApp = params.idApp;\n      data.idCategory = params.idCategory;\n      if (data.idCategory == '') {\n        data.idCategory = -1;\n      }\n\n      if (typeof params.filterStartEvent !== 'undefined') {\n        data.filterStartEvent = params.filterStartEvent;\n      }\n\n      // Call ajax and returns promise\n      return $.ajax({\n        url: self.serviceLocator.getUrl(url),\n        data: data,\n        type: 'GET',\n        dataType: 'json' });\n\n    }\n  },\n\n  /*\r\n      *   Return the list of all cases that matched the filters\r\n      */\n  getAdminCasesList: function getAdminCasesList(params) {\n    var self = this;\n    var data = params || {};\n\n    // Call ajax and returns promise\n    return $.ajax({\n      //eliminar esto con el servicio restfull\n      cache: true,\n      url: self.serviceLocator.getUrl('admin-getCasesList'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n\n  },\n\n  /*\r\n      *   Return the application's processes\r\n      */\n  getApplicationProcesses: function getApplicationProcesses(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getApplicationProcesses');\n\n    var data = {};\n\n    data['idApp'] = params['idApp'] ? params['idApp'] : -1;\n\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *   Return the application's processes\r\n      */\n  getProcessVersion: function getProcessVersion(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getProcessVersion');\n\n    var data = {};\n\n    data['idWfClass'] = params['idWFClass'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *   Return the the workflow's versions task\r\n      */\n  getProcessTasks: function getProcessTasks(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getProcessTasks');\n\n    var data = {};\n\n    data['idWfClass'] = params['idWFClass'];\n    data['version'] = params['version'] ? params['version'] : undefined;\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Retrieves the alarms from an specific task\r\n      */\n  getTaskAlarms: function getTaskAlarms(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getTaskAlarms');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Retrieves each kind of alarm lapse\r\n      */\n  getLapseMode: function getLapseMode() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getLapseMode');\n\n    return $.read(url);\n  },\n\n  /*\r\n      * Retrieves each kind of alarm recurrence\r\n      */\n  getRecurrMode: function getRecurrMode() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getRecurrMode');\n\n    return $.read(url);\n  },\n\n\n  /*\r\n      * Retrieves each kind of alarm recurrence\r\n      */\n  getScheduleType: function getScheduleType() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getScheduleType');\n\n    return $.read(url);\n  },\n\n  /*\r\n      *   Retrieves the boss list\r\n      */\n  getBossList: function getBossList(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getBossList');\n    return $.read(url);\n  },\n\n  /**\r\n      *   Add a new alarm\r\n      */\n  addAlarm: function addAlarm(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-addAlarm');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n    data['idRecurrMode'] = params['idRecurrMode'];\n    data['idLapseMode'] = params['idLapseMode'];\n    data['scheduleType'] = params['scheduleType'];\n    data['alarmTime'] = params['alarmTime'];\n    data['alarmRecurrTime'] = params['alarmRecurrTime'];\n    data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\n\n    return $.update(url, data);\n    /*\r\n                                 return $.ajax({\r\n                                 url: self.serviceLocator.getUrl('admin-addAlarm'),\r\n                                 data: data,\r\n                                 type: 'PUT',\r\n                                 dataType: 'json'\r\n                                 });\r\n                                 */\n  },\n\n  /*\r\n      *   Edits an existin alarm\r\n      */\n  editAlarm: function editAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-editAlarm');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n    data['idAlarm'] = params['idAlarm'];\n    data['idRecurrMode'] = params['idRecurrMode'];\n    data['idLapseMode'] = params['idLapseMode'];\n    data['scheduleType'] = params['scheduleType'];\n    data['alarmTime'] = params['alarmTime'];\n    data['alarmRecurrTime'] = params['alarmRecurrTime'];\n    data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\n\n\n    return $.update(url, data);\n\n\n  },\n\n  /*\r\n      *   Delete an alarm\r\n      */\n  deleteAlarm: function deleteAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-deleteAlarm');\n\n    var data = {};\n\n    data['idAlarm'] = params['idAlarm'];\n\n    return $.destroy(url, params);\n\n  },\n\n  /*\r\n      * Returns the Alarm Recipients\r\n      * @param param: idAlarm : the alarm id to get the related recipients\r\n      */\n  getAlarmRecipients: function getAlarmRecipients(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-alarmRecipients');\n\n    var data = {};\n\n    data['idAlarm'] = params['idAlarm'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Adds a new Alarm Recipient to the current alam\r\n      * @param param: idAlarm : the alarm id to get the related recipients\r\n      * @param param: idRecipient : the recipient id\r\n      */\n  addRecipientToAlarm: function addRecipientToAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-recipientToAlarm');\n\n    var data = {};\n\n    data['idAlarm'] = params['idAlarm'];\n    data['idRecipient'] = params['idRecipient'];\n\n    return $.update(url, data);\n\n\n  },\n\n  /*\r\n      * Delete/s the alarm recipient/s from the current task\r\n      * @param param: idRecipient : the recipient id/s who is going to be deleted\r\n      */\n  deleteRecipientsFromAlarm: function deleteRecipientsFromAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-deleteAlarmRecipients');\n\n    var data = {};\n\n    data['idRecipients'] = params['idRecipients'];\n\n    return $.destroy(url, data);\n  },\n\n  /*\r\n      * Send the action to toggle the alarms state: enable or disable\r\n      * @param param: idTask : the task id who is going to be actvidated/deactivaded his alarms\r\n      */\n  enableAlarm: function enableAlarm(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-enableAlarm');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * Invalidate or Reassign a set of cases\r\n      */\n  abortReassignItems: function abortReassignItems(params) {\n    var self = this;\n    var data = params || {};\n    var url = params.action == 'abort' ? 'admin-abortItems' : 'admin-reassignItems';\n    // Call ajax and returns promise\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(url),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      * Services for Asynchronous Activities\r\n      */\n  asyncActivitiesServices: function asyncActivitiesServices(params) {\n    var self = this;\n    var data = params;\n    var url = '';\n    var type = 'GET';\n    if (params.action == 'getActivities') {\n      url = self.serviceLocator.getUrl('admin-async-activities-get-activities');\n    } else if (params.action == 'retryNow') {\n      type = 'POST';\n      url = self.serviceLocator.getUrl('admin-async-activities-get-retry-now');\n      url = url.replace('{idCase}', params.idCase);\n      url = url.replace('{idworkItem}', params.idWorkitem);\n      url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\n    } else if (params.action == 'getActivitiesByTask') {\n      url = self.serviceLocator.getUrl('admin-async-activities-get-activities-by-task');\n    } else if (params.action == 'enableExecution') {\n      type = 'POST';\n      url = self.serviceLocator.getUrl('admin-async-activities-enable-execution');\n    } else if (params.action == 'enableMultiple') {\n      url = self.serviceLocator.getUrl('admin-async-activities-enable-multiple');\n      type = 'POST';\n    } else if (params.action == 'asyncExecution') {\n      url = self.serviceLocator.getUrl('admin-async-activities-async-execution');\n    } else if (params.action == 'asyncExecutionLog') {\n      url = self.serviceLocator.getUrl('admin-async-activities-async-execution-log');\n      url = url.replace('{idCase}', params.idCase);\n      url = url.replace('{idworkItem}', params.idWorkItem);\n      url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\n    } else if (params.action == 'getAsyncExecution') {\n      url = self.serviceLocator.getUrl('admin-async-activities-async-get-current-execution-log');\n    }\n    // Call ajax and returns promise\n    var response = $.ajax({\n      url: url,\n      data: data,\n      type: type,\n      dataType: 'json' });\n\n\n    return response;\n  },\n\n  /*\r\n      *  Return generate Default Assignation To all Process\r\n      */\n  getDefaultAssignationUserToAllProcess: function getDefaultAssignationUserToAllProcess(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToAllProcess'), {\n      serviceAction: 'getDefaultAssignationUserToAllProcess' });\n\n  },\n\n  /*\r\n      *  Return generate Default Assignation To Process\r\n      */\n  getDefaultAssignationUserToProcess: function getDefaultAssignationUserToProcess(params) {\n    var self = this;\n    var process;\n    // Call ajax and returns promise\n    if (params.idWFClass == '') {\n      process = -1;\n    } else {\n      process = params.idWfClass;\n    }\n    return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToProcess'), {\n      serviceAction: 'getDefaultAssignationUserToProcess',\n      process: process });\n\n\n  },\n\n  /*\r\n      * Return Assignation Process\r\n      */\n  setDefaultAssignationUserToProcess: function setDefaultAssignationUserToProcess(params) {\n    var self = this;\n    if (params.idWFClass == '') {\n      process = -1;\n    } else {\n      process = params.idWfClass;\n    }\n\n    // Call ajax and returns promise\n    return $.create(self.serviceLocator.getUrl('admin-setDefaultAssignationUserToProcess'), {\n      serviceAction: 'setDefaultAssignationUserToProcess',\n      process: process,\n      idUser: params.idUser });\n\n  },\n\n  /**\r\n      * Get the icon of a given process\r\n      * @param params\r\n      */\n  getProcessIcon: function getProcessIcon(params) {\n    var self = this;\n    var data = {\n      processId: params.processId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"process-getIcon\"),\n      data: data,\n      batchRequest: true });\n\n  },\n  /**\r\n      * Get the icon of a given collection\r\n      * @param params\r\n      */\n  getCollectionIcon: function getCollectionIcon(params) {\n    var self = this;\n    var data = {\n      collectionId: params.collectionId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"collections-getIcon\"),\n      data: data,\n      batchRequest: true });\n\n  },\n\n  /*\r\n      *   Returns the combo's data to Type Profiles depending of the params\r\n      */\n  getProfilesTypes: function getProfilesTypes(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('admin-getProfilesTypes'));\n  },\n\n  /*\r\n      *  Return generate Search Profiles\r\n      */\n  searchProfiles: function searchProfiles(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-searchProfiles');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['name'] = params['profileName'];\n\n    data[\"orgId\"] = params[\"orgId\"] ? params[\"orgId\"] : null;\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *  Return Users By Profiles\r\n      */\n  getUsersByProfile: function getUsersByProfile(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-getUsersByProfile');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['id'] = params['idProfile'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *  Remove User Profiles\r\n      */\n  removeUserFromProfile: function removeUserFromProfile(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-removeUserFromProfile');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['id'] = params['idProfile'];\n    data['idUser'] = params['idUser'];\n\n    return $.destroy(url, data);\n  },\n\n  /*\r\n      *  Add Users Profiles\r\n      */\n  addUserToProfile: function addUserToProfile(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-addUserToProfile');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['id'] = params['idProfile'];\n    data['idUser'] = params['idUser'];\n\n    return $.update(url, data);\n  },\n  /*\r\n      *  Display Licenses\r\n      */\n  licenses: function licenses() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-Licenses');\n    return $.read(url);\n  },\n\n  /*\r\n      *   Return Dimensions List\r\n      */\n  getDimensions: function getDimensions() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-GetDimensions');\n    return $.read(url);\n  },\n\n  /*\r\n      *   Edit Dimensions\r\n      */\n  editDimension: function editDimension(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['id'] = params.id;\n    data['displayName'] = params.displayName;\n    data['name'] = params.name;\n    data['idWfClass'] = params.idWfClass;\n    data['entityPath'] = params.entityPath;\n    data['description'] = params.description;\n    var url = self.serviceLocator.getUrl('admin-EditDimension');\n    // Call ajax and returns promise\n    return $.create(url, data);\n    /*return $.ajax({\r\n                                 url: self.serviceLocator.getUrl('admin-EditDimension'),\r\n                                 data: params,\r\n                                 type: 'POST',\r\n                                 dataType: 'json'\r\n                                 });*/\n  },\n\n  /*\r\n      *   Create Dimensions\r\n      */\n  createAdministrableDimension: function createAdministrableDimension(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['displayName'] = params.displayName;\n    data['name'] = params.name;\n    data['idWfClass'] = params.idWfClass;\n    data['entityPath'] = params.entityPath;\n    data['Description'] = params.description;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-CreateAdministrableDimension'),\n      data: params,\n      type: 'PUT',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      * Delete manageable dimensions\r\n      */\n  deleteDimension: function deleteDimension(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-DeleteDimension');\n    // Define data\n    params = params || {};\n    var data = {};\n    data['id'] = params.id;\n    data['idDimension'] = params.id;\n    data['administrable'] = params.administrable;\n    // Call ajax and returns promise\n    return $.destroy(url, data);\n  },\n\n  /*\r\n      *   Dimensions Process Tree\r\n      */\n  entityPathChildNodesAction: function entityPathChildNodesAction(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['pathNodeType'] = params.nodeType;\n    data['idNode'] = params.idNode;\n    data['nodeDisplayPath'] = params.nodeDisplayPath;\n    data['nodePath'] = params.nodePath;\n    data['idWfClass'] = params.idWfClass;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-EntityPathChildNodesAction'),\n      data: params,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return list of available processes\r\n      */\n  getActiveWFClasses: function getActiveWFClasses(params) {\n    var self = this;\n    var data = params || {};\n\n    // Call ajax and returns promise\n\n    return $.ajax({\n      //eliminar esto con el servicio restfull\n      cache: true,\n      url: self.serviceLocator.getUrl('admin-GetActiveWFClasses'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Resturn the list of Stored Document Templates\r\n      */\n  storeDocumentTemplates: function storeDocumentTemplates() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-document-templates-storeDocumentTemplates');\n    return $.read(url);\n  },\n\n  /*\r\n      * Restore an selected document template using his Guid as parameter\r\n      * @param params {Object} Guid: the associated Guid from the desired document template\r\n      */\n  restoreDocumentTemplates: function restoreDocumentTemplates(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-document-templates-restoreDocumentTemplates');\n\n    url += '?Guid=' + params.Guid;\n\n    return $.read(url);\n  },\n\n  /*\r\n      * Retreieves the workflow from the actual processes\r\n      */\n  getWorkFlowClasses: function getWorkFlowClasses() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-workflowClasses');\n    return $.read(url);\n  },\n\n\n  /*\r\n      * Retreives the task from a desired workflow\r\n      * @param params {Object} idWorkFlow: the desired workflow id\r\n      */\n  getTaskByWorkFlow: function getTaskByWorkFlow(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-tasksByWorkflow');\n\n    var data = {};\n    data['idWorkflow'] = params.idWorkflow;\n\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Modifies the process durationworkflow\r\n      * @param params {Object} idWorkflow: the desired process id to modify\r\n      * @param params {Object} duration: the duracion, converted in minutes\r\n      */\n  modifyProcessDuration: function modifyProcessDuration(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-modifyProcessDuration');\n\n    var data = {};\n    data['idWorkflow'] = params.idWorkflow;\n    data['duration'] = params.duration;\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * Modifies the task duration form a desired workflow\r\n      * @param params {Object} idTask: the desired task id to modifie\r\n      * @param params {Object} duration: the duracion, converted in minutes\r\n      */\n  modifyTaskDuration: function modifyTaskDuration(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-modifyTaskDuration');\n\n    var data = {};\n    data['idTask'] = params.idTask;\n    data['duration'] = params.duration;\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * this retrive data for the report my team\r\n      */\n  getDataForMyTeam: function getDataForMyTeam() {\n\n    var self = this;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('bam-resourcemonitor-myteam'),\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      * Retrive data for reports\r\n      */\n  getReporstAnalysisQuery: function getReporstAnalysisQuery() {\n\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('reports-analysisquery'));\n  },\n\n  /*\r\n      * Update report data\r\n      */\n  updateReportData: function updateReportData(params) {\n\n    var self = this;\n\n    return $.update(self.serviceLocator.getUrl('reports-analysisquery-update'), params);\n  },\n\n  /*\r\n      * Delete report data\r\n      */\n  deleteReportData: function deleteReportData(params) {\n\n    var self = this;\n\n    return $.destroy(self.serviceLocator.getUrl('reports-analysisquery-delete') + '?' + params);\n  },\n  /*\r\n      *Entrega la lista de idiomas soportados\r\n      */\n  getStoreLanguageTemplates: function getStoreLanguageTemplates() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-language-languages');\n    var data = { justActives: false };\n    return $.read(url, data);\n  },\n\n  /*\r\n      *Download template language list\r\n      */\n  getLanguageTemplate: function getLanguageTemplate(params) {\n    var self = this;\n    var defer = $.Deferred();\n    var url = self.serviceLocator.getUrl('admin-language-resource') + '?cultureName=' + params.cultureName;\n    defer.resolve('OK');\n    window.location.href = url;\n    /*\r\n                                 var response=  $.ajax({\r\n                                 type: 'GET',\r\n                                 url: url\r\n                                 });\r\n                                 response.always(function(response, status, xhr) {\r\n                                 if(response.responseText.indexOf('error') >= 0){\r\n                                 defer.reject('Download error');\r\n                                 }else{\r\n                                 defer.resolve('OK');\r\n                                 window.location.href=url;\r\n                                 }\r\n                                 });*/\n    return defer.promise();\n  },\n  /*\r\n      * Process definition service for process viewer\r\n      */\n  processDefinition: function processDefinition(params) {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl('processviewer-processdefinition'), params);\n  },\n\n  /*\r\n      * Graphic info for process viewer\r\n      */\n  graphicInfo: function graphicInfo(params) {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl('processviewer-processgraphicinfo'), params);\n  },\n\n  /**\r\n      * This service get the last version of BizagiBPM\r\n      *\r\n      * @return {json}\r\n      */\n  getLastUpdateByMobile: function getLastUpdateByMobile() {\n    var self = this;\n    return $.read({\n      url: self.serviceLocator.getUrl(\"mobile-getLastUpdate\") });\n\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getCollectionData: function getCollectionData(params) {\n    var self = this,\n    data = {},\n    url = self.serviceLocator.getUrl('templates-handler-getCollectionData');\n\n    data.idFact = params.idFact;\n    data.pag = params.page || 1;\n    data.pagSize = params.pageSize || 10;\n    data.filters = params.filters ? !Array.isArray(params.filters) ? JSON.stringify(params.filters) : undefined : undefined;\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getVirtualCollectionData: function getVirtualCollectionData(params) {\n    var self = this,\n    data = {},\n    url = self.serviceLocator.getUrl('templates-handler-getVirtualCollectionData');\n\n    data.guidVirtualCollection = params.guidVirtualCollection;\n    data.pag = params.page || 1;\n    data.pagSize = params.pageSize || 10;\n    data.filters = params.filters ? !Array.isArray(params.filters) ? JSON.stringify(params.filters) : undefined : undefined;\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getSearchData: function getSearchData(params) {\n    var self = this;\n    // Call ajax and returns promise\n    var urlSend = self.serviceLocator.getUrl(\"my-search-getData\");\n    urlSend = urlSend.replace(\"{guidSearch}\", params.guidSearch);\n    var filters = params.filters || [];\n\n    var data = {\n      filters: JSON.stringify(filters),\n      pag: params.page || 1,\n      calculateFilters: params.calculateFilters || false,\n      pagSize: params.pageSize || 10 };\n\n    return $.read(urlSend, data).then(function (data) {\n      return self.serializeEntityData(data);\n    });\n  },\n\n  /**\r\n      * Return an array with the collections or entity related to stakeholder entities\r\n      * @param params\r\n      */\n  getCollectionEntityData: function getCollectionEntityData(params) {\n    var self = this,url;\n    params = params || {};\n    var data = {\n      templateType: params.referenceType === \"VIRTUAL\" || params.referenceType === \"FACT\" ? \"List\" : \"Content\",\n      surrogateKey: params.surrogateKey,\n      pag: params.page || 1,\n      pagSize: params.pageSize || 10,\n      defaultFilterApplied: params.defaultFilterApplied,\n      filters: JSON.stringify(params.filters) };\n\n\n    // VIRTUAL\n    if (params.referenceType === \"VIRTUAL\") {\n      url = self.serviceLocator.getUrl('data-navigation-handler-collection');\n      data.reference = params.reference;\n    }\n    // ENTITY AND FACTS\n    else {\n        url = self.serviceLocator.getUrl('data-navigation-handler-entity');\n        data.reference = params.guidEntityCurrent;\n        data.xpath = params.xpath;\n        data.collectionId = params.reference;\n      }\n\n    // Call ajax and returns promise\n    return $.read(url, data).then(function (response) {\n      return self.serializeEntityData(response);\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      */\n  getFiltersEntityData: function getFiltersEntityData(params) {\n    var self = this;\n    params = params || {};\n    var data = {\n      reference: params.guidEntityCurrent,\n      collectionId: params.reference,\n      surrogateKey: params.surrogateKey,\n      xpath: params.xpath,\n      templateType: \"List\",\n      defaultFilterApplied: params.defaultFilterApplied,\n      filters: JSON.stringify(params.filters) };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"data-navigation-handler-entity-filters\"),\n      data: data });\n\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getProcessAddAction: function getProcessAddAction(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"action-handler-getProcessAddAction\");\n\n    // Call ajax and returns promise\n    return $.read(url, params).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getMultipleActions: function getMultipleActions(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"templates-handler-getMultipleActions\");\n\n    // Call ajax and returns promise\n    return $.read(url, params).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getMapping: function getMapping(params) {\n    var self = this;\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"process-handler-getMapping\"),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /**\r\n      *\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  getForm: function getForm(data) {\n    var self = this;\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"process-handler-getForm\"),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /**\r\n      * Chek if an entity has startform\r\n      * @param params\r\n      * @return {*}\r\n      */\n  hasStartForm: function hasStartForm(params) {\n    var self = this;\n    var data = {};\n\n    if (params.guid) {\n      data.guidWFClass = params.guid;\n    }\n\n    return $.read(self.serviceLocator.getUrl(\"process-handler-startform\"), data);\n  },\n\n  /**\r\n      * Executes the action\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  executeAction: function executeAction(params) {\n    var self = this;\n    var data = {\n      surrogateKey: JSON.stringify(params.surrogatedKey),\n      entityId: params.entityId,\n      ruleId: params.processId };\n\n\n    // Call ajax and returns promise\n    return $.create({\n      url: self.serviceLocator.getUrl(\"process-action-execute\"),\n      data: data });\n\n  },\n\n  /**\r\n      * executes a rule\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  actionRule: function actionRule(params) {\n    var self = this;\n    var data = {\n      surrogateKey: params.surrogateKey,\n      entityId: params.entityId,\n      ruleId: params.processId };\n\n\n    return $.create({\n      url: self.serviceLocator.getUrl(\"process-handler-rule\"),\n      data: data,\n      batchRequest: false });\n\n  },\n\n  /**\r\n      * Get following cases\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getActivitiesData: function getActivitiesData(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"process-handler-getActivitiesData\");\n    params = params || {};\n    var data = {\n      page: params.page || 1,\n      pagsize: params.pageSize || 10 };\n\n\n    if (typeof params.idworkflow !== \"undefined\" && params.idworkflow ||\n    typeof params.idWorkflow !== \"undefined\" && params.idWorkflow) {\n      data.idWorkflow = params.idworkflow || params.idWorkflow;\n    }\n    if (typeof params.idCase !== \"undefined\" && params.idCase) {\n      data.idCase = params.idCase;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).then(function (response) {\n      return self.serializeEntityData(response);\n    });\n  },\n\n  /**\r\n      * Return an array with the collections related to stakeholder entities\r\n      */\n  getPendingsData: function getPendingsData(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"process-handler-getPendingsData\");\n    params = params || {};\n    var data = {\n      page: params.page || 1,\n      pagsize: params.pageSize || 10 };\n\n\n    if (typeof params.idworkflow !== \"undefined\" && params.idworkflow ||\n    typeof params.idWorkflow !== \"undefined\" && params.idWorkflow) {\n      data.idWorkflow = params.idworkflow || params.idWorkflow;\n    }\n    if (typeof params.idCase !== \"undefined\" && params.idCase) {\n      data.idCase = params.idCase;\n    }\n    if (typeof params.taskState !== \"undefined\" && params.taskState) {\n      data.taskState = params.taskState;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).then(function (response) {\n      return self.serializeEntityData(response);\n    });\n  },\n\n  /**\r\n      * Get actions\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getActionsData: function getActionsData(params) {\n    var self = this;\n    params = params || {};\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl('entities-handler-getActions'),\n      data: params,\n      batchRequest: true }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      * Get Users, assignees and events from cases\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getUsersAndEvents: function getUsersAndEvents(params) {\n    var self = this;\n    var data = {};\n\n    if (params.idCases && params.idCases.length > 0) {\n      data.idCases = params.idCases.toString();\n    }\n\n    return $.read(self.serviceLocator.getUrl(\"entities-handler-getUsersAndEvents\"), data);\n  },\n\n  /**\r\n      * Get Users, assignees and events from cases\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getUsers: function getUsers(params) {\n    var self = this;\n    var data = {\n      caseId: params.caseId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"entities-handler-getUsers\"),\n      data: params,\n      batchRequest: true });\n\n  },\n\n  /**\r\n      * Get Users, assignees and events from cases\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getEvents: function getEvents(params) {\n    var self = this;\n    var data = {\n      caseId: params.caseId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"entities-handler-getEvents\"),\n      data: params,\n      batchRequest: true });\n\n  },\n\n  /**\r\n      * Get Users images\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getUsersImages: function getUsersImages(params, userIds) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"entities-handler-getUsersImages\");\n\n    if (userIds && userIds.length > 0) {\n      data.userIds = userIds.toString();\n    }\n\n    data.width = params.width;\n    data.height = params.height;\n    data.square = params.square;\n\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n      return $.ajax({\n        url: url,\n        data: data,\n        type: \"POST\",\n        dataType: \"json\" });\n\n    } else {\n      return $.read({\n        url: url,\n        data: data,\n        dataType: \"json\" });\n\n    }\n  },\n\n  getPreferencesCurrentUser: function getPreferencesCurrentUser() {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"currentUser\");\n    return $.ajax({\n      url: url,\n      type: \"GET\" });\n\n  },\n\n  getPreferencesWorkportalCurrentUser: function getPreferencesWorkportalCurrentUser() {\n    var self = this;\n    var resp = $.read(self.serviceLocator.getUrl(\"PreferencesWorkportalCurrentUser\"));\n    return resp;\n  },\n\n  /**\r\n      * Get stakeholder shortCurts\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getShortCuts: function getShortCuts(params) {\n    var self = this,\n    data = {},\n    url = self.serviceLocator.getUrl(\"entities-handler-getShotCuts\");\n\n    if (typeof params.icon !== \"undefined\" && params.icon) {\n      data.icon = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data);\n  },\n\n  /**\r\n      *   Returns the available list of searches\r\n      */\n  getSearchLists: function getSearchLists() {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl(\"my-search-getSearchLists\"), {});\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      */\n  getIdCasesOfProcessEntities: function getIdCasesOfProcessEntities(params) {\n    params = params || {};\n    var self = this;\n    var ids = {\n      ids: JSON.stringify(params) };\n\n\n    // TODO: Validate compatibility\n    if (bizagi.version.server.lessThanOrEqualsTo(\"11.0.0.2608\")) {\n      // Call ajax and returns promise\n      return $.read({\n        url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\n        data: ids });\n\n\n    } else {\n      return $.ajax({\n        url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\n        data: ids,\n        type: \"POST\" });\n\n    }\n  },\n\n  /**\r\n      * Retuns query form to searches\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getQueryForm: function getQueryForm(params) {\n    var self = this;\n    params = params || {};\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"query-handler-getQueryForm\"),\n      data: params,\n      type: \"POST\",\n      dataType: params.dataType || \"json\" });\n\n  },\n\n  /**\r\n      * Returns an object with the filter to send to the server\r\n      * @param params\r\n      * @param filterObject\r\n      * @param callback is called when a filter is added to the array\r\n      */\n  defineFilterObject: function defineFilterObject(params, filterObject, callback) {\n    var properties = params.properties;\n    var xpath = properties.xpath.split('@')[0];\n\n    var filter = filterObject.find(function (el) {\n      return el.xpath == xpath;\n    });\n\n    //if the control exists is because it is a range\n    if (filter) {\n      if (properties.rangeQuery == \"from\") {\n        filter.value = filter.value || {};\n        filter.searchType = 'range';\n        filter.value.min = params.value;\n      } else\n      if (properties.rangeQuery == \"to\") {\n        filter.value = filter.value || {};\n        filter.searchType = 'range';\n        filter.value.max = params.value;\n      } else\n      {\n        params.properties.typeSearch = filter.searchType;\n        var values = setValues(params);\n        $.extend(filter, values);\n      }\n\n      if (properties.orderType) {\n        filter.orderType = properties.orderType;\n      }\n      if (callback) {\n        callback(bizagi.clone(filter));\n      }\n    } else\n    {\n      var isDefaultFilter = properties.defaultFilter || false;\n      filter = setValues(params);\n\n      if (properties.orderType) {\n        filter.orderType = properties.orderType;\n      }\n\n      if (typeof filter.value != 'undefined' || filter.orderType || isDefaultFilter) {\n        filterObject.push(filter);\n        if (callback) {\n          callback(bizagi.clone(filter));\n        }\n      }\n    }\n\n\n    function setValues(params) {\n      var properties = params.properties;\n      var searchType = properties.typeSearch;\n      var value = params.value;\n\n      //Identifing the type control in order to define search type\n      if (properties.type == \"boolean\") {\n        if (value.toLowerCase() === \"null\") {\n          value = null;\n          searchType = \"Nullable\";\n        } else\n        {\n          value = bizagi.util.parseBoolean(value);\n          searchType = \"exact\";\n        }\n      }\n\n      if (properties.type == \"number\" || properties.type == \"money\" || properties.type == \"date\") {\n        searchType = \"exact\";\n      }\n\n      if (_typeof(params.value) == 'object') {\n        value = [];\n        if (Array.isArray(params.value)) {\n          for (var i = 0, len = params.value.length; i < len; i++) {\n            var val = parseInt(params.value[i].id);\n            if (!isNaN(val)) {\n              value.push(val);\n            }\n          }\n        } else\n        {\n          var val = parseInt(params.value.id);\n          if (!isNaN(val)) {\n            value.push(val);\n          }\n        }\n        searchType = \"exact\";\n        value = value.length > 0 ? value : undefined;\n      }\n\n      if (properties.rangeQuery && properties.rangeQuery !== \"none\") {\n        value = {\n          min: params.value,\n          max: params.value };\n\n        searchType = \"range\";\n      }\n\n      searchType = searchType || \"approx\";\n\n      var filter = {\n        xpath: xpath,\n        searchType: searchType };\n\n\n      if (typeof value !== 'undefined') {\n        filter.value = value;\n      }\n\n      return filter;\n    }\n  },\n\n  /*PLAN*/\n  getPlan: function getPlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-get\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getActivities: function getActivities(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-activities\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  updatePlan: function updatePlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-update\");\n    return $.update({\n      url: url.replace(\"{idPlan}\", params.id),\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  putExecutePlan: function putExecutePlan(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-execute\");\n\n    return $.create({\n      url: url,\n      data: params,\n      contentType: \"application/x-www-form-urlencoded\" });\n\n  },\n\n  deletePlan: function deletePlan(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-delete\");\n\n    return $.destroy({\n      url: url.replace(\"{idPlan}\", params.id),\n      data: params,\n      contentType: \"application/x-www-form-urlencoded\" });\n\n  },\n\n  closePlan: function closePlan(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-close\");\n\n    return $.create({\n      url: url,\n      data: params,\n      contentType: \"application/x-www-form-urlencoded\" });\n\n  },\n\n  getWorkitemsPlan: function getWorkitemsPlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-workitems\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getTransitionsByPlan: function getTransitionsByPlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-transitions-get\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  editActivityPlan: function editActivityPlan(params) {\n    var self = this;\n    var data = {};\n\n    if (params.activity) {\n      data = params.activity;\n      data.items = params.items;\n    } else {\n      data = params;\n    }\n\n    var url = self.serviceLocator.getUrl(\"project-plan-activity-edit\").replace(\"{idPlan}\", data.idPlan).replace(\"{id}\", data.id);\n\n    return $.update({\n      url: url,\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getPlanByParent: function getPlanByParent(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-get-by-parent\");\n    var def = $.Deferred();\n\n    $.when($.read({\n      url: url,\n      data: data,\n      dataType: \"json\",\n      contentType: \"application/json\" })).\n    done(function (response) {\n      def.resolve(response);\n    });\n\n    return def.promise();\n\n  },\n\n  getItemsByActivity: function getItemsByActivity(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-activity-tasks-get\");\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getPlanParent: function getPlanParent(data) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"project-plan-parent\");\n    return $.read({\n      url: url,\n      data: data,\n      dataType: \"json\" });\n\n  },\n  /**\r\n      * Serializador de servicio de entitiData\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  serializeEntityData: function serializeEntityData(data) {\n    var serializedData = data;\n    serializedData.entities = [];\n\n    /**\r\n                                   * build the return object.\r\n                                   * @param header\r\n                                   * @param row\r\n                                   * @returns {{data: {}, guid: *, surrogateKey: *, timestamp: *}}\r\n                                   * @private\r\n                                   */\n    function _buildNewObject(header, row) {\n      var newObject = {\n        data: {},\n        guid: row.guidEntity,\n        timestamp: header.timestamp },\n\n      columns = header.columns,\n      rowData = row.row;\n\n      for (name in row) {\n        if (row.hasOwnProperty(name) && name.toString() !== \"row\" && name.toString() !== \"id\") {\n          newObject[name] = row[name];\n        }\n      }\n\n      for (var i = 0, len = columns.length; i < len; i += 1) {\n        newObject.data[columns[i]] = rowData[i];\n      }\n\n      return newObject;\n    };\n\n    var k = -1,kRow;\n    while (kRow = data.rows[++k]) {\n      var i = -1,iCell;\n      while (iCell = data.cells[++i]) {\n        if (iCell.id === kRow.id) {\n          var kReturnObject = _buildNewObject(iCell, kRow);\n          serializedData.entities.push(kReturnObject);\n          break;\n        }\n      }\n    }\n\n    return serializedData;\n  },\n\n  getCardViewCustomizedColumns: function getCardViewCustomizedColumns(params) {\n    var self = this;\n    params = params || {};\n    params.sortData = bizagi.util.getLastProcessInboxSort();\n    return this.getMobileActivities(params);\n  },\n  /**\r\n      * Method that calls the activities endpoint and handles sorting and filtering\r\n      */\n  getMobileActivities: function getMobileActivities(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"case-handler-getActivityList\");\n\n    var data = params || {};\n    // information for sort\n    var sortData = params.sortData;\n    if (sortData) {\n      if (bizagi.util.isMobileInboxByProcessSupported() && sortData.sortOrder && sortData.sortDirection && sortData.sortFieldName) {\n        data.orderFieldName = sortData.sortFieldName;\n        data.orderType = sortData.sortDirection == 'asc' ? 0 : 1;\n        data.order = sortData.sortOrder;\n      } else\n      {\n        delete data.sortData;\n      }\n    }\n    if (typeof params.radNumber !== \"undefined\") {\n      data.radNumber = params.radNumber;\n    }\n    if (params.idWfClass != -1) {\n      data.idWfClass = params.idWfClass;\n    }\n    data.mobileDevice = bizagi.util.isMobileDevice();\n    data.page = data.page || 1;\n    data.pageSize = data.pageSize || 10;\n    if (data.idWfClass != undefined && data.idWfClass < 0) {\n      delete data.idWfClass;\n    }\n\n    if (params.smartInboxId) {\n      data.smartInboxGuid = params.smartInboxId;\n    }\n\n    if (params.liveFilterData) {\n      data.smartInboxFilter = self.encodeLiveFilter(params.liveFilterData);\n      delete params.liveFilterData;\n    }\n\n    var ajaxParams = {\n      url: url,\n      data: data,\n      type: \"GET\",\n      dataType: \"json\" };\n\n    if (params.avoidLoader) {\n      ajaxParams.avoidLoader = true;\n      delete data.avoidLoader;\n    }\n\n\n    var serverResponse;\n    return $.ajax(ajaxParams).then(function (response) {\n      bizagi.util.setLastProcessInboxProcessColumns(response.headers);\n      serverResponse = response;\n      return params.includeSyncErrors && params.inputtray == \"inbox\" ? self.getInboxSyncErrors() : undefined;\n    }).\n    then(function (localSyncErrors) {\n      if (localSyncErrors != undefined) {\n        serverResponse.syncErrors = localSyncErrors;\n      }\n      return serverResponse;\n    });\n\n  },\n\n  /**\r\n      * Encode json filter to base64\r\n      * @param {json} filter \r\n      */\n  encodeLiveFilter: function encodeLiveFilter(filter) {\n    var serializeFilter = \"\";\n\n    var CryptoJS = CryptoJS || function (t, e) {var r = {},i = r.lib = {},n = function n() {},o = i.Base = { extend: function extend(t) {n.prototype = this;var e = new n();return t && e.mixIn(t), e.hasOwnProperty(\"init\") || (e.init = function () {e.$super.init.apply(this, arguments);}), e.init.prototype = e, e.$super = this, e;}, create: function create() {var t = this.extend();return t.init.apply(t, arguments), t;}, init: function init() {}, mixIn: function mixIn(t) {for (var e in t) {t.hasOwnProperty(e) && (this[e] = t[e]);}t.hasOwnProperty(\"toString\") && (this.toString = t.toString);}, clone: function clone() {return this.init.prototype.extend(this);} },s = i.WordArray = o.extend({ init: function init(t, e) {t = this.words = t || [], this.sigBytes = null != e ? e : 4 * t.length;}, toString: function toString(t) {return (t || a).stringify(this);}, concat: function concat(t) {var e = this.words,r = t.words,i = this.sigBytes;if (t = t.sigBytes, this.clamp(), i % 4) for (var n = 0; n < t; n++) {e[i + n >>> 2] |= (r[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 24 - (i + n) % 4 * 8;} else if (65535 < r.length) for (n = 0; n < t; n += 4) {e[i + n >>> 2] = r[n >>> 2];} else e.push.apply(e, r);return this.sigBytes += t, this;}, clamp: function clamp() {var e = this.words,r = this.sigBytes;e[r >>> 2] &= 4294967295 << 32 - r % 4 * 8, e.length = t.ceil(r / 4);}, clone: function clone() {var t = o.clone.call(this);return t.words = this.words.slice(0), t;}, random: function random(e) {for (var r = [], i = 0; i < e; i += 4) {r.push(4294967296 * t.random() | 0);}return new s.init(r, e);} }),c = r.enc = {},a = c.Hex = { stringify: function stringify(t) {var e = t.words;t = t.sigBytes;for (var r = [], i = 0; i < t; i++) {var n = e[i >>> 2] >>> 24 - i % 4 * 8 & 255;r.push((n >>> 4).toString(16)), r.push((15 & n).toString(16));}return r.join(\"\");}, parse: function parse(t) {for (var e = t.length, r = [], i = 0; i < e; i += 2) {r[i >>> 3] |= parseInt(t.substr(i, 2), 16) << 24 - i % 8 * 4;}return new s.init(r, e / 2);} },f = c.Latin1 = { stringify: function stringify(t) {var e = t.words;t = t.sigBytes;for (var r = [], i = 0; i < t; i++) {r.push(String.fromCharCode(e[i >>> 2] >>> 24 - i % 4 * 8 & 255));}return r.join(\"\");}, parse: function parse(t) {for (var e = t.length, r = [], i = 0; i < e; i++) {r[i >>> 2] |= (255 & t.charCodeAt(i)) << 24 - i % 4 * 8;}return new s.init(r, e);} },h = c.Utf8 = { stringify: function stringify(t) {try {return decodeURIComponent(escape(f.stringify(t)));} catch (t) {throw Error(\"Malformed UTF-8 data\");}}, parse: function parse(t) {return f.parse(unescape(encodeURIComponent(t)));} },u = i.BufferedBlockAlgorithm = o.extend({ reset: function reset() {this._data = new s.init(), this._nDataBytes = 0;}, _append: function _append(t) {\"string\" == typeof t && (t = h.parse(t)), this._data.concat(t), this._nDataBytes += t.sigBytes;}, _process: function _process(e) {var r = this._data,i = r.words,n = r.sigBytes,o = this.blockSize,c = n / (4 * o);if (e = (c = e ? t.ceil(c) : t.max((0 | c) - this._minBufferSize, 0)) * o, n = t.min(4 * e, n), e) {for (var a = 0; a < e; a += o) {this._doProcessBlock(i, a);}a = i.splice(0, e), r.sigBytes -= n;}return new s.init(a, n);}, clone: function clone() {var t = o.clone.call(this);return t._data = this._data.clone(), t;}, _minBufferSize: 0 });i.Hasher = u.extend({ cfg: o.extend(), init: function init(t) {this.cfg = this.cfg.extend(t), this.reset();}, reset: function reset() {u.reset.call(this), this._doReset();}, update: function update(t) {return this._append(t), this._process(), this;}, finalize: function finalize(t) {return t && this._append(t), this._doFinalize();}, blockSize: 16, _createHelper: function _createHelper(t) {return function (e, r) {return new t.init(r).finalize(e);};}, _createHmacHelper: function _createHmacHelper(t) {return function (e, r) {return new p.HMAC.init(t, r).finalize(e);};} });var p = r.algo = {};return r;}(Math);!function () {var t = CryptoJS,e = t.lib.WordArray;t.enc.Base64 = { stringify: function stringify(t) {var e = t.words,r = t.sigBytes,i = this._map;t.clamp(), t = [];for (var n = 0; n < r; n += 3) {for (var o = (e[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 16 | (e[n + 1 >>> 2] >>> 24 - (n + 1) % 4 * 8 & 255) << 8 | e[n + 2 >>> 2] >>> 24 - (n + 2) % 4 * 8 & 255, s = 0; 4 > s && n + .75 * s < r; s++) {t.push(i.charAt(o >>> 6 * (3 - s) & 63));}}if (e = i.charAt(64)) for (; t.length % 4;) {t.push(e);}return t.join(\"\");}, parse: function parse(t) {var r = t.length,i = this._map;(n = i.charAt(64)) && -1 != (n = t.indexOf(n)) && (r = n);for (var n = [], o = 0, s = 0; s < r; s++) {if (s % 4) {var c = i.indexOf(t.charAt(s - 1)) << s % 4 * 2,a = i.indexOf(t.charAt(s)) >>> 6 - s % 4 * 2;n[o >>> 2] |= (c | a) << 24 - o % 4 * 8, o++;}}return e.create(n, o);}, _map: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\" };}(), function (t) {function e(t, e, r, i, n, o, s) {return ((t = t + (e & r | ~e & i) + n + s) << o | t >>> 32 - o) + e;}function r(t, e, r, i, n, o, s) {return ((t = t + (e & i | r & ~i) + n + s) << o | t >>> 32 - o) + e;}function i(t, e, r, i, n, o, s) {return ((t = t + (e ^ r ^ i) + n + s) << o | t >>> 32 - o) + e;}function n(t, e, r, i, n, o, s) {return ((t = t + (r ^ (e | ~i)) + n + s) << o | t >>> 32 - o) + e;}for (var o = CryptoJS, s = (a = o.lib).WordArray, c = a.Hasher, a = o.algo, f = [], h = 0; 64 > h; h++) {f[h] = 4294967296 * t.abs(t.sin(h + 1)) | 0;}a = a.MD5 = c.extend({ _doReset: function _doReset() {this._hash = new s.init([1732584193, 4023233417, 2562383102, 271733878]);}, _doProcessBlock: function _doProcessBlock(t, o) {for (var s = 0; 16 > s; s++) {var c = t[a = o + s];t[a] = 16711935 & (c << 8 | c >>> 24) | 4278255360 & (c << 24 | c >>> 8);}s = this._hash.words;var a = t[o + 0],h = (c = t[o + 1], t[o + 2]),u = t[o + 3],p = t[o + 4],d = t[o + 5],l = t[o + 6],y = t[o + 7],_ = t[o + 8],v = t[o + 9],g = t[o + 10],B = t[o + 11],x = t[o + 12],S = t[o + 13],k = t[o + 14],m = t[o + 15],z = e(z = s[0], D = s[1], w = s[2], C = s[3], a, 7, f[0]),C = e(C, z, D, w, c, 12, f[1]),w = e(w, C, z, D, h, 17, f[2]),D = e(D, w, C, z, u, 22, f[3]);z = e(z, D, w, C, p, 7, f[4]), C = e(C, z, D, w, d, 12, f[5]), w = e(w, C, z, D, l, 17, f[6]), D = e(D, w, C, z, y, 22, f[7]), z = e(z, D, w, C, _, 7, f[8]), C = e(C, z, D, w, v, 12, f[9]), w = e(w, C, z, D, g, 17, f[10]), D = e(D, w, C, z, B, 22, f[11]), z = e(z, D, w, C, x, 7, f[12]), C = e(C, z, D, w, S, 12, f[13]), w = e(w, C, z, D, k, 17, f[14]), z = r(z, D = e(D, w, C, z, m, 22, f[15]), w, C, c, 5, f[16]), C = r(C, z, D, w, l, 9, f[17]), w = r(w, C, z, D, B, 14, f[18]), D = r(D, w, C, z, a, 20, f[19]), z = r(z, D, w, C, d, 5, f[20]), C = r(C, z, D, w, g, 9, f[21]), w = r(w, C, z, D, m, 14, f[22]), D = r(D, w, C, z, p, 20, f[23]), z = r(z, D, w, C, v, 5, f[24]), C = r(C, z, D, w, k, 9, f[25]), w = r(w, C, z, D, u, 14, f[26]), D = r(D, w, C, z, _, 20, f[27]), z = r(z, D, w, C, S, 5, f[28]), C = r(C, z, D, w, h, 9, f[29]), w = r(w, C, z, D, y, 14, f[30]), z = i(z, D = r(D, w, C, z, x, 20, f[31]), w, C, d, 4, f[32]), C = i(C, z, D, w, _, 11, f[33]), w = i(w, C, z, D, B, 16, f[34]), D = i(D, w, C, z, k, 23, f[35]), z = i(z, D, w, C, c, 4, f[36]), C = i(C, z, D, w, p, 11, f[37]), w = i(w, C, z, D, y, 16, f[38]), D = i(D, w, C, z, g, 23, f[39]), z = i(z, D, w, C, S, 4, f[40]), C = i(C, z, D, w, a, 11, f[41]), w = i(w, C, z, D, u, 16, f[42]), D = i(D, w, C, z, l, 23, f[43]), z = i(z, D, w, C, v, 4, f[44]), C = i(C, z, D, w, x, 11, f[45]), w = i(w, C, z, D, m, 16, f[46]), z = n(z, D = i(D, w, C, z, h, 23, f[47]), w, C, a, 6, f[48]), C = n(C, z, D, w, y, 10, f[49]), w = n(w, C, z, D, k, 15, f[50]), D = n(D, w, C, z, d, 21, f[51]), z = n(z, D, w, C, x, 6, f[52]), C = n(C, z, D, w, u, 10, f[53]), w = n(w, C, z, D, g, 15, f[54]), D = n(D, w, C, z, c, 21, f[55]), z = n(z, D, w, C, _, 6, f[56]), C = n(C, z, D, w, m, 10, f[57]), w = n(w, C, z, D, l, 15, f[58]), D = n(D, w, C, z, S, 21, f[59]), z = n(z, D, w, C, p, 6, f[60]), C = n(C, z, D, w, B, 10, f[61]), w = n(w, C, z, D, h, 15, f[62]), D = n(D, w, C, z, v, 21, f[63]);s[0] = s[0] + z | 0, s[1] = s[1] + D | 0, s[2] = s[2] + w | 0, s[3] = s[3] + C | 0;}, _doFinalize: function _doFinalize() {var e = this._data,r = e.words,i = 8 * this._nDataBytes,n = 8 * e.sigBytes;r[n >>> 5] |= 128 << 24 - n % 32;var o = t.floor(i / 4294967296);for (r[15 + (n + 64 >>> 9 << 4)] = 16711935 & (o << 8 | o >>> 24) | 4278255360 & (o << 24 | o >>> 8), r[14 + (n + 64 >>> 9 << 4)] = 16711935 & (i << 8 | i >>> 24) | 4278255360 & (i << 24 | i >>> 8), e.sigBytes = 4 * (r.length + 1), this._process(), r = (e = this._hash).words, i = 0; 4 > i; i++) {n = r[i], r[i] = 16711935 & (n << 8 | n >>> 24) | 4278255360 & (n << 24 | n >>> 8);}return e;}, clone: function clone() {var t = c.clone.call(this);return t._hash = this._hash.clone(), t;} }), o.MD5 = c._createHelper(a), o.HmacMD5 = c._createHmacHelper(a);}(Math), function () {var t,e = CryptoJS,r = (t = e.lib).Base,i = t.WordArray,n = (t = e.algo).EvpKDF = r.extend({ cfg: r.extend({ keySize: 4, hasher: t.MD5, iterations: 1 }), init: function init(t) {this.cfg = this.cfg.extend(t);}, compute: function compute(t, e) {for (var r = (c = this.cfg).hasher.create(), n = i.create(), o = n.words, s = c.keySize, c = c.iterations; o.length < s;) {a && r.update(a);var a = r.update(t).finalize(e);r.reset();for (var f = 1; f < c; f++) {a = r.finalize(a), r.reset();}n.concat(a);}return n.sigBytes = 4 * s, n;} });e.EvpKDF = function (t, e, r) {return n.create(r).compute(t, e);};}(), CryptoJS.lib.Cipher || function (t) {var e = (d = CryptoJS).lib,r = e.Base,i = e.WordArray,n = e.BufferedBlockAlgorithm,o = d.enc.Base64,s = d.algo.EvpKDF,c = e.Cipher = n.extend({ cfg: r.extend(), createEncryptor: function createEncryptor(t, e) {return this.create(this._ENC_XFORM_MODE, t, e);}, createDecryptor: function createDecryptor(t, e) {return this.create(this._DEC_XFORM_MODE, t, e);}, init: function init(t, e, r) {this.cfg = this.cfg.extend(r), this._xformMode = t, this._key = e, this.reset();}, reset: function reset() {n.reset.call(this), this._doReset();}, process: function process(t) {return this._append(t), this._process();}, finalize: function finalize(t) {return t && this._append(t), this._doFinalize();}, keySize: 4, ivSize: 4, _ENC_XFORM_MODE: 1, _DEC_XFORM_MODE: 2, _createHelper: function _createHelper(t) {return { encrypt: function encrypt(e, r, i) {return (\"string\" == typeof r ? l : p).encrypt(t, e, r, i);}, decrypt: function decrypt(e, r, i) {return (\"string\" == typeof r ? l : p).decrypt(t, e, r, i);} };} });e.StreamCipher = c.extend({ _doFinalize: function _doFinalize() {return this._process(!0);}, blockSize: 1 });var a = d.mode = {},f = function f(t, e, r) {var i = this._iv;i ? this._iv = void 0 : i = this._prevBlock;for (var n = 0; n < r; n++) {t[e + n] ^= i[n];}},h = (e.BlockCipherMode = r.extend({ createEncryptor: function createEncryptor(t, e) {return this.Encryptor.create(t, e);}, createDecryptor: function createDecryptor(t, e) {return this.Decryptor.create(t, e);}, init: function init(t, e) {this._cipher = t, this._iv = e;} })).extend();h.Encryptor = h.extend({ processBlock: function processBlock(t, e) {var r = this._cipher,i = r.blockSize;f.call(this, t, e, i), r.encryptBlock(t, e), this._prevBlock = t.slice(e, e + i);} }), h.Decryptor = h.extend({ processBlock: function processBlock(t, e) {var r = this._cipher,i = r.blockSize,n = t.slice(e, e + i);r.decryptBlock(t, e), f.call(this, t, e, i), this._prevBlock = n;} }), a = a.CBC = h, h = (d.pad = {}).Pkcs7 = { pad: function pad(t, e) {for (var r, n = (r = (r = 4 * e) - t.sigBytes % r) << 24 | r << 16 | r << 8 | r, o = [], s = 0; s < r; s += 4) {o.push(n);}r = i.create(o, r), t.concat(r);}, unpad: function unpad(t) {t.sigBytes -= 255 & t.words[t.sigBytes - 1 >>> 2];} }, e.BlockCipher = c.extend({ cfg: c.cfg.extend({ mode: a, padding: h }), reset: function reset() {c.reset.call(this);var t = (e = this.cfg).iv,e = e.mode;if (this._xformMode == this._ENC_XFORM_MODE) var r = e.createEncryptor;else r = e.createDecryptor, this._minBufferSize = 1;this._mode = r.call(e, this, t && t.words);}, _doProcessBlock: function _doProcessBlock(t, e) {this._mode.processBlock(t, e);}, _doFinalize: function _doFinalize() {var t = this.cfg.padding;if (this._xformMode == this._ENC_XFORM_MODE) {t.pad(this._data, this.blockSize);var e = this._process(!0);} else e = this._process(!0), t.unpad(e);return e;}, blockSize: 4 });var u = e.CipherParams = r.extend({ init: function init(t) {this.mixIn(t);}, toString: function toString(t) {return (t || this.formatter).stringify(this);} }),p = (a = (d.format = {}).OpenSSL = { stringify: function stringify(t) {var e = t.ciphertext;return ((t = t.salt) ? i.create([1398893684, 1701076831]).concat(t).concat(e) : e).toString(o);}, parse: function parse(t) {var e = (t = o.parse(t)).words;if (1398893684 == e[0] && 1701076831 == e[1]) {var r = i.create(e.slice(2, 4));e.splice(0, 4), t.sigBytes -= 16;}return u.create({ ciphertext: t, salt: r });} }, e.SerializableCipher = r.extend({ cfg: r.extend({ format: a }), encrypt: function encrypt(t, e, r, i) {i = this.cfg.extend(i);var n = t.createEncryptor(r, i);return e = n.finalize(e), n = n.cfg, u.create({ ciphertext: e, key: r, iv: n.iv, algorithm: t, mode: n.mode, padding: n.padding, blockSize: t.blockSize, formatter: i.format });}, decrypt: function decrypt(t, e, r, i) {return i = this.cfg.extend(i), e = this._parse(e, i.format), t.createDecryptor(r, i).finalize(e.ciphertext);}, _parse: function _parse(t, e) {return \"string\" == typeof t ? e.parse(t, this) : t;} })),d = (d.kdf = {}).OpenSSL = { execute: function execute(t, e, r, n) {return n || (n = i.random(8)), t = s.create({ keySize: e + r }).compute(t, n), r = i.create(t.words.slice(e), 4 * r), t.sigBytes = 4 * e, u.create({ key: t, iv: r, salt: n });} },l = e.PasswordBasedCipher = p.extend({ cfg: p.cfg.extend({ kdf: d }), encrypt: function encrypt(t, e, r, i) {return r = (i = this.cfg.extend(i)).kdf.execute(r, t.keySize, t.ivSize), i.iv = r.iv, (t = p.encrypt.call(this, t, e, r.key, i)).mixIn(r), t;}, decrypt: function decrypt(t, e, r, i) {return i = this.cfg.extend(i), e = this._parse(e, i.format), r = i.kdf.execute(r, t.keySize, t.ivSize, e.salt), i.iv = r.iv, p.decrypt.call(this, t, e, r.key, i);} });}(), function () {for (var t = CryptoJS, e = t.lib.BlockCipher, r = t.algo, i = [], n = [], o = [], s = [], c = [], a = [], f = [], h = [], u = [], p = [], d = [], l = 0; 256 > l; l++) {d[l] = 128 > l ? l << 1 : l << 1 ^ 283;}var y = 0,_ = 0;for (l = 0; 256 > l; l++) {var v = (v = _ ^ _ << 1 ^ _ << 2 ^ _ << 3 ^ _ << 4) >>> 8 ^ 255 & v ^ 99;i[y] = v, n[v] = y;var g = d[y],B = d[g],x = d[B],S = 257 * d[v] ^ 16843008 * v;o[y] = S << 24 | S >>> 8, s[y] = S << 16 | S >>> 16, c[y] = S << 8 | S >>> 24, a[y] = S, S = 16843009 * x ^ 65537 * B ^ 257 * g ^ 16843008 * y, f[v] = S << 24 | S >>> 8, h[v] = S << 16 | S >>> 16, u[v] = S << 8 | S >>> 24, p[v] = S, y ? (y = g ^ d[d[d[x ^ g]]], _ ^= d[d[_]]) : y = _ = 1;}var k = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54];r = r.AES = e.extend({ _doReset: function _doReset() {for (var t = (r = this._key).words, e = r.sigBytes / 4, r = 4 * ((this._nRounds = e + 6) + 1), n = this._keySchedule = [], o = 0; o < r; o++) {if (o < e) n[o] = t[o];else {var s = n[o - 1];o % e ? 6 < e && 4 == o % e && (s = i[s >>> 24] << 24 | i[s >>> 16 & 255] << 16 | i[s >>> 8 & 255] << 8 | i[255 & s]) : (s = i[(s = s << 8 | s >>> 24) >>> 24] << 24 | i[s >>> 16 & 255] << 16 | i[s >>> 8 & 255] << 8 | i[255 & s], s ^= k[o / e | 0] << 24), n[o] = n[o - e] ^ s;}}for (t = this._invKeySchedule = [], e = 0; e < r; e++) {o = r - e, s = e % 4 ? n[o] : n[o - 4], t[e] = 4 > e || 4 >= o ? s : f[i[s >>> 24]] ^ h[i[s >>> 16 & 255]] ^ u[i[s >>> 8 & 255]] ^ p[i[255 & s]];}}, encryptBlock: function encryptBlock(t, e) {this._doCryptBlock(t, e, this._keySchedule, o, s, c, a, i);}, decryptBlock: function decryptBlock(t, e) {var r = t[e + 1];t[e + 1] = t[e + 3], t[e + 3] = r, this._doCryptBlock(t, e, this._invKeySchedule, f, h, u, p, n), r = t[e + 1], t[e + 1] = t[e + 3], t[e + 3] = r;}, _doCryptBlock: function _doCryptBlock(t, e, r, i, n, o, s, c) {for (var a = this._nRounds, f = t[e] ^ r[0], h = t[e + 1] ^ r[1], u = t[e + 2] ^ r[2], p = t[e + 3] ^ r[3], d = 4, l = 1; l < a; l++) {var y = i[f >>> 24] ^ n[h >>> 16 & 255] ^ o[u >>> 8 & 255] ^ s[255 & p] ^ r[d++],_ = i[h >>> 24] ^ n[u >>> 16 & 255] ^ o[p >>> 8 & 255] ^ s[255 & f] ^ r[d++],v = i[u >>> 24] ^ n[p >>> 16 & 255] ^ o[f >>> 8 & 255] ^ s[255 & h] ^ r[d++];p = i[p >>> 24] ^ n[f >>> 16 & 255] ^ o[h >>> 8 & 255] ^ s[255 & u] ^ r[d++], f = y, h = _, u = v;}y = (c[f >>> 24] << 24 | c[h >>> 16 & 255] << 16 | c[u >>> 8 & 255] << 8 | c[255 & p]) ^ r[d++], _ = (c[h >>> 24] << 24 | c[u >>> 16 & 255] << 16 | c[p >>> 8 & 255] << 8 | c[255 & f]) ^ r[d++], v = (c[u >>> 24] << 24 | c[p >>> 16 & 255] << 16 | c[f >>> 8 & 255] << 8 | c[255 & h]) ^ r[d++], p = (c[p >>> 24] << 24 | c[f >>> 16 & 255] << 16 | c[h >>> 8 & 255] << 8 | c[255 & u]) ^ r[d++], t[e] = y, t[e + 1] = _, t[e + 2] = v, t[e + 3] = p;}, keySize: 8 });t.AES = e._createHelper(r);}();\n\n    try {\n      serializeFilter = JSON.encode(filter);\n    } catch (e) {\n      serializeFilter = JSON.encode(\"[]\");\n    }\n\n    var encoded = CryptoJS.enc.Utf8.parse(serializeFilter);\n\n    return CryptoJS.enc.Base64.stringify(encoded);;\n  },\n\n  /**\r\n      * Include default all processes item in server resposne\r\n      */\n  includeAllProcessesItem: function includeAllProcessesItem(response) {\n    // all Process - no filter\n    var allProcessItem = {\n      idworkflow: \"-1\",\n      guidWFClass: \"-1\",\n      name: bizagi.localization.getResource(\"workportal-widget-inbox-all-processes\"),\n      path: \"App/\",\n      count: 0,\n      isFavorite: \"false\",\n      icon: \"\",\n      category: \"Processes\",\n      guidFavorite: \"\",\n      orderValue: String.fromCharCode(0) };\n\n\n    if (response.workflows) {\n      // each for count all cases or activities\n      $.each(response.workflows.workflow, function (i, workflow) {\n        response.workflows.workflow[i].orderValue = response.workflows.workflow[i].name;\n        allProcessItem.count += Number(workflow.count);\n      });\n      // Set first element in the list\n      response.workflows.workflow.unshift(allProcessItem);\n    };\n  },\n\n  /**\r\n      * validate column enabled / currentInboxView\r\n      * @returns {bool} header enabled\r\n      */\n  isInboxSystemHeaderSortable: function isInboxSystemHeaderSortable(field, lastProcessInbox, viewType) {\n    var result = false;\n    var headersEnabled = {};\n\n    if (viewType === 'detailView') {\n      headersEnabled = {\n        \"radnumber\": true,\n        \"wiestimatedsolutiondate\": true,\n        \"isfavorite\": true,\n        \"currenttask\": true,\n        \"wfclsdisplayname\": true };\n\n    } else\n    if (viewType === 'cardView') {\n      headersEnabled = {\n        \"radnumber\": true,\n        \"wiestimatedsolutiondate\": true,\n        \"isfavorite\": true,\n        \"currenttask\": true,\n        \"wfclsdisplayname\": true,\n        \"taskstate\": true };\n\n    }\n\n    // Only if wfclsdisplayname is enabled\n    if (headersEnabled.wfclsdisplayname) {\n      // specific process list \n      var isSmartInbox = lastProcessInbox.smartInboxId != undefined && lastProcessInbox.smartInboxId != null;\n      var disableProcessColumn = isSmartInbox && field.fieldName == \"wfclsdisplayname\" && !field.isSmartInbox;\n      if (lastProcessInbox.idWorkflow != -1 || disableProcessColumn) {\n        headersEnabled.wfclsdisplayname = false;\n      }\n    }\n\n    if (field && field.fieldName) {\n      // columns enabled\n      var columnEnabled = headersEnabled[field.fieldName.toLowerCase()];\n      // validate\n      if (columnEnabled && (field.order || field.fieldFilterName)) {\n        result = true;\n      }\n    }\n\n    return result;\n  },\n\n  isInboxHeaderASystemColumn: function isInboxHeaderASystemColumn(field) {\n    var systemHeaders = {\n      \"taskstate\": true,\n      \"taskstateColor\": true,\n      \"radnumber\": true,\n      \"wfclsdisplayname\": true,\n      \"currenttask\": true,\n      \"cascreationdate\": true,\n      \"wiestimatedsolutiondate\": true,\n      \"cassolutiondate\": true,\n      \"idcase\": true,\n      \"idworkitem\": true,\n      \"taskid\": true,\n      \"atrisktime\": true,\n      \"currentuser\": true,\n      \"currentfullname\": true,\n      \"fieldName\": true,\n      \"idwfclass\": true,\n      \"isfavorite\": true,\n      \"guidfavorite\": true,\n      \"creatorfullname\": true };\n\n    return systemHeaders[field.toLowerCase()] || false;\n  },\n\n  /**\r\n      * Verify if custom column is enabled\r\n      * @returns {boolean} customcolumn enabled\r\n      */\n  validateCustomColumn: function validateCustomColumn(field, maxColumnsAllowedOnView, columnsAddedCount) {\n    var result = { isValid: false, selectedColumnsCount: columnsAddedCount };\n\n    // validate if countColumnsAdded < maxColumnsAllowedOnView\n    if (columnsAddedCount < maxColumnsAllowedOnView) {\n      // is customColumn\n      if (field.isSmartInbox || field.isCustomColumn) {\n        result.isValid = true;\n        result.selectedColumnsCount = columnsAddedCount + 1;\n      }\n    }\n\n    return result;\n  },\n  /**\r\n      * Configure for usage in online and offline services\r\n      */\n  configureGlobalHandlers: function configureGlobalHandlers() {\n    var self = this;\n    $(document).off(\"openForm.services\");\n    $(document).on(\"openForm.services\", function (_, params) {\n      self.activeForm = params.form;\n    });\n    $(document).off(\"disposeForm.services\");\n    $(document).on(\"disposeForm.services\", function (_, params) {\n      self.activeForm = undefined;\n    });\n  },\n\n\n\n  /**\r\n      * <SMART_INBOX>\r\n      */\n  getAllSmartInbox: function getAllSmartInbox() {\n    var self = this;\n    var data = {};\n\n    // Call ajax and returns promise\n    return $.read({ url: self.serviceLocator.getUrl(\"smartinbox-getAllInbox\"), data: data });\n  },\n\n  getSpecificSmartInbox: function getSpecificSmartInbox(params) {\n    var self = this;\n    var data = {};\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-specific-inbox\");\n    var url = endPoint.replace(\"{settingName}\", params.settingName);\n    url = url.replace(\"{owner}\", params.owner);\n    url = url.replace(\"{smartInboxId}\", params.smartInboxId);\n\n\n    // Call ajax and returns promise\n    return $.read({ url: url, data: data });\n  },\n\n\n  /*\r\n      *   Return all the available processes to SmartInbox\r\n      */\n  getAllProcessesSmartInbox: function getAllProcessesSmartInbox(params) {\n    var self = this;\n    var data = {};\n\n    // Call ajax and returns promise\n    return $.read({ url: self.serviceLocator.getUrl(\"smartinbox-processes\"), data: data });\n  },\n\n  /*\r\n      *   Return all the available processes to SmartInbox\r\n      */\n  getAllCustomizedColumnsSmartInbox: function getAllCustomizedColumnsSmartInbox(params) {\n    var self = this;\n    var data = JSON.stringify(params);\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"smartinbox-customized-columns\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  createSmartInbox: function createSmartInbox(params) {\n    var self = this;\n    var data = JSON.stringify(params);\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"smartinbox-createinbox\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  updateSmartInbox: function updateSmartInbox(params, model) {\n    var self = this;\n    var data = JSON.stringify(model);\n\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-specific-inbox\");\n    var url = endPoint.replace(\"{settingName}\", params.settingName);\n    url = url.replace(\"{owner}\", params.owner);\n    url = url.replace(\"{smartInboxId}\", params.smartInboxId);\n\n    return $.ajax({\n      url: url,\n      data: data,\n      type: \"PUT\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  deleteSmartInbox: function deleteSmartInbox(params) {\n    var self = this;\n    var data = {};\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-specific-inbox\");\n    var url = endPoint.replace(\"{settingName}\", params.settingName);\n    url = url.replace(\"{owner}\", params.owner);\n    url = url.replace(\"{smartInboxId}\", params.smartInboxId);\n\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      //data: data,\n      type: \"DELETE\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n\n  },\n\n  shareSmartInbox: function shareSmartInbox(params, model) {\n    var self = this;\n    var data = JSON.stringify(model);\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-share\");\n    var url = endPoint.replace(\"{smartInboxId}\", params.smartInboxId);\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n\n  },\n\n  getEntityValuesForInboxFilter: function getEntityValuesForInboxFilter(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"smartinbox-entity-values\");\n    url = url.replace(\"{entityGuid}\", params.entityGuid);\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      type: \"GET\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getUserTasksForInboxFilter: function getUserTasksForInboxFilter(params) {\n    var self = this;\n    var url = \"\";\n\n    if (params.isSmartInbox) {\n      url = self.serviceLocator.getUrl(\"smartinbox-user-tasks\");\n      url = url.replace(\"{smartInboxId}\", params.id);\n    } else {\n      url = self.serviceLocator.getUrl(\"smartinbox-user-tasks-process\");\n      url = url.replace(\"{workflowId}\", params.id);\n    }\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      type: \"GET\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * END OF CODE SECTION FOR : </SMART_INBOX>\r\n      */\n\n  /**\r\n          * callServiceWithNetworkRetries\r\n          */\n  callServiceWithNetworkRetries: function callServiceWithNetworkRetries(context, serviceInvocation, pArguments, maxRetries, delayBetweenRetry, currentRetry, currentDeferred) {\n    var self = this;\n    var currentDeferred = currentDeferred || $.Deferred();\n    currentRetry = isNaN(currentRetry) ? 0 : currentRetry;\n    maxRetries = isNaN(maxRetries) ? 1 : maxRetries;\n    delayBetweenRetry = isNaN(delayBetweenRetry) ? 100 : delayBetweenRetry;\n    if (currentRetry >= maxRetries) {\n      console.error(\"Max retries reached\");\n      currentDeferred.reject(\"Max retries reached\");\n      return;\n    }\n\n    $.when(serviceInvocation.apply(context, pArguments)).\n    then(function (response) {\n      currentDeferred.resolve(response);\n    }).\n    fail(function (params) {\n      if (params.status === 0) {\n        setTimeout(function () {\n          self.callServiceWithNetworkRetries(context, serviceInvocation, pArguments, maxRetries, delayBetweenRetry, currentRetry + 1, currentDeferred);\n        }, delayBetweenRetry);\n      } else\n      {\n        currentDeferred.reject(params);\n      }\n    });\n\n    return currentDeferred.promise();\n  },\n\n  getAndSaveMobileFeaturesFromBizagiConfig: function getAndSaveMobileFeaturesFromBizagiConfig() {\n    var self = this;\n\n    if (bizagi.util.validateIfSaveMobileFeaturesIsEnabled()) {\n      $.when(self.getConfiguration()).then(function (configuration) {\n        if (configuration && configuration.features) {\n          bizagi.util.storeMobileFeatures(configuration.features);\n        }\n      });\n    }\n  } });","function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;}\n/**\r\n                                                                                                                                                                                                           * Routing service\r\n                                                                                                                                                                                                           *\r\n                                                                                                                                                                                                           * @author Edward J Morales\r\n                                                                                                                                                                                                           * @description This class has been created based on jira story DRAGON-4943\r\n                                                                                                                                                                                                           */\n\n$.Class.extend(\"bizagi.workportal.services.routing\",\n{\n  BIZAGI_WORKPORTAL_WIDGET_START_FORM: \"startForm\" },\n\n{\n  /**\r\n  * Main method\r\n  *\r\n  * @param params <object> json with parameters to route\r\n  * @return object deferred\r\n  */\n  init: function init(args) {\n    var self = this;\n    args = args || {};\n    self.params = args.params || {};\n    self.dataService = args.dataService || {};\n    self.modules = {\n      render: \"activityform\",\n      oldRender: \"oldrenderintegration\",\n      async: \"async\",\n      activitySelector: \"routing\" };\n\n\n    // By default render version is Bizagi GO\n    self.renderVersion = 2;\n\n    self.resetRouteInformation();\n  },\n\n  resetRouteInformation: function resetRouteInformation() {\n    var self = this;\n    self.route = {\n      module: \"\", // Name of module to route\n      moduleParams: {} // parameters of module\n    };\n  },\n\n  setRenderParams: function setRenderParams(params) {\n    var self = this;\n    self.params = self.getRenderParams(params);\n  },\n\n  /**\r\n     * Parse a format incoming parameters\r\n     * @param params object\r\n     * @return object json with render parameters\r\n     */\n  getRenderParams: function getRenderParams(params) {var _renderParams;\n    var self = this;\n\n    var renderParams = (_renderParams = {\n      idCase: parseInt(params.idCase || 0),\n      idWorkflow: parseInt(params.idWorkflow || 0),\n      idWorkitem: params.idWorkitem || params.idWorkItem || 0,\n      idTask: parseInt(params.idTask || 0),\n      eventAsTasks: params.eventAsTasks || false,\n      onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\n      formsRenderVersion: params.formsRenderVersion || 0,\n      referrer: params.referrer || \"\",\n      isComplex: params.isComplex !== undefined ? true : false }, _defineProperty(_renderParams, \"formsRenderVersion\",\n    2), _defineProperty(_renderParams, \"onClose\",\n    params.onClose || \"\"), _defineProperty(_renderParams, \"isOfflineForm\",\n    params.isOfflineForm || false), _defineProperty(_renderParams, \"radNumber\",\n    params.radNumber || null), _defineProperty(_renderParams, \"offlineType\",\n    params.offlineType || null), _renderParams);\n\n\n    var skipSubprocessGlobalForm = true;\n    try {\n      skipSubprocessGlobalForm = BIZAGI_SETTINGS[\"skipSubprocessGlobalForm\"] || true;\n    } catch (e) {\n    }\n\n    self.skipSubprocessGlobalForm = skipSubprocessGlobalForm == \"true\";\n\n    return renderParams;\n  },\n  /**\r\n     * Define the next route to take\r\n     * @param params object\r\n     * @return deferred with specific path\r\n     */\n  getRoute: function getRoute(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    // Params Override\n    self.params = params ? params : self.params;\n\n    var fromTask = params.fromTask || params.idTask || \"\";\n    var fromWorkItemId = params.fromWorkItemId || params.idWorkitem || params.idWorkItem || \"\";\n\n    /**\r\n                                                                                                * Get form version\r\n                                                                                                */\n    $.when(self.getRenderVersion(self.params)).\n    done(function (renderVersion) {\n      self.renderVersion = renderVersion;\n      self.route.moduleParams = self.getRenderParams(self.params);\n\n      // Looking for workitems\n      $.when(self.dataService.getWorkitems({\n        idCase: self.params.idCase,\n        onlyUserWorkItems: self.params.onlyUserWorkItems,\n        isOfflineForm: self.params.isOfflineForm,\n        fromTask: fromTask,\n        fromWorkItemId: fromWorkItemId })).\n      done(function (getWorkItems) {\n        var workItems = getWorkItems.workItems.length;\n\n        /**\r\n                                                       * If routing has been called with idCase and idWorkitem\r\n                                                       * then go to the render\r\n                                                       */\n        self.route.moduleParams.hasWorkItems = workItems ? true : false;\n        self.route.moduleParams.isEvent = self.params.isEvent || false;\n        self.route.moduleParams.hasGlobalForm = bizagi.util.parseBoolean(getWorkItems.hasGlobalForm);\n\n        if (!bizagi.util.isEmpty(getWorkItems.idWfClass)) {\n          self.route.moduleParams.idWfClass = getWorkItems.idWfClass;\n        }\n\n        //The error came from the inbox\n        if (self.params.hasSyncError === true && self.params.syncError != undefined) {\n          self.includeSyncErrorIntoModuleparams(self.params.syncError);\n        }\n\n        if (self.route.moduleParams.idWorkitem > 0) {\n          self.setRenderModuleName(self.getRenderModuleName(renderVersion));\n          if (self.route.moduleParams.idTask === 0) {\n            // Try to found idTask\n            self.route.moduleParams.idTask = self.searchIdTask(self.route.moduleParams.idWorkitem);\n          }\n\n          // We have enough information to instance the render\n          self.route.moduleParams.radNumber = bizagi.util.isEmpty(params.radNumber) ?\n          getWorkItems.radNumber || \"\" : params.radNumber;\n          self.route.moduleParams.idWorkflow = getWorkItems.idWorkFlow || \"\";\n\n          var item = getWorkItems.workItems.find(function (el) {\n            return Number(el.idWorkItem) === Number(self.route.moduleParams.idWorkitem);\n          });\n          if (item != undefined) {\n            if (item.displayName != undefined) {\n              self.route.moduleParams.displayName = item.displayName;\n            }\n            self.route.moduleParams.mobileAccess = !(item.mobileAccess === false);\n            self.route.moduleParams.forceOffline = item.forceOffline === true;\n            self.route.moduleParams.workitemstate = params.workitemstate;\n          }\n\n          self.getSyncError(self.route.moduleParams).\n          then(function (syncError) {\n            if (syncError == undefined) return;\n            self.includeSyncErrorIntoModuleparams(syncError);\n          }).\n          always(function () {\n            def.resolve(self.route);\n            self.resetRouteInformation();\n          });\n        } else {\n\n          var listAsyncWorkItems = self.checkAsyncWorkItems(getWorkItems);\n\n          // Check if case has workItems\n          if (workItems === 0) {\n\n            self.route.moduleParams.idWorkflow = getWorkItems.idWorkFlow || \"\";\n            self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\n\n            if ($.trim(getWorkItems.msgTask) !== \"\") {\n              def.resolve(self.routeToMessageForm(getWorkItems.msgTask));\n            } else if (bizagi.util.parseBoolean(getWorkItems.hasGlobalForm)) {\n              // hasn't work items, show global form\n              // Resolve route -> Global Form\n              self.route.moduleParams.displayName = null;\n              def.resolve(self.routeToGlobalForm(getWorkItems));\n            } else {\n              // Resolve route -> Global form without data\n              def.resolve(self.routeToGlobalFormWithoutData());\n            }\n          } else if (workItems === 1 || listAsyncWorkItems.length > 0) {\n            // it has one workItem\n            // Check if it is asyncronous activity\n            var workItemIndex = 0;\n            if (listAsyncWorkItems.length > 0) {\n              for (var workitemCounter = 0; workitemCounter < workItems; workitemCounter++) {\n\n                if (getWorkItems.workItems[workitemCounter].isAsynch == \"true\") {\n                  workItemIndex = workitemCounter;\n                  break;\n                }\n              }\n            }\n\n            // Change idCase\n            self.route.moduleParams.idCase = getWorkItems.workItems[workItemIndex].idCase;\n            self.route.moduleParams.idTask = getWorkItems.workItems[workItemIndex].idTask;\n            self.route.moduleParams.fromTask = getWorkItems.workItems[workItemIndex].idTask;\n            self.route.moduleParams.idWorkitem = getWorkItems.workItems[workItemIndex].idWorkItem;\n            self.route.moduleParams.idWorkflow = getWorkItems.workItems[workItemIndex].idWorkFlow;\n            self.route.moduleParams.displayName = getWorkItems.workItems[workItemIndex].displayName ?\n            getWorkItems.workItems[workItemIndex].displayName : \"\";\n            self.route.moduleParams.radNumber = getWorkItems.radNumber || \"\";\n            self.route.moduleParams.mobileAccess = !(getWorkItems.workItems[workItemIndex].mobileAccess === false);\n            self.route.moduleParams.forceOffline = getWorkItems.workItems[workItemIndex].forceOffline === true;\n\n            if (listAsyncWorkItems.length > 0) {\n              // Resolve asynchronous activity\n              self.setRenderModuleName(self.modules.async);\n            } else {\n              // Resolve render\n              self.setRenderModuleName(self.getRenderModuleName(renderVersion));\n            }\n\n            self.getSyncError(self.route.moduleParams).\n            then(function (syncError) {\n              if (syncError == undefined) return;\n              self.includeSyncErrorIntoModuleparams(syncError);\n            }).\n            always(function () {\n              def.resolve(self.route);\n              self.resetRouteInformation();\n            });\n          } else {\n\n            // it has many workItems or subprocess\n            // show routing window\n            getWorkItems.checkProcess = getWorkItems.subProcesses.length > 0 &&\n            self.skipSubprocessGlobalForm ? true : false;\n            getWorkItems.checkWorkItems = workItems > 1 ? true : false;\n\n            getWorkItems[\"fromSearchWidget\"] = self.params.referrer == \"search\" ? true : false;\n            self.setRenderModuleName(self.modules.activitySelector);\n            self.route.moduleParams.data = getWorkItems;\n\n\n            def.resolve(self.route);\n            self.resetRouteInformation();\n          }\n        }\n      }).fail(function (error) {\n        var msgTask = bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\");\n        def.resolve(self.routeToMessageForm(msgTask));\n      });\n    }).fail(function (xhr, errorType, message) {\n      def.reject();\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n     * Set name of module to instance\r\n     * @param renderName\r\n     */\n  setRenderModuleName: function setRenderModuleName(renderName) {\n    var self = this;\n\n    self.route.module = renderName;\n    self.route.moduleParams.widgetName = renderName;\n  },\n  /**\r\n     * Get render module\r\n     * @param renderVersion integer 1 || 2\r\n     * @returns boolean\r\n     */\n  getRenderModuleName: function getRenderModuleName(renderVersion) {\n    var self = this;\n    return renderVersion == 1 ? self.modules.oldRender : self.modules.render;\n  },\n  /**\r\n     * Search idTask from workItems object\r\n     * @return {number} idTask\r\n     * @param workItemsList\r\n     * @param workItemToSearch\r\n     */\n  searchIdTask: function searchIdTask(workItemsList, workItemToSearch) {\n    var idTask = 0;\n    workItemsList = workItemsList || [];\n\n    for (var i = 0, length = workItemsList.length; i < length; i++) {\n      //search idTask\n      if (parseInt(workItemsList[i][\"idWorkItem\"]) == parseInt(workItemToSearch)) {\n        idTask = parseInt(workItemsList[i][\"idTask\"]);\n        break;\n      }\n    }\n    return idTask;\n  },\n\n  /**\r\n     * Check if workitems has asynchronous activities\r\n     * @param data\r\n     * @returns {Array}\r\n     */\n  checkAsyncWorkItems: function checkAsyncWorkItems(data) {\n    var result = [];\n\n    $.each(data[\"workItems\"], function (key) {\n      if (data[\"workItems\"][key][\"isAsynch\"] == \"true\") {\n        result.push({\n          idCase: data[\"idCase\"],\n          idWorkitem: data.workItems[key].idWorkItem,\n          idTask: data.workItems[key].idTask });\n\n      }\n    });\n    return result;\n  },\n\n  /**\r\n     * Resolve global form route\r\n     * @param getWorkitems\r\n     * @returns {{module: string, moduleParams: {}}|*}\r\n     */\n  routeToGlobalForm: function routeToGlobalForm(getWorkitems) {\n    var self = this;\n\n    // Override idCase and idWorkflow\n    self.route.moduleParams.idCase = $.isNumeric(getWorkitems.idCaseForGlobalForm) && getWorkitems.\n    idCaseForGlobalForm > 0 ?\n    getWorkitems.idCaseForGlobalForm : self.route.moduleParams.idCase;\n\n    self.route.moduleParams.idWorkflow = parseInt(getWorkitems.idWorkFlow || 0);\n\n    if (self.renderVersion == 1) {\n      // Old render\n      var urlTemplate = self.dataService.serviceLocator.getUrl(\"old-render\") +\n      \"?PostBack=1&idCase=%s&idWorkitem=%s&idTask=%s\";\n      var idCase = self.route.moduleParams.idCase || \"\";\n      var idWorkitem = self.route.moduleParams.idWorkitem || \"\";\n      var idTask = self.route.moduleParams.idTask || \"\";\n      var url = printf(urlTemplate, idCase, idWorkitem, idTask);\n\n      self.route.moduleParams.onlyUserWorkItems = self.route.moduleParams.idCase || \"\";\n\n      self.setRenderModuleName(self.modules.oldRender);\n      self.route.moduleParams.url = url;\n    } else {\n      // Bizagi\n      self.setRenderModuleName(self.modules.render);\n    }\n\n    return self.route;\n  },\n  /**\r\n     * Resolve global form\r\n     * @returns {{module: string, moduleParams: {}}|*}\r\n     */\n  routeToGlobalFormWithoutData: function routeToGlobalFormWithoutData() {\n    var self = this;\n\n    self.setRenderModuleName(self.modules.render);\n    self.route.moduleParams.withOutGlobalForm = true;\n\n    return self.route;\n  },\n\n  /**\r\n     * Resolve Render with personalized message\r\n     * @param message\r\n     * @returns {{module: string, moduleParams: {}}|*|bizagi.workportal.services.routing.route}\r\n     */\n  routeToMessageForm: function routeToMessageForm(message) {\n    var self = this;\n    message = message || \"\";\n\n    self.setRenderModuleName(self.modules.render);\n    self.route.moduleParams.withOutGlobalForm = true;\n    self.route.moduleParams.messageForm = message;\n\n    return self.route;\n  },\n\n  /**\r\n     * Return the forms render version from parameters or service\r\n     * @param params object\r\n     * @returns {integer}\r\n     */\n  getRenderVersion: function getRenderVersion(params) {\n    var self = this,defer = new $.Deferred();\n\n    // Try get from parameters\n    var formsVersion = params.formsRenderVersion || 0;\n    if (formsVersion != 0) {\n      // Response from parameters\n      defer.resolve(formsVersion);\n    } else {\n\n      // Get from service\n      $.when(self.dataService.getCaseFormsRenderVersion({\n        idCase: params.idCase })).\n      done(function (data) {\n        formsVersion = parseInt(data.formsRenderVersion);\n        defer.resolve(formsVersion);\n      }).fail(function (xhr, errorType, message) {\n        defer.reject();\n      });\n    }\n\n    return defer.promise();\n  },\n\n\n  getSyncError: function getSyncError(params) {\n    var self = this;\n\n    //From the offline services is ensured that for new offline cases offlineType is start.\n    //Additionally, in new cases created online the function getRoute is called only after the case is successfully created\n    if (!bizagi.util.isOfflineErrorsViewSupported() ||\n    params.offlineType == \"start\" ||\n    self.route.moduleParams.syncError != undefined) {\n\n      return $.Deferred().resolve(undefined).promise();\n    }\n    return self.dataService.getTaskSyncError(params);\n  },\n\n  includeSyncErrorIntoModuleparams: function includeSyncErrorIntoModuleparams(syncError) {\n    if (!bizagi.util.isOfflineErrorsViewSupported()) return;\n    var self = this;\n    self.route.moduleParams.hasSyncError = true;\n    self.route.moduleParams.syncError = syncError;\n    self.route.moduleParams.offlineType = self.params.offlineType == \"start\" ? \"start\" : \"task\";\n    self.route.moduleParams.idEdited = true;\n    self.route.moduleParams.isOfflineForm = true;\n    self.route.moduleParams.isOfflineErrorMode = true;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Workportal Security Command\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Edward Morales\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script will define a common class to access the security data\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n\n$.Class(\"bizagi.workportal.command.security\", {}, {\n\n\n  init: function init(dataService) {\n    var self = this;\n    self.dataService = dataService;\n    self.rawData = {};\n  },\n\n  getSecurity: function getSecurity() {\n    var self = this;\n    var def = new $.Deferred();\n    self.security = {};\n    self.jsonSecurityList = {};\n\n    if (bizagi.menuSecurity) {\n      def.resolve(bizagi.menuSecurity);\n    } else {\n\n      $.when(self.dataService.getMenuAuthorization()).done(function (data) {\n        if (bizagi.currentUser.associatedStakeholders && bizagi.currentUser.associatedStakeholders.length > 0) {\n          data.permissions.push({ \"associatedStakeholders\": [] });\n        }\n        self.rawData = data;\n        bizagi.menuSecurity = self.convertSecurityData(data);\n        self.jsonSecurityList = data;\n        $.each(self.security, function (key, value) {\n          authMenu[key] = value;\n        });\n        def.resolve(bizagi.menuSecurity);\n      }).fail(function () {\n        def.reject();\n      });\n    }\n\n    return def.promise();\n  },\n\n\n  convertSecurityData: function convertSecurityData(data) {\n    var permsMenu = {};\n    var getRecursivePerms = function getRecursivePerms(perms) {\n      $.each(perms, function (key, value) {\n        if (_typeof(value) == 'object') {\n          if (typeof key != \"number\") {\n            permsMenu[key] = true;\n          }\n          getRecursivePerms(value);\n        } else {\n          permsMenu[value] = true;\n        }\n      });\n    };\n    getRecursivePerms(data.permissions);\n    return permsMenu;\n  },\n\n  checkSecurityPerm: function checkSecurityPerm(module) {\n    var self = this;\n    module = module || \"\";\n    var deferred = $.Deferred();\n    if (!bizagi.menuSecurity) {\n      self.getSecurity().done(function (currentMenuSecurity) {\n        deferred.resolve(!!currentMenuSecurity[module]);\n      }).fail(function () {\n        deferred.resolve(false);\n      });\n    } else {\n      deferred.resolve(!!bizagi.menuSecurity[module]);\n    }\n\n    return deferred.promise();\n  },\n\n  getRawData: function getRawData() {\n    return this.rawData;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Luis Cabarique - LuisCE\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This script will define homePortal Framework\r\n                                                                                                                                                                                                                                                                                                                                                                                */\nbizagi = typeof bizagi !== \"undefined\" ? bizagi : {};\nbizagi.webparts = typeof bizagi.webparts !== \"undefined\" ? bizagi.webparts : {};\n\n$.Class.extend(\"bizagi.workportal.homeportalFramework\", {}, {\n  /**\r\n                                                               *   Constructor\r\n                                                               */\n  init: function init(workportalFacade) {\n    var self = this;\n\n    // Set workportal facade\n    self.workportalFacade = workportalFacade;\n    self.device = bizagi.detectDevice();\n\n    self.accumulatedContext = [];\n    self.navigateFromRender = false;\n\n    self._homeportalShow();\n    self.configureHandler();\n\n    bizagi.util.mobility.homePortalNavigate = $.proxy(self.homePortalNavigate, self);\n    bizagi.util.mobility.homePortalViewShow = $.proxy(self.homePortalViewShow, self);\n    bizagi.util.mobility.homePortalViewInit = $.proxy(self.homePortalViewInit, self);\n    bizagi.util.mobility.homePortalViewHide = $.proxy(self.homePortalViewHide, self);\n    bizagi.util.mobility.drawerBeforeShow = $.proxy(self.drawerBeforeShow, self);\n  },\n  /**\r\n      * finds and executes child components based on the given layout\r\n      * @param component name of the component\r\n      * @param content jquery content container\r\n      * @returns {Array} promise of executing child components\r\n      */\n  loadComponents: function loadComponents(component, content) {\n    var self = this;\n    var components = [];\n\n    $.each(self.homePortalLayout, function (wp, v) {\n      if (Array.isArray(v.position)) {\n        $.each(v.position, function (index, value) {\n          if (value === component) {\n            var $canvas = $('#' + v.canvas[index], content);\n            var func = self.workportalFacade.executeWebpart({\n              webpart: wp,\n              canvas: $canvas,\n              pane: $canvas.parent('div[data-role=\"pane\"]') });\n\n            components.push(func);\n          }\n        });\n      } else if (v.type !== \"drawer\" && v.position === component) {\n        var $canvas = $('#' + v.canvas, content);\n        var func = self.workportalFacade.executeWebpart({\n          webpart: wp,\n          constructorName: v.constructorName,\n          canvas: $canvas,\n          pane: $canvas.parent('div[data-role=\"pane\"]') });\n\n        components.push(func);\n      } else if (v.type === \"drawer\" && v.position === component) {\n        var $canvas = $(\"#\" + v.canvas, \"body\");\n        var func = self.workportalFacade.executeWebpart({\n          webpart: wp,\n          canvas: $canvas });\n\n        components.push(func);\n      }\n    });\n\n    return $.when(components);\n  },\n  /**\r\n      * load requested template and fix the layout\r\n      * @param templateName name of the template\r\n      * @param component name of the component\r\n      * @param params aditional paramethers\r\n      * @returns {jquery} template object\r\n      */\n  loadComponentTemplate: function loadComponentTemplate(templateName, component, params) {\n    var self = this;\n    var template = kendo.template(self.workportalFacade.getTemplate(templateName), {\n      useWithBlock: false });\n\n    var components = [];\n    for (var wp in self.homePortalLayout) {\n      var wpLayout = self.homePortalLayout[wp];\n      if (Array.isArray(wpLayout.position)) {\n        $.each(wpLayout.position, function (index, value) {\n          if (value === component) {\n            components.push({\n              canvas: self.homePortalLayout[wp].canvas[index] });\n\n          }\n        });\n      } else if (wpLayout.type !== \"drawer\" && wpLayout.position === component) {\n        components.push(wpLayout);\n      }\n\n      if (wpLayout.type === \"drawer\" && wp === component) {\n        $.extend(params, {\n          \"canvas\": wpLayout.canvas,\n          \"direction\": wpLayout.direction });\n\n      }\n    }\n\n    return template($.extend(params, {\n      \"homePortalLayoutPositions\": components }));\n\n  },\n  /**\r\n      * Show the component\r\n      * @private\r\n      */\n  _homeportalShow: function _homeportalShow() {\n    var self = this;\n\n    bizagi.webpart.subscribe(\"homeportalShow\", function (e, params) {\n      params.params = params.params || {};\n      var where = \"\";\n      var openDrawer = false;\n      var navigateFromRender = false;\n\n      var transition = \"\";\n      switch (params.what) {\n        case \"reportsChart\":\n          where = \"reportsChart\";\n          openDrawer = false;\n          break;\n        case \"stuffTemplates\":\n          where = \"renderTemplates\";\n          if (params.params.data && params.params.data.navigateFromRender) {\n            self.setContextFromRender(params);\n            self.navigateFromRender = navigateFromRender = params.params.data.navigateFromRender;\n          }\n          break;\n        case \"syncErrors\":\n          params.transition = \"overlay:left\";\n          where = params.what;\n          openDrawer = false;\n          break;\n        case \"favorites\":\n        case \"pendings\":\n        case \"ontime\":\n        case \"overdue\":\n        case \"risk\":\n          where = \"caseTemplates\";\n          break;\n        case \"startForm\":\n          params.transition = \"overlay:up\";\n          where = params.what;\n          break;\n        case \"newCase\":\n        case \"menu\":\n        case \"render\":\n          openDrawer = true;\n          break;\n        case \"activitiesOptions\":\n          params.what = \"caseTemplatesOptions\";\n          openDrawer = true;\n          break;\n        default:\n          where = params.what;\n          break;}\n\n\n      if (!openDrawer) {\n        self.closeDrawers();\n        var canvas = self.homePortalLayout[where].canvas;\n        var element = $('#' + canvas);\n        if (element.css('display') === 'none' || element.selector === '#renderTemplates') {\n          var parent = element.parent();\n          var pane = parent.data('kendoMobilePane');\n          if (!params.preventNavigate) {\n            if (navigateFromRender) {\n              self.navigateToRenderTemplates();\n            } else {\n              pane.navigate(canvas, params.transition || \"\");\n            }\n          }\n          if (params.title) {\n            $.each(pane.view().header, function (index, element) {\n              var navbar = $(\".km-navbar\", element).data(\"kendoMobileNavBar\");\n              navbar.title(params.title);\n            });\n          }\n          if (bizagi.util.isAndroidSmartphoneDevice() && params.what == \"stuffTemplates\") {\n            $(\".wp-homeportal-rht-pnl-container > div#tmpl-scroller\", pane.view().content).css(\"padding-bottom\", \"64px\");\n          }\n        }\n      } else {\n        self.showDrawer(params.what);\n      }\n\n      bizagi.webpart.publish('homeportalShow-' + params.what, params.params);\n    });\n  },\n  /**\r\n      *\r\n      */\n  configureHandler: function configureHandler() {\n    var self = this;\n\n    bizagi.webpart.subscribe(\"homeportalBack\", function (e, params) {\n      self._back();\n    });\n\n    bizagi.webpart.subscribe(\"homeportalShowNotification\", function (e, params) {\n      $.notifier.add({ text: params.message });\n    });\n  },\n  /**\r\n      *\r\n      * @param drawer\r\n      */\n  showDrawer: function showDrawer(drawer) {\n    if (drawer === \"newCase\")\n    {\n      bizagi.webpart.publish(\"newcase-refresh\", { refreshCurrentStatus: true });\n      $(\"#newCase-drawer\").data(\"kendoMobileDrawer\").show();\n    } else\n    if (drawer === \"menu\")\n    {\n      //reset the scrolling to avoid leaving content out of bounds ( ADO bug 13193 )\n      $(\"#menu-drawer\").data(\"kendoMobileDrawer\").scroller.reset();\n      $(\"#menu-drawer\").data(\"kendoMobileDrawer\").show();\n    } else\n    if (drawer === \"caseTemplatesOptions\")\n    {\n      $(\"#caseTemplatesOptions\").data(\"kendoMobileDrawer\").show();\n    } else\n    if (drawer === \"syncErrors\")\n    {\n      bizagi.webpart.publish(\"bz-update-list-sync-errors-cases\", { refreshCurrentStatus: true });\n      var errorsViewTitle = bizagi.localization.getResource(\"workportal-offline-sync-errors-view-tittle\");\n      bizagi.webpart.publish(\"homeportalShow\", { \"what\": \"syncErrors\", \"title\": errorsViewTitle, \"params\": {}, \"preventNavigate\": false });\n\n      // hide taskFeed\n      bizagi.webpart.publish(\"bz-left-panel-hide\");\n    } else\n\n    {\n      if ($(\"#bz-render-drawer\").length > 0) {\n        $(\"#bz-render-drawer\").data(\"kendoMobileDrawer\").show();\n      }\n    }\n  },\n  /**\r\n      *\r\n      * @private\r\n      */\n  _cleanContext: function _cleanContext() {\n    var self = this;\n\n    if (typeof self.accumulatedContext !== 'undefined') {\n      self.accumulatedContext = [];\n    }\n    self.navigateFromRender = false;\n  },\n  /**\r\n      * Get accumulated context for actions\r\n      * @returns {{}} Accumulates context for actions\r\n      */\n  getActionsContext: function getActionsContext() {\n    var self = this;\n    var actionsContext = {};\n    var accumulatedContext = self.accumulatedContext;\n\n    if (accumulatedContext.length > 0) {\n      actionsContext.context = $.map(accumulatedContext, function (el) {\n        var entityGuid = el.entityGuid ? el.entityGuid : el.guidEntityCurrent;\n        var resp = { entityGuid: entityGuid };\n\n        if (el.surrogateKeyToMapping !== null) {\n          resp.surrogateKey = _typeof(el.surrogateKeyToMapping) === \"object\" ? el.surrogateKeyToMapping : [el.surrogateKeyToMapping];\n        } else {\n          resp.surrogateKey = \"\";\n        }\n\n        return resp;\n      }).filter(function (el) {\n        return el.surrogateKey !== \"\";\n      });\n\n    } else\n    {\n      actionsContext.context = [];\n    }\n\n    return actionsContext;\n  },\n  /**\r\n      * add context to accumulated context\r\n      * @param JSON context\r\n      * @returns {Array}\r\n      */\n  addContext: function addContext(context) {\n    var self = this;\n\n    self.accumulatedContext.push(context);\n    return { \"context\": self.accumulatedContext };\n  },\n  /**\r\n      * Extends the properties of the last context\r\n      * @param params\r\n      */\n  extendCurrentContext: function extendCurrentContext(params) {\n    var self = this;\n    $.extend(self.accumulatedContext[self.accumulatedContext.length - 1], params);\n  },\n  /**\r\n      * Pops the last object in the context\r\n      * @param JSON context\r\n      * @returns {Array}\r\n      */\n  popContext: function popContext() {\n    var self = this;\n\n    self.accumulatedContext.pop();\n    return { \"context\": self.accumulatedContext };\n  },\n  /**\r\n      *\r\n      * @param params\r\n      */\n  setContextFromRender: function setContextFromRender(params) {\n    var self = this;\n\n    params = params.params || {};\n    //self._cleanContext();\n    self.addContext($.extend(params.data, { entityType: \"actionLauncher\" }));\n  },\n  /**\r\n      *\r\n      * @param context\r\n      */\n  homePortalViewInit: function homePortalViewInit(context) {\n    context.view.element.trigger(\"view-initialized\", context.view);\n  },\n  /**\r\n      *\r\n      * @param context\r\n      */\n  homePortalViewHide: function homePortalViewHide(context) {\n    context.view.element.trigger(\"view-hidden\", context.view);\n  },\n\n  /**\r\n      *\r\n      * @param context\r\n      */\n  homePortalViewShow: function homePortalViewShow(context) {\n    context.view.element.trigger(\"homeportal-view-show\", context.view);\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to rendering REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n$.Class.extend(\"bizagi.render.services.service\",\n{\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"pageCacheId\",\n  BA_MULTIACTION_WITH_LIMIT_NUMBER: 5,\n  BA_MULTIACTION_WITH_LIMIT_QUEUE: \"multiaction\" },\n\n{\n  /*\r\n   *   Constructor\r\n   */\n  init: function init(params) {\n    params = params || {};\n    params.context = params.context || \"workflow\";\n    params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    this.serviceLocator = new bizagi.render.services.context(params);\n    this.multiactionService = new bizagi.render.services.multiactionservice(this);\n    this.multiactionServiceWithLimit = new bizagi.render.services.multiactionservice(this, this.Class.BA_MULTIACTION_WITH_LIMIT_NUMBER, this.Class.BA_MULTIACTION_WITH_LIMIT_QUEUE);\n    this.guid = Math.guid();\n\n    if (bizagi.override.enableECMMetadataMultiaction) {\n      this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\n    }\n\n    // Userfield definitions mini-cache\n    this.userfieldRequests = {};\n\n    this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone : bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet : bizagi.deviceEnum.desktop);\n    this.deviceCode = bizagi.util.getDeviceCode();\n  },\n\n  /*\r\n      *   Return the multiaction-service\r\n      */\n  multiaction: function multiaction() {\n    return this.multiactionService;\n  },\n\n  /*\r\n     *   Return the multiaction-service\r\n     */\n  multiactionWithLimit: function multiactionWithLimit() {\n    return this.multiactionServiceWithLimit;\n  },\n\n  metadataECMMultiaction: function metadataECMMultiaction() {\n    return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService : this;\n  },\n  /*\r\n      *   SINGLE SERVICES METHODS\r\n      */\n\n  /*\r\n          *   Gets form data\r\n          *   Returns a promise of the data being retrieved\r\n          */\n  getFormData: function getFormData(params) {\n    var self = this;\n\n    // Check if the params contains mocked data\n    if (params && params.data) {\n      return params.data;\n    }\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\n\n    if (params.idProcess)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\n    if (params.idForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\n    if (params.idEntity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\n    if (params.surrogateKey)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\n    if (params.idRender)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    if (params.xpathContext)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.requestedForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\n    if (params.recordXPath)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\n    if (params.summaryForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\n    if (params.idCase)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\n    if (params.idWorkitem)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\n    if (params.idTask)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\n    if (params.idPageCache)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.contextType)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\n    if (params.guidEntity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\n    if (!bizagi.util.isEmpty(params.isRefresh))\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\n    if (params.isActionStartForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\n    if (params.additionalXpaths)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\n    if (params.idStartScope)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\n    if (typeof params.readOnlyForm !== \"undefined\")\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\n    if (typeof params.printversion !== \"undefined\")\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\n    if (typeof params.recordXpath !== \"undefined\")\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\n    if (params.guid)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\n    if (params.downloadOfflineForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\n\n    if (params.editable === false) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\n    }\n\n    // Support parameter from ui\n    // Parameters that affects all the same attributes of render\n    if (params.printversion) {\n      //Print limit grid rows\n      var BA_ALL_PARAMETER_PREFIX = \"all_\";\n\n      if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\n      }\n    }\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n\n    // Call ajax and returns promise\n    bizagi.chrono.initAndStart(\"data\");\n    var ajaxParams = {\n      url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: params.action || \"LOAD\" };\n\n    if (params.downloadOfflineForm) {\n      ajaxParams.avoidLoader = true;\n    }\n    return $.ajax(ajaxParams).\n    pipe(function (response) {\n      bizagi.chrono.stopAndLog(\"data\");\n\n      // Transform data for read only version\n      if (params.printversion) {\n        try {\n          response.form.properties.editable = \"False\";\n\n          var transformGridDataToReadOnly = function transformGridDataToReadOnly(_data) {\n            if (_data == null) {\n              return _data;\n            }\n            if (_data.hasOwnProperty('type') && _data.type == 'grid') {\n              _data.id = data.id + \"-print\";\n              _data.allowAdd = \"False\";\n              _data.allowDelete = \"False\";\n              _data.allowEdit = \"False\";\n              _data.allowGrouping = \"False\";\n              _data.allowMore = \"False\";\n              _data.allowSearch = \"False\";\n            } else {\n              $.each(data, function (key, value) {\n                if (_typeof(value) == 'object') {\n                  _data[key] = transformGridDataToReadOnly(_data[key]);\n                }\n              });\n            }\n            return _data;\n          };\n          response = transformGridDataToReadOnly(response);\n        } catch (e) {\n        }\n      }\n\n      return response;\n    });\n  },\n  /*\r\n      *   Gets a search form data\r\n      *   Returns a promise of the data being retrieved\r\n      */\n  getSearchFormData: function getSearchFormData(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\n    if (params.xpath)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    if (params.idRender)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    if (params.xpathContext)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.idSearchForm)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\n    if (params.idPageCache)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SEARCHFORM\" });\n\n  },\n\n  processDataValues: function processDataValues(data) {\n    var o;\n    data = $.extend(true, {}, data);\n    for (o in data) {\n      if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\n        // for search\n        if (data[o].hasOwnProperty(\"id\")) {\n          data[o] = data[o].id;\n        }\n      }\n    }\n    return data;\n  },\n  /*\r\n      *   Sends a form action to the server\r\n      */\n  submitData: function submitData(params) {\n    var self = this;\n\n    // Define data\n    data = self.resolveData(params.data || {}, params.xpathContext);\n    data = self.processDataValues(data);\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\n\n    // Fill optional parameters\n    params = params || {};\n    if (params.xpath)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    if (params.idRender)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    if (params.xpathContext)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.idPageCache)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.guidEntity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\n    if (params.contexttype)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    if (params.transitions)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\n    if (params.surrogatekey)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\n    if (params.forcePlanCompletion)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\n\n    /* if (params.isActionStartForm)\r\n                                                                                                        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n                                                                                                        */\n    var actionType = params.action.toString().toUpperCase();\n\n    // Log submit data\n    bizagi.debug(\"Data sent\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: actionType,\n      beforeSend: function beforeSend(xhr, status) {\n        xhr.renderingService = true;\n      } });\n\n  },\n  /*\r\n      * Get data processing xpathcontext\r\n      */\n  resolveData: function resolveData(data, xpathContext) {\n    var name, newName, value;\n    if (!$.isEmptyObject(data) && xpathContext) {\n      if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\n        for (name in data) {\n          if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\n            newName = name.substr(name.search(/\\]/) + 2);\n            value = data[name];\n            data[newName] = value;\n            delete data[name];\n          }\n        }\n      }\n    }\n    return data;\n  },\n  /*\r\n      *   Fetch a property from the server\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      *   -   property\r\n      */\n  getPropertyData: function getPropertyData(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\n\n    if (params.sessionId)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    if (params.contexttype)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    if (params.guidentity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\n    if (params.surrogatekey)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\n    if (params.pxpath)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\n    if (params.prows)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\n    if (params.ppage)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\n    if (params.pfilter != undefined && params.pfilter != null)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\n    /*else\r\n                                                                              data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\n    if (params.psort != undefined && params.psort != null)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\n    if (params.porder)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\n    if (params.pcaseId)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\n    if (params.pguidEntity)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\n    if (params.psurrogatedKey) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\n    }\n    if (params.pactionXpath) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\n    }\n    if (params.ptemplateGuid) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\n    }\n    if (params.pparameters) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    // TODO: change REST library in order to support extra HTTP parameters\n    // Please be careful with dataType parameter\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\",\n      beforeSend: function beforeSend(xhr, status) {\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } });\n\n\n  },\n  /*\r\n      *   Refresh the data property from the server\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      */\n  getData: function getData(params) {\n    return this.getPropertyData($.extend(params, {\n      property: \"data\" }));\n\n  },\n  /*\r\n      *   Refresh the data property from the server\r\n      *   This version is to fetch search data\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      *   -   term\r\n      */\n  getSearchData: function getSearchData(params) {\n    var self = this;\n    params.extra = params.extra || {};\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\n\n    return this.getPropertyData($.extend(params, {\n      property: \"data\" }));\n\n  },\n\n  /*\r\n      * Refresh tha data property from the server\r\n      * Params:\r\n      *   -   collapsestate\r\n      */\n  getCollapseData: function getCollapseData(params) {\n    var self = this;\n    params.extra = params.extra || {};\n\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\n\n    return this.getPropertyData($.extend(params, {\n      property: \"collapseState\" }));\n\n  },\n\n  /*\r\n      *   Refresh the data property from the server\r\n      *   This version is to fetch grid data\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      *   -   sort\r\n      *   -   page\r\n      *   -   rows\r\n      */\n  getGridData: function getGridData(params) {\n    var self = this;\n    params.extra = params.extra || {};\n\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\n\n    return this.getPropertyData($.extend(params, {\n      property: \"data\" }));\n\n  },\n\n  getGridDataExclusivesSelected: function getGridDataExclusivesSelected(params) {\n    var self = this;\n    params.extra = params.extra || {};\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\n    return this.getPropertyData($.extend(params, {\n      property: \"exclusivesSelected\" }));\n\n  },\n\n  /*\r\n      *   Returns the upload plugin cancel image\r\n      */\n  getUploadCancelImage: function getUploadCancelImage() {\n    return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\n  },\n  /*\r\n      *   Returns the upload file url for each file\r\n      */\n  getUploadFileUrl: function getUploadFileUrl(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"fileContent\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n\n  downloadFile: function downloadFile(params) {\n    var self = this;\n    var fileUrl = self.getUploadFileUrl(params);\n\n    return $.ajax({\n      url: fileUrl,\n      type: \"GET\",\n      queue: params.queue,\n      dataType: \"binary\",\n      processData: false //Always false for binary dataType\n    }).\n    then(function (binary_file) {\n      if (binary_file.type == \"application/json\") {\n        return self.readFileAsJSON(binary_file);\n      }\n\n      if (typeof binary_file == \"string\") {\n        var xhr = arguments[2];\n        var contentType = xhr.getResponseHeader('Content-type');\n        binary_file = bizagi.util.media.byteArrayToBlob(self.stringToByteArray(binary_file), contentType);\n      }\n      return binary_file;\n    });\n  },\n\n  readFileAsJSON: function readFileAsJSON(binary_file) {\n    var def = new $.Deferred();\n    var reader = new FileReader();\n    reader.onloadend = function () {\n      def.reject({ responseText: reader.result });\n    };\n    reader.readAsText(binary_file);\n    return def.promise();\n  },\n\n  stringToByteArray: function stringToByteArray(binary) {\n    return bizagi.util.stringToByteArray(binary);\n  },\n\n\n  getUploadFileEntityUrl: function getUploadFileEntityUrl(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\n    if (params.isContextContainerWidgetRender) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\n    } else {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\n    }\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n\n  /*\r\n      *   Returns the upload add url\r\n      */\n  getUploadAddUrl: function getUploadAddUrl() {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n  },\n  /*\r\n      *   Returns the upload add url\r\n      */\n  getUploadAddFileUrl: function getUploadAddFileUrl(isUserPreferences) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\n    var data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = isUserPreferences === true ? \"SAVEUSERIMAGE\" : \"savefile\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n  },\n\n  deleteImage: function deleteImage(params) {\n    var self = this;\n\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // Log submit data\n    bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n\n  /*\r\n      *   Returns the upload add url\r\n      */\n  deleteUploadFile: function deleteUploadFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // Log submit data\n    bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n\n  },\n  /*\r\n      * Return file meta data\r\n      */\n  getECMMetadata: function getECMMetadata(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"getECMMetadata\";\n    data.idFileUpload = params.idFileUpload;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    if (params.sessionId) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    }\n    // Log submit data\n    bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      interceptor: {\n        intercept: true,\n        source: \"rendering_\" + self.guid } });\n\n\n\n  },\n  /*\r\n      * Checkout a file\r\n      **/\n  checkOutFile: function checkOutFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"checkOutFile\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n\n    // Log submit data\n    bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      * cancelCheckOut\r\n      **/\n  cancelCheckOut: function cancelCheckOut(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"cancelCheckOut\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      * Checkout a file\r\n      **/\n  deleteECMFile: function deleteECMFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"delete\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *  Update ECM file content\r\n      **/\n  updateECMFileContent: function updateECMFileContent(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"updateECMFileContent\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n\n    data.metaValues = params.metaValues;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *  Update file content\r\n      **/\n  updateECMMetadata: function updateECMMetadata(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"updateECMMetadata\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n\n    data.metaValues = params.metaValues;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  getFileProperties: function getFileProperties(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"getFileProperties\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      interceptor: {\n        intercept: true,\n        source: \"rendering_\" + self.guid } });\n\n\n  },\n  getFile: function getFile(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"fileContent\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\n\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || url,\n      data: jQuery.param(data),\n      type: \"POST\",\n      dataType: \"binary\",\n      processData: false });\n\n  },\n  uploadECMFile: function uploadECMFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"uploadECMFile\";\n    data.fileUpload = params.fileUpload; // Content of file\n    data.xPath = params.xPath;\n\n    data.idAttrib = params.idAttrib;\n    data.fileName = params.fileName;\n    data.metaValues = params.metaValues;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n\n    // Log submit data\n    bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  getECMFileUrl: function getECMFileUrl(params) {\n    var self = this;\n    var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\n\n    // Define data\n    var data = params.extra || {};\n\n    data.action = \"viewECMFile\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n\n    data.fileName = params.fileName;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n    if (params.sessionId) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    }\n    if (params.p_sessionId) {\n      data.p_sessionId = params.p_sessionId;\n    }\n\n\n    // Log submit data\n    bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n  /*\r\n      *\r\n      */\n  isFileOnECM: function isFileOnECM(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    data[\"action\"] = \"isFileOnECM\";\n    data[\"idUpload\"] = params.idUpload;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\n  },\n  /*\r\n      *   Start a grid record edition\r\n      */\n  editGridRecord: function editGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"EDITRELATION\" });\n\n  },\n  /*\r\n      *   Sends a grid request to add a new row\r\n      *   The server returns the new row in json\r\n      */\n  addGridRecord: function addGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Log submit data\n    bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\n\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"ADDRELATION\" });\n\n  },\n  /*\r\n      *   Sends a grid request to add a new row, and sending the data at the same time\r\n      *   The server returns the new row in json\r\n      */\n  addGridRecordData: function addGridRecordData(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Build data to submit\n    var submitData = params.submitData || {};\n    for (key in submitData) {\n      data[key] = submitData[key];\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"ADDRELATIONWITHDATA\" });\n\n  },\n  /*\r\n      *   Submits the grid record data to the server\r\n      */\n  saveGridRecord: function saveGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\n\n    // Send the submitted data page cache because it cointains the grid's form page cache\n    if (params.submitData.idPageCache) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\n      delete params.submitData.idPageCache;\n    }\n\n    var submitData = params.submitData || {};\n\n    // Build data to submit\n    submitData = self.processDataValues(submitData);\n\n    for (key in submitData) {\n      data[key] = submitData[key];\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SAVERELATION\" });\n\n  },\n  /*\r\n      *   Deletes a grid record in the server\r\n      */\n  deleteGridRecord: function deleteGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"REMOVERELATION\" });\n\n  },\n\n  /*\r\n      * Get association flipped status\r\n      */\n  getFlipAssociation: function getFlipAssociation(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log request data\n    bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"text\" }).\n    pipe(function (response) {\n      try {\n        // Try to attempt to parse JSON\n        return bizagi.services.ajax.parseJSON(response);\n      } catch (e) {\n        // If JSON is not valid we need to return the original text response\n        return response;\n      }\n    });\n  },\n  /*\r\n      *   Cancels an add or edit request for a grid\r\n      */\n  rollbackGridAction: function rollbackGridAction(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"ROLLBACK\" });\n\n  },\n  /*\r\n      *   Returns the search render default image\r\n      */\n  getSearchDefaultImage: function getSearchDefaultImage() {\n    return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\n  },\n\n  processDataCriteria: function processDataCriteria(criteria) {\n    var o;\n    criteria = $.extend(true, [], criteria);\n    for (o in criteria) {\n      if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\n        // for search\n        if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\n          criteria[o].value = criteria[o].value.id;\n        }\n      }\n    }\n    return criteria;\n  },\n\n  /*\r\n      *   Perform entity search in the server\r\n      */\n  submitSearch: function submitSearch(params) {\n    var self = this,criteria;\n\n    // Define data\n    var data = params.extra || {};\n\n    var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\n\n    if (params.order && params.order !== \"\" && sort !== \"\")\n    sort += \" \" + params.order;\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\n\n    criteria = self.processDataCriteria(params.criteria);\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\n\n    // Optional search params\n    if (params.allowFullSearch)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\n    if (params.maxRecords)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\n\n    // Log submit data\n    bizagi.debug(\"Performing advanced search\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SEARCHENTITYFORRENDER\" });\n\n  },\n\n  /*\r\n      *   Submits the stakeholder associated\r\n      */\n  associateStakeholder: function associateStakeholder(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\n    data[\"associatedUser\"] = params.associatedUser;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\n\n    // Log submit data\n    bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    // TODO: change REST library in order to support extra HTTP parameters\n    // Please be careful with dataType parameter\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\" });\n\n  },\n\n  /*\r\n      *   Refresh the stakeholder associated list\r\n      */\n  refreshAssociateStakeholder: function refreshAssociateStakeholder(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Log submit data\n    bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    // TODO: change REST library in order to support extra HTTP parameters\n    // Please be careful with dataType parameter\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\" });\n\n  },\n\n  /*\r\n      *   Gets the link to the letter\r\n      */\n  getLetterNotEditableUrl: function getLetterNotEditableUrl(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Call ajax and returns promise\n    var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n  },\n  /*\r\n      *   Gets the content for editable letters\r\n      */\n  getLetterContent: function getLetterContent(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"html\" }).\n    pipe(function (response) {\n      try {\n        return bizagi.services.ajax.parseJSON(response);\n      } catch (e) {\n        return response;\n      }\n    });\n  },\n  /*\r\n      *   Get the can generate letter flag\r\n      */\n  getCanGenerateLetter: function getCanGenerateLetter(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *   Saves the content for editable letters\r\n      */\n  saveLetterContent: function saveLetterContent(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Define content\n    var content = params.content || \"\";\n\n    // Define url\n    var url = params.url || self.serviceLocator.getUrl(\"render-letter-save-url\");\n    var fullUrl = url + \"?\" + jQuery.param(data);\n\n    // Log submit data\n    bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: fullUrl,\n      data: content,\n      type: \"POST\",\n      dataType: \"html\" });\n\n  },\n  /*\r\n      *   Returns the icons path for the letter plugin\r\n      */\n  getLetterEditorIconsPath: function getLetterEditorIconsPath() {\n    return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\n  },\n  /*\r\n      *   Executes a button action in the server\r\n      */\n  executeButton: function executeButton(params) {\n    return this.getPropertyData($.extend(params, {\n      property: \"buttonRule\" }));\n\n  },\n  /*\r\n      *   Executes a fileprint action in the server\r\n      */\n  getFilePrintUrl: function getFilePrintUrl(params) {\n\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n\n  },\n  /*\r\n      *   Start a link form edition\r\n      */\n  editLinkForm: function editLinkForm(params) {\n    // Actually it does the same than edit grid records\n    return this.editGridRecord(params);\n  },\n  /*\r\n      *   Saves the content of the link form\r\n      */\n  saveLinkForm: function saveLinkForm(params) {\n    // Actually it does the same than edit grid records\n    //return this.saveGridRecord(params);\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Send the submitted data page cache because it cointains the grid's form page cache\n    if (params.submitData.idPageCache) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\n      delete params.submitData.idPageCache;\n    }\n\n    var submitData = params.submitData || {};\n\n    // Build data to submit\n    submitData = self.processDataValues(submitData);\n\n    for (key in submitData) {\n      data[key] = submitData[key];\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SAVEFORMLINKRELATION\" });\n\n  },\n  /*\r\n      *   Rollbacks the link form edition\r\n      */\n  rollbackLinkForm: function rollbackLinkForm(params) {\n    // Actually it does the same than rollback grid records\n    return this.rollbackGridAction(params);\n  },\n  /*   Commit the link form edition\r\n      */\n  commitLinkForm: function commitLinkForm(params) {\n    // Actually it does the same than rollback grid records\n    return this.commitGridAction(params);\n  },\n  /*   Sends schekpoint action\r\n      */\n  sendCheckpoint: function sendCheckpoint(params) {\n    // Actually it does the same than rollback grid records\n    return this.sendCheckpointAction(params);\n  },\n  /*\r\n      *   Loads the userfield definition\r\n      */\n  getUserfieldDefinition: function getUserfieldDefinition(params) {\n    var self = this;\n    params = params || {};\n\n    // Check in deferreds cache\n    if (self.userfieldRequests[params.userfield])\n    return self.userfieldRequests[params.userfield];\n\n    // Required params: idCase\n    self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\n    {\n      guidUserfield: params.userfield,\n      device: params.device || \"desktop\" });\n\n\n\n    // Return deferred\n    return self.userfieldRequests[params.userfield];\n  },\n  /**\r\n      *  Get render json for one render o container\r\n      *  @param {object} params object with idRender,idPageCache\r\n      */\n  refreshControl: function refreshControl(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n    params.idForm ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"PARTIALREFRESH\" });\n\n  },\n  /**\r\n      *  Get render json for one render o container\r\n      *  @param {object} params object with idRender,idPageCache\r\n      */\n  refreshGridCell: function refreshGridCell(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.idForm ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\n    params.typeRender ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /**\r\n      * Request to execute rule on server\r\n      * @param {object} params h_pageCacheId, guidrule\r\n      */\n  executeRule: function executeRule(params) {\n    var self = this;\n\n\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n  /**\r\n      * Request to execute interface on server\r\n      * @param {object} params h_pageCacheId, guidinterface\r\n      */\n  executeInterface: function executeInterface(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params[\"interface\"] || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n  /**\r\n      * Request to execute SAP Connecor\r\n      * @param {object} params h_pageCacheId, guidinterface\r\n      */\n  executeSAPConnector: function executeSAPConnector(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n  /**\r\n      * Request to execute a Bizagi connector\r\n      * @param params\r\n      * @return {{}}\r\n      */\n  executeConnector: function executeConnector(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n\n  /**\r\n      * Request to execute pipeline on server\r\n      * @param {object} params h_pageCacheId, guidpipeline\r\n      */\n  executePipeline: function executePipeline(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEPIPELINE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidpipeline\"] = params.pipeline || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n\n  /*\r\n      *   Document Templates generate rest service\r\n      */\n  generateDocumentTemplate: function generateDocumentTemplate(params) {\n    var self = this;\n    params = params || {};\n    params.append = params.append ? params.append : false;\n\n    return $.create(\n    self.serviceLocator.getUrl(\"render-document-generate\"),\n    {\n      h_pageCacheId: params.idPageCache,\n      contextXpath: params.xpathcontext,\n      groupMappingId: params.groupMapping,\n      xpathAttribute: params.xpath,\n      append: params.append,\n      controlId: params.id });\n\n\n  },\n  /*\r\n      *   Document Templates generate rest service\r\n      */\n  getAllDocumentsDownloadUrl: function getAllDocumentsDownloadUrl(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\n    var data = {};\n    data[\"h_pageCacheId\"] = params.idPageCache;\n    data[\"contextXpath\"] = params.xpathContext;\n    data[\"xpathAttribute\"] = params.xpath;\n    data[\"idCase\"] = params.idCase;\n    data[\"idWorkItem\"] = params.idWorkItem;\n    data[\"p_sessionId\"] = params.sessionId;\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n\n  },\n\n\n  getCaseNumber: function getCaseNumber(params) {\n    var self = this;\n    //this function use sendEMail\n    //and not possible use dat ain ajax\n    //this is workaround (rhonyp)\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\n      type: \"GET\",\n      dataType: \"json\" });\n\n  },\n\n  getCaseAssignees: function getCaseAssignees(params) {\n    var self = this;\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\n      idCase: params.idCase }).\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    params = params || {};\n\n    return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\n      idCase: params.idCase,\n      onlyUserWorkItems: params.onlyUserWorkItems || \"\" });\n\n  },\n  /*\r\n      *   Executes a grid export action in the server\r\n      */\n  getGridExportUrl: function getGridExportUrl(params) {\n\n    var self = this,\n    url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\n    data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n\n  /*\r\n      * Executes a send email action in the server\r\n      */\n  sendEmail: function sendEmail(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n\n    // Email parameters\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * Request to invalidates page cache in server, since it is no needed anymore\r\n      */\n  invalidatePageCache: function invalidatePageCache(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"INVALIDATEPAGECACHE\" });\n\n  },\n\n  /*\r\n      * Search users usign parameters suchs as userName, fullName, domain and organization\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersList: function getUsersList(params) {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\n  },\n  /*\r\n     * Search users usign parameters suchs as userName, fullName, domain and organization\r\n     * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n     * @return {deferred} ajax object with JSON content\r\n     */\n  getUsersListFromQueryForm: function getUsersListFromQueryForm(params) {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl(\"render-query-getUsersList\"), params);\n  },\n  /*\r\n      * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersListFromPreferences: function getUsersListFromPreferences(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\n  },\n\n  /**\r\n      * Get Users when the context is the boss field and User Form\r\n      * @param {*} params \r\n      */\n  getUsersListForXpathIdBossUser: function getUsersListForXpathIdBossUser(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForXpathIdBossUser\"), params);\n  },\n\n  /**\r\n      * Get Users when the context is the delegate field and User Form\r\n      * @param {*} params \r\n      */\n  getUsersListForXpathIdDelegate: function getUsersListForXpathIdDelegate(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForXpathIdDelegate\"), params);\n  },\n\n  /*\r\n      * Search users for Stakeholders\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersListForStakeholders: function getUsersListForStakeholders(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\n  },\n\n  /*\r\n      * Search users usign parameters suchs as userName, fullName, domain and organization\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersForAssignation: function getUsersForAssignation(params) {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\n  },\n\n  /**\r\n      * Get Users Creation/Edition Form\r\n      */\n  getUsersForm: function getUsersForm(params) {\n    var self = this;\n    return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\n  },\n  /**\r\n      *   Return generate Data To Send By Email\r\n      */\n  generateDataToSendByEmail: function generateDataToSendByEmail(params) {\n    var self = this;\n    params = params || {};\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\n      data: params,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /**\r\n      * Return generate Send user password Mail\r\n      */\n  sendUserEmail: function sendUserEmail(params) {\n    var self = this;\n    params = params || {};\n    var data = {\n      action: \"SendUserEmail\",\n      emailTo: params.eMailTo,\n      subject: params.subject,\n      body: params.body };\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\n      data: params,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n\n  /**\r\n      * Get bizagi configuration\r\n      * @param {Function}   type callback function when the file load is succed\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getConfiguration: function getConfiguration() {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"admin-users-config\");\n\n    return $.read(url);\n  },\n\n  /**\r\n      * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n      */\n  verifyPathToBase: function verifyPathToBase(pathToBase, url) {\n\n    if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\n      return url;\n    } else {\n      return pathToBase + url;\n    }\n\n  },\n\n  /**\r\n      * Get template of entity\r\n      * @param params { guid, prepare}\r\n      */\n  getTemplate: function getTemplate(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\n\n    if (params.templateType) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\n    }\n\n    if (params.templateGuid) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\n    }\n\n    if (params.isDefaultTemplate != undefined) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\n    }\n\n    // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\n    // and the service recives either tablet or smartphone\n    var deviceType = bizagi.util.detectDevice();\n    if (bizagi.util.isTabletDevice()) {\n      deviceType = \"tablet\";\n    } else if (bizagi.util.isSmartphoneDevice()) {\n      deviceType = \"mobile\";\n    }\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\n\n    // When prepare is true just return data, this feature is used by multiaction service\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\n  },\n\n  /**\r\n      * Chek if an entity has startform\r\n      * @param params\r\n      * @return {*}\r\n      */\n  hasStartForm: function hasStartForm(params) {\n    var self = this;\n    var data = {};\n\n    if (params.guidWFClass) {\n      data.guidWFClass = params.guidWFClass;\n    }\n\n    return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\n  },\n\n  /**\r\n      * Get the start form of the case\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getStartForm: function getStartForm(params) {\n    var self = this;\n    var data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\n\n    if (params.idStartScope) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\n    }\n    if (params.idCase) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\n    }\n    if (params.idStartScope) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\n    }\n    if (params.idWorkitem) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\n    }\n    if (params.additionalXpaths) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\n    }\n    if (params.surrogatedKey) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\n    }\n    if (params.recordXpath) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\n    }\n    if (params.mappingstakeholders) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\n    }\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      cache: true });\n\n  },\n  /*\r\n      *   Start a link form edition\r\n      */\n  editActionForm: function editActionForm(params) {\n    // Actually it does the same than edit grid records\n    return this.editGridRecord(params);\n  },\n\n  /**\r\n      * Get list of actions in action launcher\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getActions: function getActions(params) {\n    var self = this;\n    var extendParams = $.extend(params, { prepare: true });\n\n    var data = self.getPropertyData(extendParams) || [];\n\n    if (params.ptags) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\n    }\n\n    if (params.pmaxitems) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\n    }\n\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\",\n      beforeSend: function beforeSend(xhr, status) {\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } });\n\n\n  },\n\n  /**\r\n      * Execute actions or constructors\r\n      * @param params\r\n      */\n  executeActions: function executeActions(params) {\n    var self = this;\n    var extendParams = $.extend({}, params, { prepare: true });\n    var data = self.getPropertyData(extendParams) || [];\n\n    if (params.pguidConstructor) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\n    }\n\n    if (params.pguidAction) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\n    }\n    if (params.prepare) {\n      return data;\n    }\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\" });\n\n\n  },\n\n  /**\r\n      * Get list of actions in action launcher\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getPolymorphicActions: function getPolymorphicActions(params) {\n    var self = this;\n    var extendParams = $.extend(params, { prepare: true });\n    var data = self.getPropertyData(extendParams) || [];\n\n    if (params.ptags) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\n    }\n\n    if (params.additionalXpaths) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\n    }\n\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\" });\n\n  },\n\n  /**\r\n      * Make a JSON tree of polymorphic constructors categories\r\n      * @param values\r\n      * @return {Array}\r\n      */\n  serializePolymorphicActions: function serializePolymorphicActions(values) {\n    // json serializer\n    var actions = [];\n    var GUID_ENTITY = 0,DISPLAY_NAME = 1,XPATHCONTEXT = 2,TYPE = 3,GUID_OBJECT = 4,GUID_CONSTRUCTOR = 5,GUID_PARENT_ENTITY = 6;\n\n    /**\r\n                                                                                                                                 * Get children by guid of entity\r\n                                                                                                                                 * @param guid\r\n                                                                                                                                 * @return {Array}\r\n                                                                                                                                 */\n    var getChildren = function getChildren(guid) {\n      var children = [];\n      guid = guid || \"\";\n\n      $.each(values, function (key, value) {\n        if (value[GUID_PARENT_ENTITY] == guid) {\n          children.push(value);\n        }\n      });\n      return children;\n    };\n\n    /**\r\n        * Get parents by action object\r\n        * @param node\r\n        * @return {string}\r\n        */\n    var getParents = function getParents(node) {\n      node = node || {};\n      var parents = \"\";\n\n      $.each(values, function (key, value) {\n        if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\n          parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\n        }\n      });\n      return parents;\n    };\n\n\n    /**\r\n        * Make a tree of actions\r\n        * @param list\r\n        * @param guid\r\n        * @return {*}\r\n        */\n    var fillTree = function fillTree(list, guid) {\n      var node;\n      var children = getChildren(guid);\n      $.each(children, function (key, value) {\n        var child = fillTree([], value[GUID_ENTITY]);\n        node = {\n          \"guidEntity\": value[GUID_ENTITY],\n          \"displayName\": value[DISPLAY_NAME],\n          \"hasConstructor\": value[GUID_CONSTRUCTOR] ? true : false,\n          \"type\": value[TYPE],\n          \"guidObject\": value[GUID_OBJECT],\n          \"guidConstructor\": value[GUID_CONSTRUCTOR],\n          \"xpathContext\": value[XPATHCONTEXT],\n          \"children\": child,\n          \"parents\": getParents(value) };\n\n        if (node.guidConstructor !== \"\" || node.children.length > 0) {\n          list.push(node);\n        }\n      });\n\n      return list;\n    };\n    fillTree(actions, \"\");\n    return actions;\n  },\n\n  /**\r\n      * Gets the image for an entity xpath\r\n      * @param params\r\n      */\n  getEntityImage64: function getEntityImage64(params) {\n    var self = this,\n    data = {\n      width: params.data,\n      height: params.height,\n      xpath: params.xpath },\n\n    url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\n\n    return $.ajax({\n      url: url,\n      data: data });\n\n  },\n\n  /**\r\n      * Get data files when user access from my stuff, because there is no scope\r\n      */\n  getFilesDataForLayoutUploadControl: function getFilesDataForLayoutUploadControl(params) {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\n  },\n\n  /**\r\n      * Process an upload file into the server\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  processUploadFile: function processUploadFile(params) {\n    return $.ajax({\n      url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\n      data: params.formData,\n      type: \"POST\",\n      contentType: false,\n      processData: false });\n\n  },\n\n  /**\r\n      * Commit an add or edit request for a grid\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  commitGridAction: function commitGridAction(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"COMMIT\" });\n\n  },\n  /*\r\n      *   Commit an add or edit request for a grid\r\n      */\n  sendCheckpointAction: function sendCheckpointAction(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"CHECKPOINT\" });\n\n  },\n\n  /**\r\n      * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n      */\n  verifyMobilePathToBase: function verifyMobilePathToBase(pathToBase, url) {\n    return bizagi.util.isMashupContext() ? (url || \"\").replaceAll(pathToBase, \"\") : url;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to multiaction rendering REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"pageCacheId\" },\n{\n\n  /* \r\n  *   Constructor\r\n  */\n  init: function init(service, limit, queue) {\n    this.service = service;\n    this.serviceLocator = service.serviceLocator;\n\n    // Multiaction - batch stuff\n    this.batch = {};\n    this.batchTimer = 50;\n    this.maxNumberOfActions = limit || 0;\n    this.queue = queue || null;\n    this.deferredBatchExecuting = $.Deferred();\n    this.deferredBatchExecuting.resolve();\n    this.disabledRequests = false;\n    this.circularDependencies = new bizagi.circularDependencies();\n\n    // Create proxyed version of methods\n    this.replicateServiceMethods();\n  },\n\n  /*\r\n     *   Returns the internal service\r\n     */\n  getService: function getService() {\n    return this.service;\n  },\n\n  /*\r\n     *   Create a proxied multiaction version for service calls\r\n     */\n  replicateServiceMethods: function replicateServiceMethods() {\n    var self = this;\n    for (var key in this.service.Class.prototype) {\n      // Omit the folowing methods\n      if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\n\n      // Replicate instance methods\n      self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\n    }\n  },\n\n  /*\r\n     *   Perform the proxy call for each service method\r\n     */\n  proxyMethod: function proxyMethod(method, parameters) {\n    var service = this.service;\n\n    // Check if has only one argument, else execute directly\n    if (!parameters || parameters.length != 1) {\n      return method.apply(service, parameters);\n    }\n\n    // Check if the argument is object, else execute directly\n    if (_typeof(parameters[0]) != \"object\") {\n      return method.apply(service, parameters);\n    }\n\n    var params = parameters[0];\n\n    // If the caller is requesting a prepare call, just execute the method with the current parameters\n    if (params.prepare == true) return method.apply(service, parameters);\n\n    // Prepare the ajax instead of sending it\n    var originalPrepare = params.prepare;\n    params.prepare = true;\n\n    var action = method.apply(service, parameters);\n    if (originalPrepare === undefined || originalPrepare == null) delete params.prepare;else\n    params.prepare = originalPrepare;\n    return this.add(action);\n  },\n\n  /**\r\n     * This method make a standard error message\r\n     */\n  makeCircularDependenciesError: function makeCircularDependenciesError(error) {\n    var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\n\n    return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\n  },\n\n\n  /*\r\n     *   Add an action to be performed in a multiaction, and be resolved later\r\n     *   returns a deferred\r\n     */\n  add: function add(action) {\n    var self = this;\n    var deferred = new $.Deferred();\n\n    var name = action.h_action || \"unnamed\";\n\n    // Put here all actions to ignore in circular dependencies\n    var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\", \"GETFILE\"];\n\n    if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\n      self.circularDependencies.addNode(name, action);\n    }\n\n    // First clear previous timeout\n    clearTimeout(self.batchTimeout);\n    var tag = action.tag = Math.guid();\n    var singleAction = { action: action, deferred: deferred };\n    self.batch[tag] = singleAction;\n\n    var fn = function fn() {\n      var resolveDependencies = self.circularDependencies.resolve();\n\n      if (resolveDependencies.error) {\n        // Reset Queue\n        for (var i in self.batch) {\n          var message = resolveDependencies.error.multiactionError;\n          self.batch[i].deferred.reject(message);\n        }\n        self.batch = {};\n      } else\n      if (!self.disabledRequests) {\n        self.deferredBatchExecuting = self.fire();\n      }\n    };\n\n    // Start a new timeout\n    self.batchTimeout = setTimeout(fn, self.batchTimer);\n\n    // If we have a limit, then fire it again\n    if (self.maxNumberOfActions != 0) {\n      if (Object.keys(self.batch).length >= self.maxNumberOfActions) {\n        clearTimeout(self.batchTimeout);\n        fn();\n      }\n    }\n\n    return deferred.promise();\n  },\n  /*\r\n     *   Fires up the multiaction\r\n     */\n  fire: function fire() {\n    var self = this;\n    var batch = {};\n\n    // Prepare actions and clone batch manually\n    var actions = [];\n    $.each(self.batch, function (tag, item) {\n      actions.push(item.action);\n      batch[tag] = item;\n    });\n\n    // Reset batch\n    self.batch = {};\n\n    // Fire ajax \n    return $.when(self.execute({ actions: actions, rejectDeferreds: false })).\n    done(function (responses) {\n\n      // Process each response\n      $.each(responses, function (i, response) {\n        var tag = response.tag;\n        if (!response.error) {\n          batch[tag].deferred.resolve(response.result);\n        } else {\n          batch[tag].deferred.reject(response.error, response, response.error.message);\n        }\n\n        // Remove paired tag from collection\n        delete batch[tag];\n      });\n\n      // Check if there are unpaired actions so we need to trigger fail deferred\n      $.each(batch, function (i, item) {\n        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\n      });\n    }).fail(function (xhr, type, error) {\n\n      // Check if there are unpaired actions so we need to trigger fail deferred\n      var errorMessage = typeof error !== \"undefined\" ? error.message : error || \"Operation didn't executed\";\n      $.each(batch, function (i, item) {\n        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\n      });\n    });\n  },\n  /*\r\n     *   Sends a multiaction to the server\r\n     */\n  execute: function execute(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\n\n    // Check action tag\n    $.each(params.actions, function (i, action) {\n      action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\n      delete action.tag;\n    });\n\n    // Fill optional parameters\n    params = params || {};\n    if (params.actions) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\n    }\n\n    // Log submit data\n    bizagi.debug(\"Performing multi-action\", data);\n\n    // Call ajax and returns promise\n    var deferred = new $.Deferred();\n    $.ajax({\n      url: self.serviceLocator.getUrl(\"render-multiaction\"),\n      data: data,\n      queue: this.queue,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"MULTIACTION\",\n      beforeSend: function beforeSend(xhr, status) {\n        xhr.renderingService = true;\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } }).\n\n    done(function (responses) {\n      for (i in responses) {\n        if (typeof responses[i] !== \"function\") {\n          var response = responses[i];\n          if (response.error) {\n            if (rejectDeferreds) {\n              deferred.reject(response.error, \"servererror\", response);\n              return;\n            }\n\n          }\n        }\n      }\n      deferred.resolve(responses);\n\n    }).fail(function (xhr) {\n      var response = xhr.responseText || xhr;\n      var finalResponse = {};\n      // Try to parse the response\n      try {\n        finalResponse = JSON.parse(response);\n      } catch (e) {}\n      deferred.reject(xhr, \"servererror\", finalResponse);\n    });\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Disable the request, restart the form is mandatory who calls this method \r\n      * or unexpected behavior will happen on the form\r\n      */\n  disableRequests: function disableRequests() {\n    var self = this;\n    self.disabledRequests = true;\n  },\n\n  /**\r\n      * Identify if batch action is running, by default is resolved\r\n      * @returns Deferred object if batch action is running\r\n      */\n  validateIfBatchIsExecuting: function validateIfBatchIsExecuting() {\n    var self = this;\n    return self.deferredBatchExecuting;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Ricardo Perez\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n//$.Class.extend\n$.Class(\"bizagi.workportal.services.db\", {}, {\n  /* \r\n                                               *   Constructor\r\n                                               */\n  init: function init() {\n    var self = this;\n\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n\n    if (!self.disabledb) {\n      self.createDatabases();\n    }\n  },\n\n  /*\r\n     * Delete all Documents (databases)\r\n     * Example for callback : function (err, info) { }\r\n     * \r\n     */\n  _destroy: function _destroy(callback) {\n    this.deleteDatabases(callback);\n  },\n\n  createDatabases: function createDatabases() {\n    var self = this;\n    var globalIdHash = self.globalId.hashCode();\n\n    self.dbRecentProcesses = new PouchDB(\"RecentProcesses\" + globalIdHash, { auto_compaction: true }); // Recent process\n    self.dbProcessesHierarchy = new PouchDB(\"ProcessesHierarchy\" + globalIdHash, { auto_compaction: true }); // Process hierarchy to new cases creation\n    self.dbStartForms = new PouchDB(\"StartForms\" + globalIdHash, { auto_compaction: true }); // To save all forms for server\n    self.dbStartData = new PouchDB(\"StartData\" + globalIdHash, { auto_compaction: true }); // Save the data from forms    \n\n    //Offline forms in whole process\n    self.dbActivities = new PouchDB(\"Activities\" + globalIdHash, { auto_compaction: true }); // Save the offline tasks that can be worked with offline forms\n    self.dbActivityForms = new PouchDB(\"ActivityForms\" + globalIdHash, { auto_compaction: true });\n    self.dbActivityData = new PouchDB(\"ActivityData\" + globalIdHash, { auto_compaction: true }); // Cases in outbox that will be advanced\n    self.dbProcessColumns = new PouchDB(\"ProcessColumns\" + globalIdHash, { auto_compaction: true }); // Custom Columns (and metadata) for each Process\n  },\n\n  deleteDatabases: function deleteDatabases(callback) {\n    var def = new $.Deferred();\n    var self = this;\n\n    var databases = [\n    self.dbRecentProcesses,\n    self.dbProcessesHierarchy,\n    self.dbStartForms,\n    self.dbStartData,\n    self.dbActivities,\n    self.dbActivityForms,\n    self.dbActivityData,\n    self.dbProcessColumns];\n\n\n    var databasesDeleted = 0;\n    if (typeof callback === \"undefined\") {\n      callback = function callback(err, info) {\n        if (err) {\n          def.reject(err);\n        } else\n        {\n          databasesDeleted++;\n          if (databasesDeleted == databases.length) {\n            def.resolve(\"All db deleted successfully\");\n          }\n        }\n      };\n    }\n\n    databases.forEach(function (database) {\n      database.destroy(callback);\n    });\n\n    return def.promise();\n  },\n\n  restartDatabases: function restartDatabases() {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.deleteDatabases()).\n    done(function () {\n      self.createDatabases();\n      def.resolve();\n    }).\n    fail(function () {\n      self.createDatabases();\n      def.resolve();\n    });\n    return def.promise();\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n    return objects;\n  },\n\n  /*\r\n     *   This method return all the open cases for the user authenticated from de DB\r\n     *   Returns a promise\r\n     */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbStartData.query({ map: map }, { reduce: false }, function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  } });","/*\r\n*   Name: Bizagi Template Services\r\n*   Author: Bizagi UI Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to all templates available on bizagi\r\n*/\n\n$.Class.extend(\"bizagi.kendo.templates.services.service\", {\n  // Static templates\n  customTemplateFile: bizagi.loader.getResource(\"tmpl\", \"bizagi.overrides.\" + bizagi.detectDevice() + \".custom.templates\"),\n  cachedFiles: {},\n  cachedTemplates: {},\n  customTemplates: {} },\n{\n  /* \r\n  *   Constructor\r\n  */\n  init: function init(localization) {\n    this.localization = localization;\n    this.cssRegex = /{{css \"(.+)\"}}/g;\n    this.loadingFileDeferred = {};\n  },\n\n  /*\r\n     *   Load custom templates info in order to override framework stuff\r\n     */\n  loadCustomTemplates: function loadCustomTemplates() {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(this.getTemplateFile(this.Class.customTemplateFile)).\n    done(function (response) {\n      var temp = $(\"<div />\").html(response);\n      var responseParts = $(\"script\", temp);\n\n      $.each(responseParts, function (i, responsePart) {\n        responsePart = $(responsePart);\n        self.Class.customTemplates[responsePart.attr(\"id\")] = responsePart.html();\n      });\n\n      defer.resolve();\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Returns the template from cache or from ajax\r\n     *   Must return a deferred\r\n     */\n  getTemplate: function getTemplate(template, id) {\n    var self = this;\n    var isCustomTemplate = false;\n\n    // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\n    template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\n\n    // If the template contains the hash before the question mark, we need to exchange them\n    template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\n\n    if (bizagi.enableCustomizations) {\n      var hash = self.getHash(template);\n\n      // Check if a custom template has been given in order to override it\n      if (self.Class.customTemplates[hash]) {\n        isCustomTemplate = true;\n      }\n    }\n\n    if (isCustomTemplate || bizagi.loader.environment !== \"release\") {\n      return this.internalGetTemplate(template, id).\n      pipe(function (resolvedTemplate) {\n        // Creates a in-memory element to hold the template\n        return resolvedTemplate;\n      });\n    } else {\n      return this.getTemplateForRelease(template, id).\n      pipe(function (resolvedTemplate) {\n        return resolvedTemplate;\n      });\n    }\n  },\n\n  /*\r\n      *   Returns the template from cache or from ajax\r\n      *   Must return a deferred\r\n      */\n  getTemplateWidget: function getTemplateWidget(template, id) {\n    var self = this;\n    var isCustomTemplate = false;\n\n    // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\n    template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\n\n    // If the template contains the hash before the question mark, we need to exchange them\n    template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\n\n    if (bizagi.enableCustomizations) {\n      var hash = self.getHash(template);\n\n      // Check if a custom template has been given in order to override it\n      if (self.Class.customTemplates[hash]) {\n        isCustomTemplate = true;\n      }\n    }\n\n    if (isCustomTemplate || bizagi.loader.environment !== \"release\") {\n      return this.internalGetTemplate(template, id).\n      pipe(function (resolvedTemplate) {\n        // Creates a in-memory element to hold the template\n        return resolvedTemplate;\n      });\n    } else {\n      return this.getTemplateForRelease(template, id).then(function (resolvedTemplate) {\n        return resolvedTemplate;\n      });\n    }\n  },\n\n  /*\r\n     *   Returns the template from cache or from ajax\r\n     *   Must return a deferred\r\n     */\n  getTemplateWebpart: function getTemplateWebpart(template, id) {\n    // If the template contains double hash, it's because its in release mode, then we got to ignore the first hash\n    template = template.replace(/([^#]*#)([^#]*#)([^#]*)/g, \"$1$3\");\n\n    // If the template contains the hash before the question mark, we need to exchange them\n    template = template.replace(/([a-zA-Z_\\/.-=]*)#([a-zA-Z_\\/.-]*)\\?(build=[a-zA-Z0-9.-]*)/g, \"$1?$3#$2\");\n    return this.internalGetTemplate(template, id).\n    pipe(function (resolvedTemplate) {\n      // Creates a in-memory element to hold the template\n      return resolvedTemplate;\n    });\n  },\n\n  /*\r\n     * Load the production template and return requested template\r\n     */\n  getTemplateForRelease: function getTemplateForRelease(template, id) {\n    var self = this;\n    var defer = $.Deferred();\n    var url;\n    var hash;\n\n    // extract url\n    if (self.containsHash(template)) {\n      url = self.getUrlWithoutHashes(template);\n      hash = self.getHash(template);\n    } else {\n      url = template;\n      hash = \"\";\n    }\n\n    var cachedTemplate = self.Class.cachedTemplates[url];\n\n    if (!cachedTemplate) {\n      $.when(self.loadTemplateFileForRelease(url)).\n      done(function () {\n        defer.resolve(self.processAndReturnTemplate(url, hash, id));\n      });\n\n    } else {\n      defer.resolve(self.processAndReturnTemplate(url, hash, id));\n    }\n\n    return defer.promise();\n  },\n\n  loadTemplateFileForRelease: function loadTemplateFileForRelease(url) {\n    var self = this;\n    var defer = $.Deferred();\n\n    // Check in cache\n    if (self.Class.cachedTemplates[url]) {\n      return self.Class.cachedTemplates[url];\n    }\n\n    // Check if it is already being loaded\n    if (self.loadingFileDeferred[url]) {\n      $.when(self.loadingFileDeferred[url]).\n      done(function () {\n        // Resolve with cached content\n        defer.resolve(self.Class.cachedTemplates[url]);\n      });\n      return defer.promise();\n    }\n\n    // Load file via ajax\n    self.loadingFileDeferred[url] = $.Deferred();\n    $.when($.ajax({ url: url, dataType: \"text\" }), self.localization.ready()).\n    done(function (response) {\n      if (!response)\n      defer.reject(\"\");\n\n      // response is an object\n      if (typeof response != \"string\")\n      response = JSON.parse(response[0]);\n\n      self.Class.cachedTemplates[url] = response;\n\n      // process templates for translate, remove CSS and generate global function template\n      var index;\n      var valueTemplate;\n      var translatedTemplate;\n\n      for (index in response) {\n        if (response.hasOwnProperty(index)) {\n          valueTemplate = response[index];\n          translatedTemplate = self.localization.translate(valueTemplate);\n\n          // Remove css tags\n          translatedTemplate = translatedTemplate.replace(self.cssRegex, \"\");\n          self.Class.cachedTemplates[url][index] = translatedTemplate;\n        }\n      }\n\n      self.loadingFileDeferred[url].resolve();\n      defer.resolve(response);\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n     * Return hashed template\r\n     */\n  processAndReturnTemplate: function processAndReturnTemplate(url, hash, id) {\n    var self = this;\n    var template = self.Class.cachedTemplates[id];\n\n    if (!template) {\n      template = self.Class.cachedTemplates[url][hash];\n\n      if (!template) {\n        throw \"template \" + template + \"doesn't exist\";\n      } else {\n        self.Class.cachedTemplates[id] = template;\n      }\n    }\n\n    return template;\n  },\n\n  /*\r\n     *   Returns the template from cache or from ajax\r\n     *   Must return a deferred\r\n     */\n  internalGetTemplate: function internalGetTemplate(template, id) {\n    var self = this;\n    var defer = new $.Deferred();\n    var cachedTemplate = this.Class.cachedTemplates[id];\n\n    if (!cachedTemplate) {\n\n      // Check if the template has a hash\n      if (self.containsHash(template)) {\n        var url = self.getUrlWithoutHashes(template);\n        var hash = self.getHash(template);\n\n        // Check if a custom template has been given in order to override it\n        if (self.Class.customTemplates[url]) {\n          // Resolve deferred\n          if (self.Class.customTemplates[url][id]) {\n            defer.resolve(self.Class.customTemplates[hash]);\n            return defer.promise();\n          }\n        }\n\n        $.when(self.getTemplatePart(url, hash, id)).\n        done(function (response) {\n          // Set in cache\n          self.Class.cachedTemplates[id] = response;\n\n          // Resolve deferred\n          defer.resolve(response);\n        });\n\n      } else {\n        // Gets the full template\n        $.when(self.getTemplateFile(template)).\n        done(function (response) {\n          self.Class.cachedTemplates[id] = response;\n          // Resolve deferred\n          defer.resolve(response);\n        });\n      }\n    } else {\n      defer.resolve(cachedTemplate);\n    }\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Gets a template part from a composite template file\r\n     *   Just load one template at a time to avoid multiple loadings of the same file\r\n     */\n  getTemplatePart: function getTemplatePart(templateUrl, hash) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // If it is already loading a template set a timeout to check later\n    $.when(self.loadingTemplatePartExecution).\n    done(function () {\n      // Set a async flag to synchronize this method\n      self.loadingTemplatePart = true;\n      self.loadingTemplatePartExecution = new $.Deferred();\n\n      // Load template file\n      $.when(self.getTemplateFile(templateUrl)).\n      done(function (response) {\n        var temp = $(\"<div />\").html(response);\n        var responsePart = $(\"#\" + hash, temp);\n\n        // Assertion to check that hash exists inside the main template                \n        if (BIZAGI_ENVIRONMENT === \"debug\" && responsePart.length === 0) {\n          console.warn(\"No template part (\" + hash + \") found in content for:\" + templateUrl);\n        }\n\n        // Set response\n        response = responsePart.html();\n\n        // Free async flag\n        self.loadingTemplatePartExecution.resolve();\n        self.loadingTemplatePart = true;\n\n        // Resolve main deferred\n        defer.resolve(response);\n      });\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Loads a full template file and keeps it on cache\r\n     */\n  getTemplateFile: function getTemplateFile(template) {\n    var self = this;\n    var cachedTemplate = this.Class.cachedFiles[template];\n\n    if (cachedTemplate) return cachedTemplate;\n\n    // Not found in cache, fetch it with ajax\n    return $.when($.ajax({ url: template, dataType: \"text\" }), self.localization.ready()).\n    pipe(function (response) {\n      // if no response has been found in the source file return an empty template\n      if (!response) return \"\";\n\n      if (typeof response != \"string\")\n      response = response[0];\n\n      // Translate template\n      var translatedTemplate = self.localization.translate(response);\n\n      // Find css and import them\n      var matches = translatedTemplate.match(self.cssRegex);\n\n      if (matches) {\n        $.each(matches, function (i, match) {\n          var cssFile = match.replace(self.cssRegex, \"$1\");\n\n          bizagi.loader.loadFile({ src: cssFile, type: \"css\", environment: \"debug\" });\n        });\n      }\n      // Remove css tags\n      translatedTemplate = translatedTemplate.replace(self.cssRegex, \"\");\n\n      // Set in cache\n      self.Class.cachedFiles[template] = typeof translatedTemplate === \"string\" ? translatedTemplate :\n      translatedTemplate[0].outerHTML;\n\n      return translatedTemplate;\n    });\n  },\n\n  /*\r\n     *   Check if a url contains hashes\r\n     */\n  containsHash: function containsHash(url) {\n    return url.indexOf(\"#\") !== -1;\n  },\n\n  /*\r\n     *   Get url hash\r\n     */\n  getHash: function getHash(url) {\n    return url.substring(url.indexOf(\"#\") + 1, url.length);\n  },\n\n  /*\r\n     *   Get url without hashes\r\n     */\n  getUrlWithoutHashes: function getUrlWithoutHashes(url) {\n    return url.substring(0, url.indexOf(\"#\"));\n  } });\n\n\nif (!bizagi.override.enableMSF) {\n\n  jQuery.fn.fastEmpty = function () {\n    $(this).kendoTmplEmpty();\n  };\n\n  jQuery.fasttmpl = function (tmpl, data) {\n    return jQuery.kendoTmpl(tmpl, data);\n  };\n\n  //jQuery.tmpl = function (tmpl, data) {\n  //    return jQuery.kendoTmpls(tmpl, data);\n  //};\n\n  jQuery.cacheTemplate = function (tmpl, data) {\n    jQuery.cacheKendoTemplate(tmpl, data);\n  };\n\n}\n// KENDO TEMPLATES\n\n/**\r\n *   Overrides detach method to apply custom stuff\r\n */\njQuery.fn.kendoTmplEmpty = function () {\n  this.children().remove();\n\n  // Check if it has loading property to apply plugin\n  var element = $(this);\n  if (element.hasClass(\"ui-bizagi-component-loading\")) {\n    element.loadingMessage();\n  }\n};\n\n/**\r\n    *   JQuery tmpl extension\r\n    */\njQuery.kendoTmpl = function (tmpl, data) {\n  if (typeof tmpl === \"undefined\") return \"\";\n\n  tmpl = tmpl.replace(/(\\n*)|(\\r*)|(\\t*)/g, \"\");\n  tmpl = tmpl.replace(/\\s+/g, \" \");\n\n  var tempTmpl = kendo.template(tmpl, { useWithBlock: false });\n  var html = tempTmpl(data);\n\n  return $.trim(html.replace(/>\\s*</g, \"><\"));\n};\n\njQuery.kendoTmpls = function (tmpl, data) {\n  return $(jQuery.kendoTmpl(tmpl, data));\n};\n\njQuery.cacheKendoTemplate = function (tmpl, data) {\n  var tempTmpl = bizagi.kendo.templates.services.service.cachedTemplates[tmpl];\n  return jQuery.kendoTmpl(tempTmpl, data);\n};","/**\r\n * System loader override to avoid workportalflat/webparts requests\r\n *\r\n * scoped in a function so we don't mess up system's vars\r\n */\n\n(function () {\n\n  // Creates or Defines steal loader\n  var steal = window.steal || {};\n  // Create or Define BizAgi namespace\n  var bizagi = window.bizagi || {};\n  bizagi.loader = bizagi.loader || {};\n\n  if (bizagi.loader.environment === \"release\") {\n\n    // Loader override methods\n    (function () {\n\n      var loaderOverride = {\n        /**\r\n                              * Auto called function when JS file is loaded to register its webparts\r\n                              * @param webpartName Array/String\r\n                              */\n        registerMobileWebpart: function registerMobileWebpart(webpartName) {\n\n          if (typeof webpartName === \"string\") {\n            webpartName = [webpartName];\n          }\n\n          this.webparts = this.webparts || {};\n\n          // Creates a dummy webpart for each one\n          webpartName.map(function (name) {\n            if (!this.webparts[name]) {\n              this.webparts[name] = {\n                \"class\": \"bizagi.workportal.webparts.\" + name,\n                devices: null,\n                location: \"\",\n                name: name,\n                js: [],\n                css: [],\n                tmpl: [] };\n\n            }\n            this.webparts[name].initialized = true;\n            this.webparts[name].initializing = false;\n            this.webparts[name].loadingDeferred = this.webparts[name].loadingDeferred || new $.Deferred();\n          }.bind(this));\n        } };\n\n\n      Object.keys(loaderOverride).map(function (key) {\n        bizagi.loader[key] = loaderOverride[key];\n      });\n\n    })();\n\n    // Steal override methods\n    (function () {\n      var loadedWebparts = false;\n\n      steal.origRequest = steal.request;\n      steal.request = function (options, success, error) {\n        if (!arguments[0] || !arguments[0].src || !(arguments[0].src + \"\").match(/\\/workportalflat\\/webparts\\//i)) {\n          // If asked for a normal, not workportalflat/webpart, go and do your things\n          return this.origRequest(options, success, error);\n        } else\n        {\n          var device = bizagi.detectDevice().replace(/[^a-z0-9]+/ig, \"\");\n\n          if (!loadedWebparts) {\n            // Is is the 1st time that asked for workportalflat/webpart, lets load all at once\n\n            var prefix = bizagi.loader.useAbsolutePath ? bizagi.loader.basePath + bizagi.loader.getLocationPrefix() : \"\" + bizagi.loader.getLocationPrefix();\n            var js = prefix + \"jquery/workportalflat/production/\" + device + \"/webpart.\" + device + \".production.js?build=\" + bizagi.loader.build;\n            var css = prefix + \"jquery/workportalflat/production/\" + device + \"/webpart.\" + device + \".production.css?build=\" + bizagi.loader.build;\n\n            loadedWebparts = true;\n\n            bizagi.loader.loadFile({ type: \"js\", src: js });\n            bizagi.loader.loadFile({ type: \"css\", src: css });\n\n          }\n\n          // In any case: register a dummy resource\n          var url = arguments[0].id + \"\";\n          bizagi.loader.registerMobileWebpart(device);\n\n          steal.resources[url].completed.resolve();\n          steal.resources[url].loaded.resolve();\n          steal.resources[url].loading = false;\n          steal.resources[url].executing = false;\n          steal.resources[url].options.text = JSON.stringify(bizagi.loader.webparts[device]);\n\n          success(steal.resources[url].options.text);\n        }\n\n      };\n    })();\n\n  }\n\n})();","bizagi = typeof bizagi !== \"undefined\" ? bizagi : {};\nbizagi.util = typeof bizagi.util !== \"undefined\" ? bizagi.util : {};\nbizagi.context = typeof bizagi.context !== \"undefined\" ? bizagi.context : {};\nbizagi.util.smartphone = typeof bizagi.util.smartphone !== \"undefined\" ? bizagi.util.smartphone : {};\nbizagi.util.tablet = typeof bizagi.util.tablet !== \"undefined\" ? bizagi.util.tablet : {};\nbizagi.util.mobility = typeof bizagi.util.mobility !== \"undefined\" ? bizagi.util.mobility : {};\n\nbizagi.util.smartphone.startLoading = function () {\n  bizagi.loading.start();\n};\n\nbizagi.util.smartphone.stopLoading = function () {\n  bizagi.loading.stop();\n};\n\nbizagi.util.mobility.getResource = function (resourceKey, fallback) {\n  return bizagi.localization.getResource(resourceKey, fallback);\n};\n\nbizagi.loader.initWebpartOld = bizagi.loader.initWebpart;\n\nbizagi.loader.initWebpart = function (webpart, device, callback) {\n  var self = this;\n  if (webpart != null) {\n    if (!webpart.initialized) {\n      if (webpart.devices) {\n        if (typeof webpart.devices[device] !== 'undefined') {\n          bizagi.loader.initWebpartOld($.extend(webpart, webpart.devices[device]), device, callback);\n        } else {\n          console.log(\"No existe la definicion del device \" + device + \" Para el webpart \" + webpart.name);\n        }\n      } else {\n        bizagi.loader.initWebpartOld(webpart, device, callback);\n      }\n    } else {\n      steal.then(function () {\n        // Invokes callback\n        if (callback) callback();\n      });\n    }\n  }\n\n  return this;\n};\n\n/**\r\n    * Initializes a webpart on-demand\r\n    * @param webpart\r\n    * @param device\r\n    * @returns {*}\r\n    */\nbizagi.util.initWebpart = function (webpart, device) {\n  var defer = new $.Deferred();\n\n  device = device || bizagi.detectDevice();\n\n  if (webpart.initialized) {\n    // If already initialized resolve the deferred\n    defer.resolve();\n  } else {\n\n    if (webpart.initializing) {\n      $.when(webpart.loadingDeferred.promise()).\n      done(function () {\n        defer.resolve();\n      });\n    } else {\n\n      webpart.loadingDeferred = new $.Deferred();\n      webpart.initializing = true;\n      bizagi.loader.initWebpart(webpart, device, function () {\n\n        // Resolve deferreds\n        webpart.loadingDeferred.resolve();\n        webpart.initializing = false;\n        defer.resolve();\n      });\n    }\n  }\n\n  return defer.promise();\n};\n\nbizagi.util.isDate = function (value) {\n  value = value || '';\n  var state = false;\n  var slash = typeof value == 'string' ? value.split(\"/\") : '';\n  try {\n    // Check format int/int/int\n    if (slash.length == 3) {\n      var date = new Date(value);\n      if (date.getYear() > 0) {\n        state = true;\n      }\n    }\n  } catch (e) {\n    state = false;\n  }\n\n  return state;\n};\n\nbizagi.util.setContext = function (params, reset) {\n  params = params || {};\n  reset = reset || false;\n  if (reset) {\n    bizagi.context = {};\n  }\n\n  $.each(params, function (key, value) {\n    bizagi.context[key] = value;\n  });\n};\n\n/**\r\n    * Get time ago\r\n    * @param commentTime\r\n    * @returns {jQuery|*|*|*|*|*|*}\r\n    */\nbizagi.getTimeAgo = function (commentTime) {\n  return $.timeago(new Date(commentTime));\n};\n\n/**\r\n    * Data grouped\r\n    * @param date\r\n    */\nbizagi.getGroupedData = function (date) {\n  var groupedData = {};\n\n  var actualDate = new Date();\n  var actualYear = actualDate.getFullYear();\n  var actualMonth = actualDate.getMonth();\n  var actualDay = actualDate.getDate();\n\n  date = bizagi.util.isDate(date) ? date : actualDate;\n\n  var tmpDate = new Date(date);\n  var tmpMonth = tmpDate.getMonth();\n  var tmpYear = tmpDate.getFullYear();\n  var tmpDay = tmpDate.getDate();\n\n  var dateDiff = new Date(tmpYear, tmpMonth, tmpDay, 0, 0, 0) - new Date(actualYear, actualMonth, actualDay, 0, 0, 0);\n\n  if (dateDiff < 0) {\n    groupedData.date = bizagi.util.dateFormatter.formatDate(new Date(tmpDate), \"dd MMM\");\n    groupedData.type = bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n    groupedData.status = \"red\";\n  } else {\n    if (actualDay === tmpDay) {\n      groupedData.date = bizagi.util.dateFormatter.formatDate(new Date(tmpDate), \"hh:mm\");\n      groupedData.type = bizagi.localization.getResource(\"workportal-taskfeed-today\");\n      groupedData.status = \"yellow\";\n    } else if (actualDay + 1 === tmpDay) {\n      groupedData.date = bizagi.util.dateFormatter.formatDate(new Date(tmpDate), \"hh:mm\");\n      groupedData.type = bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n      groupedData.status = \"yellow\";\n    } else {\n      groupedData.date = bizagi.util.dateFormatter.formatDate(new Date(tmpDate), \"dd MMM\");\n      groupedData.type = bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n      groupedData.status = \"green\";\n    }\n  }\n\n  return groupedData;\n};\n\nbizagi.util.getTaskStatus = function (date) {\n  // Current date\n  var actualDate = new Date();\n  var actualMonth = actualDate.getMonth();\n  var actualDay = actualDate.getDate();\n  var actualYear = actualDate.getFullYear();\n\n  // Solution date\n  var solutionDate = date || \"\";\n  if (!bizagi.util.isDate(solutionDate)) return \"--\";\n\n  // Temporal date\n  var tmpDate = new Date(solutionDate);\n  var tmpDay = tmpDate.getDate();\n  var tmpMonth = tmpDate.getMonth();\n  var tmpYear = tmpDate.getFullYear();\n\n  // Difference date\n  var dateDiff = new Date(tmpYear, tmpMonth, tmpDay, 0, 0, 0) -\n  new Date(actualYear, actualMonth, actualDay, 0, 0, 0);\n\n  if (dateDiff < 0) {\n    return bizagi.util.dateFormatter.formatDate(new Date(solutionDate), \"dd MMM\");\n  } else {\n    if (actualMonth === tmpMonth && actualDay === tmpDay) {\n      return bizagi.util.dateFormatter.formatDate(new Date(solutionDate), \"hh:mm\");\n    } else if (actualMonth === tmpMonth && actualDay + 1 === tmpDay) {\n      return bizagi.util.dateFormatter.formatDate(new Date(solutionDate), \"hh:mm\");\n    } else {\n      return bizagi.util.dateFormatter.formatDate(new Date(solutionDate), \"dd MMM\");\n    }\n  }\n};\n\n/*\r\n   * Give format to data\r\n   */\nbizagi.util.formatDataType = function (value, dataType) {\n\n  var parseValue = \"\";\n\n  if (dataType === \"NText\" || dataType === \"VarChar\") {\n    parseValue = \"<div>\" + bizagi.util.replaceLineBreak(value) + \"</div>\";\n  } else if (dataType === \"Boolean\") {\n    parseValue = bizagi.util.formatBoolean(value);\n  } else if (dataType === \"Int\" || dataType === \"BigInt\" || dataType === \"SmallInt\" || dataType === \"TinyInt\") {\n    parseValue = value;\n  } else if (dataType === \"Money\") {\n    parseValue = bizagi.util.formatMonetaryCell(value);\n  } else if (dataType === \"Float\" || dataType === \"Real\") {\n    parseValue = bizagi.util.formatDecimalCell(value);\n  } else if (dataType === \"DateTime\") {\n    parseValue = bizagi.util.dateFormatter.formatDate(new Date(value), bizagi.localization.getResource(\"dateFormat\") + \" \" + bizagi.localization.getResource(\"timeFormat\"));\n  } else {\n    parseValue = value;\n  }\n\n  return parseValue;\n};\n\n/*\r\n   *   Dar formato a la celda tipo DateTime\r\n   */\nbizagi.util.formatDateTime = function (value) {\n  value = value == null ? \"\" : value;\n  value = typeof value != \"string\" ? value.toString() : value;\n  if (Date.parse(value)) {\n    var newDate = new Date(value);\n    var date = (newDate.getMonth() + 1 < 10 ? \"0\" + (newDate.getMonth() + 1) : newDate.getMonth() + 1) + \"/\" + (newDate.getDate() < 10 ? '0' + newDate.getDate() : newDate.getDate()) + \"/\" + newDate.getFullYear();\n    var time = (newDate.getHours() < 12 && value.toLowerCase().indexOf(\"pm\") > 0 ? newDate.getHours() + 12 : newDate.getHours()) + \":\" + (newDate.getMinutes() < 10 ? \"0\" + newDate.getMinutes() : newDate.getMinutes());\n\n    return date + \" \" + time;\n  } else {\n    return value;\n  }\n};\n\n/*\r\n   * Aplicar formato Tipo moneda\r\n   */\nbizagi.util.formatMonetaryCell = function (value) {\n  return bizagi.util.formatMoney(value, BIZAGI_DEFAULT_CURRENCY_INFO);\n};\n\n\nbizagi.util.formatDecimal = function (value, format) {\n  var i = $(\"<i/>\").text(value);\n  if (i.formatCurrency) {i.formatCurrency(format);}\n  return i.text();\n};\n\n/**\r\n    * Syntax Highlight\r\n    * @param {} json\r\n    * @returns {}\r\n    */\nbizagi.util.syntaxHighlight = function (json) {\n  if (typeof json == \"undefined\" || json == null) return \"\";\n\n  json = json.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n\n  return json.replace(/(\"(\\\\u[a-zA-Z0-9]{4}|\\\\[^u]|[^\\\\\"])*\"(\\s*:)?|\\b(true|false|null)\\b|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?)/g, function (match) {\n    var cls = \"number\";\n\n    if (/^\"/.test(match)) {\n      if (/:$/.test(match)) {\n        cls = \"key\";\n      } else {\n        cls = \"string\";\n      }\n    } else if (/true|false/.test(match)) {\n      cls = \"boolean\";\n    } else if (/null/.test(match)) {\n      cls = \"null\";\n    }\n\n    return \"<span class='\" + cls + \"'>\" + match + \"</span>\";\n  });\n};\n\n/**\r\n    * Convert String to Base64 Unicode\r\n    * @param {} str\r\n    * @returns {}\r\n    */\nbizagi.util.b64EncodeUnicode = function (string) {\n  return btoa(encodeURIComponent(string).replace(/%([0-9A-F]{2})/g, function (match, p1) {\n    return String.fromCharCode(\"0x\" + p1);\n  }));\n};","bizagi = typeof bizagi !== 'undefined' ? bizagi : {};\nbizagi.util = typeof bizagi.util !== 'undefined' ? bizagi.util : {};\nbizagi.util.tablet = typeof bizagi.util.tablet !== \"undefined\" ? bizagi.util.tablet : {};\nbizagi.util.mobility = typeof bizagi.util.mobility !== \"undefined\" ? bizagi.util.mobility : {};\nbizagi.environment = typeof BIZAGI_ENVIRONMENT !== \"undefined\" ? BIZAGI_ENVIRONMENT : queryString[\"environment\"] || \"debug\";\n\nbizagi.util.tablet.startLoading = function () {\n  bizagi.loading.start();\n};\n\nbizagi.util.tablet.stopLoading = function () {\n  bizagi.loading.stop();\n};\n\nbizagi.util.tablet.startkendo = function (params) {\n  if (typeof bizagi.kendoMobileApplication === \"undefined\") {\n    bizagi.kendoMobileApplication = new kendo.mobile.Application($(\"body\"), {\n      transition: \"slide\",\n      skin: \"flat\",\n      initial: \"initKendo\",\n      init: function init(e) {\n        kendo.ui.progress($(\".km-flat\"), true);\n        params.started && params.started();\n      } });\n\n\n    bizagi.kendoMobileApplication.bizagiNavigate = function (e, t) {\n      this.navigate(e, t);\n    };\n  } else {\n    params.started && params.started();\n  }\n};","/*\r\n*   Name: BizAgi Workportal Main Controller\r\n*   Author: oo\r\n*   Comments:\r\n*   -   This script will define a base class to handle workportal layouts for any device\r\n*/\n\n$.Class.extend(\"bizagi.workportal.controllers.controller\", {}, {\n\n  /**\r\n                                                                 *   Constructor\r\n                                                                 */\n  init: function init(workportalFacade, dataService, params) {\n    // Set workportal facade\n    this.workportalFacade = workportalFacade;\n\n    // Set data service\n    this.dataService = dataService;\n\n    // Set l10n service\n    this.resources = bizagi.localization;\n\n    //set container to bind events\n    this.container = params.container || document;\n\n    // Set a component container hash to use with templates\n    this.componentContainers = {};\n\n    bizagi.workportal.controllers.instances = {};\n    bizagi.workportal.controllers.instances.controller = this;\n  },\n\n  /**\r\n     *   Returns the current workportal\r\n     */\n  getWorkportal: function getWorkportal() {\n    return this.workportalFacade.workportal;\n  },\n\n  /**\r\n     *   Publish an event so any controller can subscribe to it\r\n     */\n  publish: function publish(eventName, params) {\n    return $(this.container).triggerHandler(eventName, params);\n  },\n\n  /**\r\n     *   Subscribe to an event that any controller could trigger\r\n     */\n  subscribe: function subscribe(eventName, callback) {\n    $(this.container).bind(eventName, callback);\n  },\n\n  subscribeEvent: function subscribeEvent(eventName, callback) {\n    $(document).bind(eventName, callback);\n  },\n\n\n  /**\r\n     *   Subscribe to one time event that any controller could trigger\r\n     */\n  subscribeOneTime: function subscribeOneTime(eventName, callback) {\n    $(this.container).one(eventName, callback);\n  },\n\n  /**\r\n     *   Un Subscribe to an event that any controller could trigger in this document\r\n     */\n  unsubscribe: function unsubscribe(eventName, callback) {\n    if (callback) {\n      $(this.container).unbind(eventName, callback);\n    } else\n    {$(this.container).unbind(eventName);}\n  },\n\n  /**\r\n     *   Makes the base processing of the layout (mix templates + data)\r\n     *   after all that processing will call a post-render method to\r\n     *   be implemented in each device to apply custom plugins\r\n     *   Returns a promise because the rendering could be asynchronous\r\n     */\n  render: function render() {\n    bizagi.showMessageBox(\"controllers render\", \"Error\");\n\n    var self = this;\n    var defer = new $.Deferred();\n\n    // Render content\n    $.when(self.renderContent()).\n    done(function () {\n\n      // Call post-render method\n      self.postRender();\n\n      // Resolve deferred\n      defer.resolve(self.getContent());\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Returs the rendered content\r\n     */\n  getContent: function getContent() {\n    return this.content;\n  },\n\n  /*\r\n     *   Returns the mapped resource\r\n     */\n  getResource: function getResource(key, defaultValue) {\n    return this.resources.getResource(key, defaultValue);\n  },\n\n  /*\r\n     *   Renders the content for the current controller\r\n     *\r\n     */\n  renderContent: function renderContent() {\n    // Override on implementations\n    return \"\";\n  },\n\n  /*\r\n     *   To be overriden in each device to apply layouts\r\n     */\n  postRender: function postRender() {}\n\n  /*\r\n                                       *   Returns the component replaced tag selector\r\n                                       */ });","/*\r\n*   Name: BizAgi Work Portal Service Context Factory\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\n\n$.Class.extend(\"bizagi.workportal.services.context\", {}, {\n  /* \r\n                                                           *   Constructor\r\n                                                           */\n  init: function init(params) {\n    this.context = params.context;\n    this.endPoints = bizagi.workportal.services.getEndPoints(params);\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n  },\n\n  /*\r\n     *   Returns the given url for a specified service\r\n     */\n  getUrl: function getUrl(service) {\n    if (typeof this.endPoints[service] === 'undefined') {\n      bizagi.log(\"Url not found\", \"No endpoint defined for: \" + service);\n    }\n    return this.endPoints[service];\n  },\n\n  setProxyPrefix: function setProxyPrefix(params) {\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    this.endPoints = bizagi.workportal.services.getEndPoints(params);\n  } });","/*\r\n*   Name: BizAgi Device Render Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will detect the current device and then will load the appropiate factory on demand\r\n*/\n\n$.Class.extend(\"bizagi.workportal.device.factory\", {}, {\n\n  /* \r\n                                                         *   Constructor, detects the device\r\n                                                         */\n  init: function init(workportal) {\n    this.device = bizagi.util.detectDevice();\n    this.workportal = workportal;\n    this.cachedFacade = null;\n  },\n\n  /*\r\n     *   Returns the appropiate workportal facade based on the device detection\r\n     *   Because it loads the scripts on demand it must return a promise\r\n     */\n  getWorkportalFacade: function getWorkportalFacade(dataService, initializeTemplates) {\n    var self = this;\n    var defer = new $.Deferred();\n    initializeTemplates = typeof initializeTemplates !== \"undefined\" ? initializeTemplates : true;\n\n    if (self.cachedFacade != null) {\n      // Resolve with cached factory                \n      defer.resolve(self.cachedFacade);\n\n    } else {\n\n      // If factory is not cached then build it\n      if (this.device === \"desktop\") {\n\n        self.cachedFacade = new bizagi.workportal.desktop.facade(this.workportal, dataService);\n\n        // Chain template loading\n        $.when(self.cachedFacade.initAsyncStuff(initializeTemplates)).done(function () {\n          // Resolve operation\n          defer.resolve(self.cachedFacade);\n        });\n\n        return defer.promise();\n\n      } else if (bizagi.util.isTabletDevice()) {\n\n        self.cachedFacade = new bizagi.workportal.tablet.facade(dataService, this.device);\n\n        // Chain template loading\n        $.when(self.cachedFacade.initAsyncStuff()).done(function () {\n          // Resolve operation\n          defer.resolve(self.cachedFacade);\n        });\n\n        return defer.promise();\n\n      } else if (bizagi.util.isSmartphoneDevice()) {\n\n        self.cachedFacade = new bizagi.workportal.smartphone.facade(dataService, this.device);\n\n        // Chain template loading\n        $.when(self.cachedFacade.initAsyncStuff()).done(function () {\n          // Resolve operation\n          defer.resolve(self.cachedFacade);\n        });\n\n        return defer.promise();\n      } else {\n        // if no device supported\n        bizagi.showMessageBox(\"Not supported device: \" + this.device, \"Error\");\n        defer.resolve(\"\");\n      }\n    }\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Returns the current data service being used\r\n     */\n  getDataService: function getDataService() {\n    return this.dataService;\n  } });","/*\r\n *   Name: BizAgi Workportal\r\n *   Author: Bizagi Mobile Team\r\n *   Comments:\r\n *   -   This script will process a workportal page using a device factory to use the adequate rendering\r\n *       to create the layout\r\n */\n\n// Reload without tag\nif (location.href.indexOf(\"#\") != -1) {\n  document.location = \"index.html\";\n}\n\n// Define BizAgi Workportal namespace\nbizagi.workportal = bizagi.workportal || {};\n\n// Define global variables\nbizagi.workportal.currentInboxView = \"inbox\";\n\n// Define state variables\nbizagi.workportal.state = bizagi.workportal.state || {};\n\n// Define webparts\nbizagi.webparts = bizagi.webparts || {};\nbizagi.webparts.instances = bizagi.webparts.instances || [];\n\n//bizagi.workportal.instances = {};\n\n/*\r\n *   Renders the workportal\r\n */\n$.Class.extend(\"bizagi.workportal.facade\", {}, {\n  /* \r\n                                                 *   Constructor\r\n                                                 */\n  init: function init(params) {\n\n    // Defines a device factory for all rendering\n    this.deviceFactory = new bizagi.workportal.device.factory(this);\n\n    // Creates a data service instance\n    this.dataService = new bizagi.workportal.services.service(params);\n\n    // Create instance of routing service\n    this.dataService.routing = new bizagi.workportal.services.routing({ dataService: this.dataService });\n\n    // Execute Case link\n    if (!bizagi.util.isEmpty(window.location.search)) {\n      var queryString = bizagi.util.getQueryString();\n\n      // Set idCase param from query string\n      if (queryString[\"idCase\"]) {\n        params.idCase = queryString[\"idCase\"];\n        this.isConfiguredFromHash = true;\n      }\n\n      // Set idWorkitem param from query string\n      if (queryString[\"idWorkitem\"]) {\n        params.idWorkitem = queryString[\"idWorkitem\"];\n      }\n    }\n\n    // Set default params\n    this.defaultParams = params || {};\n  },\n\n  /*\r\n     *   Creates a webpart inside a canvas but don't execute it\r\n     */\n  createWebpart: function createWebpart(params) {\n    return this.executeWebpart($.extend(params, {\n      creating: true }));\n\n  },\n\n  /*\r\n     *   Executes a webpart inside a canvas\r\n     */\n  executeWebpart: function executeWebpart(params) {\n    var self = this;\n    var doc = this.ownerDocument;\n    var body = $(\"body\", doc);\n\n    // Creates ready deferred\n    var canvas = params.canvas;\n\n    var processWebpart = true;\n    if (params.webpartConfiguration) {\n      processWebpart = self.testWebpartConfiguration(params);\n    }\n    if (processWebpart) {\n      // Process the webpart asynchonous\n      return self.processWebpart(params).\n      then(function (result) {\n\n        result.name = result.webpart.Class.fullName;\n        bizagi.webparts.instances.push(result);\n\n        // Append content to canvas\n        canvas.append(result.content);\n        canvas.triggerHandler(\"ondomincluded\");\n\n        return result;\n      });\n    }\n  },\n\n  /*\r\n     *   Returns the execution deferred to determine if the component is ready or not\r\n     */\n  ready: function ready() {\n\n    return this.executionDeferred.promise();\n  },\n\n  /*\r\n     *   Process a webpart\r\n     */\n  processWebpart: function processWebpart(params) {\n    var self = this;\n    var defer = new $.Deferred();\n    var webpartController;\n\n    // Create a workportal facade\n    var facade = this.deviceFactory.getWorkportalFacade(self.dataService, false);\n\n    // Combine workportal params with call params\n    $.extend(params, this.defaultParams);\n\n    // Set callback when requests have been done\n    $.when(facade).then(function (workportalFacade) {\n\n      var deferTemplates = new $.Deferred();\n\n      // Load webpart templates\n      $.when(workportalFacade.loadWebpart(params)).\n      done(function () {\n        deferTemplates.resolve(workportalFacade);\n      });\n\n      return deferTemplates.promise();\n\n    }).then(function (workportalFacade) {\n      webpartController = workportalFacade.getWebpart(params.webpart, params);\n\n      // Render the full content\n      return webpartController.render(params);\n\n    }).then(function (content) {\n      // Resolve deferred\n      defer.resolve({ webpart: webpartController, content: content });\n    }).fail(function (error) {\n      defer.reject(error);\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Returns the main controller\r\n     */\n  getMainController: function getMainController() {\n    return this.mainController;\n  },\n\n  execute: function execute() {\n    var self = this;\n    var args = arguments;\n    var facade = this.deviceFactory.getWorkportalFacade(self.dataService);\n\n    // Process offline data \n    self.processOfflineData();\n\n    bizagi.loading.start();\n    return $.when(facade).then(function (deviceFacade) {\n      return deviceFacade.executeWebparts(args);\n    }).then(function () {\n      // Check if the required params are filled\n      if (!bizagi.util.isEmpty(self.defaultParams.idCase) && self.isConfiguredFromHash) {\n        var params = {\n          action: \"routing\",\n          idCase: self.defaultParams.idCase };\n\n\n        if (self.defaultParams.idWorkitem) {\n          params.idWorkitem = self.defaultParams.idWorkitem;\n        }\n\n        var splitView = $(\"#homePortal\").data(\"kendoMobileSplitView\");\n        if (splitView && splitView.element) {\n          splitView.element.hide();\n        }\n\n        bizagi.webpart.publish(\"executeRoutingAction\", params);\n      } else {\n        // TODO: To review in iOS\n        if (!bizagi.util.isNativePluginSupported() || bizagi.util.isNativePluginSupported() && bizagi.util.isiOSTabletDevice()) {\n          bizagi.kendoMobileApplication.navigate(\"#homePortal\");\n        }\n      }\n      bizagi.loading.stop();\n    });\n  },\n\n  /*\r\n     *   Process offline data\r\n     */\n  processOfflineData: function processOfflineData() {\n    var self = this;\n    var shouldPushData = !(bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice());\n    if (shouldPushData && typeof self.dataService.fetchOfflineData != \"undefined\" && self.dataService.online === true) {\n      if (bizagi.util.isOfflineFormsV2Supported()) {\n        $.when(self.dataService.getOutboxCasesCount()).\n        then(function (cases) {\n          if (cases > 0) {\n            if (bizagi.util.isNativePluginSupported()) {\n              bizagiapp.openSyncDialog();\n            }\n            self.dataService.pushOfflineData();\n          }\n        });\n      } else\n      {\n        self.dataService.pushOfflineData();\n      }\n    }\n  } });","/*\r\n*   Name: BizAgi Smartphone Workportal Facade\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script will define a workportal facade to access to all components\r\n*/\n\n\n$.Class.extend(\"bizagi.workportal.tablet.facade\", {\n  render_module: \"renderingflat\",\n\n  setup: function setup() {\n    this.render_module = bizagi.override.enableMSF ? \"rendering\" : \"renderingflat\";\n  },\n  /*\r\n     *   Returns the implementation class by widget\r\n     */\n  getWidgetImplementation: function getWidgetImplementation(widget) {\n    bizagi.log(\"getWidgetImplementation\" + widget);\n  } },\n{\n  /*\r\n  *   Constructor\r\n  */\n  init: function init(dataService, device) {\n    var self = this;\n    self.templates = {};\n    self.dataService = dataService;\n    self.getMobileFeaturesFromBizagiConfig();\n    self.setMobileMetaTags();\n    self.setMobileIcons();\n    self.modules = {};\n    self.device = device;\n    self.homePortalFramework = new bizagi.workportal.homeportalFramework(this);\n    self.security = new bizagi.workportal.command.security(dataService);\n\n    if (bizagi.override.enableMSF) {\n      if (bizagi.hasOwnProperty(\"kendo\")) {\n        self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\n      } else {\n        self.templateService = new bizagi.templates.services.service(bizagi.localization);\n      }\n    } else {\n      self.templateService = new bizagi.kendo.templates.services.service(bizagi.localization);\n    }\n  },\n\n  getMobileFeaturesFromBizagiConfig: function getMobileFeaturesFromBizagiConfig() {\n    var self = this;\n\n    // Bizagi config => Mobile Features\n    self.dataService.getAndSaveMobileFeaturesFromBizagiConfig();\n  },\n\n  /* SETS iPhone META TAGS\r\n     =====================================================*/\n  setMobileMetaTags: function setMobileMetaTags() {\n    $('<meta>', {\n      name: \"apple-mobile-web-app-capable\",\n      content: \"yes\" }).\n    appendTo('head');\n\n    $('<meta>', {\n      name: \"viewport\",\n      content: \"width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no\" }).\n    appendTo('head');\n\n    $('<link>', {\n      rel: 'apple-touch-icon-precomposed',\n      href: 'jquery/common/base/css/tablet/images/BizAgi_logo.png' }).\n    appendTo('head');\n\n    $('<link>', {\n      rel: 'apple-touch-startup-image',\n      href: 'jquery/common/base/css/tablet/images/splash.png' }).\n    appendTo('head');\n  },\n\n  setMobileIcons: function setMobileIcons() {\n    var generatedIcons = '<svg xmlns=\"http://www.w3.org/2000/svg\" display=\"none\" width=\"0\" height=\"0\" id=\"genome-mobile-icons\"><defs> <path d=\"M14,11 C14.5522847,11 15,11.4477153 15,12 C15,12.5522847 14.5522847,13 14,13 C13.4477153,13 13,12.5522847 13,12 C13,11.4477153 13.4477153,11 14,11 Z M10.62,11.22 C10.8071865,11.4087188 10.9115368,11.664197 10.91,11.93 C10.9115368,12.195803 10.8071865,12.4512812 10.62,12.64 L8.53,14.71 C8.34373936,14.8947442 8.09233988,14.9988954 7.83,15 C7.5627541,14.9988906 7.30707144,14.8908556 7.12,14.7 C6.73227641,14.3099625 6.73227641,13.6800375 7.12,13.29 L7.42,13 L4.55,13 C3.61113249,13.0026559 2.7096639,12.6322374 2.04390894,11.9702332 C1.37815398,11.308229 1.00264842,10.4088675 1,9.47 L1,7 C1,6.44771525 1.44771525,6 2,6 C2.55228475,6 3,6.44771525 3,7 L3,9.47 C3.01094569,10.3182207 3.70170869,11.0000706 4.55,11 L7.55,11 L7.12,10.58 C6.93068735,10.3922334 6.82420168,10.1366375 6.82420168,9.87 C6.82420168,9.60336246 6.93068735,9.3477666 7.12,9.16 C7.51003745,8.77227641 8.13996255,8.77227641 8.53,9.16 L10.62,11.22 Z M2,3 C2.55228475,3 3,3.44771525 3,4 C3,4.55228475 2.55228475,5 2,5 C1.44771525,5 1,4.55228475 1,4 C1,3.44771525 1.44771525,3 2,3 Z M11.45,3 C12.3888675,2.99734409 13.2903361,3.36776255 13.9560911,4.02976678 C14.621846,4.691771 14.9973516,5.59113247 15,6.53 L15,9 C15,9.55228475 14.5522847,10 14,10 C13.4477153,10 13,9.55228475 13,9 L13,6.53 C12.9890543,5.6817793 12.2982913,4.99992938 11.45,5 L8.45,5 L8.88,5.42 C9.06931265,5.6077666 9.17579832,5.86336246 9.17579832,6.13 C9.17579832,6.39663754 9.06931265,6.6522334 8.88,6.84 C8.69128117,7.02718651 8.43580298,7.13153676 8.17,7.13 C7.90766012,7.12889538 7.65626064,7.02474416 7.47,6.84 L5.38,4.78 C5.19281349,4.59128117 5.08846324,4.33580298 5.09,4.07 C5.08846324,3.80419702 5.19281349,3.54871883 5.38,3.36 L7.47,1.29 C7.86212218,0.900639269 8.49563924,0.902877853 8.88499998,1.29500002 C9.27436072,1.68712218 9.27212216,2.32063925 8.88,2.71 L8.58,3 L11.45,3 Z\" id=\"icon-sync-path-1\"/> <style>.a{fill:none;}</style><style>.a{fill:#fff;}.b{fill:#da3b3b;}</style></defs><symbol viewBox=\"0 0 16 16\" id=\"bz-arrow-left--16\"><path d=\"M11,15a1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.42L6.41,8l5.3-5.29a1,1,0,1,0-1.42-1.42l-6,6a1,1,0,0,0,0,1.42l6,6A1,1,0,0,0,11,15Z\"/></symbol><symbol viewBox=\"0 0 16 16\" id=\"bz-dots-v--16\"><circle cx=\"8\" cy=\"3\" r=\"1.5\"/><circle cx=\"8\" cy=\"8\" r=\"1.5\"/><circle cx=\"8\" cy=\"13\" r=\"1.5\"/></symbol><symbol viewBox=\"0 0 16 16\" id=\"bz-summary--16\">  <path d=\"M12,3a1,1,0,0,0,0,2v8H4V5A1,1,0,0,0,4,3H3A1,1,0,0,0,2,4v9a2,2,0,0,0,2,2h9a1,1,0,0,0,1-1V5A2,2,0,0,0,12,3Z\"/> <rect x=\"6\" y=\"1\" width=\"4\" height=\"3\" rx=\"1\"/> <path d=\"M6,8h4a1,1,0,0,0,0-2H6A1,1,0,0,0,6,8Z\"/> <path d=\"M10,9H6a1,1,0,0,0,0,2h4a1,1,0,0,0,0-2Z\"/> </symbol><symbol viewBox=\"0 0 16 16\" id=\"dots-menu\"><g id=\"dots-menu-dots-menu-16x\"><circle cx=\"8\" cy=\"4\" r=\"1\"/><circle cx=\"8\" cy=\"8\" r=\"1\"/><circle cx=\"8\" cy=\"12\" r=\"1\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"icon-sync\"><desc>Created with sketchtool.</desc> <!-- Generator: sketchtool 54.1 (76490) - https://sketchapp.com -->    <g id=\"icon-sync-Mobile-Prototype\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"> <g id=\"icon-sync-Inbox-Offline-Edited\" transform=\"translate(-311.000000, -157.000000)\"> <g id=\"icon-sync-cases\" transform=\"translate(0.000000, 141.000000)\"> <g id=\"icon-sync-case\"> <g id=\"icon-sync-edited\" transform=\"translate(311.000000, 16.000000)\"> <g id=\"icon-sync-2.0/16x/cloud\"> <mask id=\"icon-sync-mask-2\" fill=\"white\"> <use xlink:href=\"#icon-sync-path-1\"/> </mask> <use id=\"icon-sync-Mask\" fill=\"#9E9E9E\" xlink:href=\"#icon-sync-path-1\"/> </g> </g> </g> </g> </g> </g> </symbol><symbol viewBox=\"0 0 32 32\" id=\"icon-trash\"><desc>Created with sketchtool.</desc> <!-- Generator: sketchtool 54.1 (76490) - https://sketchapp.com -->   <g id=\"icon-trash-Mobile-Prototype\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"> <g id=\"icon-trash-Drafts-Offline\" transform=\"translate(-335.000000, -149.000000)\"> <g id=\"icon-trash-cases\" transform=\"translate(0.000000, 141.000000)\"> <g id=\"icon-trash-case\"> <g id=\"icon-trash-icon\" transform=\"translate(335.000000, 8.000000)\"> <rect id=\"icon-trash-box\" x=\"0\" y=\"0\" width=\"32\" height=\"32\"/> <path d=\"M21,13 C21.553,13 22,13.447 22,14 L22,21 C22,22.654 20.654,24 19,24 L13,24 C11.346,24 10,22.654 10,21 L10,14 C10,13.447 10.447,13 11,13 C11.553,13 12,13.447 12,14 L12,21 C12,21.552 12.448,22 13,22 L19,22 C19.552,22 20,21.552 20,21 L20,14 C20,13.447 20.447,13 21,13 Z M14,19.5 C14,19.776 13.776,20 13.5,20 C13.224,20 13,19.776 13,19.5 L13,14.5 C13,14.224 13.224,14 13.5,14 C13.776,14 14,14.224 14,14.5 L14,19.5 Z M16.5,19.5 C16.5,19.776 16.276,20 16,20 C15.724,20 15.5,19.776 15.5,19.5 L15.5,14.5 C15.5,14.224 15.724,14 16,14 C16.276,14 16.5,14.224 16.5,14.5 L16.5,19.5 Z M19,19.5 C19,19.776 18.776,20 18.5,20 C18.224,20 18,19.776 18,19.5 L18,14.5 C18,14.224 18.224,14 18.5,14 C18.776,14 19,14.224 19,14.5 L19,19.5 Z M23,10 C23.553,10 24,10.447 24,11 C24,11.553 23.553,12 23,12 L9,12 C8.447,12 8,11.553 8,11 C8,10.447 8.447,10 9,10 L13,10 L13,9 C13,8.447 13.447,8 14,8 L18,8 C18.553,8 19,8.447 19,9 L19,10 L23,10 Z\" id=\"icon-trash-trash\" fill=\"#9E9E9E\"/> </g> </g> </g> </g> </g> </symbol><symbol viewBox=\"0 0 16 16\" id=\"star\"><g id=\"star-star-16x\"><path d=\"M11.708,14.20605a.50183.50183,0,0,1-.294-.0957L8,11.62988,4.58594,14.11035a.5.5,0,0,1-.76953-.55859L5.12012,9.53809,1.70605,7.05762A.4999.4999,0,0,1,2,6.15332H6.22021l1.3042-4.01367a.52044.52044,0,0,1,.95118,0l1.3042,4.01367H14a.4999.4999,0,0,1,.294.9043L10.87988,9.53809l1.30371,4.01367a.50021.50021,0,0,1-.47558.65429ZM8,10.51172a.50193.50193,0,0,1,.294.0957l2.46337,1.79L9.81641,9.501a.49916.49916,0,0,1,.18164-.5586l2.46289-1.78906H9.4165a.5.5,0,0,1-.47558-.3457L8,3.91211,7.05908,6.80762a.5.5,0,0,1-.47558.3457H3.53906L6.002,8.94238a.49916.49916,0,0,1,.18164.5586l-.94091,2.89648,2.46337-1.79A.50193.50193,0,0,1,8,10.51172Z\"/></g></symbol><symbol viewBox=\"0 0 24 24\" id=\"bz-arrow-left--24\"><path d=\"M17,23a1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.42L8.41,12l9.3-9.29a1,1,0,1,0-1.42-1.42l-10,10a1,1,0,0,0,0,1.42l10,10A1,1,0,0,0,17,23Z\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"bz-dots-v--24\"><circle cx=\"12\" cy=\"7\" r=\"1.5\"/><circle cx=\"12\" cy=\"12\" r=\"1.5\"/><circle cx=\"12\" cy=\"17\" r=\"1.5\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"bz-summary--24\"><path d=\"M18,5a1,1,0,0,0,0,2,1,1,0,0,1,1,1V21H6a1,1,0,0,1-1-1V7H6A1,1,0,0,0,6,5H4A1,1,0,0,0,3,6V20a3,3,0,0,0,3,3H20a1,1,0,0,0,1-1V8A3,3,0,0,0,18,5Z\"/><path d=\"M9,7h6a1,1,0,0,0,1-1V4a1,1,0,0,0-1-1H14V2a1,1,0,0,0-1-1H11a1,1,0,0,0-1,1V3H9A1,1,0,0,0,8,4V6A1,1,0,0,0,9,7Zm3-3a1,1,0,0,0,1,1H11A1,1,0,0,0,12,4Z\"/><path d=\"M8,11h8a1,1,0,0,0,0-2H8a1,1,0,0,0,0,2Z\"/><path d=\"M16,13H8a1,1,0,0,0,0,2h8a1,1,0,0,0,0-2Z\"/><path d=\"M16,17H8a1,1,0,0,0,0,2h8a1,1,0,0,0,0-2Z\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"bzg-arrow-left\"><path d=\"M17,23a1,1,0,0,0,.71-.29,1,1,0,0,0,0-1.42L8.41,12l9.3-9.29a1,1,0,1,0-1.42-1.42l-10,10a1,1,0,0,0,0,1.42l10,10A1,1,0,0,0,17,23Z\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"bzg-edit\"><path d=\"M14.71,5.29a1,1,0,0,0-1.42,0l-12,12A1,1,0,0,0,1,18v4a1,1,0,0,0,1,1H6a1,1,0,0,0,.71-.29L17.29,12.12a3,3,0,0,0,0-4.24ZM3,21V18.41L5.59,21ZM15.88,10.71,7,19.59,4.41,17,14,7.41l1.88,1.88A1,1,0,0,1,15.88,10.71Z\"/><path d=\"M21.71,2.29a3.84,3.84,0,0,0-5.42,0l-1,1a1,1,0,0,0,0,1.42l4,4a1,1,0,0,0,1.42,0l1-1A3.84,3.84,0,0,0,21.71,2.29Zm-1.42,4-.29.3L17.41,4l.3-.29a1.82,1.82,0,1,1,2.58,2.58Z\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"bzg-sync\"><g id=\"bzg-sync-sync-24x\"><path d=\"M12,1A11.03251,11.03251,0,0,0,4.333,4.12646V2a1,1,0,0,0-2,0V7a.9471.9471,0,0,0,.0318.15759.97252.97252,0,0,0,.02966.147,1.36527,1.36527,0,0,0,.18414.33252.97322.97322,0,0,0,.18116.16027.9342.9342,0,0,0,.07714.0683c.01526.00879.03254.00824.048.01612a.97526.97526,0,0,0,.20746.06958A.97927.97927,0,0,0,3.2738,7.988C3.29449,7.98932,3.312,8,3.333,8h5a1,1,0,0,0,0-2H5.31873A8.98139,8.98139,0,0,1,21,12a1,1,0,0,0,2,0A11.01245,11.01245,0,0,0,12,1Z\"/><path d=\"M21.60565,16.69556a1.36192,1.36192,0,0,0-.18365-.332.97292.97292,0,0,0-.18445-.163.92322.92322,0,0,0-.07446-.06579c-.01484-.00861-.0315-.00806-.04657-.01581a1.59562,1.59562,0,0,0-.39454-.10785C20.70276,16.01,20.68652,16,20.667,16h-5a1,1,0,1,0,0,2h3.01428A8.98139,8.98139,0,0,1,3,12a1,1,0,0,0-2,0,10.98942,10.98942,0,0,0,18.667,7.87329V22a1,1,0,0,0,2,0V17a.94293.94293,0,0,0-.0318-.15784A.964.964,0,0,0,21.60565,16.69556Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"activity\"><g id=\"activity-icon-name-16x\"><path d=\"M8,10.5a.49989.49989,0,0,1-.44727-.27637L6.69092,8.5H6a.5.5,0,0,1,0-1H7a.5011.5011,0,0,1,.44727.27637L7.96533,8.8125l2.5752-6.00977A.47665.47665,0,0,1,11.00586,2.5a.50143.50143,0,0,1,.4585.31445L13.33838,7.5H14a.5.5,0,0,1,0,1H13a.49951.49951,0,0,1-.46436-.31445L10.98389,4.30664,8.45947,10.19727A.50017.50017,0,0,1,8.01465,10.5Z\"/><path d=\"M3,8.5H2a.5.5,0,0,1,0-1H3a.5.5,0,0,1,0,1Z\"/><path d=\"M13,14.5H3a.5.5,0,0,1,0-1H13a.5.5,0,0,1,0,1Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"arrow-down\"><g id=\"arrow-down-arrow-down-16x\"><path d=\"M8,11.5a.47.47,0,0,1-.35-.15l-6-6a.48.48,0,0,1,0-.7.5.5,0,0,1,.71,0L8,10.29l5.64-5.64a.5.5,0,0,1,.71,0A.49.49,0,0,1,14.5,5a.47.47,0,0,1-.15.35l-6,6A.47.47,0,0,1,8,11.5Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"arrow-sort-down\"><g id=\"arrow-sort-down-arrow-sort-down-16x\"><path d=\"M13.21,10.21l-4.5,4.5a1,1,0,0,1-.33.21.92.92,0,0,1-.76,0,1,1,0,0,1-.33-.21l-4.5-4.5A1,1,0,0,1,2.5,9.5a1,1,0,0,1,.29-.71,1,1,0,0,1,1.42,0L7,11.59V2A1,1,0,0,1,9,2v9.59l2.79-2.8a1,1,0,0,1,1.42,0A1,1,0,0,1,13.21,10.21Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"arrow-sort-up\"><g id=\"arrow-sort-up-sort-up-16x\"><path d=\"M13.21,5.79l-4.5-4.5a1,1,0,0,0-.33-.21,1,1,0,0,0-.76,0,1,1,0,0,0-.33.21l-4.5,4.5a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L7,4.41V14a1,1,0,0,0,2,0V4.41l2.79,2.8a1,1,0,0,0,1.42,0A1,1,0,0,0,13.21,5.79Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"arrow-up\"><g id=\"arrow-up-arrow-up-16x\"><path d=\"M14,11.5a.51.51,0,0,1-.36-.15L8,5.71,2.36,11.35a.5.5,0,0,1-.71,0A.49.49,0,0,1,1.5,11a.47.47,0,0,1,.15-.35l6-6a.48.48,0,0,1,.7,0l6,6a.5.5,0,0,1-.35.85Z\"/></g></symbol><symbol viewBox=\"0 0 12 12\" id=\"bzg-clear-circle\"><path d=\"M6,0a6,6,0,1,0,6,6A6,6,0,0,0,6,0ZM8.42,7a1,1,0,0,1,0,1.41A1,1,0,0,1,7,8.42l-1-1-1,1a1,1,0,0,1-1.41,0A1,1,0,0,1,3.58,7l1-1-1-1A1,1,0,0,1,5,3.58l1,1,1-1A1,1,0,0,1,8.42,5l-1,1Z\"/></symbol><symbol viewBox=\"0 0 16 16\" id=\"bzg-edit\"><path d=\"M10.71,3.29a1,1,0,0,0-1.42,0l-8,8A1,1,0,0,0,1,12v2a1,1,0,0,0,1,1H4a1,1,0,0,0,.71-.29L12,7.41a2,2,0,0,0,0-2.82ZM3.59,13H3v-.59l7-7,.59.59Z\"/><path d=\"M14.71,1.29a2.43,2.43,0,0,0-3.42,0,1,1,0,0,0,0,1.42l2,2a1,1,0,0,0,1.42,0,2.44,2.44,0,0,0,0-3.42Z\"/></symbol><symbol viewBox=\"0 0 16 16\" id=\"bzg-sync\"><g id=\"bzg-sync-sync-16x\"><path d=\"M8,1A7.01076,7.01076,0,0,0,3.7998,2.40869V2a1,1,0,0,0-2,0V5a.94306.94306,0,0,0,.02875.14227.90487.90487,0,0,0,.389.649.93942.93942,0,0,0,.08423.07446c.01672.00971.03564.00916.05267.01782a.97641.97641,0,0,0,.19452.0658.973.973,0,0,0,.194.03919C2.76282,5.98969,2.7796,6,2.7998,6h3a1,1,0,1,0,0-2H5.00928A4.993,4.993,0,0,1,13,8a1,1,0,0,0,2,0A7.00818,7.00818,0,0,0,8,1Z\"/><path d=\"M14.13745,10.68872a1.35284,1.35284,0,0,0-.18512-.32941.97349.97349,0,0,0-.17334-.15319.92492.92492,0,0,0-.08075-.07135c-.016-.00934-.03418-.00879-.05053-.01716a1.59015,1.59015,0,0,0-.392-.10644C13.23633,10.01007,13.21991,10,13.2002,10h-3a1,1,0,0,0,0,2h.79064A4.99313,4.99313,0,0,1,3,8,1,1,0,0,0,1,8a6.99166,6.99166,0,0,0,11.2002,5.59149V14a1,1,0,0,0,2,0V11a.94717.94717,0,0,0-.02887-.14313A.97211.97211,0,0,0,14.13745,10.68872Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"bzg-undo\"><path d=\"M11,4H3.87l1-1.45a1,1,0,0,0-1.66-1.1l-2,3a.47.47,0,0,0,0,.1l-.05.1a1.05,1.05,0,0,0,0,.7l.05.1a.47.47,0,0,0,0,.1l2,3A1,1,0,0,0,4,9a.94.94,0,0,0,.55-.17,1,1,0,0,0,.28-1.38L3.87,6H11a2,2,0,0,1,2,2V9a2,2,0,0,1-2,2H2a1,1,0,0,0,0,2h9a4,4,0,0,0,4-4V8A4,4,0,0,0,11,4Z\"/></symbol><symbol viewBox=\"0 0 16 16\" id=\"chart-bars\"><g id=\"chart-bars-chart-bars-16x\"><path d=\"M14.5,14H14V7.5a.5.5,0,0,0-.5-.5h-2a.5.5,0,0,0-.5.5V14H10V5.5A.5.5,0,0,0,9.5,5h-2a.5.5,0,0,0-.5.5V14H6V9.5A.5.5,0,0,0,5.5,9h-2a.5.5,0,0,0-.5.5V14H2V3h.5a.5.5,0,0,0,0-1h-1a.5.5,0,0,0-.5.5v12a.5.5,0,0,0,.5.5h13a.5.5,0,0,0,0-1ZM4,14V10H5v4Zm4,0V6H9v8Zm4,0V8h1v6Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"dots-menu\"><g id=\"dots-menu-dots-menu-16x\"><circle cx=\"8\" cy=\"4\" r=\"1\"/><circle cx=\"8\" cy=\"8\" r=\"1\"/><circle cx=\"8\" cy=\"12\" r=\"1\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"filter\"><g id=\"filter-filter-16x\"><path d=\"M5.7,14.86V7.27L1,1H15L10.3,7.27v5ZM3,2,6.7,6.94v6.2l2.6-1.5V6.94L13,2Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"gear\"><g id=\"gear-gear-16x\"><path d=\"M8.72,15H7.34c-.54,0-.71-.33-1.33-1.89L5.82,13c-1.41.64-1.59.64-1.73.64H4l-.43-.22-1-1c-.39-.41-.25-.78.4-2.29L2.9,10C1.33,9.44,1,9.27,1,8.72V7.34c0-.57.37-.73,1.9-1.33L3,5.82C2.27,4.3,2.15,4,2.54,3.56l1-1A.76.76,0,0,1,4,2.37,5.74,5.74,0,0,1,5.8,3L6,2.9C6.56,1.36,6.73,1,7.28,1H8.66c.54,0,.71.33,1.33,1.89l.19.08c1.42-.65,1.58-.66,1.74-.64l.19,0,.33.18,1,1c.39.39.27.75-.39,2.29L13.1,6c1.56.57,1.9.73,1.9,1.29V8.66c0,.57-.37.73-1.9,1.33l-.07.19c.7,1.52.82,1.87.43,2.26l-1,1a.76.76,0,0,1-.52.21c-.13,0-.32,0-1.75-.61l-.2.08C9.43,14.67,9.27,15,8.72,15ZM7.48,14H8.57c.1-.21.29-.67.55-1.39l.08-.21.23-.14.78-.33.19.08c.91.4,1.31.54,1.48.6l.77-.77c-.07-.22-.27-.68-.59-1.38l-.1-.19L12,10l.32-.78.2-.08C12.88,9,13.7,8.68,14,8.52V7.43c-.2-.11-.67-.29-1.39-.56l-.27-.09-.41-1,.09-.2c.14-.33.49-1.14.59-1.47l-.77-.77c-.15,0-.52.2-1.38.6l-.2.09L10,4l-.79-.33-.07-.19C9,3.12,8.68,2.3,8.52,2H7.43c-.1.21-.29.67-.55,1.39l-.08.2-.22.15-.79.33L5.6,4A15.17,15.17,0,0,0,4.12,3.4l-.77.76c.07.22.27.68.59,1.38l.1.19L4,6l-.32.78-.2.08C3.12,7,2.3,7.32,2,7.48V8.57c.2.11.67.29,1.39.56l.21.07.15.23.32.78-.09.2c-.14.33-.49,1.14-.59,1.47l.77.77c.15-.06.52-.2,1.38-.6l.2-.09L6,12l.79.33.08.2C7,12.89,7.32,13.7,7.48,14Z\"/><path d=\"M8,10.5A2.5,2.5,0,1,1,10.5,8,2.5,2.5,0,0,1,8,10.5Zm0-4A1.5,1.5,0,1,0,9.5,8,1.5,1.5,0,0,0,8,6.5Z\"/></g></symbol><symbol viewBox=\"0 0 24 24\" id=\"icon-check-mark\"><g id=\"icon-check-mark-check-mark-24x\"><path d=\"M8.11,19.36a1,1,0,0,1-.71-.29l-4.95-5a1,1,0,0,1,0-1.41,1,1,0,0,1,1.42,0L8.11,17l12-12a1,1,0,0,1,1.42,0,1,1,0,0,1,0,1.41L8.82,19.07A1,1,0,0,1,8.11,19.36Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"icon-close\"><g id=\"icon-close-close-16x\"><path d=\"M9.41,8l5.3-5.29a1,1,0,1,0-1.42-1.42L8,6.59,2.71,1.29A1,1,0,0,0,1.29,2.71L6.59,8l-5.3,5.29a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L8,9.41l5.29,5.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42Z\"/></g></symbol><symbol viewBox=\"0 0 24 24\" id=\"icon-download\"><g id=\"icon-download-download-24x\"><path d=\"M22,23H2a1,1,0,0,1-1-1V17a1,1,0,0,1,2,0v4H21V17a1,1,0,0,1,2,0v5A1,1,0,0,1,22,23Z\"/><path d=\"M19,10a1,1,0,0,0-.29-.71,1,1,0,0,0-1.42,0L13,13.58V2a1,1,0,0,0-2,0V13.58L6.71,9.29a1,1,0,0,0-1.42,1.42l6,6a.91.91,0,0,0,.33.22.69.69,0,0,0,.24,0A.7.7,0,0,0,12,17a.7.7,0,0,0,.14,0,.69.69,0,0,0,.24,0,.91.91,0,0,0,.33-.22l6-6A1,1,0,0,0,19,10Z\"/></g></symbol><symbol viewBox=\"0 0 24 24\" id=\"icon-offline\"><desc>Created with sketchtool.</desc> <!-- Generator: sketchtool 54.1 (76490) - https://sketchapp.com -->   <g id=\"icon-offline-Mobile-Prototype\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"> <g id=\"icon-offline-Inbox-Offline\" transform=\"translate(-32.000000, -97.000000)\" fill=\"#9E9E9E\"> <g id=\"icon-offline-controls/alert\" transform=\"translate(16.000000, 84.000000)\"> <g id=\"icon-offline-icon\" transform=\"translate(16.000000, 13.000000)\"> <path d=\"M7.86075713,14.278983 L8.17741033,13.9623298 C8.61266861,13.5270715 9.31870454,13.5270715 9.75396283,13.9623298 L12.0238702,16.2322372 L14.2937776,13.9623298 C14.7290359,13.5270715 15.4350718,13.5270715 15.8703301,13.9623298 L16.1869833,14.278983 C16.6222416,14.7146143 16.6222416,15.4202772 16.1869833,15.8555355 L13.9170759,18.1250699 L16.0777025,20.2856965 C16.5129608,20.7209548 16.5129608,21.4273637 16.0777025,21.862622 L15.7610493,22.1789022 C15.325791,22.6141605 14.6197551,22.6141605 14.1844968,22.1789022 L12.0238702,20.0182756 L9.86287064,22.1789022 C9.42761236,22.6141605 8.72157643,22.6141605 8.28631815,22.1789022 L7.96966495,21.862622 C7.53440666,21.4273637 7.53440666,20.7209548 7.96966495,20.2856965 L10.1302915,18.1250699 L7.86075713,15.8555355 C7.42549885,15.4202772 7.42549885,14.7142413 7.86075713,14.278983 M4.49878784,10.0558215 C6.56169578,8.40765836 9.17138062,7.41517996 12.0171567,7.41517996 C14.846522,7.41517996 17.4431529,8.39572325 19.5008392,10.0267297 C19.8999192,10.2557344 20.1714428,10.6812955 20.1714428,11.1743644 C20.1714428,11.9080002 19.5769255,12.5025176 18.8436626,12.5025176 C18.4408529,12.5025176 18.0842917,12.3193883 17.840741,12.0359296 L17.8317896,12.044881 C16.2276372,10.7887114 14.2128427,10.0334432 12.0175297,10.0334432 C9.81028159,10.0334432 7.78504382,10.7965438 6.17678871,12.0646485 L6.16746441,12.0553242 C5.92391372,12.3440045 5.56399577,12.5316094 5.15671039,12.5316094 C4.42307453,12.5316094 3.82855722,11.9370921 3.82855722,11.2034562 C3.82818425,10.7103873 4.09970784,10.2851992 4.49878784,10.0558215 M24,7.33573693 C24,8.06899981 23.4054827,8.6638901 22.6714739,8.6638901 C22.2716479,8.6638901 21.9173245,8.48337167 21.6737739,8.20326972 L21.632001,8.24504258 C19.0402188,6.00497296 15.6648225,4.64660906 11.9701622,4.64660906 C8.288183,4.64660906 4.92322994,5.99564866 2.3348045,8.22191832 C2.09125381,8.50798782 1.73282775,8.69298191 1.32815317,8.69298191 C0.594517312,8.69298191 0,8.0984646 0,7.36482874 C0,6.90495431 0.234226394,6.49990676 0.589668677,6.26157767 C3.65475228,3.60937403 7.64629825,2 12.0175297,2 C16.3730963,2 20.3515882,3.59818487 23.4118232,6.2332318 C23.7665195,6.47156089 24,6.87623547 24,7.33573693\" id=\"icon-offline-icon-offline\"/> </g> </g> </g> </g> </symbol><symbol viewBox=\"0 0 16 16\" id=\"icon-refresh\"><g id=\"icon-refresh-refresh-16x\"><path d=\"M13.84,7.16a1,1,0,0,0-1,1,4.85,4.85,0,1,1-2.05-4h-1a1,1,0,0,0,0,2H13a1,1,0,0,0,1-1V2a1,1,0,0,0-2,0v.57a6.84,6.84,0,1,0,2.89,5.59A1,1,0,0,0,13.84,7.16Z\"/></g></symbol><symbol viewBox=\"0 0 24 24\" id=\"icon-retrieve-offline\"><g id=\"icon-retrieve-offline-retrieving-24x\"><path d=\"M5.24,13.45a2.86,2.86,0,0,1-.1-4.64l.78-.59-.26-.94a1.09,1.09,0,0,1,0-.26A1.34,1.34,0,0,1,7,5.71a1.65,1.65,0,0,1,.38,0l1.13.33.55-1a3.91,3.91,0,0,1,3.48-2,4,4,0,0,1,2.37.8l1.43-1.43A6,6,0,0,0,7.49,3.75,3.35,3.35,0,0,0,3.63,7a3,3,0,0,0,0,.42,4.83,4.83,0,0,0,.16,7.42Z\"/><path d=\"M18.33,5.71a5.13,5.13,0,0,0-.26-.87l2.14-2.13a1,1,0,1,0-1.42-1.42l-15,15a1,1,0,0,0,0,1.42,1,1,0,0,0,1.42,0L6.92,16H11v3.59l-1.29-1.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,.33.21.94.94,0,0,0,.76,0,1,1,0,0,0,.33-.21l3-3a1,1,0,0,0-1.42-1.42L13,19.59V16h3.64A5.27,5.27,0,0,0,18.33,5.71ZM16.64,14H8.91l7.51-7.51.11.81.95.24A3.27,3.27,0,0,1,16.64,14Z\"/></g></symbol><symbol viewBox=\"0 0 24 24\" id=\"icon-warning\"><g id=\"icon-warning-warning-24x\"><path d=\"M21.33,23H2.62A2,2,0,0,1,.83,20.11L10.18,2.33A2,2,0,0,1,12,1.24h0a2,2,0,0,1,1.79,1.11l9.36,17.74A2,2,0,0,1,21.33,23ZM12,3.26,2.6,21l18.74,0Z\"/><path d=\"M12,16a1,1,0,0,1-1-1V8a1,1,0,0,1,2,0v7A1,1,0,0,1,12,16Z\"/><circle cx=\"12\" cy=\"18\" r=\"1\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"logout\"><g id=\"logout-logout-16x\"><path d=\"M4.5,15h-3a.5.5,0,0,1-.5-.5V1.5A.5.5,0,0,1,1.5,1h3a.5.5,0,0,1,0,1H2V14H4.5a.5.5,0,0,1,0,1Z\"/><path d=\"M14.85,7.65l-4-4a.51.51,0,0,0-.71,0A.5.5,0,0,0,10,4a.49.49,0,0,0,.14.35L13.29,7.5H6a.5.5,0,0,0,0,1h7.29l-3.15,3.15a.51.51,0,0,0,0,.71.5.5,0,0,0,.36.14.49.49,0,0,0,.35-.14l4-4a.48.48,0,0,0,0-.7Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"menu\"><g id=\"menu-menu-16x\"><path d=\"M12.5,4h-9a.5.5,0,0,1,0-1h9a.5.5,0,0,1,0,1Z\"/><path d=\"M12.5,8h-9a.5.5,0,0,1,0-1h9a.5.5,0,0,1,0,1Z\"/><path d=\"M12.5,12h-9a.5.5,0,0,1,0-1h9a.5.5,0,0,1,0,1Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"panel-detail\"><g id=\"panel-detail-panel-detail-16x\"><path d=\"M13.5,1.5H2.5a1.001,1.001,0,0,0-1,1v11a1.001,1.001,0,0,0,1,1h11a1.001,1.001,0,0,0,1-1V2.5A1.001,1.001,0,0,0,13.5,1.5Zm-11,1h3v11h-3ZM13.5,14v-.5h-7V2.5h7v11h.001Z\"/><path d=\"M11,4.5H9a.5.5,0,0,0,0,1h2a.5.5,0,0,0,0-1Z\"/><path d=\"M11,7.5H9a.5.5,0,0,0,0,1h2a.5.5,0,0,0,0-1Z\"/><path d=\"M11,10.5H9a.5.5,0,0,0,0,1h2a.5.5,0,0,0,0-1Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"plus\"><g id=\"plus-plus-16x\"><path d=\"M14.5,7.5h-6v-6a.5.5,0,0,0-1,0v6h-6a.5.5,0,0,0,0,1h6v6a.5.5,0,0,0,1,0v-6h6a.5.5,0,0,0,0-1Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"search\"><g id=\"search-search-16x\"><path d=\"M14.85,14.15l-4-4A.53.53,0,0,0,10.7,10,5.44,5.44,0,0,0,12,6.5,5.5,5.5,0,1,0,6.5,12,5.44,5.44,0,0,0,10,10.7a.53.53,0,0,0,.11.15l4,4a.48.48,0,0,0,.7,0A.48.48,0,0,0,14.85,14.15ZM6.5,11A4.5,4.5,0,1,1,11,6.5,4.51,4.51,0,0,1,6.5,11Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"sort-down\"><g id=\"sort-down-sort-down-16x\"><path d=\"M14,3.5H2a.5.5,0,0,1,0-1H14a.5.5,0,0,1,0,1Z\"/><path d=\"M11,6.833H2a.5.5,0,0,1,0-1h9a.5.5,0,0,1,0,1Z\"/><path d=\"M8,10.167H2a.5.5,0,0,1,0-1H8a.5.5,0,0,1,0,1Z\"/><path d=\"M5,13.5H2a.5.5,0,0,1,0-1H5a.5.5,0,0,1,0,1Z\"/></g></symbol><symbol viewBox=\"0 0 16 16\" id=\"star\"><g id=\"star-star-16x\"><path d=\"M11.708,14.20605a.50183.50183,0,0,1-.294-.0957L8,11.62988,4.58594,14.11035a.5.5,0,0,1-.76953-.55859L5.12012,9.53809,1.70605,7.05762A.4999.4999,0,0,1,2,6.15332H6.22021l1.3042-4.01367a.52044.52044,0,0,1,.95118,0l1.3042,4.01367H14a.4999.4999,0,0,1,.294.9043L10.87988,9.53809l1.30371,4.01367a.50021.50021,0,0,1-.47558.65429ZM8,10.51172a.50193.50193,0,0,1,.294.0957l2.46337,1.79L9.81641,9.501a.49916.49916,0,0,1,.18164-.5586l2.46289-1.78906H9.4165a.5.5,0,0,1-.47558-.3457L8,3.91211,7.05908,6.80762a.5.5,0,0,1-.47558.3457H3.53906L6.002,8.94238a.49916.49916,0,0,1,.18164.5586l-.94091,2.89648,2.46337-1.79A.50193.50193,0,0,1,8,10.51172Z\"/></g></symbol><symbol viewBox=\"0 0 12 12\" id=\"status-at-risk\"><path d=\"M10,11H2a1,1,0,0,1-.89-1.45l4-8a1,1,0,0,1,1.8,0l4,8A1,1,0,0,1,10,11ZM3.62,9H8.38L6,4.21Z\"/></symbol><symbol viewBox=\"0 0 12 12\" id=\"status-on-time\"><path d=\"M6,11a5,5,0,1,1,5-5A5,5,0,0,1,6,11ZM6,3A3,3,0,1,0,9,6,3,3,0,0,0,6,3Z\"/></symbol><symbol viewBox=\"0 0 12 12\" id=\"status-overdue\"><path d=\"M8,11H4A3,3,0,0,1,1,8V4A3,3,0,0,1,4,1H8a3,3,0,0,1,3,3V8A3,3,0,0,1,8,11ZM4,3A1,1,0,0,0,3,4V8A1,1,0,0,0,4,9H8A1,1,0,0,0,9,8V4A1,1,0,0,0,8,3Z\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"sync-cases\"><path d=\"M18.6,18H6a4.1,4.1,0,0,1-.28-8.19A6.5,6.5,0,0,1,18.48,11a3.5,3.5,0,1,1,.12,7ZM6,10.8A3.1,3.1,0,0,0,6,17H18.6a2.5,2.5,0,0,0,0-5,2.94,2.94,0,0,0-.51.05l-.63.13,0-.64A5.49,5.49,0,0,0,6.61,10.41l-.08.41L6,10.8Z\"/></symbol><symbol viewBox=\"0 0 24 24\" id=\"sync-failed\"><circle class=\"a\" cx=\"18\" cy=\"15\" r=\"4\"/><path class=\"a\" d=\"M12.26,18H5.65a4.47,4.47,0,0,1-3.79-7.12A4.48,4.48,0,0,1,5.5,9a6.45,6.45,0,0,1,12.07.39.5.5,0,1,1-.94.32,5.46,5.46,0,0,0-10.32,0,.5.5,0,0,1-.52.33H5.64l-.16,0a3.48,3.48,0,0,0-2.81,1.43,3.55,3.55,0,0,0-.49,3.2A3.59,3.59,0,0,0,5.65,17h6.61a.5.5,0,0,1,0,1Z\"/><path class=\"b\" d=\"M18.77,15l1.07-1.07a.54.54,0,0,0-.77-.77L18,14.23l-1.07-1.07a.54.54,0,0,0-.77.77L17.23,15l-1.07,1.07a.55.55,0,0,0,.39.93.52.52,0,0,0,.38-.16L18,15.77l1.07,1.07a.52.52,0,0,0,.38.16.55.55,0,0,0,.39-.93Z\"/></symbol><symbol viewBox=\"0 0 16 16\" id=\"view-grid\"><g id=\"view-grid-view-grid-16x\"><path d=\"M7,7H1V1H7ZM2,6H6V2H2Z\"/><path d=\"M7,15H1V9H7ZM2,14H6V10H2Z\"/><path d=\"M15,7H9V1h6ZM10,6h4V2H10Z\"/><path d=\"M15,15H9V9h6Zm-5-1h4V10H10Z\"/></g></symbol></svg><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><g id=\"sync-failed-24x\"><path d=\"M11.91309,17.5H5.82129a4.26506,4.26506,0,0,1-4.10938-2.82031A4.17882,4.17882,0,0,1,5.667,9.167h.00489A6.12717,6.12717,0,0,1,11.165,5.5h.02344a6.104,6.104,0,0,1,5.34277,3.27539.49962.49962,0,0,1-.89258.44922A5.1569,5.1569,0,0,0,11.1875,6.5H11.169a5.1372,5.1372,0,0,0-4.708,3.376.49011.49011,0,0,1-.5127.32129l-.13867-.01661A1.137,1.137,0,0,0,5.667,10.167a3.18006,3.18006,0,0,0-2.55664,1.29785A3.16088,3.16088,0,0,0,5.82129,16.5h6.0918a.5.5,0,0,1,0,1Z\" fill=\"#FFFFFF\"/><circle cx=\"18\" cy=\"16\" r=\"4\" fill=\"#DA3B3B\"/></g></svg>';\n    $(\"head\").append(generatedIcons);\n  },\n\n  /*\r\n     *   This function will load asynchronous stuff needed in the module\r\n     */\n  initAsyncStuff: function initAsyncStuff() {\n    var self = this;\n    // Load default templates            \n    return $.when(self.loadTemplate(\"base\", bizagi.getTemplate(\"base.workportal.tablet\"))).\n    then(function (template) {\n      var def = new $.Deferred();\n      $(\"body\").append(template);\n      bizagi.util.tablet.startkendo({\n        started: function started() {\n          def.resolve();\n        } });\n\n      return def.promise();\n    });\n  },\n\n  /*\r\n     *   Load one template and save it internally\r\n     */\n  loadTemplate: function loadTemplate(template, templateDestination) {\n    var self = this;\n    // Go fetch the template\n    return self.templateService.getTemplate(templateDestination, template).\n    done(function (resolvedTemplate) {\n      if (typeof resolvedTemplate === \"string\") {\n        self.templates[template] = $.trim(resolvedTemplate.replace(/\\n/g, \"\"));\n      }\n    });\n  },\n\n  /*\r\n     *   Load one template and save it internally\r\n     */\n  loadTemplateWebpart: function loadTemplateWebpart(template, templateDestination) {\n    var self = this;\n\n    // Go fetch the template\n    return self.templateService.getTemplateWebpart(templateDestination, template).\n    done(function (resolvedRemplate) {\n      self.templates[template] = $.trim(resolvedRemplate.replace(/\\n/g, \"\"));\n    });\n  },\n\n  /*\r\n     *   Method to fetch templates from a private dictionary\r\n     */\n  getTemplate: function getTemplate(template) {\n    var self = this;\n    return self.templates[template];\n  },\n  /*\r\n     *   Initializes a webpart\r\n     */\n  loadWebpart: function loadWebpart(params) {\n    var self = this;\n    var defer = new $.Deferred();\n    var webpartName = params.webpart;\n    var webpart = bizagi.getWebpart(webpartName, params);\n\n    if (!webpart) {\n      bizagi.log(\"webpart not found\");\n    }\n\n    if (bizagi.loader.environment === \"release\") {\n      defer.resolve(webpart);\n    } else {\n      // Ensure the webpart is initialized\n      $.when(bizagi.util.initWebpart(webpart, self.device)).\n      done(function () {\n        // Load all templates asyncronously\n        $.when.apply(this, $.map(webpart.tmpl, function (tmpl) {\n          return self.loadTemplateWebpart(tmpl.originalAlias, bizagi.getTemplate(tmpl.alias, true));\n        })).done(function () {\n          defer.resolve(webpart);\n        });\n\n      });\n    }\n\n    return defer.promise();\n  },\n\n  /*\r\n     *   Returns a webpart\r\n     */\n  getWebpart: function getWebpart(webpartImplementation, params) {\n    var _hasConstructorName = function _hasConstructorName(webpartImplementation, params) {\n      return params.constructorName ? params.constructorName : webpartImplementation;\n    };\n    try {\n      webpartImplementation = _hasConstructorName(webpartImplementation, params);\n      // Create a dynamic function to avoid problem with eval calls when minifying the code\n      if (webpartImplementation.indexOf(\"bizagi\") === -1) {\n        webpartImplementation = \"bizagi.workportal.webparts.\" + webpartImplementation;\n      }\n\n      var dynamicFunction;\n      var stringBuilder = [\"var baDynamicFn = function(facade, dataService, params){ \\r\\n\"];\n\n      stringBuilder.push(\"return new \" + webpartImplementation + \"(facade, dataService, params);\\r\\n\");\n      stringBuilder.push(\"}\\r\\n\");\n      stringBuilder.push(\"baDynamicFn\");\n\n      dynamicFunction = eval(stringBuilder.join(\"\\n\"));\n\n      // Call the dynamic function\n      return dynamicFunction(this, this.dataService, params);\n\n    } catch (e) {\n      bizagi.log(e);\n    }\n  },\n\n  /*\r\n     * call the render method for webparts and insert into canvas\r\n     */\n  executeWebpart: function executeWebpart(params) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(self.loadWebpart(params)).done(function (webpart) {\n      var webpartImplementation = webpart[\"class\"];\n      var dynamic = self.getWebpart(webpartImplementation, params);\n\n      $.when(dynamic.isAuthorized()).done(function (autorization) {\n        if (autorization) {\n          $.when(dynamic.render($.extend(params, { creating: false }))).\n          done(function () {\n            params.canvas.triggerHandler(\"ondomincluded\");\n            defer.resolve(dynamic);\n          });\n        } else {\n          defer.fail();\n        }\n      });\n    }).fail(function (e) {\n      console.log(e.message);\n      defer.fail(e);\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * execute the current user information then start the webparts\r\n      * @param {Boolean} noExecuteWebparts only currentUser request\r\n      */\n  executeWebparts: function executeWebparts(noExecuteWebparts) {\n    var self = this,\n    _canExecuteWebparts = noExecuteWebparts !== true;\n\n    // load rendering first\n    self.loadModule(self.Class.render_module);\n\n    return $.when(self.dataService.getCurrentUser()).fail(function (err) {\n      $.when(self.dataService.logoutMobile()).\n      always(function (response) {\n        self.defaultLogout();\n      });\n    }).pipe(\n    function (currentUser) {\n      // Sacar de este lugar cuando se adicione el security al currentUser\n      currentUser.userProperties = {};\n      var userProperty;\n      var i = -1;\n      self.startedOffline(self.dataService.online === false);\n      while (userProperty = currentUser.sUserProperties[++i]) {\n        currentUser.userProperties[userProperty.key] = userProperty.value;\n      }\n\n      bizagi.currentUser = currentUser;\n      var startpage = currentUser.userProperties.userstartpage = currentUser.userProperties.userstartpage || \"\";\n      self.sortMenuItemsByStartPage(startpage, currentUser);\n\n      if (_canExecuteWebparts) {\n\n        return $.when(self.loadReleaseTemplates(), self.security.getSecurity()).then(function () {\n          return $.when(\n          self.executeWebpart({\n            webpart: \"homePortal\",\n            constructorName: self.homePortalFramework.getHomePortalConstructorName(),\n            loadMeSection: self.meSection(),\n            canvas: $(\"body\") }),\n\n          self.executeWebpart({\n            webpart: \"newcase\",\n            canvas: $(\"body\") }),\n\n          self.executeWebpart({\n            webpart: \"render\",\n            canvas: $(\"body\") })).\n          then(function () {\n            bizagi.debug(\"Finalizo ejecucin de webparts workportal\");\n          });\n        });\n      }\n    });\n\n  },\n\n  loadReleaseTemplates: function loadReleaseTemplates() {\n\n    if (bizagi.loader.environment !== \"release\") {\n      return true;\n    }\n\n    var self = this;\n    var defer = new $.Deferred();\n    var prefix = bizagi.loader.useAbsolutePath ? bizagi.loader.basePath + bizagi.loader.getLocationPrefix() : \"\" + bizagi.loader.getLocationPrefix();\n    var url = prefix + \"jquery/workportalflat/production/\" + this.device.replace(/[^a-z0-9]+/gi, \"\") + \"/webpart.\" + this.device.replace(/[^a-z0-9]+/gi, \"\") + \".production.tmpl.html?build=\" + bizagi.loader.build;\n\n    steal.then({\n      src: url,\n      id: url,\n      type: \"text\",\n      waits: false,\n      onError: function onError(options) {\n        bizagi.log(\"Could not load file \" + options.src, options, \"error\");\n        defer.reject(options);\n      } }).\n    then(function () {\n      var waitingTime = 1000;\n      setTimeout(function () {\n        var data = steal.resources[url].options.text;\n        self.templates = eval(\"(\" + data + \")\");\n\n        Object.keys(self.templates).map(function (key) {\n          self.templates[key] = self.templateService.localization.translate(self.templates[key]);\n        });\n\n        defer.resolve();\n      }, waitingTime);\n    });\n\n    return defer.promise();\n  },\n\n  /**\r\n      * set homePortalLayout section to start with\r\n      * @param {String} startpage Values userstartpage property\r\n      *  \"\" -> El usuario no ha configurado esta opcin(usuario viejo).\r\n      *  \"1\" -> Automatic\r\n      *  \"2\" -> Me\r\n      *  \"3\" -> Inbox\r\n      * @param {*} currentUser \r\n      */\n  sortMenuItemsByStartPage: function sortMenuItemsByStartPage(startpage, currentUser) {\n    var self = this;\n    _isStakeholder = typeof currentUser.associatedStakeholders !== \"undefined\" && currentUser.associatedStakeholders.length > 0,\n    _automaticOrMe = startpage === \"1\" || startpage === \"2\",\n    _changingView = function _changingView() {\n      var actualChanging = self.homePortalFramework.isChangingView();\n      self.homePortalFramework.isChangingView(false);\n      return actualChanging;\n    },\n    _isChangingView = _changingView(),\n    _loadMe = self.meSection(_automaticOrMe && _isStakeholder && !_isChangingView);\n\n    if (_loadMe) {\n      // Merge layouts - Load dashboard \"dashboard\"\n      self.homePortalFramework.homePortalLayout = $.extend(self.homePortalFramework.homePortalLayoutDashboard,\n      self.homePortalFramework.homePortalLayoutTaskFeed,\n      self.homePortalFramework.homePortalLayoutComplement,\n      self.homePortalFramework.homePortalLayoutSyncErrors);\n    } else {\n      // Merge layouts - Load task feed  \"taskFeed\"\n      self.homePortalFramework.homePortalLayout = $.extend(self.homePortalFramework.homePortalLayoutTaskFeed,\n      self.homePortalFramework.homePortalLayoutDashboard,\n      self.homePortalFramework.homePortalLayoutComplement,\n      self.homePortalFramework.homePortalLayoutSyncErrors);\n    }\n  },\n\n  /**\r\n      * set the section to start with\r\n      * @param {Boolean} value true => me,  false => taskfeed\r\n      */\n  meSection: function meSection(value) {\n    var self = this;\n    if (value !== undefined) {\n      self.loadMeSection = value;\n    }\n    return self.loadMeSection;\n  },\n\n  /**\r\n      * validate if the user is a stakeholder\r\n      */\n  hasStakeholders: function hasStakeholders() {\n    return bizagi.currentUser.associatedStakeholders && bizagi.currentUser.associatedStakeholders.length > 0;\n  },\n\n  /**\r\n      * the initial value is set only, let to know if the user started the app on offline mode\r\n      * @param {Boolean} value\r\n      */\n  startedOffline: function startedOffline(value) {\n    var self = this;\n    if (value !== undefined) {\n      self._startedOffline = value;\n    }\n    return self._startedOffline;\n  },\n\n  /**\r\n      * review if is necessary call endpoint for get stakeholder info\r\n      */\n  validateUserInformation: function validateUserInformation() {\n    var self = this,\n    _needStakeholderInfo = self.startedOffline() === true,\n    _isReady = function _isReady() {\n      var defer = new $.Deferred();\n      defer.resolve();\n      return defer;\n    };\n    if (_needStakeholderInfo && self.dataService.online)\n    self.firstConnectionDone();\n    return _needStakeholderInfo ? self.executeWebparts(true) : _isReady();\n  },\n\n  /**\r\n      * any method can execute this one, to execute something on first time get internet\r\n      * on first time to get online resolve the promise, else all promise will reject\r\n      */\n  executeOnFirstOnline: function executeOnFirstOnline() {\n    var self = this,\n    _startedOnline = !self.startedOffline(),\n    _firstConDone = self._firstConnectionDone === undefined ? _startedOnline : self._firstConnectionDone,\n    _needWait = self.startedOffline() && _firstConDone === false,\n    _defer = self._firstConnectionDefer === undefined ? new $.Deferred() : self._firstConnectionDefer;\n\n    self._firstConnectionDefer = _defer;\n    self._firstConnectionDone = _firstConDone;\n    if (!_needWait) _defer.reject();\n    return _defer;\n  },\n\n  /**\r\n      * resolve the firstConnection promise ans set the flag firstConnectionDone in true\r\n      */\n  firstConnectionDone: function firstConnectionDone() {\n    var self = this;\n    self._firstConnectionDone = true;\n    if (self._firstConnectionDefer !== undefined)\n    self._firstConnectionDefer.resolve();\n  },\n\n  loadModule: function loadModule(bizagiModule) {\n    var self = this;\n    if (typeof bizagiModule !== \"string\") {\n      return;\n    }\n\n    if (typeof self.modules[bizagiModule] !== \"undefined\") {\n      return self.modules[bizagiModule];\n    }\n\n    self.modules[bizagiModule] = new $.Deferred();\n\n    bizagi.loader.start(bizagiModule).then(function () {\n      self.modules[bizagiModule].resolve();\n    });\n\n    return self.modules[bizagiModule].promise();\n  },\n\n  defaultLogout: function defaultLogout() {\n    /* istanbul ignore next: untestable */\n    if (bizagi.util.isCordovaSupported()) {\n      window.location = bizagi.services.ajax.logoutPage;\n    } else {\n      window.location.replace(\"\");\n    }\n  } });","\n/*\r\n*   Name: BizAgi Workportal Webpart helper\r\n*   Author: oscaro\r\n*   Comments:\r\n*   -   This script will define helper functions that the webparts could use to reuse some logic\r\n*/\n/*\r\n   *   Static Methods to configure webparts\r\n   */\nbizagi = typeof bizagi !== \"undefined\" ? bizagi : {};\nbizagi.webparts = typeof bizagi.webparts !== \"undefined\" ? bizagi.webparts : {};\n\n\n$.Class.extend(\"bizagi.workportal.webpart.helper\", {}, {\n  /* \r\n                                                         *   Constructor\r\n                                                         */\n  init: function init(webpart) {\n    // Set data service\n    this.dataService = webpart.dataService;\n\n    // Set l10n service\n    this.resources = webpart.resources;\n\n    // Set workportal facade\n    this.workportalFacade = webpart.workportalFacade;\n\n    //Load Aditional templates\n    this.templates = {};\n  },\n  /*  \r\n     *   Returns the file url\r\n     */\n  getFileImage: function getFileImage(files) {\n    var self = this;\n\n    if (!files || files.length == 0) return self.getEmptyFile();\n    return files;\n  },\n  getFile: function getFile(files) {\n    var self = this;\n\n    if (!files || files.length == 0) return self.getEmptyFile();\n    return self.dataService.getFile(files[0]);\n  },\n\n  loadTemplate: function loadTemplate(template, templateDestination) {\n    var self = this;\n\n    // Go fetch the template\n    return self.workportalFacade.templateService.getTemplate(templateDestination).\n    done(function (resolvedRemplate) {\n      self.templates[template] = resolvedRemplate;\n    });\n  },\n\n  //beta Iframe\n  isWebpartInIFrame: function isWebpartInIFrame() {\n    try {\n      return window.self !== window.top;\n    } catch (e) {\n      return true;\n    }\n  },\n  //pending implement\n  getFailServerErrorDeferred: function getFailServerErrorDeferred(a, b, c) {} });","/*\r\n *   Name: BizAgi Workportal Webpart Controller\r\n *   Author: Diego Parra\r\n *   Comments:\r\n *   -   This script will define a base class to all widgets\r\n */\n\n/* Asegura que el namespace este creado*/\nbizagi = typeof bizagi !== \"undefined\" ? bizagi : {};\nbizagi.webpart = typeof bizagi.webpart !== \"undefined\" ? bizagi.webpart : {};\nbizagi.webpart.subscribe = function (eventName, callback) {\n  $(document).bind(eventName, callback);\n};\nbizagi.webpart.publish = function (eventName, params) {\n  return $(document).triggerHandler(eventName, params);\n};\n\nbizagi.webpart.whenCreated = function (webpartName, callback) {\n  bizagi.webpart.subscribe(\"bizagi-webpart-created\", function (params) {\n    if (params.webpart.Class.fullname == \"bizagi.workportal.webparts.\" + webpartName) {\n      if (callback) callback(params);\n    }\n  });\n};\n\nbizagi.webpart.whenExecuted = function (webpartName, callback) {\n  bizagi.webpart.subscribe(\"bizagi-webpart-executed\", function (params) {\n    if (params.webpart.Class.fullname == \"bizagi.workportal.webparts.\" + webpartName) {\n      if (callback) callback(params);\n    }\n  });\n};\n\n\nbizagi.workportal.controllers.controller.extend(\"bizagi.workportal.webparts.webpart\", {\n  BIZAGI_WORKPORTAL_WEBPART_ROUTING: \"routing\",\n  BIZAGI_WORKPORTAL_WEBPART_RENDER: \"activityform\",\n  BIZAGI_WORKPORTAL_WEBPART_ASYNC: \"async\",\n  BIZAGI_WORKPORTAL_WEBPART_OLDRENDERINTEGRATION: \"oldrenderintegration\",\n  BIZAGI_TAP_EVENT: 'ontouchstart' in window ? 'touchend' : 'click' },\n{\n  /*\r\n   *   Constructor\r\n   */\n  init: function init(workportalFacade, dataService, params) {\n    var self = this;\n\n    self.authorizationRole = params.authorizationRole;\n    // Call base\n    this._super(workportalFacade, dataService, params);\n\n    // Set helper\n    this.helper = new bizagi.workportal.webpart.helper(this);\n\n    this.canvas = params.canvas;\n\n    this.pane = params.pane;\n\n    // Set project\n    this.project = params.project;\n    this.sharepointProxyPrefix = params.sharepointProxyPrefix;\n\n    //homePortal Framework\n    this.homePortalFramework = this.workportalFacade.homePortalFramework;\n\n    self.security = new bizagi.workportal.command.security(dataService);\n\n    // Set namespace\n    this.namespace = params.namespace;\n    // visible\n    this.isVisible = true;\n    this.isWebpartInIFrame = typeof params.isWebpartInIFrame != 'undefined' ? params.isWebpartInIFrame : self.helper.isWebpartInIFrame();\n    this.adjustButtonsToContent = params.adjustButtonsToContent;\n    this.remoteServer = params.remoteServer;\n\n    if (this.remoteServer) {\n\n      //postmessage object definition\n      self.postmessageSocket = new bizagi.postmessage({\n        remoteServer: this.remoteServer,\n        destination: window.parent,\n        origin: window });\n\n      self.postmessageSocket.receive = function (msg) {\n        var params = msg.data;\n\n        // Auto-discard self messages\n        if (params.message) {\n          if (params.message.iframeidentifier == BIZAGI_IFRAME_IDENTIFIER) {\n            return;\n          }\n        }\n\n        if (params.event) {\n          switch (params.event) {\n            case \"postmessage-bizagi-canCloseIFramePopUp\":\n              if (self.canHide && self.Class.shortName == params.message.webPartDestine) {\n                $.when(self.canHide()).\n                done(function () {\n                  var iframeclosemsg = {};\n                  iframeclosemsg.event = \"postmessage-bizagi-closeIFramePopUp\";\n                  iframeclosemsg.message = {};\n                  iframeclosemsg.message.iframeidentifier = BIZAGI_IFRAME_IDENTIFIER;\n                  self.postmessageSocket.send(iframeclosemsg);\n                  var showCasesMSG = {\n                    message: {} };\n\n                  showCasesMSG.event = \"ui-bizagi-reload-cases\";\n                  self.postmessageSocket.send(showCasesMSG);\n                });\n              }\n              break;\n            case \"postmessage-bizagi-openParentPopUp\":\n              //Do nothing this message is for parent\n              break;\n            default:\n              //re send message to other webparts\n              self.publish(params.event, params.message, true);\n              break;}\n\n        } else {\n          //set iframe height and width\n\n        }\n      };\n      self.postmessageSocket.startReceiving();\n      self.sendDimensionsiFrame();\n    }\n  },\n\n  /**\r\n      * Check if the current user have permitions to execute this webpart\r\n      * @returns bolean\r\n      */\n  isAuthorized: function isAuthorized() {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.workportalFacade.security.checkSecurityPerm(self.authorizationRole)).done(function (perm) {\n      if (perm || typeof self.authorizationRole == \"undefined\") {\n        def.resolve(true);\n      } else {\n        def.resolve(false);\n      }\n    });\n\n    return def.promise();\n  },\n\n\n  sendDimensionsiFrame: function sendDimensionsiFrame(mandatorysend) {\n    var self = this;\n    //If webpart is put in iFrame resize the iframe with content height\n    //else if iframe show in popUp FixButtons, is desirable\n    //If namespace is defined this is a chil webpart\n    //delay wait for finish render\n    if (this.remoteServer) {\n      if (!!!self.adjustButtonsToContent && (!!!self.namespace || mandatorysend)) {\n        if (self.isWebpartInIFrame) {\n          window.setTimeout(function () {\n\n            var iframeDimentions = {\n              message: {} };\n\n            iframeDimentions.message.iframeName = BIZAGI_IFRAME_IDENTIFIER;\n            iframeDimentions.message.iframeHeight = $('body').height();\n            if (self.Class.shortName == \"newcaselist\") {\n            } else {\n              iframeDimentions.message.iframeWidth = undefined;\n            }\n            self.postmessageSocket.send(iframeDimentions);\n\n\n          }, 50);\n        }\n      }\n    }\n\n  },\n\n  /**\r\n      *   Publish an event so any controller can subscribe to it\r\n      */\n  publish: function publish(eventName, params, notFireToIframe) {\n    var self = this;\n    eventName = this.namespace ? this.namespace + \".\" + eventName : eventName;\n    //publish event to iframe\n    if (!!!notFireToIframe && eventName.indexOf(\"bizagi-webpart-created\") == -1 && eventName.indexOf(\"bizagi-webpart-executed\") == -1 && self.postmessageSocket) {\n      var msg = {};\n      msg.event = eventName;\n      //By iFrame messages it can not transmit the canvas object or object workportal\n      if (params) {\n        params.canvas = null;\n        params.workportal = null;\n      }\n      msg.message = {};\n      msg.message = $.extend(params, {\n        project: this.project,\n        iframeidentifier: BIZAGI_IFRAME_IDENTIFIER });\n\n      self.postmessageSocket.send(msg);\n    }\n    //publish event localy in webparts\n    return this._super(eventName, $.extend(params, {\n      project: this.project }));\n\n  },\n\n  /**\r\n      *   Subscribe to an event that any controller could trigger\r\n      */\n  subscribe: function subscribe(eventName, callback) {\n    var self = this;\n    eventName = this.namespace ? this.namespace + \".\" + eventName : eventName;\n    this._super(eventName, function (e, params) {\n      if (typeof params === 'undefined') params = {};\n      if (self.project == params.project && self.isVisible)\n      return callback(e, params);\n    });\n  },\n\n  /**\r\n      *   UnSubscribe to an event that any controller could trigger\r\n      */\n  unsubscribe: function unsubscribe(eventName, callback) {\n    var self = this;\n    eventName = this.namespace ? this.namespace + \".\" + eventName : eventName;\n    this._super(eventName, callback);\n  },\n\n  /*\r\n      *   Re-draw the webpart\r\n      */\n  refresh: function refresh(params) {\n    var self = this;\n\n    var content;\n    // Clear content\n    if (self.canvas.data(\"role\") == \"view\") {\n      content = self.canvas.data(\"kendoMobileView\").contentElement();\n    } else {\n      content = self.canvas;\n    }\n    content.empty();\n    // Dispose stuff\n    //self.prepareForRefresh();\n\n    // Re-draw content;\n    return self.render(params).then(function (newContent) {\n      content.append(newContent);\n      self.canvas.triggerHandler(\"ondomincluded\");\n      return \"included\";\n    });\n  },\n\n  /*\r\n      *   Renders the web part\r\n      *   Also ensures that templates are loaded\r\n      */\n  render: function render(params) {\n    var self = this;\n\n    // Set params in webpart variable\n    self.params = params;\n\n    if (params.creating) {\n      self.content = self.empty();\n\n      // Trigger webpart created event\n      self.publish(\"bizagi-webpart-created\", {\n        webpart: self });\n\n\n      return self.content;\n    }\n\n    // Trigger webpart created event\n    self.publish(\"bizagi-webpart-created\", {\n      webpart: self });\n\n\n    // Load templates\n    return $.when(self.renderContent(params)).\n    pipe(function (content) {\n      // Then customize in current device\n      // if you use kendoTmpl the object string is transformed to object html -jquery\n      if (typeof content == \"string\") {\n        content = $(content);\n      }\n\n      self.content = content;\n      params.canvas.append(content);\n\n      return $.when(self.postRender(params)).then(function () {\n        // Trigger webpart executed event\n        self.publish(\"bizagi-webpart-executed\", {\n          webpart: self });\n\n        self.sendDimensionsiFrame();\n        return self.getContent();\n      });\n    });\n  },\n\n  /*\r\n      *   Renders the web part, override this method in each webpart\r\n      */\n  renderContent: function renderContent(params) {},\n\n  /*\r\n                                                     *   Customize the web part in each device\r\n                                                     */\n  postRender: function postRender(params) {},\n\n  /*\r\n                                               *   Return the rendered content\r\n                                               */\n  getContent: function getContent() {\n    return this.content;\n  },\n\n  /*\r\n      *   Creates an empty content\r\n      */\n  empty: function empty() {\n    return $(\"<div/>\");\n  },\n\n  /*  \r\n      *   Return a specified template\r\n      */\n  getTemplate: function getTemplate(template) {\n    return this.workportalFacade.getTemplate(template);\n  },\n\n  /*  \r\n      *   Create webpart\r\n      */\n  createWebpart: function createWebpart(params) {\n    return this.workportalFacade.workportal.createWebpart(params);\n  },\n\n  /*  \r\n      *   Execute webpart\r\n      */\n  executeWebpart: function executeWebpart(params) {\n    return this.workportalFacade.workportal.executeWebpart(params);\n  },\n  /**\r\n      *   Manage the error in base class\r\n      */\n  manageError: function manageError(msg, defer, canvasError) {\n    var self = this;\n    var errorMsg = '';\n    if (msg.responseText) {\n      errorMsg = msg.responseText;\n    } else {\n      errorMsg = msg;\n    }\n    if (errorMsg.indexOf(\"AUTHENTICATION_ERROR\") == -1) {\n      self.helper.getFailServerErrorDeferred({\n        message: errorMsg,\n        sharepointProxyPrefix: self.sharepointProxyPrefix },\n      defer);\n      self.endWaiting();\n      //en caso de no tener un canvasError el error se despliega en todo el content\n      if (canvasError) {\n        defer.done(function (value) {\n          canvasError.append(value);\n          self.endWaiting();\n        });\n      }\n      //defer.resolve(msg);\n    } else {\n      //when it's generate autentication error, cannot load the template\n      var content = self.content = \"<div class='ui-bizagi-webpart-error-message'>The current user does not exist as a registered user in the bizagi project</div>\";\n      if (canvasError) {\n        canvasError.append(content);\n      }\n      self.endWaiting();\n      defer.resolve(content);\n    }\n  },\n\n  /**\r\n      *   Hide WebPart\r\n      */\n  hide: function hide(hideParent) {\n    var self = this;\n    self.canvas.hide();\n    if (hideParent) {\n      self.canvas.parent().hide();\n    }\n    self.isVisible = false;\n  },\n  /**\r\n      *    Show WebPart\r\n      */\n  show: function show() {\n    var self = this;\n    self.canvas.show();\n    self.canvas.parent().show();\n    self.isVisible = true;\n  },\n  /**\r\n      *    visible flat\r\n      */\n  isVisible: function isVisible() {\n    var self = this;\n    return self.isVisible;\n  },\n\n  destroy: function destroy() {\n\n  },\n\n  getHomeportalFrameworkIntance: function getHomeportalFrameworkIntance() {\n    if (!this.workportalFacade.homePortalFramework) {\n      this.workportalFacade.homePortalFramework = new bizagi.workportal.homeportalFramework(this.workportalFacade);\n    }\n    return this.workportalFacade.homePortalFramework;\n  } });","/**\r\n * Created by RicardoPD on 3/20/2015.\r\n */\n\nbizagi.workportal.webparts.webpart.extend(\"bizagi.workportal.webparts.rendermanager\", {},\n\n{\n  /*\r\n   *   Constructor\r\n   */\n  init: function init(workportalFacade, dataService, initialParams) {\n    var self = this;\n    // Call base\n    this._super(workportalFacade, dataService, initialParams);\n    if (!initialParams || typeof initialParams.navigator == 'undefined') {\n      console.error(\"it is a render webpart and there is no navigator to this webpart\");\n    }\n    self.navigator = initialParams.navigator;\n\n  } });","/*\r\n *   Name:\r\n *   Author: Luis Cabarique - LuisCE\r\n *   Comments:\r\n *   -   This script will define homePortal Framework\r\n */\nbizagi = typeof bizagi !== \"undefined\" ? bizagi : {};\nbizagi.webparts = typeof bizagi.webparts !== \"undefined\" ? bizagi.webparts : {};\n\n\nbizagi.workportal.homeportalFramework.extend(\"bizagi.workportal.homeportalFramework\", {}, {\n  /**\r\n                                                                                             *   Constructor\r\n                                                                                             */\n  init: function init(workportalFacade) {\n    var self = this;\n    self._super(workportalFacade);\n    self.deviceType = \"tablet\";\n\n    self.homePortalLayout = {};\n\n    self.homePortalLayoutDashboard = {\n      \"menuHome\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"left\",\n        \"type\": \"view\",\n        \"canvas\": \"menuHome\",\n        \"title\": \"\",\n        \"layout\": \"menu-default\" },\n\n      \"dashBoard\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"type\": \"view\",\n        \"canvas\": \"dashBoard\",\n        \"title\": \"\",\n        \"layout\": \"main-default\" } };\n\n\n\n    self.homePortalLayoutComplement = {\n      \"reportsChart\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"canvas\": \"reportsChart\",\n        \"title\": \"Reports\",\n        \"layout\": \"main-default-close\" },\n\n      \"loadForm\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"type\": \"view\",\n        \"canvas\": \"loadForm\",\n        \"title\": \"Search Form\",\n        \"layout\": \"main-default-close-action\" },\n\n      \"renderTemplates\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"type\": \"view\",\n        \"canvas\": \"renderTemplates\",\n        \"title\": \"Render Template\",\n        \"layout\": \"main-double-header\" },\n\n      \"caseTemplates\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"type\": \"view\",\n        \"canvas\": \"caseTemplates\",\n        \"title\": \"\",\n        \"layout\": \"main-double-header-cases\" },\n\n      \"caseTemplatesOptions\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"left\",\n        \"type\": \"view\",\n        \"canvas\": \"caseTemplatesOptions\",\n        \"title\": \"\",\n        \"layout\": \"side-default-back\" },\n\n      \"stakeHolder\": {\n        \"position\": \"homePortal\",\n        \"canvas\": \"menuHome\" },\n\n      \"shortCut\": {\n        \"position\": \"menuHome\",\n        \"canvas\": \"shortCut\" },\n\n      \"searchesList\": {\n        \"position\": \"menuHome\",\n        \"canvas\": \"searchesList\" },\n\n      \"stuff\": {\n        \"position\": [\"dashBoard\"],\n        \"canvas\": [\"stuff\"] } };\n\n\n\n    var req = self.viewRequirements(self._viewTaskFeedMode());\n    self.homePortalWebpart = req.homePortalWebpart;\n    self.menuWebpart = req.menuWebpart;\n    self.homePortalLayoutTaskFeed = req.taskFeedLayout;\n\n    self.homePortalLayoutSyncErrors = {\n      \"syncErrors\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"type\": \"view\",\n        \"canvas\": \"syncErrors\",\n        \"title\": \"Sync errors\",\n        \"layout\": \"main-syncErrors-header\" } };\n\n\n\n    bizagi.util.mobility.leftPaneViewShown = $.proxy(self.leftPaneViewShown, self);\n  },\n\n  /**\r\n      * constants for view mode in taskFeed\r\n      */\n  VIEW_TASKFEED_MODE: {\n    CARDS: \"cards\",\n    LIST: \"list\" },\n\n\n  /**\r\n                     * return the homePortal and layout for taskFeed depends of the View\r\n                     * @param {String} viewToShow \r\n                     */\n  viewRequirements: function viewRequirements(viewToShow) {\n    var self = this,\n    _homePortalLayoutTaskFeed = {\n      \"taskFeed\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"left\",\n        \"type\": \"view\",\n        \"canvas\": \"taskFeed\",\n        \"title\": \"\",\n        \"layout\": \"side-default\" },\n\n      \"summaryItem\": {\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"canvas\": \"summaryItem\",\n        \"type\": \"view\",\n        \"title\": \"\",\n        \"layout\": \"main-default\" } },\n\n\n    _homePortalLayoutCards = {\n      \"taskFeed\": {\n        \"constructorName\": \"taskFeedCards\",\n        \"position\": \"homePortal\",\n        \"direction\": \"right\",\n        \"type\": \"view\",\n        \"canvas\": \"taskFeed\",\n        \"title\": \"\",\n        \"layout\": \"main-default\" },\n\n      \"summaryItem\": {\n        \"constructorName\": \"summaryItemCards\",\n        \"position\": \"homePortal\",\n        \"canvas\": \"summaryItem\" } },\n\n\n    _res = {},\n    _default = {\n      homePortalWebpart: {\n        constructorName: undefined },\n\n      menuWebpart: {\n        constructorName: undefined },\n\n      taskFeedLayout: _homePortalLayoutTaskFeed };\n\n    switch (viewToShow) {\n      case self.VIEW_TASKFEED_MODE.LIST:\n        _res = _default;\n        break;\n\n      case self.VIEW_TASKFEED_MODE.CARDS:\n        _res.homePortalWebpart = {\n          constructorName: \"homePortalCards\" };\n\n        _res.menuWebpart = {\n          constructorName: \"menuCards\" };\n\n        _res.taskFeedLayout = _homePortalLayoutCards;\n        break;\n\n      default:\n        console.error(\"Error: view to show is not defined\");\n        _res = _default;\n        break;}\n\n    return _res;\n  },\n\n  /**\r\n      * return the constructor name for homePortal\r\n      */\n  getHomePortalConstructorName: function getHomePortalConstructorName() {\n    var self = this;\n    return self.homePortalWebpart.constructorName;\n  },\n\n  /**\r\n      * return the constructor name for menu\r\n      */\n  getMenuConstructorName: function getMenuConstructorName() {\n    var self = this;\n    return self.menuWebpart.constructorName;\n  },\n\n  /**\r\n      * return the constructor name for summaryItem \r\n      */\n  getSummaryItemConstructorName: function getSummaryItemConstructorName() {\n    var self = this;\n    return self.homePortalLayoutTaskFeed.summaryItem.constructorName;\n  },\n\n  _back: function _back(direction) {\n    var self = this;\n\n    // Add conditions to direction\n    if (direction === \"left\") {\n      $(\"#left-pane\").data(\"kendoMobilePane\").navigate(\"#:back\");\n    } else {\n      $(\"#right-pane\").data(\"kendoMobilePane\").navigate(\"#:back\");\n    }\n  },\n\n  _backRenderTemplates: function _backRenderTemplates(transition) {\n    var self = this;\n\n    if (self.accumulatedContext.length > 1) {\n      var context = self.accumulatedContext[self.accumulatedContext.length - 1];\n      var accumulatedContext = self.popContext().context;\n      if (context.navigateFromRender) {\n        bizagi.kendoMobileApplication.navigate(\"renderSplitView\");\n        self.navigateFromRender = false;\n      } else {\n        var data = accumulatedContext[accumulatedContext.length - 1];\n        var args = {\n          data: data,\n          calculateFilters: data.calculateFilters || false,\n          filters: [],\n          eventType: \"DATA-NAVIGATION\" };\n\n\n        bizagi.webpart.publish(\"homeportalShow\", {\n          \"what\": \"stuffTemplates\",\n          \"title\": args.data.displayName,\n          \"params\": args,\n          \"preventNavigate\": true });\n\n      }\n    } else {\n      if (self.navigateFromRender) {\n        bizagi.kendoMobileApplication.navigate(\"renderSplitView\");\n        self.navigateFromRender = false;\n      }\n    }\n\n    self._back(transition);\n  },\n\n  _collapseHomePortalPane: function _collapseHomePortalPane() {\n    $(\"#homePortal\").data(\"kendoMobileSplitView\").collapsePanes();\n  },\n\n  configureHandler: function configureHandler() {\n    var self = this;\n    self._super();\n  },\n\n  navigateToRenderTemplates: function navigateToRenderTemplates(pane) {\n    $(\"#homePortal #right-pane\").data(\"kendoMobilePane\").navigate(\"renderTemplates\");\n    bizagi.kendoMobileApplication.navigate(\"homePortal\");\n  },\n\n  /**\r\n      * navigation control\r\n      * @param navParams\r\n      */\n  homePortalNavigate: function homePortalNavigate(navParams) {\n    var destination = navParams.url;\n    var canvas = navParams.sender.element;\n  },\n\n  /**\r\n      *\r\n      * @param context\r\n      */\n  homePortalViewInit: function homePortalViewInit(context) {\n    var self = this;\n    self._super(context);\n    self.destination = context.view.id.replace(/#/i, \"\");\n    self.content = context.view.element;\n    self.container = context.view.container;\n\n    switch (self.destination) {\n      case \"summaryItem\":\n        $(self.content).on(\"click\", \".bz-header-open-leftPane\", function (event) {\n          self._openLeftPane();\n        });\n        $(self.content).on(\"click\", \".btn-back\", function (event) {\n          self._back();\n        });\n        $(self.content).on(\"touchend\", \"#bz-workarea-newcase\", function (event) {\n          event.preventDefault();\n          self.showNewCase();\n        });\n        $(self.content).on(\"touchend\", \"#bz-workarea-changeview\", function (event) {\n          event.preventDefault();\n          self.changeView();\n        });\n        $(self.content).on(\"touchend\", \"#bz-workarea-view-sync-panel\", function (event) {\n          event.preventDefault();\n          self.showSyncPanel();\n        });\n        break;\n      case \"dashBoard\":\n        $(\".km-view-title\", self.content).children().text(\"DashBoard\");\n        $(self.content).on(\"click\", \".bz-header-open-leftPane\", function (event) {\n          self._openLeftPane();\n        });\n        $(self.content).on(\"click\", \".btn-back\", function (event) {\n          self._back();\n        });\n        $(self.content).on(\"click\", \"#bz-workarea-newcase\", function (event) {\n          self.showNewCase();\n        });\n        break;\n      case \"discussionCase\":\n        $(self.content).on(\"click\", \".btn-back\", function (event) {\n          self._back();\n        });\n        $(self.content).on(\"click\", \"#bz-workarea-newcase\", function (event) {\n          self.showNewCase();\n        });\n        break;\n      case \"menuHome\":\n        $(self.content).data(\"kendoMobileView\").header.on(\"click\", \".btn-menu\", function (event) {\n          self.showMenu();\n        });\n        break;\n      case \"taskFeed\":\n        $(self.content).on(\"touchend\", \".bz-header-left-btn.btn-open-drawer\", function (event) {\n          event.preventDefault();\n          self.showMenu();\n        });\n\n        $(self.content).on(\"touchend\", \"#bz-workarea-newcase\", function (event) {\n          event.preventDefault();\n          self.showNewCase();\n        });\n        $(self.content).on(\"touchend\", \"#bz-workarea-changeview\", function (event) {\n          event.preventDefault();\n          self.changeView();\n        });\n        $(self.content).on(\"touchend\", \"#bz-workarea-view-sync-panel\", function (event) {\n          event.preventDefault();\n          self.showSyncPanel();\n        });\n        break;\n      case \"syncErrors\":\n        $(self.content).on(\"click\", \".btn-back\", function (event) {\n          // Only in main view (activities + summary) not in cards\n          if (self._viewTaskFeedMode() === self.VIEW_TASKFEED_MODE.LIST) {\n            // for show taskFeed panel\n            bizagi.webpart.publish(\"bz-left-panel-show\");\n            self.destination = 'summaryItem';\n          } else\n          {\n            self.destination = 'taskFeed';\n          }\n          bizagi.webpart.publish(\"bz-update-list-cases\", { updateDataList: true });\n          self._back();\n        });\n        break;\n      case \"caseTemplatesOptions\":\n        $(self.content).on(\"click\", \".bz-header-left-btn.btn-back\", function (event) {\n          self._back(\"right\");\n          self._back(\"left\");\n        });\n        break;\n      case \"caseTemplates\":\n        $(self.content).on(\"click\", \".bz-header-open-leftPane\", function (event) {\n          self._openLeftPane();\n        });\n        $(self.content).on(\"click\", \"#bz-workarea-newcase\", function (event) {\n          self.showNewCase();\n        });\n        break;\n      case \"renderTemplates\":\n        $(self.content).on(\"click\", \".btn-back\", function (event) {\n          self._backRenderTemplates();\n        });\n        $(self.content).on(\"click\", \"#bz-workarea-newdata\", function (event) {\n          bizagi.webpart.publish(\"newData\");\n        });\n        $(self.content).on(\"click\", \".bz-header-open-leftPane\", function (event) {\n          self._openLeftPane();\n        });\n        break;\n      case \"reportsChart\":\n        $(self.content).on(\"click\", \".btn-close\", function (event) {\n          $(\"iframe\", \".bz-wp-reports-chart\").remove();\n          $(\".bz-wp-reports-chart\", self.content).empty();\n\n          self.reportsChartEndLeftPanel();\n        });\n        break;}\n\n  },\n\n  /**\r\n      * when view is shown\r\n      * @param navParams\r\n      */\n  homePortalViewShow: function homePortalViewShow(navParams) {\n    var self = this;\n    var navLength;\n    self._super(navParams);\n    self.destination = navParams.view.id.replace(/#/i, \"\");\n    self.content = navParams.view.element;\n    self.container = navParams.view.container;\n\n\n    switch (self.destination) {\n      case \"renderTemplates\":\n        $(\".km-view-title\", self.content).children().text(\"DashBoard\");\n        break;\n\n      case \"caseTemplates\":\n        //fix navigation bug\n        navLength = navParams.sender.history.length;\n        if (navParams.sender.history[navLength - 1] === navParams.sender.history[navLength - 3]) {\n          navParams.sender.history.pop();\n          navParams.sender.history.pop();\n        }\n\n        $(\"#left-pane\").getKendoMobilePane().navigate(\"caseTemplatesOptions\");\n        break;\n\n      case \"reportsChart\":\n        navLength = navParams.sender.history.length;\n        if (navParams.sender.history[navLength - 1] === navParams.sender.history[navLength - 3]) {\n          navParams.sender.history.pop();\n        }\n\n        $(\".km-view-title\", self.content).children().text(\"\");\n\n        $(\".btn-close\", self.content).unbind(\"click\").bind(\"click\", function () {\n          $(\"iframe\", \".bz-wp-reports-chart\").remove();\n          $(\".bz-wp-reports-chart\", self.content).empty();\n\n          $(\".km-view-title\", self.content).children().text(\"\");\n          self._back();\n        });\n\n        self.reportsChartEndLeftPanel = self.reportsChartStartLeftPanel();\n        break;\n\n      case \"syncErrors\":\n        break;\n\n      default:\n\n        break;}\n\n\n    self.getMenuWebpartInstance();\n  },\n\n  /**\r\n      * hide the left panel and return the method to show again if is actually shown, else omit everything\r\n      */\n  reportsChartStartLeftPanel: function reportsChartStartLeftPanel() {\n    var self = this,\n    _leftPanel = $(\"#left-pane\", self.canvas),\n    _isVisible = _leftPanel.css(\"display\") !== \"none\",\n    _action = _isVisible ? _leftPanel.toggle.bind(_leftPanel) : function () {};\n    _action();\n    return _action;\n  },\n\n  leftPaneViewShown: function leftPaneViewShown(navParams) {\n    var self = this;\n\n    self.leftDestination = navParams.view.id.replace(/#/i, \"\");\n    self.leftContent = navParams.view.element;\n  },\n\n  _openLeftPane: function _openLeftPane() {\n    var self = this;\n\n    var view = bizagi.kendoMobileApplication.view();\n    view.expandPanes();\n  },\n\n  homePortalLayoutInit: function homePortalLayoutInit(context) {\n  },\n\n  /**\r\n      * Close all open drawers\r\n      */\n  closeDrawers: function closeDrawers() {\n    $(\"#newCase-drawer\").data(\"kendoMobileDrawer\").hide();\n  },\n\n  /**\r\n      * For new case\r\n      */\n  showNewCase: function showNewCase() {\n    this.showDrawer(\"newCase\");\n  },\n\n  /**\r\n      * For showSyncPanel\r\n      */\n  showSyncPanel: function showSyncPanel() {\n    this.showDrawer(\"syncErrors\");\n  },\n\n  /**\r\n      * toggle the list view to cards\r\n      */\n  changeView: function changeView() {\n    var self = this,\n    _view = self.VIEW_TASKFEED_MODE,\n    _newView =\n    self._viewTaskFeedMode() === _view.CARDS ? _view.LIST : _view.CARDS;\n    self._viewTaskFeedMode(_newView);\n    self.isChangingView(true);\n    location.reload();\n  },\n\n  /**\r\n      * return a localStorage value of the key and if the val is set the value is overrided\r\n      * if the localStorage does not have value the defaultVal is used\r\n      */\n  _getSetLocalStorage: function _getSetLocalStorage(key, val, defaultVal) {\n    var _actualValue = function _actualValue() {return localStorage.getItem(key);},\n    _setValue = function _setValue(val) {return localStorage.setItem(key, val);},\n    _getValue = function _getValue() {\n      if (_actualValue() === null)\n      _setValue(defaultVal);\n      return _actualValue();\n    };\n    if (val !== undefined)\n    _setValue(val);\n    return _getValue();\n  },\n\n  /**\r\n      * return the view for taskFeed and let set the new value too\r\n      */\n  _viewTaskFeedMode: function _viewTaskFeedMode(val) {\n    var self = this,\n    _key = \"homePortalView\",\n    _default = self.VIEW_TASKFEED_MODE.LIST;\n\n    return bizagi.util.isMobileInboxCardViewSupported() ?\n    self._getSetLocalStorage(_key, val, _default) :\n    _default;\n  },\n\n  /**\r\n      * return the view for taskFeed and let set the new value too\r\n      */\n  isChangingView: function isChangingView(val) {\n    var self = this,\n    _key = \"homePortalChangingView\",\n    _default = false;\n    return self._getSetLocalStorage(_key, val, _default) == \"true\";\n  },\n\n  /**\r\n      * Show menu sidebar\r\n      */\n  showMenu: function showMenu() {\n    var self = this;\n    self.getMenuWebpartInstance().done(function (instance) {\n      instance.showModal();\n    });\n  },\n\n  /**\r\n      * if there is not an instance, create a new and resolve else just resolve\r\n      * this includes Native menu, so please NO override the constructorName here\r\n      */\n  getMenuWebpartInstance: function getMenuWebpartInstance() {\n    var self = this,\n    _isReady = self.menuWebpartInstance !== undefined,\n    _newInstance = self.workportalFacade.executeWebpart.bind(self.workportalFacade, {\n      webpart: \"menu\",\n      canvas: $(\"body\"),\n      isCardsLayout: self.homePortalWebpart.constructorName === \"homePortalCards\" }),\n\n    _saveInstance = function _saveInstance(instance) {self.menuWebpartInstance = instance;},\n    defer = _isReady ? new $.Deferred() : _newInstance();\n\n    _isReady ? defer.resolve(self.menuWebpartInstance) : defer.then(_saveInstance);\n\n    return defer;\n  } });","/*\r\n*   Name: BizAgi Reporting Definition JSON\r\n*   Author: David Romero\r\n*   Comments:\r\n*   -   This script defines global components for reports\r\n*/\n\nif (!bizagi.reporting) {\n  bizagi.reporting = {};\n}\n\nbizagi.reporting = {\n  BAMProcess: {\n    defaultReport: \"bamprocessloadanalysis\",\n    info: {\n      reportSet: 1 },\n\n    reports: {\n      \"bamprocessloadanalysis\": {\n        components: [\"filters-processversion\", \"filters-dimension\"],\n        resource: \"bz-rp-loadanalysis-tab\" },\n\n      \"bamprocessworkinprogress\": {\n        components: [\"filters-processversion\", \"filters-dimension\"],\n        resource: \"bz-rp-workinprogress-tab\" } } },\n\n\n\n  BAMTask: {\n    defaultReport: \"bamtasksworkinprogress\",\n    info: {\n      reportSet: 2 },\n\n    reports: {\n      \"bamtasksworkinprogress\": {\n        components: [\"filters-processversion\", \"filters-dimension\"],\n        resource: \"bz-rp-workinprogress-tab\" },\n\n      \"bamtaskloadanalysis\": {\n        components: [\"filters-processversion\", \"filters-dimension\"],\n        resource: \"bz-rp-loadanalysis-tab\" } } },\n\n\n\n  AnalyticsProcess: {\n    defaultReport: \"analyticsprocesscycletime\",\n    info: {\n      reportSet: 3 },\n\n    reports: {\n      \"analyticsprocesscycletime\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-cycletime-tab\" },\n\n      \"analyticsprocessdurationhistogram\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-durationhistogram-tab\" },\n\n      \"analyticsprocessactivity\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-processactivity-tab\" },\n\n      \"analyticsprocessactivationranking\": {\n        components: [\"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-activationranking-tab\" },\n\n      \"analyticsprocessfrequentspaths\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-frequentspaths-tab\" } } },\n\n\n\n  AnalyticsTask: {\n    defaultReport: \"analyticstaskcycletime\",\n    info: {\n      reportSet: 4 },\n\n    reports: {\n      \"analyticstaskcycletime\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-cycletime-tab\" } } },\n\n\n\n  ResourceBAM: {\n    callBack: \"myTeamCallBack\",\n    defaultReport: \"bamresourcemonitorworkinprogress\",\n    info: {\n      reportSet: 6 },\n\n    reports: {\n      \"bamresourcemonitorworkinprogress\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-workinprogress-tab\" },\n\n      \"bamresourcemonitorworkinprogressuser\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-workinprogressuser-tab\" },\n\n      \"bamresourcemonitorworkinprogressteam\": {\n        components: [\"filters-processversion\", \"filters-dimension\", \"filters-time\"],\n        resource: \"bz-rp-workinprogressteam-tab\" } } },\n\n\n\n  AnalyticsSensor: {\n    defaultReport: \"sensors\",\n    reports: {\n      \"sensors\": {\n        components: [\"filters-dimension\", \"filters-time\"] } },\n\n\n    info: {\n      reportSet: 5 } } };","/*\r\n*   Name: BizAgi Workportal Search Command\r\n*   Author: Richar Urbano - RicharU\r\n*   Comments:\r\n*   -   This script will define a common class to access the search capability\r\n*/\n\n$.Class(\"bizagi.workportal.command.search\", {\n  SEARCH_PAGE_SIZE: 30,\n  SEARCH_DELAY: 700 },\n{\n  init: function init(dataService) {\n    var self = this;\n\n    self.isTabletDevice = bizagi.util.isTabletDevice();\n    self.enableOfflineForm = bizagi.util.hasOfflineFormsEnabled();\n\n    self.dataService = dataService;\n  },\n\n  searchList: function searchList(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Offline type of tray\n    params.inputtray = bizagi.util.inputTray(self.dataService.online);\n\n    var referrerParams = {\n      radNumber: $.trim(params.query),\n      idWorkflow: \"\",\n      taskState: \"all\",\n      onlyFavorites: false,\n      order: \"\",\n      numberOfFields: 2,\n      orderFieldName: \"\",\n      orderType: \"0\",\n      page: params.page || 1,\n      pageSize: self.Class.SEARCH_PAGE_SIZE,\n      inputtray: params.inputtray ? params.inputtray : \"inbox\" };\n\n\n    if (bizagi.util.isQuickSearchEnabled()) {\n      return self.loadDataListBeta(referrerParams);\n    } else {\n      return self.loadDataList(referrerParams);\n    }\n  },\n\n  /*\r\n     *   Load data by server\r\n     */\n  loadDataList: function loadDataList(params) {\n    var self = this;\n\n    return self.dataService.getCasesByWorkflow(params).done(function (data) {\n      data.elements = [];\n      var elements = [];\n\n      if (data.totalPages === 0) {\n        elements.push({ noResults: true, message: bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\") });\n      }\n\n      for (var counter = 0, length = data.rows.length; length > counter; counter++) {\n\n        var tmpElement = data.rows[counter][\"fields\"];\n        var radNumber = data.rows[counter].radnumber || data.rows[counter].id;\n        var element = {};\n        var solutionDateElement = tmpElement[tmpElement.length - 1];\n        var resultElement = {};\n\n        element.radNumber = radNumber;\n\n        // Get solutionDate                \n        if (typeof solutionDateElement.Value != \"string\") {\n\n          for (var i = 0, elementLength = solutionDateElement.Value.length; i < elementLength; i++) {\n            var dateValue = solutionDateElement.Value[i];\n            if (dateValue !== \"\" && typeof dateValue == \"string\") {\n              resultElement.solutionDate = dateValue;\n              break;\n            }\n          }\n        } else {\n          resultElement.solutionDate = solutionDateElement.Value;\n        }\n\n        // Get format solutionDate\n        resultElement.solutionDate = bizagi.util.getTaskStatus(resultElement.solutionDate);\n\n        // Get process name\n        for (var j = 0; j < tmpElement.length; j++) {\n          if (tmpElement[j].DisplayName === \"Process\") {\n            resultElement.processName = tmpElement[j].Value;\n            break;\n          }\n        }\n\n        // If not process name found, get the first row\n        if (!resultElement.processName) {\n          resultElement.processName = tmpElement[0].Value;\n        }\n\n        // Get workItems data and build result element\n        if (typeof data.rows[counter].workitems != \"undefined\") {\n\n          var dataRowWorkItems = data.rows[counter].workitems;\n          for (var counterCase = 0; dataRowWorkItems.length > counterCase; counterCase++) {\n            element[0] = data.rows[counter][\"id\"];\n            element[1] = dataRowWorkItems[counterCase][\"idWorkItem\"];\n            element[2] = dataRowWorkItems[counterCase][\"idTask\"];\n            element[\"state\"] = dataRowWorkItems[counterCase][\"State\"].toLowerCase() || \"gray\";\n            element[5] = dataRowWorkItems[counterCase][\"TaskName\"] || bizagi.localization.getResource(\"webpart-cases-summary-without-name\");\n            element[6] = [];\n            element[6][0] = [];\n            element[6][0] = [0, data.rows[counter][\"id\"]];\n\n            element[4] = resultElement.processName;\n            element[3] = resultElement.solutionDate;\n\n            // OfflineForm\n            if (data.rows[counter].isOfflineForm) {\n              element[7] = data.rows[counter].isOfflineForm;\n              element[8] = data.rows[counter].isOpen;\n            }\n\n            // Clone element to a new one, to avoid that final result stays with the last element repeated\n            var newObject = $.extend(true, {}, element);\n            elements.push(newObject);\n          }\n        } else {\n\n          element[0] = data.rows[counter][\"id\"];\n          element[1] = element[2] = 0;\n          element[5] = bizagi.localization.getResource(\"webpart-cases-summary-without-name\");\n          element[\"state\"] = \"gray\";\n          element[6] = [];\n          element[6][0] = [];\n          element[6][0] = [0, data.rows[counter][\"id\"]];\n          element[4] = resultElement.processName;\n          element[3] = resultElement.solutionDate;\n\n          // OfflineForm\n          if (data.rows[counter].isOfflineForm) {\n            var grouped = bizagi.getGroupedData(tmpElement[3]);\n            element[7] = data.rows[counter].isOfflineForm;\n            element[8] = data.rows[counter].isOpen;\n            element[\"state\"] = grouped.status;\n          }\n\n          elements.push(element);\n        }\n      }\n\n      data.elements = elements;\n\n      return data.elements;\n    }).fail(function (msg) {\n      var data = { \"elements\": [], \"page\": 1, \"totalPages\": 1 };\n\n      data.elements.push({ noResults: true, message: bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\") });\n      return data.elements;\n    });\n  },\n\n  /*\r\n     *   Load data by server\r\n     */\n  loadDataListBeta: function loadDataListBeta(params) {\n    var self = this;\n\n    return self.dataService.getCasesListBeta(params).\n    done(function (data) {\n      if (data.elements.length === 0) {\n        data.elements.push({ noResults: true, message: bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\") });\n      }\n      return data.elements;\n    }).fail(function (msg) {\n      var data = { \"elements\": [], \"page\": 1, \"totalPages\": 1 };\n      data.elements.push({ noResults: true, message: bizagi.localization.getResource(\"workportal-menu-search-found-no-cases\") });\n      return data.elements;\n    });\n  },\n\n  /**\r\n     *  Render the case\r\n     */\n  getCaseData: function getCaseData(params) {\n    var dataItem = params.dataItem;\n    var data = {};\n\n    if (dataItem && typeof dataItem.noResults === \"undefined\") {\n      if (dataItem[1] !== -1 && dataItem[2] !== -1) {\n        data.idCase = dataItem[0];\n        data.idWorkitem = bizagi.util.isNumeric(dataItem[1]) ? dataItem[1] : 0;\n        data.idTask = bizagi.util.isNumeric(dataItem[2]) ? dataItem[2] : 0;\n        data.displayName = dataItem[5] || dataItem[6];\n        data.radNumber = dataItem[\"radNumber\"];\n        data.isOfflineForm = dataItem[7] === true || false;\n        data.formsRenderVersion = dataItem[7] === true ? 2 : 0;\n      } else {\n        data.idCase = dataItem[0];\n        data.displayName = dataItem[4] || dataItem[0];\n      }\n    }\n\n    return data;\n  } });","/*\r\n *   Name: BizAgi Case Actions Events\r\n *   Author: Andres Arenas V\r\n *   Comments:\r\n *   -   \r\n */\n$.Class.extend(\"bizagi.actionsEvents\", {}, {\n  /**\r\n                                              * Init constructor\r\n                                              * @param dataService The dataService for making request\r\n                                              * @param parent\r\n                                              *  - \"Entities\": When it comes from RenderTemplates\r\n                                              *  - \"Cases\": When it comes from CasesTemplates\r\n                                              * @param params\r\n                                              *  - \"homePortalFramework\": Used to handle Data Navigation and AccumulatedContext\r\n                                              */\n  init: function init(dataService, parent, params) {\n    var self = this;\n    self.initialParams = params || {};\n    self.parent = parent || \"Entities\";\n    self.dataService = dataService;\n  },\n  /**\r\n      * Get the events of an specific entity\r\n      * @param entities A list with all the entities\r\n      * @return The promise with the events of the entity\r\n      */\n  getEvents: function getEvents(entities) {\n    var self = this;\n    var promises = $.map(entities, function (entity) {\n      var idCase = entity.idCase;\n      if (typeof idCase !== \"undefined\" && idCase > 0) {\n        return self.dataService.getEvents({ caseId: idCase }).then(function (data) {\n          entity.events = data.map(function (el) {\n            el.isEvent = true;\n            return el;\n          });\n        });\n      }\n    });\n\n    return $.when.apply($, promises);\n  },\n  /**\r\n      * Get all actions of an specific entity.\r\n      * @params entities A list with all the entities.\r\n      * @return The promise with the actions of the entity.\r\n      */\n  getActions: function getActions(entities) {\n    var self = this;\n\n    var promises = $.map(entities, function (entity) {\n      // Se pone esta condicion dado que si viene desde CasesTemplates solo debe sacar las acciones cuyo surrogateKey de la\n      // entidad sea mayor o igual a 0.\n      if (self.parent === \"Entities\" || self.parent === \"Cases\" && entity.surrogateKey >= 0) {\n        var data = {\n          surrogateKey: entity.surrogateKey,\n          guidEntity: entity.guid };\n\n        if (typeof entity.idCase !== \"undefined\") {\n          data.caseId = entity.idCase;\n        }\n\n        //promesa para el llamado de acciones de cada elemento\n        return self.dataService.getActionsData(data).then(function (actions) {\n          entity.actions = actions;\n          //promesa encadenada para el llamado de has start form para todas las acciones de tipo proceso\n          return $.when.apply($, $.map(actions, function (action) {\n            if (action.type == \"Process\") {\n              return self.dataService.validateHasStartForm({ processId: action.reference }).then(function (resp) {\n                action.hasStartForm = resp.startForm;\n                action.entityId = resp.entityId;\n                action.entityName = resp.entityName;\n              });\n            }\n          }));\n        });\n      }\n    });\n\n    return $.when.apply($, promises);\n  },\n  /**\r\n      * Build a list with all the common actions of the selected item. A common action is an action that:\r\n      *  - Is in all selected items.\r\n      *  - Has multiplicity 2.\r\n      *  - Is a process without startform.\r\n      * @param selectedItems The selected items.\r\n      * @return A list with the common actions of the selected items.\r\n      */\n  getCommomActions: function getCommomActions(selectedItems) {\n    var self = this;\n    var items = selectedItems || [];\n    var tempActions = [];\n    var i = -1,a;\n\n    while (a = items[++i]) {\n      tempActions[i] = a.actions || [];\n    }\n\n    return tempActions.shift().reduce(function (res, v) {\n      var actionExist = tempActions.every(function (a) {\n        return typeof a.find(function (el) {\n          return el.id == v.id;\n        }) !== 'undefined';\n      });\n      if (actionExist && typeof res.find(function (el) {\n        return el.id == v.id;\n      }) === 'undefined' && actionAgreesRules(v)) {\n        res.push(v);\n      }\n      return res;\n    }, []);\n\n    function actionAgreesRules(action) {\n      if (typeof action.mode === \"undefined\" || action.mode === \"Entity\") {\n        if (action.multiplicity == 2) {\n          return true;\n        } else\n        if (action.type == \"Form\") {\n          return false;\n        } else\n        if (action.type == \"Process\" && action.hasStartForm) {\n          return false;\n        }\n        return true;\n      }\n      return false;\n    }\n  },\n  /**\r\n      * Build the necesary params to process the action based on the action type.\r\n      * @param action The action to execute.\r\n      * @param entity The parent entity.\r\n      */\n  executeActionSingleData: function executeActionSingleData(action, entity) {\n    var self = this;\n\n    if (action.type === \"WorkOnIt\") {\n      bizagi.loading.start();\n\n      var idCase = typeof action.idCase !== \"undefined\" ? action.idCase : entity.idCase;\n      self.executeChangeCaseEvent(idCase, action.idTask, action.idWorkitem, entity);\n    } else if (typeof action.isEvent !== \"undefined\" && action.isEvent) {\n      self.processEvent(action);\n    } else {\n      var actionType = action.type;\n      var isMultiInstance = action.multiplicity === 2 ? true : false;\n\n      if (actionType === \"Rule\") {\n        var params = {\n          actionType: actionType,\n          entityId: entity.guid,\n          isMultiInstance: isMultiInstance,\n          processId: action.reference,\n          surrogateKey: entity.surrogateKey,\n          displayName: action.displayName };\n\n\n        self.processAction(params).then(function (resp) {\n          var keyResource = \"workportal-widget-templateengine-action-rule-notification-singular\";\n          var message = printf(bizagi.localization.getResource(keyResource), params.displayName, 1);\n\n          if (resp.result === \"success\") {\n            var summary = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-success\");\n            message = message + \" \" + printf(summary, \"\");\n            $.notifier.add({ title: params.displayName, text: message, sticky: true });\n          } else {\n            var summary = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-error\");\n            message = message + \" \" + summary;\n            $.notifier.add({ title: params.displayName, text: message, sticky: true, class_name: \"error\" });\n          }\n\n          self.refreshTemplate();\n        });\n      } else if (actionType === \"Form\" || actionType === \"Process\") {\n        var params = {\n          actionType: actionType,\n          displayName: action.displayName,\n          entityGuid: entity.guid,\n          entitySurrogateKey: entity.surrogateKey,\n          id: action.id,\n          isMultiInstance: isMultiInstance,\n          isBatch: action.isBatch || null,\n          reference: action.reference,\n          readonlyform: action.readonlyform,\n          showConfirmation: action.showConfirmation };\n\n\n        if (actionType === \"Process\") {\n          params.entityId = action.entityId;\n          params.entityName = action.entityName;\n          params.hasStartForm = action.hasStartForm;\n        }\n        if (typeof entity.idCase !== \"undefined\") {\n          params.caseId = entity.idCase;\n        }\n        self.processAction(params);\n      }\n    }\n  },\n\n  executeChangeCaseEvent: function executeChangeCaseEvent(idCase, idTask, idWorkitem, entity) {\n    var self = this;\n    $.when(bizagi.webpart.publish(\"changeCase\", {\n      idCase: idCase,\n      idTask: idTask,\n      idWorkitem: idWorkitem })).\n    fail(function (error) {\n      self.showErrorMessage(entity.idCase, error);\n    }).always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  /**\r\n      * Build the necesary params to process the action based on the action type and action multiplicity.\r\n      *  - When the multiplicity is 2 it should run one rule that contains all selected items.\r\n      *  - When the multiplicity is 1 it should create one case per selected item.\r\n      * @param action The action to execute.\r\n      * @param entity The parent entity.\r\n      * @param selectedItems The items that the action is going to execute.\r\n      */\n  executeActionMultipleData: function executeActionMultipleData(action, entity, selectedItems) {\n    var self = this;\n    var isMultiInstance = action.multiplicity === 2 ? true : false;\n    var surrogatedKeys = selectedItems.map(function (el) {\n      return el.surrogateKey;\n    });\n\n    switch (action.type) {\n      case \"Process\":\n        var params = {\n          actionType: action.type,\n          displayName: action.displayName,\n          entityGuid: entity.guid,\n          entityId: action.entityId,\n          entityName: action.entityName,\n          id: action.id,\n          isMultiInstance: isMultiInstance,\n          reference: action.reference,\n          hasStartForm: action.hasStartForm };\n\n        if (self.parent === \"Cases\") {\n          params.caseId = selectedItems.map(function (el) {\n            return el.idCase;\n          });\n        }\n        // When the multiplicity is 2 it should create one case that contains all selected items\n        if (isMultiInstance) {\n          params.isBatch = false;\n          params.entitySurrogateKey = surrogatedKeys;\n\n          self.processAction(params);\n        }\n        // When the multiplicity is 1 it should create one case per selected item\n        else {\n            params.isBatch = true;\n            self.processBatchCreationAction(params, selectedItems);\n          }\n        break;\n\n      case \"Rule\":\n        var params = {\n          actionType: action.type,\n          entityId: entity.guid,\n          isMultiInstance: isMultiInstance,\n          processId: action.reference,\n          displayName: action.displayName };\n\n\n        // When the multiplicity is 2 it should run one rule that contains all selected items\n        if (isMultiInstance) {\n          params.surrogatedKey = surrogatedKeys;\n          self.processAction(params).then(function (resp) {\n\n            var keyResource = \"workportal-widget-templateengine-action-rule-notification-singular\";\n\n            var messageSummary = printf(bizagi.localization.getResource(keyResource), params.displayName, 1);\n            var message = \"\";\n\n            if (resp.result === \"success\") {\n              message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-success\");\n              message = printf(message, 1);\n            } else\n            {\n              message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-error\");\n            }\n            $.notifier.add({ title: message, text: messageSummary, sticky: true });\n\n\n            self.refreshTemplate();\n          });\n        }\n        // When the multiplicity is 1 it should run one rule per selected item\n        else {\n            params.confirmation = false;\n\n            var i = -1,a,promises = [];\n            while (a = selectedItems[++i]) {\n              params.surrogateKey = a.surrogateKey;\n              promises.push(self.processAction(params));\n            }\n\n            $.when.apply($, promises).then(function () {\n\n              var dirty_message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-notification-plural\");\n              var message = printf(dirty_message, params.displayName, selectedItems.length);\n              var success_summary = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-success\");\n              message += printf(success_summary, \"\");\n\n              $.notifier.add({ title: params.displayName, text: message, sticky: true });\n\n              self.refreshTemplate();\n            }).fail(function () {\n\n              var dirty_message = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-notification-plural\");\n              var message = printf(dirty_message, params.displayName, selectedItems.length);\n              var success_summary = bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-error\");\n              message += printf(success_summary, \"\");\n              $.notifier.add({ title: params.displayName, text: message, sticky: true, class_name: \"error\" });\n\n            });\n          }\n        break;\n\n      default:\n        break;}\n\n  },\n\n  /**\r\n      * Process the action type process in batch\r\n      *  - Process: Build the data and go to processAction.\r\n      *  - Form: Build the data, call the mapping and go to processAction.\r\n      * @param actionParams Contains the necesary data to process the action.\r\n      * @param selectedItems Contains the selected elements.\r\n      */\n  processBatchCreationAction: function processBatchCreationAction(actionParams, selectedItems) {\n    var self = this;\n    var i = -1,a;\n    a = selectedItems[++i];\n\n    // This is the way to send requests in series not in parallel\n    function process() {\n      $.when(self.processAction(actionParams)).always(function () {\n        a = selectedItems[++i];\n        if (typeof a !== \"undefined\") {\n          actionParams.itemSelected = a;\n          process(actionParams);\n        }\n      });\n    }\n\n    if (typeof a !== \"undefined\") {\n      actionParams.itemSelected = a;\n      process(actionParams);\n    }\n  },\n\n  /**\r\n      * Process the action base on the type\r\n      *  - Process: Build the data and go to processAction.\r\n      *  - Form: Build the data, call the mapping and go to processAction.\r\n      * @param action Contains the necesary data to process the action.\r\n      */\n  processAddAction: function processAddAction(action) {\n    var self = this;\n    var params = {\n      actionType: action.type,\n      addAction: true,\n      displayName: action.displayName,\n      entityGuid: action.guidEntity,\n      entitySurrogateKey: null,\n      reference: action.reference };\n\n\n    if (action.type === \"Process\") {\n      params.entityId = action.guidEntity;\n      params.entityName = action.xpathContext;\n      params.hasStartForm = action.startForm;\n\n      self.processAction(params);\n    } else\n    if (action.type === \"Form\") {\n      var actionParam = {\n        xpathContext: \"\",\n        guidEntity: action.guidEntity,\n        accumulatedContext: JSON.stringify(self.initialParams.homePortalFramework.getActionsContext()) };\n\n      $.when(self.dataService.getMapping(actionParam)).then(function (mapping) {\n        params.mapping = mapping;\n\n        self.processAction(params);\n      }).fail(function (error) {\n        self.showErrorMessage(action.displayName, error);\n      });\n    }\n  },\n  /**\r\n      * Process the action based on the Type.\r\n      *  - Process: Call the mapping and create a new case.\r\n      *  - Form: Load the startform based on params.\r\n      *  - Rule: Show confirmation dialog and if user agrees execute rule depending if it is multinstance or not.\r\n      * @param params Contains the necesary data to process the action.\r\n      */\n  processAction: function processAction(params) {\n    var self = this;\n    var origin = self.parent === \"Entities\" ? \"stuffTemplates\" : \"caseTemplates\";\n    params.confirmation = typeof params.confirmation !== \"undefined\" ? params.confirmation : true;\n    var defer = new $.Deferred();\n\n    switch (params.actionType) {\n      case \"Process\":\n        var actionParams = { xpathContext: params.entityName, guidEntity: params.entityId };\n\n        //Updates the las element in the context\n        var entitySurrogateKey = typeof params.itemSelected !== \"undefined\" ? params.itemSelected.surrogateKey : params.entitySurrogateKey;\n        self.initialParams.homePortalFramework.extendCurrentContext({ surrogateKeyToMapping: entitySurrogateKey });\n        var accumulatedContext = self.initialParams.homePortalFramework.getActionsContext();\n\n        actionParams.accumulatedContext = JSON.stringify(accumulatedContext);\n        $.when(self.dataService.getMapping(actionParams)).done(function (mapping) {\n          var createParams = {\n            guidProcess: params.reference,\n            hasStartForm: params.hasStartForm,\n            isBatch: typeof params.isBatch !== \"undefined\" ? params.isBatch : null,\n            isMultiInstance: params.isMultiInstance,\n            mapping: mapping,\n            notification: true,\n            displayName: params.displayName,\n            type: params.actionType,\n            origin: origin };\n\n          if (typeof params.caseId !== \"undefined\") {\n            createParams.idParentCase = params.caseId;\n          }\n          $.when(bizagi.webpart.publish(\"createNewCase\", createParams)).then(function () {\n            defer.resolve(createParams);\n          }).fail(function () {\n            defer.reject();\n          });\n\n\n        }).fail(function (error) {\n          self.showErrorMessage(params.displayName, error);\n          defer.reject();\n        });\n        break;\n\n      case \"Form\":\n        bizagi.webpart.publish(\"render-start-form\", {\n          params: {\n            displayName: params.displayName,\n            entityGuid: params.entityGuid,\n            entitySurrogateKey: params.entitySurrogateKey,\n            formGuid: params.reference,\n            mapping: typeof params.mapping !== \"undefined\" ? params.mapping : null,\n            type: params.actionType,\n            origin: origin,\n            readonlyform: params.readonlyform,\n            showConfirmation: params.showConfirmation } });\n\n\n\n        defer.resolve();\n        break;\n      case \"Rule\":\n        if (params.confirmation) {\n          bizagi.showConfirmationBox(\n          bizagi.localization.getResource(\"workportal-widget-templateengine-action-rule-confirmation\"),\n          \"Bizagi\",\n          true,\n          [{ label: \"Ok\", action: \"resolve\" }, { label: \"Cancel\", action: \"reject\" }]).\n          done(function () {\n            self.executeRuleAction(params).then(function (resp) {\n              defer.resolve(resp);\n            }).fail(function (error) {\n              defer.reject(error);\n            });\n          });\n        } else {\n          self.executeRuleAction(params).then(function (resp) {\n            defer.resolve(resp);\n          }).fail(function (error) {\n            defer.reject(error);\n          });\n        }\n        break;\n\n      default:\n        defer.resolve();\n        break;}\n\n\n    return defer.promise();\n  },\n  /**\r\n      * Show an error message based on the code status response from server.\r\n      * @param title The title of the message to show.\r\n      * @param error The server error response.\r\n      */\n  showErrorMessage: function showErrorMessage(title, error) {\n    //TODO capturar el codigo del error {404, 500, etc} y mandar el mensaje acorde al error\n    var message = bizagi.localization.getResource(\"workportal-widget-sortbar-execute-error-message\").replace(\"%s\", title);\n    $.notifier.add({\n      title: \"Error\",\n      text: message,\n      class_name: \"error\",\n      sticky: false });\n\n  },\n\n  /**\r\n      * Ejecuta una unica accion de tipo Regla\r\n      * @param params\r\n      * return promise*\r\n      */\n  executeRuleAction: function executeRuleAction(params) {\n    var self = this;\n    var promiseData = params.isMultiInstance ? self.dataService.executeAction : self.dataService.actionRule;\n    return $.when(promiseData.apply(self.dataService, [params]));\n  },\n\n  /**\r\n      * Reload the template\r\n      */\n  refreshTemplate: function refreshTemplate() {\n    var self = this;\n    var context = self.initialParams.homePortalFramework.accumulatedContext;\n    var args = {\n      calculateFilters: true,\n      data: context.length > 0 ? context[context.length - 1] : self.accumulatedContext,\n      filters: [],\n      eventType: \"DATA-NAVIGATION\" };\n\n\n    bizagi.webpart.publish(\"homeportalShow\", {\n      \"what\": \"stuffTemplates\",\n      \"title\": args && args.data ? args.data.displayName : \"\",\n      \"params\": args,\n      \"preventNavigate\": true });\n\n    //TODO dejar unicamente el homeportalShow con el refresh cuando se soporte la actualizacin de un solo resgitro\n    //self.publish(\"homeportalShow\", {\"what\": origin, params : {refresh:true, surrogateKey: self._renderParams.h_surrogateKey, idCase: bizagi.context.idCase}});\n  },\n\n  /**\r\n      * Perform the process action and send it throught \"executeRoutingAction\"\r\n      * @param params\r\n      */\n  processEvent: function processEvent(eventParams) {\n    bizagi.webpart.publish(\"executeRoutingAction\", {\n      idCase: eventParams.idCase,\n      idWorkItem: eventParams.idWorkitem,\n      idTask: eventParams.idTask,\n      idWorkflow: eventParams.idWorkflow,\n      isEvent: true });\n\n  } });","/*\r\n *   Name: BizAgi Case Users\r\n *   Author: Andres Arenas V\r\n *   Comments:\r\n *   -   \r\n */\n$.Class.extend(\"bizagi.caseUsers\", {}, {\n  /**\r\n                                          * Init constructor\r\n                                          * @param dataService The dataService for making request\r\n                                          * @param parent\r\n                                          *  - \"Entities\": When it comes from RenderTemplates\r\n                                          *  - \"Cases\": When it comes from CasesTemplates\r\n                                          * @param params Additional data\r\n                                          */\n  init: function init(dataService, parent, params) {\n    var self = this;\n    self.initialParams = params || {};\n    self.parent = parent || \"Entities\";\n    self.dataService = dataService;\n    self.userDataPromise = {};\n  },\n  /**\r\n      * Get the users of an specific entity\r\n      * @param entities A list with all the entities\r\n      * @return The promise with the users of the entity\r\n      */\n  getUsers: function getUsers(entities) {\n    var self = this;\n    var users = [];\n\n    var promises = $.map(entities, function (entity) {\n      return self.dataService.getUsers({ caseId: entity.idCase }).done(function (data) {\n        entity[\"assignees\"] = $.map(data.assignees, function (el) {return $.extend(el, { initials: self._getInitials(el.name) });});\n        entity[\"createdBy\"] = $.extend(data.createdBy, { initials: self._getInitials(data.createdBy.name) });\n        //Obtiene instancias unicas del usuario para el caso\n        entity[\"users\"] = self._getUniqueUsers($.merge([entity.createdBy], entity.assignees));\n        entity[\"workOnIt\"] = self._canWorkOnIt(data.assignees);\n\n        //Se crea un array con los usuarios unicos para retornarlos\n        var i = -1,user;\n        while (user = entity.users[++i]) {\n          var exist = users.find(function (el) {\n            return user.idUser == el.idUser;\n          });\n          if (!exist) {\n            users.push(user);\n          }\n        }\n      });\n    });\n\n    return $.when.apply($, promises).then(function (data) {\n      return users;\n    });\n  },\n  /**\r\n      * Extract initials from specified name\r\n      * @param name The name of the user\r\n      * @return The first letter of the name and the first letter of the last name\r\n      */\n  _getInitials: function _getInitials(name) {\n    var names = name.split(' ');\n    var firstInitial = typeof names[0] !== 'undefined' ? names[0].charAt(0) : \"\";\n    var secondInitial = typeof names[1] !== 'undefined' ? names[1].charAt(0) : \"\";\n\n    return firstInitial + secondInitial;\n  },\n  /**\r\n      * Remove the duplicated users from a list\r\n      * @param users A list with all the users of an entity\r\n      * @return A list with unique users\r\n      */\n  _getUniqueUsers: function _getUniqueUsers(users) {\n    var i = -1,user,uniqueUsers = [];\n\n    while (user = users[++i]) {\n      var exist = uniqueUsers.find(function (el) {\n        return user.idUser == el.idUser;\n      });\n      if (!exist) {\n        uniqueUsers.push({\n          idUser: user.idUser,\n          name: user.name,\n          initials: user.initials });\n\n      }\n    }\n\n    if (uniqueUsers.length > 0) {\n      uniqueUsers[0].isAssignee = true;\n    }\n\n    return uniqueUsers;\n  },\n  /**\r\n      * Determines if the current user can work on it case\r\n      * @param assignees\r\n      * @return {boolean}\r\n      */\n  _canWorkOnIt: function _canWorkOnIt(assigneesUsers) {\n    var user,i = -1,canWorkOnIt = false;\n\n    while (user = assigneesUsers[++i]) {\n      if (user.idUser === bizagi.currentUser.idUser) {\n        canWorkOnIt = true;\n        break;\n      }\n    }\n    return canWorkOnIt;\n  } });","/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\n\n// Create or define namespace\nbizagi.render = typeof bizagi.render !== \"undefined\" ? bizagi.render : {};\nbizagi.render.services = typeof bizagi.render.services !== \"undefined\" ? bizagi.render.services : {};\nbizagi.render.services.endPoints = [];\n\n// Creates a endpoint hash factory to resolve custom requirements\nbizagi.render.services.getEndPoints = function (params) {\n\n  var renderHandlerPathRest = \"Rest/Handlers/Render\";\n  var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\n  var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\n  var letterHandlerPathRest = \"Rest/Handlers/Letter\";\n  var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\n  var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\n  var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\n  // Default workportal end-points\n  if (params.context == \"workflow\") {\n    return {\n      \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\n      \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\n      \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\n      \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\n      \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\n      \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\n      \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\n      \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\n      \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\n      \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\n      \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\n      \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\n      \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\n      \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\n      \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\n      \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\n      \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\n      \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\n      \"render-query-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsersForQueryFormsById/{queryFormId}/\",\n      \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\n      \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\n      \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\n      \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\n      \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\n      \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\n      \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\n      \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\n      \"admin-getUsersList-ForXpathIdBossUser\": params.proxyPrefix + \"Rest/Users/SearchUsersForBosses\",\n      \"admin-getUsersList-ForXpathIdDelegate\": params.proxyPrefix + \"Rest/Users/SearchUsersForDelegates\",\n      \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\n      \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\n      //users administration\n      \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\n      \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\n      \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\" };\n\n  }\n  // Sharepoint end-points (must be customized for each project)\n  if (params.context == \"sharepoint\" || params.context == \"portal\") {\n    if (typeof params.sharepointProxyPrefix === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\n    return {\n      \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\n      \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\n      \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\n      \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\n      \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\n      \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\n      \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\n      \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\n      \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\n      \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\n      \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\n      \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\n      \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\n      \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\n      \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\n      \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\n      \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\n      \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\" };\n\n  }\n\n  if (params.context == \"entitymanagement\") {\n    return {\n      \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\n      \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\" };\n\n  }\n\n  if (params.context == \"search\") {\n    return {\n      \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\n      \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\" };\n\n  }\n\n  return {};\n};","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\n\n$.Class.extend(\"bizagi.render.services.context\", {}, {\n  /* \r\n                                                       *   Constructor\r\n                                                       */\n  init: function init(params) {\n    this.context = params.context;\n    this.endPoints = bizagi.render.services.getEndPoints(params);\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n  },\n\n  /*\r\n     *   Returns the given url for a specified service\r\n     */\n  getUrl: function getUrl(service) {\n    if (this.endPoints[service] == null) {\n      alert(\"No endpoint defined for: \" + service);\n    }\n    return this.endPoints[service];\n  },\n\n  setProxyPrefix: function setProxyPrefix(params) {\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    this.endPoints = bizagi.render.services.getEndPoints(params);\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\n\nbizagi.render.services.service.extend(\"bizagi.render.services.service\", {},\n{\n  /* \r\n   *   Constructor\r\n   */\n  init: function init(params) {\n    // Call base\n    var self = this;\n\n    self._super(params);\n    self.database = params.database;\n    self.gridService = new bizagi.grid.services.service({\n      renderDataService: this,\n      database: params.database });\n\n    self.fileService = new bizagi.file.services.service({\n      renderDataService: this,\n      database: params.database });\n\n    self.syncService = new bizagi.sync.services.service({\n      renderDataService: this,\n      database: params.database });\n\n    self.formService = new bizagi.form.services.service({\n      renderDataService: this,\n      database: params.database });\n\n  },\n\n  getFileService: function getFileService() {\n    var self = this;\n    return self.fileService;\n  },\n\n  getSyncService: function getSyncService() {\n    var self = this;\n    return self.syncService;\n  },\n\n  getGridService: function getGridService() {\n    var self = this;\n    return self.gridService;\n  },\n\n  getFormService: function getFormService() {\n    var self = this;\n    return self.formService;\n  },\n\n  getFormData: function getFormData(params) {\n    var self = this;\n\n    params = params || {};\n\n    if (!params.isOfflineForm) {\n      return self._super(params);\n    } else {\n      if (params.workitemstate == \"inactive\" && params.online && params.alreadyMarkedAsActive !== true) {\n        // Always call the backend service in order to mark the activity as opened  \n        self._super(params);\n      }\n      if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getNativeFormData !== \"undefined\") {\n        return self.getFormDataFromNative(params).\n        then(function (result) {\n          return self.database.mergeForm(result[1], result[0].data, { online: params.online });\n        });\n\n      } else {\n        if (params.offlineType === 'task') {\n          //It is not a start event\n          if (params.isEdited || !params.isOpen) {\n            var def = new $.Deferred();\n            $.when(self.database.getTaskData(params)).then(function (formData) {\n              var syncStatus = params.syncError || formData.syncStatus;\n              var hasSyncError = params.hasSyncError || !bizagi.util.isEmpty(syncStatus);\n              var formPromise = self.database.getTaskForm(params);\n              $.when(self.database.mergeDataDocument(formData.data, formPromise)).done(function (complexData) {\n                var object = {\n                  data: complexData,\n                  isOpen: params.isOpen };\n\n                self.database.mergeForm(object, formPromise, { online: params.online, hasSyncError: hasSyncError }).then(function (mergedForm) {\n                  def.resolve(mergedForm);\n                });\n              });\n\n            });\n            return def.promise();\n          } else\n\n          return self.database.getTaskForm(params);\n        } else\n        {\n          return $.when(self.database.getCase(params.idCase)).\n          then(function (response) {\n            var idWfClass = $.trim(response.idWfClass.toString());\n            return self.database.mergeForm(response, self.database.getFormData(idWfClass), { online: params.online });\n          });\n        }\n      }\n    }\n  },\n\n  getOfflineImage: function getOfflineImage(params, fileType) {\n    if (params.offlineType === \"task\")\n    return this.database.getActivityImage(params, fileType);else\n\n    return this.database.getStartDataImage(params, fileType);\n  },\n\n  getOfflineActivityDataImage: function getOfflineActivityDataImage(params, fileFormat) {\n    return this.database.getActivityDataImage(params, fileFormat);\n  },\n\n  saveOfflineImage: function saveOfflineImage(params, image) {\n    if (params.operationType === \"synchronization\")\n    return this.database.saveActivityFormImage(params, image);else\n    if (params.operationType === \"edition\") {\n      if (params.offlineType === \"task\")\n      return this.database.saveActivityDataImage(params, image);else\n\n      return this.database.saveStartDataImage(params, image);\n    } else\n\n    return null;\n  },\n\n  saveOfflineFile: function saveOfflineFile(params, file, mimeType) {\n    if (params.operationType === \"synchronization\")\n    return this.database.saveActivityFormFile(params, file, mimeType);else\n    if (params.operationType === \"edition\") {\n      if (params.offlineType === \"task\")\n      return this.database.saveActivityDataFile(params, file, mimeType);else\n\n      return this.database.saveStartDataFile(params, file, mimeType);\n    } else\n\n    return null;\n  },\n\n  getOfflineFile: function getOfflineFile(params, fileType, mimeType) {\n    if (params.offlineType === \"task\")\n    return this.database.getActivityFile(params, fileType, mimeType);else\n\n    return this.database.getStartDataFile(params, fileType, mimeType);\n  },\n\n  getOfflineActivityDataFile: function getOfflineActivityDataFile(params, fileType, mimeType) {\n    return this.database.getActivityDataFile(params, fileType, mimeType);\n  },\n\n  getFormDataFromNative: function getFormDataFromNative(params) {\n    var def = new $.Deferred();\n\n    bizagiapp.getNativeFormData(params, function (form) {\n\n      bizagiapp.getCase(params.idCase, function (caseInfo) {\n\n        var result = [JSON.parse(form), JSON.parse(caseInfo)];\n\n        def.resolve(result);\n\n      }, function (error) {\n\n        def.reject(error);\n\n      });\n\n\n    }, function (error) {\n      def.reject(error);\n    });\n\n    return def.promise();\n  },\n\n  submitData: function submitData(params) {\n    var self = this;\n\n    params = params || {};\n\n    if (!params.isOfflineForm) {\n      return self._super(params);\n    } else {\n\n      var data = self.resolveData(params.data || {}, params.xpathContext);\n      var action = (params.action || \"\").toLowerCase();\n      // current action (save, next or next without validations)\n      if (action != '' && (action == 'save' || action == 'next' || action == 'nextwithoutvalidations' || action == 'submitdata')) {\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = action;\n      }\n\n      if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getNativeFormData !== \"undefined\") {\n        return self.saveNativeFormInfo(params, data);\n      }\n\n      if (params.offlineType === 'task') {\n        self.sanityDataForSaveInDB(data);\n\n        return self.database.saveTaskData(params, data);\n      } else\n      {\n        return self.database.saveStartData(params, data);\n      }\n    }\n  },\n\n  sanityDataForSaveInDB: function sanityDataForSaveInDB(data) {\n    delete data.deferreds;\n  },\n\n  saveNativeFormInfo: function saveNativeFormInfo(params, data) {\n    var self = this;\n\n    var def = new $.Deferred();\n\n    self.getFormDataFromNative(params).then(function (result) {\n      return self.database.nativesaveStartData(data, result[1], result[0].data).\n      done(function (doc) {\n        bizagiapp.saveFormData(params, doc);\n        def.resolve(doc);\n      });\n    });\n\n    return def.promise();\n  },\n\n\n  removeStartCaseSyncError: function removeStartCaseSyncError(params) {\n    var self = this;\n    var updatedStartCase;\n    return self.database.getCase(params.idCase).\n    then(function (startCase) {\n      startCase.isOpen = true;\n      delete startCase.syncDetails;\n      delete startCase.syncStatus;\n      updatedStartCase = startCase;\n      return self.database.saveStartCase(params.idCase, startCase);\n    }).\n    then(function () {\n      return updatedStartCase;\n    });\n  },\n\n  removeTaskCaseSyncError: function removeTaskCaseSyncError(params) {\n    var self = this;\n    var offlineId = params.idCase + \"-\" + params.idWorkitem;\n    var updatedTaskCase;\n    return self.database.getTask(offlineId).\n    then(function (taskCase) {\n      taskCase.isOpen = true;\n      taskCase.isEdited = true;\n      delete taskCase.syncDetails;\n      delete taskCase.syncStatus;\n      updatedTaskCase = taskCase;\n      return self.database.saveTask(offlineId, taskCase);\n    }).\n    then(function () {\n      return self.database.getTaskData(params);\n    }).\n    then(function (taskData) {\n      if (taskData && taskData.data != undefined) {\n        taskData.data.h_action = \"\";\n        delete taskData.data.retry_h_actions;\n        delete taskData.data.actions;\n      }\n      return self.database.saveTaskData(params, taskData.data);\n    }).\n    then(function () {\n      return updatedTaskCase;\n    });\n  },\n\n  parseServiceError: function parseServiceError(callbackArguments) {\n    var error = {};\n    var stringError;\n    if (callbackArguments == undefined) {\n      return;\n    }\n    if (callbackArguments.responseText) {\n      stringError = callbackArguments.responseText;\n    } else\n    if (callbackArguments.length == 1 && !callbackArguments[0].responseText) {\n      error = callbackArguments[0];\n    } else\n    if (callbackArguments.length > 0 && callbackArguments[0] && callbackArguments[0].responseText) {\n      stringError = callbackArguments[0].responseText;\n    } else if (callbackArguments.length == 3) {\n      var internalError = callbackArguments[2];\n      while (internalError != undefined && internalError.error) {\n        internalError = internalError.error;\n      };\n      if (internalError.errorType) {\n        error = internalError;\n      } else\n      {\n        error.type = \"error\";\n        error.errorType = callbackArguments[1];\n        error.message = callbackArguments[2];\n      }\n    } else\n    {\n      try {\n        stringError = JSON.stringify(callbackArguments);\n      } catch (parsingError) {}\n    }\n\n    if (stringError != undefined) {\n      try {\n        error = JSON.parse(stringError);\n      } catch (parsingError) {\n        error.type = \"error\";\n        error.errorType = \"parsingError\";\n        error.message = \"Error parsing the server response: \" + stringError;\n      }\n    }\n    return error;\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.file = bizagi.file || {};\nbizagi.file.services = bizagi.file.services || {};\nif (!bizagi.file.services.service) {\n  $.Class.extend(\"bizagi.file.services.service\", {\n    // STATIC METHODS\n    loaders: {},\n\n    isLoading: function isLoading(key) {\n      return this.loaders[key] || false;\n    },\n\n    setLoading: function setLoading(idCase, idWorkitem, xpathContext, xpath) {\n      var key = this.internalBuildOfflineFileLoadingKey(idCase, idWorkitem, xpathContext, xpath);\n      this.loaders[key] = true;\n    },\n\n    clearLoading: function clearLoading(idCase, idWorkitem, xpathContext, xpath) {\n      var key = this.internalBuildOfflineFileLoadingKey(idCase, idWorkitem, xpathContext, xpath);\n      this.loaders[key] = false;\n    },\n\n    internalBuildOfflineFileLoadingKey: function internalBuildOfflineFileLoadingKey(idCase, idWorkitem, xpathContext, xpath) {\n      var key = \"case:\" + idCase;\n      if (!bizagi.util.isEmpty(idWorkitem)) key += \"-\" + idWorkitem;\n      key += \"::\";\n\n      key += \"xpath:\";\n      if (!bizagi.util.isEmpty(xpathContext)) key += xpathContext + \".\";\n      key += xpath;\n\n      return key;\n    } },\n\n  {\n    EMPTY_IMAGE: \"R0lGODlhAQABAIAAAP7//wAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==\",\n\n    // INSTANCE METHODS\n    init: function init(params) {\n      var self = this;\n      self.renderDataService = params.renderDataService;\n      self.database = params.database;\n    },\n\n    isLoading: function isLoading(control)\n    {\n      return this.Class.isLoading(this.buildOfflineFileLoadingKey(control));\n    },\n\n    buildOfflineFileLoadingKey: function buildOfflineFileLoadingKey(control) {\n      var form = control.getFormContainer();\n      var idCase = form.getParams().idCase;\n      var idWorkitem = form.getParams().idWorkitem;\n\n      return this.Class.internalBuildOfflineFileLoadingKey(idCase, idWorkitem, control.properties.xpathContext, control.properties.xpath);\n    },\n\n    /*************************************************************************************************\r\n        *          DOWNLOAD IMAGE METHODS\r\n        *************************************************************************************************/\n    downloadFormImages: function downloadFormImages(form, params) {\n      var self = this;\n      var imageControls = self.database.filterXpathsByTypeMap(form, { image: true, columnImage: true, signature: true });\n      var promises = [];\n\n      // Create promises to add in multi-action\n      imageControls.forEach(function (imageControl) {\n        var id = self.buildOfflineImageId(imageControl.value, imageControl.xpathContext, imageControl.xpath);\n        if (params.localFiles[id]) return;\n\n        // In this case we won't wait for promise, because we wany async loading of this\n        promises.push(self.downloadImage(params, form.form, imageControl));\n      });\n\n      return promises;\n    },\n\n    downloadImage: function downloadImage(params, form, imageControl) {\n      var self = this;\n      var isVersion2OrSuperior = form.properties.compatibilityVersion >= 2;\n\n      if (isVersion2OrSuperior && bizagi.util.isEmpty(imageControl.value)) return $.Deferred().resolve(null).promise();\n\n      var getPropertyDataParams = {\n        xpath: imageControl.xpath,\n        idRender: imageControl.renderId,\n        xpathContext: imageControl.xpathContext || \"\",\n        idPageCache: form.pageCacheId,\n        sessionId: form.sessionId,\n        property: isVersion2OrSuperior ? \"fileBinaryContent\" : \"fileFullContent\" };\n\n\n      if (isVersion2OrSuperior) {\n        return self.downloadImageVersion2(params, getPropertyDataParams, form, imageControl);\n      }\n\n      return self.downloadImageVersion1(params, getPropertyDataParams, form, imageControl);\n    },\n\n    downloadImageVersion2: function downloadImageVersion2(params, getUploadFileUrlParams, form, imageControl) {\n      var self = this;\n      self.Class.setLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n      getUploadFileUrlParams.queue = params.bulkDownload ? \"offlineimages\" : undefined;\n\n      return self.renderDataService.downloadFile(getUploadFileUrlParams).\n      then(function (binary_file) {\n\n        binary_file.name = imageControl.xpath;\n        params.operationType = \"synchronization\";\n        params.id = self.buildOfflineImageId(imageControl.value, imageControl.xpathContext, imageControl.xpath);\n        return self.database.saveActivityFormImage(params, binary_file, binary_file.type);\n      }).\n      then(function () {\n        if (!params.bulkDownload) return self.ensureImageIsPersistedLocally(params);\n        return;\n      }).\n      always(function () {\n        self.Class.clearLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n      });\n    },\n\n    ensureImageIsPersistedLocally: function ensureImageIsPersistedLocally(params, counter) {\n      var self = this;\n      counter = counter || 3;\n      if (counter == 0) {\n        console.log(\"downloadImageVersion2::image not found after 3 retries '\" + params.id + \"'\", params);\n        return $.Deferred().resolve().promise();\n      }\n\n      // PERFORM A IMAGE LOADING IMMEDIATELY, TO MAKE SURE THE IMAGE IS THERE [BUG QA: 42953]\n      // **  ATTEMPT 3 TIMES WITH 200 ms of wait **\n      var getOfflineImageParams = {\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        id: params.id,\n        offlineType: \"task\",\n        loadImageFromForm: false };\n\n      var invokeAgain = false;\n      return self.renderDataService.getOfflineImage(getOfflineImageParams, bizagi.util.db.AttachmentType.Blob).\n      then(function (blob) {\n        if (blob == null) {\n          //bizagi.util.console.log(\"downloadImageVersion2::image not found '\" + params.id + \"' ... retrying \" + counter + \"more times\", params);\n          invokeAgain = true;\n          return bizagi.util.sleepFor(200);\n        }\n        return;\n      }).\n      then(function () {\n        if (invokeAgain) return self.ensureImageIsPersistedLocally(params, counter - 1);\n        return;\n      });\n    },\n\n    downloadImageVersion1: function downloadImageVersion1(params, getPropertyDataParams, form, imageControl) {\n      var self = this;\n      self.Class.setLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n\n      return self.renderDataService.multiaction().getPropertyData(getPropertyDataParams).\n      then(function (base64Image) {\n        if (base64Image == undefined) return;\n\n        var saveParams = {\n          id: imageControl.xpathContext ? imageControl.xpathContext + '.' + imageControl.xpath : imageControl.xpath,\n          idCase: params.idCase,\n          idWorkitem: params.idWorkitem,\n          operationType: \"synchronization\" };\n\n        return self.database.saveActivityFormImage(saveParams, base64Image);\n      }).\n      always(function () {\n        self.Class.clearLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n      });\n    },\n\n    /*************************************************************************************************\r\n        *          DOWNLOAD FILE METHODS\r\n        *************************************************************************************************/\n    downloadFormFiles: function downloadFormFiles(form, params) {\n      var self = this;\n      var data = {};\n      var promises = [];\n      var uploads = self.database.filterXpathsByTypeMap(form, { upload: true, columnUpload: true });\n      uploads.forEach(function (upload) {\n        var result = self.downloadFilesInUploadControl(params, form, upload);\n        Array.prototype.push.apply(promises, result);\n        if (upload.type !== \"columnUpload\") //Grid handles convertion by cell\n          data[upload.xpath] = self.database.convertUploadOnlineValueInOfflineValue(upload.value);\n      });\n\n      return {\n        data: data,\n        promises: promises };\n\n    },\n\n    downloadFilesInUploadControl: function downloadFilesInUploadControl(params, form, uploadControl) {\n      var self = this;\n      var promises = [];\n\n      if (uploadControl.value && Array.isArray(uploadControl.value)) {\n        uploadControl.value.forEach(function (singleFileValue) {\n          var fileId = singleFileValue[0];\n          var fileName = singleFileValue[1];\n          var fullXpath = (uploadControl.xpathContext ? uploadControl.xpathContext + '.' : '') + uploadControl.xpath + '.' + fileId;\n          if (params.localFiles[fullXpath]) return;\n\n          // In this case we won't wait for promise, because we wany async loading of this\n          promises.push(self.downloadSingleFile(params, form, uploadControl, fileId, fileName, fullXpath));\n        });\n      }\n      return promises;\n    },\n\n    downloadSingleFile: function downloadSingleFile(params, form, uploadControl, fileId, fileName, fullXpath) {\n      var self = this;\n      return self.downloadBinaryFile(params, form, uploadControl, fileId, fileName).\n      then(function (binaryFile) {\n        if (binaryFile) {\n          params.operationType = \"synchronization\";\n          params.id = fullXpath;\n          self.renderDataService.saveOfflineFile(params, binaryFile, binaryFile.type);\n        }\n      });\n    },\n\n    downloadBinaryFile: function downloadBinaryFile(params, form, uploadControl, fileId, fileName) {\n      var self = this;\n      var getFileUrlParams = {\n        xpath: uploadControl.xpath,\n        idRender: uploadControl.renderId,\n        xpathContext: uploadControl.xpathContext || \"\",\n        idPageCache: form.form.pageCacheId,\n        fileId: fileId,\n        sessionId: form.form.sessionId,\n        queue: params.bulkDownload ? \"offlinefiles\" : undefined };\n\n\n      return self.renderDataService.downloadFile(getFileUrlParams).\n      then(function (binary_file) {\n        binary_file.name = fileName;\n        return binary_file;\n      });\n    },\n\n\n\n    /*************************************************************************************************\r\n        *          UPLOAD IMAGE METHODS\r\n        *************************************************************************************************/\n    uploadFormImages: function uploadFormImages(params, imageValues) {\n      var self = this;\n      var promises = [];\n      imageValues.forEach(function (imageControl) {\n        var data = imageControl.value;\n        if (!data) return;\n\n        $.extend(params, imageControl);\n        promises.push(self.uploadImage(params, data));\n      });\n\n      return promises;\n    },\n\n    uploadFormGridImages: function uploadFormGridImages(params, imagesByRow, entityMap) {\n      var self = this;\n      var rowKeys = Object.keys(imagesByRow);\n      var promises = [];\n\n      for (var k = 0; k < rowKeys.length; k++) {\n        var row = imagesByRow[rowKeys[k]];\n        var imagesKeys = Object.keys(row);\n\n        for (var l = 0; l < imagesKeys.length; l++) {\n\n          if (imagesKeys[l] != \"isNew\") {\n            var imageInfo = row[imagesKeys[l]];\n            if (row.isNew) {\n              //Use created entity id\n              var newKey = entityMap[rowKeys[k]];\n              if (newKey === undefined) continue;\n              imageInfo.xpathContext = imageInfo.gridXpath + self.database.buildCellXpathFilter(newKey);\n            } else {\n              imageInfo.xpathContext = imageInfo.gridXpath + self.database.buildCellXpathFilter(rowKeys[k]);\n            }\n\n            if (!imageInfo) continue;\n\n            //Column image case\n            if (imageInfo.columnXpath) params.xpath = imageInfo.xpathContext + '.' + imageInfo.columnXpath;\n\n            uploadParams = $.extend({}, params, imageInfo);\n            promises.push(self.uploadImage(uploadParams, imageInfo));\n          }\n\n        }\n      }\n\n      return promises;\n    },\n\n    uploadImage: function uploadImage(params, data) {\n      var self = this;\n      var addParams = self.buildAddParamsForUpload(params, 'savefile');\n      var uploadFileName = !bizagi.util.isEmpty(data.name) ? data.name : \"offlineImage_\" + bizagi.util.randomNumber() + \".png\";\n      var uploadKey = params.xpath;\n      var uploadAddUrl = self.renderDataService.getUploadAddFileUrl(false);\n\n      var formData = new FormData();\n      $.each(addParams, function (key, item) {\n        formData.append(key, item);\n      });\n      return self.renderDataService.getOfflineImage({\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        id: data.offlineId,\n        offlineType: params.offlineType,\n        loadImageFromForm: false },\n      bizagi.util.db.AttachmentType.Blob).\n      then(function (binaryFile) {\n        if (data.isSignature && binaryFile == null)\n        binaryFile = bizagi.util.b64toBlob(self.EMPTY_IMAGE, \"image/png\");\n\n        if (binaryFile) {\n          formData.append(uploadKey, binaryFile, uploadFileName);\n          return $.ajax({ url: uploadAddUrl, type: \"POST\", contentType: false, processData: false, data: formData });\n        }\n\n        // Failed getOfflineImage\n        bizagi.util.console.error(\"UploadImage:: Missing local file\", params, data.offlineId);\n        return $.Deferred().reject({ type: \"error\", errorType: \"offlineUploadFileError\", message: \"Missing local file \" + data.offlineId }).promise();\n      }).\n      then(function (resp) {\n        if (resp.type && resp.type === \"error\") {\n          bizagi.util.console.error(\"UploadImage:: Server returned error\", params, resp);\n          return $.Deferred().reject(resp).promise();\n        }\n\n        bizagi.util.console.log(\"Image uploaded\", resp, uploadKey, uploadFileName);\n        return resp;\n      }).\n      fail(function (error) {\n        bizagi.util.console.error(\"UploadImage:: fail\", error);\n      });\n    },\n\n    /*************************************************************************************************\r\n        *          UPLOAD FILE METHODS\r\n        *************************************************************************************************/\n\n    uploadAndDeleteFormFiles: function uploadAndDeleteFormFiles(params, uploadValues, actions) {\n      var self = this;\n      var promises = [];\n      uploadValues.forEach(function (uploadControlValue) {\n        Array.prototype.push.apply(promises, self.uploadAndDeleteFiles(params, uploadControlValue, actions));\n      });\n\n      return promises;\n    },\n\n    uploadFormGridFiles: function uploadFormGridFiles(uploadParams, filesByRow, entityMap, actions) {\n      var self = this;\n      var promises = [];\n\n      var rowKeys = Object.keys(filesByRow);\n      for (var k = 0; k < rowKeys.length; k++) {\n        var row = filesByRow[rowKeys[k]];\n        var filesKeys = Object.keys(row);\n        for (var l = 0; l < filesKeys.length; l++) {\n          if (filesKeys[l] != \"isNew\") {\n            var fileInfo = row[filesKeys[l]];\n            if (row.isNew) {\n              //Use created entity id\n              var newKey = entityMap[rowKeys[k]];\n              if (newKey === undefined) continue;\n              fileInfo.xpathContext = fileInfo.gridXpath + self.database.buildCellXpathFilter(newKey);\n            } else {\n              fileInfo.xpathContext = fileInfo.gridXpath + self.database.buildCellXpathFilter(rowKeys[k]);\n            }\n            Array.prototype.push.apply(promises, self.uploadAndDeleteFiles(uploadParams, fileInfo, actions));\n          }\n\n        }\n      }\n\n      return promises;\n    },\n\n    uploadAndDeleteFiles: function uploadAndDeleteFiles(params, uploadControl, deleteActions) {\n      var promises = [];\n      var self = this;\n      var files = uploadControl.value;\n      if (!files || files.length == 0) {\n        return;\n      }\n\n      files.forEach(function (file) {\n        var status = file.status;\n        if (\"new\" === status) {\n          var uploadParams = {\n            fileId: file.id,\n            fileName: file.fileName,\n            fileMimeType: file.mimeType };\n\n          $.extend(uploadParams, params);\n          promises.push(self.uploadFile(uploadParams, uploadControl));\n\n        } else if (\"deleted\" === status) {\n          var deleteParams = {\n            renderId: uploadControl.renderId,\n            xpath: uploadControl.xpath,\n            fileId: file.id,\n            idPageCache: params.pageCacheId };\n\n          //Column file scenario\n          if (uploadControl.columnXpath) {\n            deleteParams.xpath = uploadControl.columnXpath;\n            deleteParams.xpathContext = uploadControl.xpathContext;\n          }\n          var deleteAction = self.deleteFile(deleteParams);\n          deleteActions.push(deleteAction);\n        }\n      });\n\n      return promises;\n    },\n\n    uploadFile: function uploadFile(params, uploadControl) {\n      var self = this;\n      var xpath = uploadControl.xpath;\n\n      //Column file scenario\n      if (uploadControl.columnXpath) {\n        xpath = uploadControl.columnXpath;\n        var xpathContext = uploadControl.xpathContext ? uploadControl.xpathContext + \".\" : \"\";\n        var attachmentId = xpathContext + xpath + '.' + params.fileId;\n        if (uploadControl.isNew && uploadControl.fullXpath) {\n          attachmentId = uploadControl.fullXpath + \".\" + params.fileId;\n        }\n      } else\n      {\n        var attachmentId = xpath + '.' + params.fileId;\n      }\n\n      return self.getOfflineFile(params, attachmentId).\n      then(function (blobFile) {\n        if (blobFile) {\n          var uploadFileParams = {\n            xpath: xpath,\n            renderId: uploadControl.renderId,\n            pageCacheId: params.pageCacheId,\n            sessionId: params.sessionId,\n            fileName: params.fileName,\n            xpathContext: uploadControl.xpathContext };\n\n          return self.uploadBinaryFile(uploadFileParams, blobFile);\n        }\n\n        bizagi.util.console.error(\"UploadFile:: Missing local file\", params, attachmentId);\n        return $.Deferred().reject({\n          type: \"error\",\n          errorType: \"offlineUploadFileError\",\n          message: \"Missing local file \" + attachmentId }).\n        promise();\n      });\n    },\n\n\n    uploadBinaryFile: function uploadBinaryFile(params, binaryFile) {\n      var self = this;\n      var addParams = self.buildAddParamsForUpload(params, 'addfile');\n      var formData = new FormData();\n      $.each(addParams, function (key, item) {\n        formData.append(key, item);\n      });\n      formData.append(params.xpath, binaryFile, params.fileName);\n\n      return self.renderDataService.processUploadFile({\n        url: self.renderDataService.getUploadAddUrl(),\n        formData: formData }).\n\n      then(function (res) {\n        if (res.type && res.type === \"error\") {\n          bizagi.util.console.error(\"UploadBinaryFile:: Server returned error\", params, res);\n          return $.Deferred().reject(res).promise();\n        } else\n        {\n          bizagi.util.console.log(\"File uploaded\", res, params.xpath, params.fileName);\n          return res;\n        }\n      });\n    },\n\n    getOfflineFile: function getOfflineFile(params, attachmentId) {\n      var self = this;\n      var offlineType = params.offlineType;\n      var getFileParams = {\n        id: attachmentId,\n        idCase: params.idCase };\n\n\n      if (offlineType && offlineType === \"start\") {\n        getFileParams.offlineType = params.offlineType;\n        return self.renderDataService.getOfflineFile(getFileParams, bizagi.util.db.AttachmentType.Blob, params.fileMimeType);\n      }\n\n      // Activity form\n      getFileParams.idWorkitem = params.idWorkitem;\n      return self.renderDataService.getOfflineActivityDataFile(getFileParams, bizagi.util.db.AttachmentType.Blob, params.fileMimeType);\n    },\n\n    deleteFile: function deleteFile(params) {\n      var self = this;\n      var fileId = params.fileId;\n      var fileXpath = params.xpath + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\n      var deleteParams = {\n        xpath: fileXpath,\n        idRender: params.renderId,\n        xpathContext: params.xpathContext || \"\",\n        idPageCache: params.idPageCache,\n        prepare: true };\n\n      return self.renderDataService.deleteUploadFile(deleteParams);\n    },\n\n    /*************************************************************************************************\r\n        *          UTIL METHODS\r\n        *************************************************************************************************/\n\n    buildOfflineImageId: function buildOfflineImageId(value, xpathContext, xpath, isVersion2OrSuperior, isStartForm) {\n      isVersion2OrSuperior = isVersion2OrSuperior || (isVersion2OrSuperior === undefined ? true : false);\n      if (bizagi.util.isEmptyValue(value)) value = null;\n      value = bizagi.util.isArray(value) && bizagi.util.isArray(value[0]) ? value[0][1] : value;\n\n      var result = (xpathContext ? xpathContext + '.' : '') + xpath;\n      if (isVersion2OrSuperior && !bizagi.util.isEmpty(value) && !isStartForm) {\n        result += '.' + value;\n      }\n      return result;\n    },\n\n    getOfflineImageName: function getOfflineImageName(value, forceChange) {\n      if (bizagi.util.isEmptyValue(value)) value = null;\n      var result = bizagi.util.isArray(value) && bizagi.util.isArray(value[0]) ? value[0][1] : null;\n      if (forceChange) {\n        result = \"offlineImage_\" + bizagi.util.randomNumber() + \".png\";\n      }\n      return result;\n    },\n\n    changeOfflineImageName: function changeOfflineImageName(value, imageName) {\n      if (bizagi.util.isEmptyValue(value)) return;\n      if (bizagi.util.isArray(value) && bizagi.util.isArray(value[0])) value[0][1] = imageName;\n    },\n\n    resolveBlobFromPath: function resolveBlobFromPath(path, fileName) {\n      var blobPromise = new $.Deferred();\n      var self = this;\n      var isNative = bizagi.util.isCordovaSupported();\n      if (isNative) {\n        if (!bizagi.util.isAndroidDevice()) {\n          path = bizagi.util.media.normalizeIOSFilePath(path);\n        } else\n        {\n          // Fix android 4.4 getting images from recent folder\n          path = bizagi.util.media.getImagePath(path);\n        }\n\n        var errorHandler = function errorHandler(error) {\n          bizagi.util.console.error('Error converting path to blob', error);\n          blobPromise.reject(error);\n        };\n\n        window.resolveLocalFileSystemURL(path, function (fileEntry) {\n          fileEntry.file(function (file) {\n            var reader = new FileReader();\n            reader.onloadend = function () {\n              var blob = new Blob([this.result], { type: file.type });\n              blob.name = fileName;\n              blobPromise.resolve(blob);\n            };\n            reader.readAsArrayBuffer(file);\n          }, errorHandler);\n        }, errorHandler);\n      } else\n      {\n        //In browser is the File\n        blobPromise.resolve(path);\n      }\n      return blobPromise;\n    },\n\n    buildAddParamsForUpload: function buildAddParamsForUpload(params, action) {\n      var addParams = {};\n      addParams[\"h_xpath\"] = params.xpath;\n      addParams[\"h_idRender\"] = params.renderId;\n      addParams[\"h_xpathContext\"] = params.xpathContext || \"\";\n      addParams[\"h_pageCacheId\"] = params.pageCacheId;\n      addParams[\"p_sessionId\"] = params.sessionId;\n      addParams[\"h_action\"] = action;\n\n      try {\n        BIZAGI_SESSION_NAME != undefined ?\n        addParams[BIZAGI_SESSION_NAME] = params.sessionId :\n        addParams[\"JSESSIONID\"] = params.sessionId;\n      } catch (e) {\n        addParams[\"JSESSIONID\"] = params.sessionId;\n      }\n      addParams.queueID = \"q_\" + bizagi.util.encodeXpath(params.xpath);\n      return addParams;\n    } });\n\n}","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.sync = bizagi.sync || {};\nbizagi.sync.services = bizagi.sync.services || {};\nbizagi.sync.services.service = bizagi.sync.services.service || {};\n$.Class.extend(\"bizagi.sync.services.service\", {\n  // STATIC METHODS\n  logKey: \"OFFLINE SYNC TRACES::\",\n  syncTraces: {},\n\n  getCurrentSyncStep: function getCurrentSyncStep(id) {\n    return this.syncTraces[id] ? this.syncTraces[id].currentStep : null;\n  },\n\n  setCurrentSyncStep: function setCurrentSyncStep(id, step, stepParameters) {\n    var trace = this.syncTraces[id] || {};\n    var traceAlreadyAdded = !bizagi.util.isEmpty(trace);\n    trace.currentStep = step;\n    trace.steps = trace.steps || [];\n    trace.steps.push({\n      step: step,\n      stepParameters: stepParameters });\n\n\n    if (!traceAlreadyAdded) {\n      this.syncTraces[id] = trace;\n    }\n  },\n\n  addSyncStepResponse: function addSyncStepResponse(id, stepName, stepResponse) {\n    var trace = this.syncTraces[id];\n    if (bizagi.util.isEmpty(trace)) {\n      console.error(\"OFFLINE SYNC TRACES::addCurrentSyncStepResponse:: Sync trace does not exist\", id);\n      return;\n    }\n    if (trace.steps == undefined) {\n      trace.steps = [];\n    }\n    var stepObject = trace.steps.find(function (value) {\n      return value.step == stepName;\n    });\n    if (bizagi.util.isEmpty(stepObject)) {\n      console.warn(\"OFFLINE SYNC TRACES::addCurrentSyncStepResponse:: step \" + stepName + \" does not exist\", stepName);\n      stepObject = {\n        step: \"not-found-\" + bizagi.util.randomNumber() + \"-\" + stepName };\n\n      trace.steps.push(stepObject);\n    }\n    stepObject.stepResponse = stepResponse;\n  },\n\n  addCurrentSyncStepResponse: function addCurrentSyncStepResponse(id, stepResponse) {\n    var trace = this.syncTraces[id];\n    if (bizagi.util.isEmpty(trace)) {\n      console.error(\"OFFLINE SYNC TRACES::addCurrentSyncStepResponse:: Sync trace does not exist\", id);\n      return;\n    }\n    this.addSyncStepResponse(id, trace.currentStep, stepResponse);\n  },\n\n  clearTrace: function clearTrace(id) {\n    if (!this.syncTraces[id]) return;\n    delete this.syncTraces[id].steps;\n  },\n\n  printTrace: function printTrace(id) {\n    var trace = this.syncTraces[id];\n    var traceLogKey = this.logKey + \"TRACE::\" + id + \"::\";\n    if (bizagi.util.isEmpty(trace)) return;\n    bizagi.util.console.log(traceLogKey + \" ** TRACE START **\", \"\");\n    bizagi.util.console.log(traceLogKey + \"LAST STEP:: \" + trace.currentStep, \"\");\n    (trace.steps || []).forEach(function (currentStep, stepIndex) {\n      bizagi.util.console.log(traceLogKey + (stepIndex + 1) + \"::\" + currentStep.step + \":: params\", currentStep.stepParameters);\n      bizagi.util.console.log(traceLogKey + (stepIndex + 1) + \"::\" + currentStep.step + \":: response\", currentStep.stepResponse);\n    });\n    bizagi.util.console.log(traceLogKey + \" ** TRACE END **\", \"\");\n  },\n\n  printAndClearTrace: function printAndClearTrace(id) {\n    var self = this;\n    setTimeout(function () {\n      self.printTrace(id);\n      self.clearTrace(id);\n    }, 1000);\n  } },\n\n\n{\n  // INSTANCE METHODS\n  init: function init(params) {\n    var self = this;\n    self.renderDataService = params.renderDataService;\n    self.database = params.database;\n    self.fileService = self.renderDataService.getFileService();\n    self.gridService = self.renderDataService.getGridService();\n  },\n\n  /*************************************************************************************************\r\n     *          MAIN SYNC METHODS\r\n     *************************************************************************************************/\n  syncOfflineStartCase: function syncOfflineStartCase(params) {\n    var self = this;\n    var serverResponse;\n    var offlineId = params.id || params.idCase;\n\n    var loadFormParams = {\n      action: \"LOADSTARTFORM\",\n      idProcess: params.idProcess,\n      downloadOfflineForm: true };\n\n\n    bizagi.util.console.log(\"SYNCHRONIZING Start Case\", params);\n    self.Class.setCurrentSyncStep(offlineId, \"getFormData\", params);\n    return self.renderDataService.getFormData(loadFormParams).\n    then(function (response) {\n      serverResponse = response;\n      self.Class.addCurrentSyncStepResponse(offlineId, response);\n      if (response.errorType) return $.Deferred().reject(response).promise();\n      if (!response.form) return $.Deferred().reject(\"Form not found in server response\").promise();\n      self.Class.setCurrentSyncStep(offlineId, \"separateComplexControls\", { data: params.data });\n      return self.database.separateComplexControls({ offlineType: \"start\" }, params.data);\n    }).\n    then(function (separatedCaseData) {\n      self.Class.addCurrentSyncStepResponse(offlineId, separatedCaseData);\n      params.pageCacheId = serverResponse.form.pageCacheId;\n      params.sessionId = serverResponse.form.sessionId;\n      params.formId = serverResponse.form.properties.id;\n      params.offlineType = \"start\";\n      return self.performSyncOfflineCase(params, separatedCaseData);\n    }).\n    then(function (performSyncResponse) {\n      //self.Class.printTrace(offlineId);\n      self.Class.clearTrace(offlineId);\n      return performSyncResponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(offlineId, error);\n      self.Class.printAndClearTrace(offlineId);\n      bizagi.util.console.error(\"START case sync failed\", error);\n      return self.updateSyncStatusError(error, \"start\", offlineId);\n    });\n  },\n\n  syncOfflineTaskCase: function syncOfflineTaskCase(params) {\n    var self = this;\n    var data = params.data;\n    var serverResponse;\n    delete params[\"data\"];\n    var offlineId = params.idCase + \"-\" + params.idWorkitem;\n\n    params.downloadOfflineForm = true;\n\n    //Retrieve the form from server in order to obtain a valid idPageCache\n    bizagi.util.console.log(\"SYNCHRONIZING Task Case\", params);\n    self.Class.setCurrentSyncStep(offlineId, \"getFormData\", params);\n    return self.renderDataService.getFormData(params).\n    then(function (response) {\n      serverResponse = response;\n      self.Class.addCurrentSyncStepResponse(offlineId, response);\n      if (response.errorType) return $.Deferred().reject(response).promise();\n      if (!response.form) return $.Deferred().reject(\"Form not found in server response\").promise();\n      self.Class.setCurrentSyncStep(offlineId, \"separateComplexControls\", { params: params, data: data });\n      return self.database.separateComplexControls(params, data);\n    }).\n    then(function (separatedCaseData) {\n      self.Class.addCurrentSyncStepResponse(offlineId, separatedCaseData);\n      params.pageCacheId = serverResponse.form.pageCacheId;\n      params.sessionId = serverResponse.form.sessionId;\n      params.offlineType = \"task\";\n      params.formId = serverResponse.form.properties.id;\n      params.id = offlineId;\n      return self.performSyncOfflineCase(params, separatedCaseData);\n    }).\n    then(function (performSyncResponse) {\n      //self.Class.printTrace(offlineId);\n      self.Class.clearTrace(offlineId);\n      return performSyncResponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(offlineId, error);\n      self.Class.printAndClearTrace(offlineId);\n      return self.updateSyncStatusError(error, \"task\", offlineId);\n    });\n  },\n\n  /*************************************************************************************************\r\n      *          INTERNAL METHODS\r\n      *************************************************************************************************/\n\n  performSyncOfflineCase: function performSyncOfflineCase(params, sData) {\n    var self = this;\n    var gridActions = [];\n    var collectedFormActions = [];\n    var entityMap;\n    params.gridPromises = null;\n    self.Class.setCurrentSyncStep(params.id, \"checkpoint\", params);\n    return self.createCheckpoint(params).\n    then(function (checkpointResponse) {\n      self.Class.addCurrentSyncStepResponse(params.id, checkpointResponse);\n      return self.processGridRecords(params, sData, gridActions, collectedFormActions);\n    }).\n    then(function (gridActionsResponse) {\n      entityMap = self.parseGridAdditionsResponse(gridActions, gridActionsResponse);\n      self.Class.addCurrentSyncStepResponse(params.id, { gridActionsResponse: gridActionsResponse, entityMap: entityMap });\n      return self.processUploads(params, sData, entityMap, collectedFormActions);\n    }).\n    then(function (result) {\n      self.Class.addSyncStepResponse(params.id, \"uploadPromises\", result);\n      return self.processMultiAction(params, sData.data, entityMap, collectedFormActions);\n    }).\n    then(function (processMultiactionresponse) {\n      self.Class.addSyncStepResponse(params.id, \"multiaction\", processMultiactionresponse);\n      return processMultiactionresponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(params.id, error);\n      var lastAction = self.Class.getCurrentSyncStep(params.id);\n      //Rollback for first checkpoint\n      return self.manageError(params, error, lastAction, arguments);\n    });\n  },\n\n  processGridRecords: function processGridRecords(params, data, gridActions, collectedActions) {\n    var self = this;\n    var gridValues = data.grids;\n\n    if (gridValues) {\n      params.gridPromises = gridPromises = self.gridService.uploadGridData(gridValues, params.pageCacheId);\n\n      if (gridPromises.bizAdditions && gridPromises.bizAdditions.length > 0)\n      Array.prototype.push.apply(gridActions, gridPromises.bizAdditions);\n\n      if (gridPromises.bizDeletions && gridPromises.bizDeletions.length > 0)\n      Array.prototype.push.apply(collectedActions, gridPromises.bizDeletions);\n    }\n    self.Class.setCurrentSyncStep(params.id, \"multiaction grid\", { gridVallues: gridValues, gridActions: gridActions });\n    return self.renderDataService.multiaction().execute({ actions: gridActions });\n  },\n\n  parseGridAdditionsResponse: function parseGridAdditionsResponse(gridActions, gridActionsResponse) {\n    var entityMap = {};\n\n    if (gridActions !== undefined && gridActions.length > 0) {\n      for (var i = 0; i < gridActions.length; i++) {\n        if (gridActionsResponse[i] && gridActionsResponse[i].result.type === \"success\")\n        entityMap[gridActions[i][\"offline-entityId\"]] = gridActionsResponse[i].result.IdEntity;\n      }\n    }\n    return entityMap;\n  },\n\n  processUploads: function processUploads(params, data, entityMap, actions) {\n    var self = this;\n    var uploadPromises = [];\n    var imageValues = data.images;\n    var uploadValues = data.uploads;\n\n    self.Class.setCurrentSyncStep(params.id, \"uploadPromises\", { imageValues: imageValues, uploadValues: uploadValues });\n    try {\n      if (uploadValues && uploadValues.length > 0)\n      Array.prototype.push.apply(uploadPromises, self.fileService.uploadAndDeleteFormFiles(params, uploadValues, actions));\n\n      if (imageValues && imageValues.length > 0)\n      Array.prototype.push.apply(uploadPromises, self.fileService.uploadFormImages(params, imageValues));\n\n      var gridPromises = params.gridPromises;\n      if (gridPromises) {\n        if (Object.keys(gridPromises.bizImages).length > 0)\n        Array.prototype.push.apply(uploadPromises, self.fileService.uploadFormGridImages(params, gridPromises.bizImages, entityMap, actions));\n\n        if (Object.keys(gridPromises.bizFiles).length > 0)\n        Array.prototype.push.apply(uploadPromises, self.fileService.uploadFormGridFiles(params, gridPromises.bizFiles, entityMap, actions));\n      }\n    } catch (e) {\n      return $.Deferred().reject(e).promise();\n    }\n    return $.when.apply($, uploadPromises);\n\n  },\n\n  processMultiAction: function processMultiAction(params, data, entityMap, actions) {\n    var self = this;\n    var offlineType = params.offlineType;\n    var syncAction = self.getSyncAction(offlineType, data);\n    var isNextAction = syncAction != undefined && syncAction.length > 0 && syncAction.toLowerCase().includes(\"next\");\n    var actions = self.prepareMultiActionData(params, data, entityMap, syncAction, actions);\n    var syncActionTagResponse, multiactionResponse, commitResponse, wasActionPerformed;\n    var lastAction = \"multiaction\";\n    self.Class.setCurrentSyncStep(params.id, lastAction, actions);\n\n    return self.renderDataService.multiaction().execute({ actions: actions }).\n    then(function (response) {\n      self.Class.addSyncStepResponse(params.id, \"multiaction\", response);\n\n      multiactionResponse = response;\n      wasActionPerformed = self.wasMultiActionPerformed(response);\n      syncActionTagResponse = response[response.length - 1].result;\n\n      if (!wasActionPerformed) return $.Deferred().reject(response).promise();\n\n      lastAction = \"commit-multiaction\";\n      self.Class.setCurrentSyncStep(params.id, \"commit-multiaction\");\n      return self.performCommit(params, isNextAction);\n    }).\n    then(function (response) {\n      commitResponse = response;\n      self.Class.addSyncStepResponse(params.id, \"commit-multiaction\", response);\n      return self.deleteOfflineCase(params, wasActionPerformed, isNextAction);\n    }).\n    then(function () {\n      if (!wasActionPerformed) return $.Deferred().reject(multiactionResponse).promise();\n\n      if (commitResponse != undefined && commitResponse.DataChangesetVersion != undefined) {\n        syncActionTagResponse.DataChangesetVersion = commitResponse.DataChangesetVersion;\n      }\n      syncActionTagResponse.containsNext = $.grep(actions, function (o) {return o.h_action.toLowerCase().includes(\"next\");}).length > 0;\n      return syncActionTagResponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(params.id, error);\n      var cleanTaskDataActions = lastAction == \"multiaction\" && !params.isRetry;\n      return self.performRollback(params, error, cleanTaskDataActions);\n    });\n  },\n\n  prepareMultiActionData: function prepareMultiActionData(params, data, entityMap, syncAction, actions) {\n    var self = this;\n    var multiActionData = self.convertStartFormDataToStandardFormat(data);\n    var submitDataDone = false;\n    self.replaceGridChangesWithAddedRows(multiActionData, entityMap);\n    var buttonActions = self.addButtonActions(params, multiActionData);\n    if (buttonActions !== null && buttonActions.length > 0) {\n      Array.prototype.push.apply(actions, buttonActions);\n      submitDataDone = true;\n    }\n    var trySaveorTryNextAction = self.addTrySaveOrTryNextAction(params, syncAction, multiActionData, submitDataDone);\n    if (!bizagi.util.isEmpty(trySaveorTryNextAction)) actions.push(trySaveorTryNextAction);\n\n    return actions;\n  },\n\n  replaceGridChangesWithAddedRows: function replaceGridChangesWithAddedRows(data, entityMap) {\n    if (bizagi.util.isEmpty(data)) return;\n\n    Object.keys(data).forEach(function (key) {\n      var matches = key.match(/\\[id=(\\d+)\\]/);\n      if (matches) {\n        var oldKey = matches[1];\n        var addedKey = entityMap[oldKey];\n        if (entityMap[oldKey] !== undefined) {\n          var oldXpath = key;\n          var newXpath = key.replace(oldKey, addedKey);\n          data[newXpath] = data[oldXpath];\n          delete data[oldXpath];\n        }\n      }\n    });\n  },\n\n  addButtonActions: function addButtonActions(params, data) {\n    var self = this;\n    var actions = [];\n\n    if (bizagi.util.isEmpty(data)) return [];\n    var button_actions = params.isRetry && data.retry_h_actions ? data.retry_h_actions : data.h_actions;\n    delete data.h_actions;\n    delete data.retry_h_actions;\n\n    if (!Array.isArray(button_actions) || button_actions.length < 1) return [];\n\n    var submitDataAction = self.renderDataService.submitData({\n      action: \"SUBMITDATA\",\n      data: data,\n      idPageCache: params.pageCacheId,\n      prepare: true });\n\n    submitDataAction.tag = \"submitData\";\n    actions.push(submitDataAction);\n\n    button_actions.forEach(function (h_action_item) {\n      if (h_action_item) {\n        h_action_item.h_pageCacheId = params.pageCacheId;\n        actions.push(h_action_item);\n      }\n    });\n\n    return actions;\n  },\n\n  addTrySaveOrTryNextAction: function addTrySaveOrTryNextAction(params, syncAction, data, submitDoneBefore) {\n    var self = this;\n    if (!bizagi.util.isEmpty(syncAction))\n    {\n      // object base without data\n      actionParams = {\n        action: syncAction,\n        idPageCache: params.pageCacheId,\n        prepare: true,\n        transitions: '' };\n\n\n      // add data only when is required\n      if (!submitDoneBefore) actionParams.data = data;\n\n      var result = self.renderDataService.submitData(actionParams);\n      result.tag = 'performAction';\n      return result;\n    }\n    return null;\n  },\n\n  deleteOfflineCase: function deleteOfflineCase(params, wasActionPerformed, isNextAction) {\n    var self = this;\n    var offlineType = params.offlineType;\n\n    if (offlineType === \"start\") {\n      self.Class.setCurrentSyncStep(params.id, \"deleteStartCase\", { params: params });\n      return self.database.deleteCase(params).\n      then(function (deleteCaseResponse) {\n        self.Class.addSyncStepResponse(params.id, \"deleteStartCase\", deleteCaseResponse);\n        return deleteCaseResponse;\n      });\n    }\n    // Regular activity form\n    self.Class.setCurrentSyncStep(params.id, \"removeSyncStatus\", { params: false });\n    return self.database.updateCaseSyncStatus({\n      type: offlineType,\n      id: params.id,\n      syncStatus: undefined,\n      syncDetails: undefined }).\n\n    then(function (updateSyncStatusResponse) {\n      self.Class.addSyncStepResponse(params.id, \"removeSyncStatus\", updateSyncStatusResponse);\n      self.Class.setCurrentSyncStep(params.id, \"updateTaskIsEdited\", { params: false });\n      return self.database.updateTaskIsEdited(params.id, false);\n    }).\n    then(function (updateIsEditedResponse) {\n      self.Class.addSyncStepResponse(params.id, \"updateTaskIsEdited\", updateIsEditedResponse);\n      var deleteTaskDataParams = isNextAction ? $.extend({ deleteAttachments: true }, params) : params;\n      self.Class.setCurrentSyncStep(params.id, \"deleteTaskData\", { deleteTaskDataParams: deleteTaskDataParams });\n      return self.database.deleteTaskData(deleteTaskDataParams);\n    }).\n    then(function (deleteTaskDataResponse) {\n      self.Class.addSyncStepResponse(params.id, \"deleteTaskData\", deleteTaskDataResponse);\n      if (offlineType === \"task\" && wasActionPerformed && isNextAction) {\n        self.Class.setCurrentSyncStep(params.id, \"deleteTaskForm\", { params: params });\n        return self.database.deleteTaskForm(params);\n      }\n      self.Class.setCurrentSyncStep(params.id, \"deleteTaskForm\", \"--skipped--\");\n    }).\n    then(function (deleteTaskFormResponse) {\n      self.Class.addSyncStepResponse(params.id, \"deleteTaskForm\", deleteTaskFormResponse);\n      if (offlineType === \"task\" && wasActionPerformed && isNextAction) {\n        self.Class.setCurrentSyncStep(params.id, \"deleteTaskIfNext\", { params: params });\n        return self.database.deleteTask(params);\n      }\n      self.Class.setCurrentSyncStep(params.id, \"deleteTaskIfNext\", \"--skipped--\");\n      return deleteTaskFormResponse;\n    }).\n    then(function (deleteTaskIfNextResponse) {\n      self.Class.addSyncStepResponse(params.id, \"deleteTaskIfNext\", deleteTaskIfNextResponse);\n      return deleteTaskIfNextResponse;\n    }).\n    fail(function (error) {\n      var deleteError = {\n        type: \"error\",\n        errorType: \"offlineSyncError\",\n        message: \"Local case could not be deleted\",\n        details: error };\n\n      self.Class.addCurrentSyncStepResponse(params.id, deleteError);\n      return $.Deferred().reject(deleteError).promise();\n    });\n  },\n\n  /*************************************************************************************************\r\n     *          UTIL METHODS\r\n     *************************************************************************************************/\n  convertStartFormDataToStandardFormat: function convertStartFormDataToStandardFormat(data) {\n    var result = {};\n    Object.keys(data).forEach(function (key) {\n      result[key] = data[key];\n      if (data[key].value !== undefined) {\n        result[key] = data[key].value;\n      }\n    });\n    return result;\n  },\n\n  getSyncAction: function getSyncAction(offlineType, data) {\n    if (offlineType === \"start\") return \"createnewcase\";else\n    if (data.h_action === \"save\") return \"trysave\";else\n    if (data.h_action === \"next\") return \"trynext\";\n    return data.h_action;\n  },\n\n  wasMultiActionPerformed: function wasMultiActionPerformed(res) {\n    return res.length > 0 && res[res.length - 1].result && res[res.length - 1].result.type === 'success';\n  },\n\n  createCheckpoint: function createCheckpoint(params) {\n    var self = this;\n    return self.renderDataService.sendCheckpoint({\n      idRender: params.formId,\n      xpath: \"\",\n      xpathContext: \"\",\n      idPageCache: params.pageCacheId });\n\n  },\n\n  performCommit: function performCommit(params, isNextAction) {\n    var self = this;\n    if (isNextAction) return $.Deferred().resolve(null).promise();\n\n    return self.renderDataService.commitGridAction({\n      idRender: params.formId,\n      xpath: \"\",\n      xpathContext: \"\",\n      idPageCache: params.pageCacheId });\n\n  },\n\n  manageError: function manageError(params, error, lastAction, args) {\n    var self = this;\n    if (lastAction != \"checkpoint\") {\n      if (Array.isArray(error)) {\n        error = error.map(function (err) {\n          return self.renderDataService.parseServiceError(err);\n        });\n      } else\n      {\n        error = self.renderDataService.parseServiceError(args);\n      }\n      return self.performRollback(params, error);\n    }\n    return self.updateSyncStatusError(args, params.offlineType, params.id);\n  },\n\n  performRollback: function performRollback(params, error, cleanTaskDataActions) {\n    var self = this;\n    self.Class.setCurrentSyncStep(params.id, \"rollback\", { params: params, error: error, cleanTaskDataActions: cleanTaskDataActions });\n    return self.renderDataService.rollbackGridAction({\n      idRender: params.formId,\n      xpath: \"\",\n      xpathContext: \"\",\n      idPageCache: params.pageCacheId }).\n\n    always(function (rollbackResponse) {\n      self.Class.addCurrentSyncStepResponse(params.id, rollbackResponse);\n      if (!cleanTaskDataActions) {\n        self.Class.setCurrentSyncStep(params.id, \"cleanTaskDataActions\", \"--skipped--\");\n        return;\n      }\n      self.Class.setCurrentSyncStep(params.id, \"cleanTaskDataActions\", { id: params.id });\n      return self.database.cleanTaskDataActions(params.id);\n    }).\n    then(function (cleanTaskDataActionsResponse) {\n      self.Class.addSyncStepResponse(params.id, \"cleanTaskDataActions\", cleanTaskDataActionsResponse);\n      if (params.offlineType == \"start\") {\n        self.Class.setCurrentSyncStep(params.id, \"openOfflineTask\", \"--skipped--\");\n        return;\n      }\n      self.Class.setCurrentSyncStep(params.id, \"openOfflineTask\", { id: params.id });\n      return self.database.openOfflineTask(params.id);\n    }).\n    then(function (openOfflineTaskResponse) {\n      self.Class.addSyncStepResponse(params.id, \"openOfflineTask\", openOfflineTaskResponse);\n      return $.Deferred().reject(error).promise();\n    });\n  },\n\n  updateSyncStatusError: function updateSyncStatusError(args, offlineType, identifier) {\n    var self = this;\n    var error = self.renderDataService.parseServiceError(args) || {};\n    var syncErrorDetails = self.buildSyncErrorObject(error);\n    return self.database.updateCaseSyncStatus({\n      type: offlineType,\n      id: identifier,\n      syncStatus: \"failed\",\n      syncDetails: syncErrorDetails }).\n\n    then(function () {\n      return $.Deferred().reject(error).promise();\n    });\n  },\n\n  buildSyncErrorObject: function buildSyncErrorObject(error) {\n    var syncErrorType = \"technical\";\n    var message = [];\n    var performActionObject = error;\n\n    if (Array.isArray(error)) {\n      error.forEach(function (singleError) {\n        if (singleError.result == undefined) return;\n        var responseType = (singleError.result.type || \"\").toLowerCase();\n        if (responseType.includes(\"message\")) {\n          syncErrorType = \"business\";\n          if (singleError.result.message) {\n            message.push(singleError.result.message);\n          }\n          if (Array.isArray(singleError.result.messages)) {\n            message = message.concat(singleError.result.messages);\n          }\n        }\n      });\n    } else\n    if (error != undefined && error.result != undefined) {\n      var responseType = (error.result.type || \"\").toLowerCase();\n      if (responseType.includes(\"message\")) {\n        syncErrorType = \"business\";\n        if (error.result.message) {\n          message.push(error.result.message);\n        }\n        if (Array.isArray(error.result.messages)) {\n          message = message.concat(error.result.messages);\n        }\n      }\n    } else\n    if (error.message) {\n      message.push(error.message);\n    }\n    return {\n      type: syncErrorType,\n      message: message.length == 1 ? message[0] : message,\n      actionResponse: performActionObject,\n      timestamp: Date.now() };\n\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.grid = bizagi.grid || {};\nbizagi.grid.services = bizagi.grid.services || {};\nbizagi.grid.services.service = bizagi.grid.services.service || {};\n$.Class.extend(\"bizagi.grid.services.service\", {\n  // STATIC METHODS\n},\n\n{\n  // INSTANCE METHODS\n  init: function init(params) {\n    var self = this;\n    self.renderDataService = params.renderDataService;\n    self.database = params.database;\n  },\n\n  uploadGridData: function uploadGridData(gridsData, idPageCache) {\n    var self = this;\n    var promisesResponse = {\n      bizAdditions: [],\n      bizDeletions: [],\n      bizImages: {},\n      bizFiles: {} };\n\n    gridsData.forEach(function (currentGridData) {\n\n      Array.prototype.push.apply(promisesResponse.bizAdditions, self.processNewRecords(currentGridData, idPageCache));\n      Array.prototype.push.apply(promisesResponse.bizDeletions, self.processDeletedRecords(currentGridData, idPageCache));\n      $.extend(promisesResponse.bizImages, self.processImages(currentGridData));\n      $.extend(promisesResponse.bizFiles, self.processFiles(currentGridData));\n\n    });\n\n    return promisesResponse;\n  },\n\n  processNewRecords: function processNewRecords(currentGridData, idPageCache) {\n    var self = this;\n\n    //Addition promises\n    var newRecords = [];\n    var gridNewRecords = currentGridData.value[\"new-records\"];\n\n    if (gridNewRecords) {\n      var keys = Object.keys(gridNewRecords);\n\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = gridNewRecords[keys[i]];\n        rowData['idPageCache'] = idPageCache;\n\n        var actionParams = self.renderDataService.addGridRecordData(rowData);\n        actionParams[\"offline-entityId\"] = keys[i];\n\n        newRecords.push({\n          actionParams: actionParams,\n          creationTimestamp: rowData.creationTimestamp });\n\n      }\n    }\n\n    // Sort additions\n    return newRecords.sort(function (a, b) {\n      return a.creationTimestamp - b.creationTimestamp;\n    }).map(function (newRecord) {\n      return newRecord.actionParams;\n    });\n  },\n\n  processImages: function processImages(currentGridData) {\n    var result = {};\n\n    if (currentGridData.value[\"edited-images\"]) {\n      var keys = Object.keys(currentGridData.value[\"edited-images\"]);\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = currentGridData.value[\"edited-images\"][keys[i]];\n        result[keys[i]] = rowData;\n      }\n    }\n\n    return result;\n  },\n\n  processFiles: function processFiles(currentGridData) {\n    var result = {};\n    var offlineFiles = currentGridData.value[\"offline-files\"];\n\n    if (offlineFiles) {\n      var keys = Object.keys(offlineFiles);\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = offlineFiles[keys[i]];\n        result[keys[i]] = rowData;\n      }\n    }\n\n    return result;\n  },\n\n  processDeletedRecords: function processDeletedRecords(currentGridData, idPageCache) {\n    var self = this;\n    var result = [];\n    var deletedRecords = currentGridData.value[\"deleted-records\"];\n\n    if (deletedRecords) {\n      var keys = Object.keys(deletedRecords);\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = deletedRecords[keys[i]];\n        rowData['idPageCache'] = idPageCache;\n        result.push(self.renderDataService.deleteGridRecord(rowData));\n      }\n    }\n    return result;\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.form = bizagi.form || {};\nbizagi.form.services = bizagi.form.services || {};\nbizagi.form.services.service = bizagi.form.services.service || {};\n$.Class.extend(\"bizagi.form.services.service\", {\n  // STATIC METHODS\n},\n\n{\n  // INSTANCE METHODS\n  init: function init(params) {\n    var self = this;\n    self.renderDataService = params.renderDataService;\n    self.database = params.database;\n    self.fileService = self.renderDataService.getFileService();\n  },\n\n  getServerTaskForm: function getServerTaskForm(params) {\n    var self = this;\n    var form;\n    var hasEntryPipeline;\n    var wasPipelineExecuted;\n    params.downloadOfflineForm = true;\n    var service = params.bulkDownload ? self.renderDataService.multiactionWithLimit() : self.renderDataService;\n    return service.getFormData(params).\n    then(function (response) {\n      return self.executeOfflineEntryPipelineAndReloadForm(response, params);\n    }).\n    then(function (pipelineExecutionResponse) {\n      form = pipelineExecutionResponse.form;\n      hasEntryPipeline = pipelineExecutionResponse.hasEntryPipeline === true;\n      wasPipelineExecuted = pipelineExecutionResponse.wasPipelineExecuted === true;\n      return self.getFileAttachmentsFromLocalTaskForm(params);\n    }).\n    then(function (localFiles) {\n      if (form.errorType) return $.Deferred().reject(form).promise();\n      if (params.deleteNextButton) form = self.database.deleteNextButton(form);\n\n      form.dataChangeset = params.dataChangeset;\n      params.localFiles = localFiles;\n\n      var result = self.fileService.downloadFormFiles(form, params);\n\n      var filePromises = result.promises;\n      var imagePromises = self.fileService.downloadFormImages(form, params);\n      var downloadAttachmentsPromises = Array.prototype.push.apply(filePromises, imagePromises);\n\n      if (params.bulkDownload && downloadAttachmentsPromises.length > 0) {\n\n        // When downloading offline forms in bulk, wait for data promises\n        return $.when.apply($, downloadAttachmentsPromises).\n        then(function () {\n          return self.mergeForm(form, result.data);\n        });\n\n      }\n\n      // Single offline form, don't wait for files\n      return self.mergeForm(form, result.data);\n    }).\n    then(function (resolvedForm) {\n      return {\n        form: resolvedForm,\n        hasEntryPipeline: hasEntryPipeline,\n        wasPipelineExecuted: wasPipelineExecuted };\n\n    }).\n    fail(function () {\n      bizagi.util.console.error(\"Error downloading task form\", params);\n    });\n  },\n\n  executeOfflineEntryPipeline: function executeOfflineEntryPipeline(formData) {\n    var self = this;\n    var formProperties = formData.form ? formData.form.properties : {};\n    var shouldExecutePipeline = self.hasFormEntryPipeline(formData);\n\n    if (!shouldExecutePipeline) {\n      return $.Deferred().resolve({ hasEntryPipeline: false, wasPipelineExecuted: false }).promise();\n    }\n\n    return $.when(self.renderDataService.executePipeline({\n      pipeline: formProperties.loadExecution,\n      idPageCache: formData.form.pageCacheId })).\n\n    then(function () {\n      return { hasEntryPipeline: true, wasPipelineExecuted: true };\n    }, function () {\n      return $.Deferred().resolve({ hasEntryPipeline: true, wasPipelineExecuted: false }).promise();\n    });\n  },\n\n  executeOfflineEntryPipelineAndReloadForm: function executeOfflineEntryPipelineAndReloadForm(data, params) {\n    var self = this;\n\n    if (!params.executeOfflineEntryPipeline) return { form: data, wasPipelineExecuted: false };\n\n    // Execute pipeline, then reload form\n    return self.executeOfflineEntryPipeline(data).\n    then(function (response) {\n      hasEntryPipeline = response.hasEntryPipeline;\n      wasPipelineExecuted = response.wasPipelineExecuted;\n\n      if (hasEntryPipeline && wasPipelineExecuted) {\n        return self.renderDataService.getFormData(params).\n        then(function (getFormDataResponse) {\n          return {\n            form: getFormDataResponse,\n            hasEntryPipeline: hasEntryPipeline,\n            wasPipelineExecuted: wasPipelineExecuted };\n\n        });\n      }\n      return {\n        form: data,\n        hasEntryPipeline: hasEntryPipeline,\n        wasPipelineExecuted: wasPipelineExecuted };\n\n    });\n  },\n\n  getFileAttachmentsFromLocalTaskForm: function getFileAttachmentsFromLocalTaskForm(params) {\n    var self = this;\n    return self.database.getFileAttachmentsFromLocalTaskForm(params).\n    then(function (localAttachments) {\n      return localAttachments;\n    }, function () {\n      return {};\n    });\n  },\n\n  mergeForm: function mergeForm(form, data) {\n    var self = this;\n    return self.database.mergeDataDocument(data, form).\n    then(function (complexData) {\n      var object = { data: data };\n      object.data = complexData;\n      object.isOpen = true;\n\n      return self.database.mergeForm(object, form, { online: true });\n    });\n  },\n\n  downloadOfflineStartForm: function downloadOfflineStartForm(params) {\n    var self = this;\n    params.action = \"LOADSTARTFORM\";\n    params.downloadOfflineForm = true;\n\n    return self.renderDataService.multiactionWithLimit().getFormData(params).\n    then(function (serverResponse) {\n      if (serverResponse.errorType) return $.Deferred().reject(serverResponse).promise();\n      if (!serverResponse.form) return $.Deferred().reject(serverResponse).promise();\n\n      serverResponse.form.properties.isTaskForm = false;\n      if (serverResponse.form.buttons === undefined || Array.isArray(serverResponse.form.buttons) && serverResponse.form.buttons.length < 2)\n      serverResponse.form.buttons = self.addFormDefaultButtons();;\n      serverResponse.lastSynchronization = Date.now();\n\n      return self.database.saveStartForm(params, serverResponse);\n    });\n  },\n\n  downloadOfflineTaskForm: function downloadOfflineTaskForm(params) {\n    var self = this;\n    var hasEntryPipeline;\n    var wasPipelineExecuted;\n    params.deleteNextButton = false;\n\n    return self.getServerTaskForm({\n      idCase: params.idCase,\n      idWorkitem: params.idWorkitem,\n      executeOfflineEntryPipeline: params.executeOfflineEntryPipeline === true,\n      bulkDownload: params.bulkDownload }).\n\n    then(function (response) {\n\n      var form = response.form;\n      hasEntryPipeline = response.hasEntryPipeline;\n      wasPipelineExecuted = response.wasPipelineExecuted;\n      form.form.properties.isTaskForm = true;\n\n      if (form.form.buttons === undefined || Array.isArray(form.form.buttons) && form.form.buttons.length == 0)\n      form.form.buttons = self.addFormDefaultButtons();\n\n      return self.database.saveTaskForm(params, form);\n    }).\n    then(function () {\n\n      if (!params.isSingleSync) {\n        var formNotificationParams = $.extend({}, params);\n        formNotificationParams.type = \"download-form-success\";\n        $(document).trigger(\"offline-notify-form-sync-event\", formNotificationParams);\n      }\n\n      return {\n        wasFormDownloaded: true,\n        hasEntryPipeline: hasEntryPipeline,\n        wasPipelineExecuted: wasPipelineExecuted };\n\n    });\n  },\n\n  /*************************************************************************************************\r\n      *          UTIL METHODS\r\n      *************************************************************************************************/\n\n  addFormDefaultButtons: function addFormDefaultButtons() {\n    return [\n    {\n      button: {\n        properties: {\n          actions: [\n          \"submitData\",\n          \"refresh\"],\n\n          caption: \"render-form-button-save\",\n          id: \"ec0a5a02-0f81-44a7-8d64-ac090a01d61b\" } } },\n\n\n\n    {\n      button: {\n        properties: {\n          actions: [\n          \"validate\",\n          \"submitData\",\n          \"next\",\n          \"routing\"],\n\n          caption: \"render-form-button-next\",\n          id: \"ba81c7af-0d83-4139-879d-b040f0f81bd7\" } } }];\n\n\n\n\n  },\n\n  // TODO: Check if there is another way to check this without invoking 'renderDataService.getFormData'\n  verifyFormEntryPipeline: function verifyFormEntryPipeline(params) {\n    var self = this;\n    return self.renderDataService.getFormData(params).\n    then(function (formData) {\n      return self.hasFormEntryPipeline(formData);\n    }).\n    fail(function (err) {\n      bizagi.util.console.error(\"verifyFormEntryPipeline => getFormData error\", err);\n      return false;\n    });\n  },\n\n  hasFormEntryPipeline: function hasFormEntryPipeline(formData) {\n    var formProperties = formData.form ? formData.form.properties : {};\n    var hasEntryPipeline = bizagi.util.parseBoolean(formProperties.hasEntryPipeline) === true &&\n    !bizagi.util.isEmpty(formProperties.loadExecution);\n    return hasEntryPipeline;\n  } });","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"h_pageCacheId\" },\n{\n\n  /*\r\n  *   Sends a multiaction to the server\r\n  */\n  execute: function execute(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\n\n    // Check action tag\n    $.each(params.actions, function (i, action) {\n      action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\n      if (action[self.Class.BA_PAGE_CACHE]) {\n        data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\n      }\n      delete action[self.Class.BA_PAGE_CACHE];\n      delete action.tag;\n    });\n\n    // Fill optional parameters\n    params = params || {};\n    if (params.actions) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\n    }\n\n    // Log submit data\n    bizagi.debug(\"Performing multi-action metadata\", data);\n\n    // Call ajax and returns promise\n    var deferred = new $.Deferred();\n    $.ajax({\n      url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"MULTIACTION\",\n      beforeSend: function beforeSend(xhr, status) {\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } }).\n\n    done(function (responses) {\n      for (i in responses) {\n        if (typeof responses[i] !== \"function\") {\n          var response = responses[i];\n          if (response.error) {\n            if (rejectDeferreds) {\n              deferred.reject(this, \"servererror\", response);\n              return;\n            }\n\n          }\n        }\n      }\n      deferred.resolve(responses);\n\n    }).fail(function (xhr) {\n      var response = xhr.responseText || xhr;\n      var finalResponse;\n      // Try to parse the response\n      try {\n        finalResponse = JSON.parse(response);\n      } catch (e) {}\n      deferred.reject(xhr, \"servererror\", finalResponse);\n    });\n\n    return deferred.promise();\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\nvar STOREOBJECTNAME = \"offlineTasks\";\nbizagi.workportal.services.db.extend(\"bizagi.workportal.services.db\", {}, {\n\n  /**\r\n                                                                             * This method create a new case in the db to offline status\r\n                                                                             * @param {} params \r\n                                                                             * @returns {} promise\r\n                                                                             */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    var idWfClass = params.idWfClass,\n    id = new Date().toISOString();\n\n    var offlineCase = {\n      _id: id,\n      idWfClass: idWfClass.toString(),\n      idWorkFlow: idWfClass.toString(),\n      idCase: id,\n      isFavorite: false,\n      globalId: self.globalId,\n      createdBy: {\n        Name: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n        userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n      creationDate: new Date(),\n      process: params.displayName || \"Offline\",\n      categoryName: params.process || params.categoryName || \"Offline\",\n      displayName: params.displayName || \"Offline\",\n      radNumber: id,\n      // closed: false,\n      isOfflineForm: true,\n      formsRenderVersion: 2,\n      isOpen: true,\n      workItems: [\n      {\n        idWorkItem: bizagi.util.uniqueID(),\n        idTask: bizagi.util.uniqueID(),\n        idCase: id,\n        colorState: \"Green\",\n        State: \"Green\",\n        TaskName: params.displayName || \"Offline\" }] };\n\n\n\n\n    return this.saveStartCase(id, offlineCase).\n    then(function () {\n      return offlineCase;\n    });\n  },\n\n  /**\r\n      * Delete case\r\n      * @param {} params \r\n      * @returns {} promise \r\n      */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbStartData.get(params.idCase, function (err, doc) {\n      if (!err) {\n        self.dbStartData.remove(doc, function (error, response) {\n          if (!error) {\n            def.resolve(response);\n          } else {\n            bizagi.log(\"Error erasing case\");\n            def.reject(err);\n          }\n        });\n\n      } else {\n        bizagi.log(\"Error, the case do not exist\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * Delete tasks in dbActivities\r\n      */\n  deleteTask: function deleteTask(params) {\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var db = this.dbActivities;\n    return bizagi.util.db.deleteDocument(db, documentId);\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this,\n    def = new $.Deferred();\n\n    if (params.fromWorkItemId) {\n      var doc = {\n        workItems: [params.fromWorkItemId] };\n      def.resolve(doc);\n    } else\n    {\n      self.dbStartData.get(params.idCase, function (err, doc) {\n        if (!err) {\n          def.resolve(doc);\n        } else {\n\n          def.reject(err);\n        }\n      });\n    }\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the categories as the services if exists in the database\r\n      * @param {} data \r\n      * @returns {} promise\r\n      */\n  getCategories: function getCategories(data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (!data.enableOfflineForm) {\n      def.resolve({});\n    } else\n    {\n      var db = self.dbProcessesHierarchy;\n      $.when(bizagi.util.db.getDocument(db, self.globalId)).\n      then(function (processesHierarchyDoc) {\n        self.categories = processesHierarchyDoc.doc;\n        if (data.idApp || data.idCategory) {\n          var groupCategory = getGroup(self.categories, data);\n          def.resolve({\n            category: groupCategory,\n            totalApps: data.idApp ? groupCategory.length : 0 });\n\n        } else {\n          var tempCategories = self.categories;\n          while (tempCategories.length == 1 && (\n          tempCategories[0].categories || tempCategories[0].subCategories)) {\n            tempCategories = getGroup(\n            tempCategories,\n            tempCategories[0].appId ? { idApp: tempCategories[0].appId } :\n            { idCategory: tempCategories[0].idCategory });\n\n          }\n\n          def.resolve({\n            category: tempCategories,\n            totalApps: tempCategories[0] && tempCategories[0].appId ? tempCategories.length : 0 });\n\n        }\n      }).\n      fail(function () {//Document not found\n        def.resolve({\n          category: [],\n          totalApps: 0 });\n\n      });\n    }\n    return def.promise();\n\n    /**\r\n                           * Get the group for new cases similar to service \r\n                           * @param {} categories \r\n                           * @param {} data \r\n                           * @returns {} \r\n                           */\n    function getGroup(categories, data) {\n      for (var i = 0, len = categories.length; i < len; i++) {\n        if (categories[i].appId && categories[i].appId == data.idApp) {\n          return categories[i].categories;\n        }\n        if (categories[i].idCategory && categories[i].idCategory == data.idCategory) {\n          return categories[i].subCategories;\n        } else {\n          if (categories[i].categories) {\n            var cat = getGroup(categories[i].categories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n\n          if (categories[i].subCategories) {\n            var cat = getGroup(categories[i].subCategories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n        }\n      }\n    }\n  },\n\n  /**\r\n      * This method return all the open cases for the user authenticated from de DB\r\n      * @returns {} promise\r\n      */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbStartData.query({\n      map: map },\n    {\n      reduce: false },\n    function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get case by id\r\n      * @param {} idCase \r\n      * @returns {} \r\n      */\n  getCase: function getCase(idCase) {\n    var self = this;\n    var db = self.dbStartData;\n    return bizagi.util.db.getDocument(db, idCase);\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    if (params.radnumber || params.radNumber) {\n      params[\"radNumber\"] = params.radnumber ? params.radnumber : params.radNumber;\n    }\n\n    if (params.idcase || params.idCase) {\n      params[\"radNumber\"] = params.idcase ? params.idcase : params.idCase;\n    }\n\n    self.dbStartData.allDocs({\n      include_docs: true },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber)) {\n            var localCase = {\n              id: resp.rows[i].id,\n              idWFClass: resp.rows[i].idWFClass,\n              idWorkFlow: resp.rows[i].id,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isOfflineForm: true,\n              syncStatus: resp.rows[i].syncStatus,\n              fields: [\n              {\n                Value: resp.rows[i].value.process,\n                DisplayName: resp.rows[i].value.process,\n                DataType: \"VarChar\",\n                isRadNumber: false },\n              {\n                Value: resp.rows[i].value.creationDate,\n                DisplayName: \"Process creation date\",\n                DataType: \"DateTime\",\n                isRadNumber: false }] };\n\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local data base\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n\n  getAllProcesses: function getAllProcesses(params) {\n    var def = new $.Deferred();\n    var self = this;\n\n    var response = {\n      \"workflows\": {\n        \"taskstate\": \"\",\n        \"workflow\": [] } };\n\n\n\n    var activeProcessesQueryFun = {\n      map: function map(doc) {\n        if (doc.idWfClass && doc.isOpen) {\n          emit({\n            idWfClass: doc.idWfClass,\n            process: doc.process,\n            category: doc.categoryName },\n          1);\n        }\n      },\n      reduce: \"_count\" };\n\n\n    var queryArgs = {\n      include_docs: false,\n      group: true };\n\n\n    var executeQueryPromise = bizagi.util.db.executeQuery(self.dbActivities, activeProcessesQueryFun, queryArgs);\n\n    $.when(executeQueryPromise).\n    then(function (queryResponse) {\n      var responseRows = queryResponse.rows;\n      if (responseRows != undefined && responseRows.length > 0) {\n        responseRows.forEach(function (row) {\n          var casesCount = row.value;\n          response.workflows.workflow.push({\n            idworkflow: row.key[\"idWfClass\"],\n            name: row.key[\"process\"],\n            count: casesCount,\n            isFavorite: false,\n            category: row.key[\"category\"] });\n\n        });\n      }\n      def.resolve(JSON.stringify(response));\n    }).\n    fail(function (queryErr) {\n      def.reject(queryErr);\n    });\n    return def.promise();\n  },\n\n  getOutboxCases: function getOutboxCases() {\n    var self = this;\n\n    return self.dbStartData.allDocs({\n      include_docs: true,\n      attachments: true }).\n    toJqueryPromise().\n    then(function (response) {\n      response.rows = $.grep(response.rows, function (item) {return !item.doc.isOpen;});\n      response.rows = $.map(response.rows, function (item) {\n        return {\n          id: item.id,\n          key: item.doc.isOpen,\n          value: item.doc };\n\n      });\n      return response;\n    }).\n    fail(function (err) {\n      bizagi.log(\"Error loading data before syncronization\");\n      return err;\n    });\n  },\n\n  getOutboxTaskCases: function getOutboxTaskCases() {\n    var self = this;\n    var def = new $.Deferred();\n    self.dbActivityData.allDocs({ include_docs: true }, function (err, resp) {\n      if (!err) {\n        def.resolve(resp);\n      } else\n\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n  getOutboxTaskCasesFilteredBySyncStatus: function getOutboxTaskCasesFilteredBySyncStatus(pSyncStatus, includeDocs) {\n    var self = this;\n    var def = new $.Deferred();\n    pSyncStatus = pSyncStatus || \"none\";\n    var queryMap = {\n      map: function filterCaseBySyncStatus(doc, emit) {\n        if (doc.data != undefined && !bizagi.util.isEmpty(doc.data.h_action)) {\n          var emitValue = doc.syncStatus;\n          if (pSyncStatus === \"any\" && emitValue != undefined || pSyncStatus === \"none\" && emitValue == undefined) {\n            emitValue = pSyncStatus;\n          }\n          emit(emitValue);\n        }\n      } };\n\n\n\n    var filterParameters = {\n      key: pSyncStatus,\n      include_docs: includeDocs == true };\n\n    self.dbActivityData.query(queryMap, filterParameters, function (error, result) {\n      if (error) {\n        def.reject(error);\n      } else\n      {\n        def.resolve(result.rows);\n      }\n    });\n\n    return def.promise();\n  },\n\n  existantCase: function existantCase(params, data) {\n    var self = this;\n    var idWfClass = params.idWfClass,\n    id = params.idCase + \"-\" + params.idWorkitem;\n\n    return offlineCase = {\n      _id: id,\n      idCase: id,\n      isFavorite: false,\n      globalId: self.globalId,\n      createdBy: {\n        Name: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n        userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n      creationDate: new Date(),\n      process: params.process || \"Offline\",\n      categoryName: params.process || params.categoryName || \"Offline\",\n      displayName: params.displayName || \"Offline\",\n      radNumber: id,\n      // closed: false,\n      isOfflineForm: true,\n      formsRenderVersion: 2,\n      isOpen: true,\n      workItems: [\n      {\n        idWorkItem: bizagi.util.uniqueID(),\n        idTask: bizagi.util.uniqueID(),\n        idCase: id,\n        colorState: \"Green\",\n        State: \"Green\",\n        TaskName: params.process || \"Offline\" }] };\n\n\n\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {}  Returns a promise\r\n      *  Struct: [\r\n      *   idCase, idWorkItem, idTask,\r\n      *   dueDate, processName, activityName,\r\n      *   customzedColumns: [key, value],\r\n      *   isOfflineForm, isOpen\r\n      * ]\r\n      */\n  getCasesList: function getCasesList(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"page\": 1,\n      \"totalPages\": 1,\n      \"elements\": [] };\n\n\n    var isOpen = params.inputtray === \"drafts\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.isOpen, doc);\n      } };\n\n\n    self.dbStartData.query(queryFun, {\n      reduce: false,\n      key: isOpen },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.rows.length; i < len; i++) {\n          if (typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          resp.rows[i].value.radNumber.toString().indexOf(params.radNumber.toString()) != -1) {\n\n            var localCase = [\n            resp.rows[i].value.idCase,\n            resp.rows[i].value.workItems[0][\"idWorkItem\"][0] || \"\",\n            resp.rows[i].value.workItems[0][\"idTask\"][0] || \"\",\n            resp.rows[i].value.creationDate,\n            resp.rows[i].value.categoryName,\n            resp.rows[i].value.displayName,\n            [\n            [\"Case No\", resp.rows[i].value.idCase],\n            [\"Process\", resp.rows[i].value.process],\n            [\"Process creation date\", bizagi.util.formatDateTime(resp.rows[i].value.creationDate)]],\n\n            resp.rows[i].value.isOfflineForm,\n            resp.rows[i].value.isOpen];\n\n            localCase.offlineType = \"start\";\n            localCase.syncStatus = resp.rows[i].value.syncStatus;\n            localCase.taskstate = resp.rows[i].value.workItems[0].State.toLowerCase() || \"\";\n            if (!bizagi.util.isEmpty(localCase.syncStatus)) {\n              localCase.hasSyncError = true;\n              localCase.syncError = resp.rows[i].value.syncDetails;\n            }\n            cases.elements.push(localCase);\n          }\n        }\n        def.resolve(cases);\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n  /*\r\n     *   This method return the cases created offline by idWorkflow\r\n     *   Returns a promise\r\n     */\n  getCustomizedColumnsNewData: function getCustomizedColumnsNewData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.isOpen, doc);\n      } };\n\n\n    self.dbStartData.query(queryFun, {\n      reduce: false,\n      key: isOpen },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.rows.length; i < len; i++) {\n          if (typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber) {\n            var localCase = {\n              id: resp.rows[i].value.idCase,\n              idWFClass: resp.rows[i].value.idWfClass,\n              idWorkFlow: resp.rows[i].value.idWorkFlow,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isAborted: false,\n              isOfflineForm: true,\n              fields: [\n              resp.rows[i].value.idCase,\n              resp.rows[i].value.process,\n              {\n                \"workitems\": resp.rows[i].value.workItems },\n\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate),\n              \"\",\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate)] };\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get recent processes\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    var deferred = new $.Deferred();\n    var db = self.dbRecentProcesses;\n    $.when(bizagi.util.db.getDocument(db, self.globalId)).\n    then(function (recentProcesses) {\n      deferred.resolve(recentProcesses);\n    }).\n    fail(function (error) {\n      var emptyRecents = { \"processes\": [] };\n      deferred.resolve(emptyRecents);\n    });\n    return deferred.promise();\n  },\n  /**\r\n      * Save all the work items as a single object\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  saveOfflineTasks: function saveOfflineTasks(tasksMap) {\n    var self = this;\n    var saveQueue = new bizagiQueue();\n    for (i in tasksMap) {\n      var currentTask = tasksMap[i];\n      var idWfClass = currentTask[10],\n      id = currentTask[0] + '-' + currentTask[1];\n\n      var offlineCase = {\n        _id: id,\n        endDate: currentTask.endDate,\n        group: currentTask.group,\n        icon: currentTask.icon,\n        state: currentTask.state,\n        taskState: currentTask.taskState,\n        shortEndDate: currentTask.shortEndDate,\n        atRiskTime: currentTask[11],\n        type: currentTask.type,\n        idWfClass: idWfClass.toString(),\n        idWorkFlow: idWfClass.toString(),\n        idCase: currentTask[0],\n        isFavorite: currentTask[9],\n        isEdited: false,\n        createdBy: {\n          Name: typeof currentTask.creatorFullName !== \"undefined\" ? currentTask.creatorFullName : typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n          userName: typeof currentTask.creatorFullName !== \"undefined\" ? currentTask.creatorFullName : typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n        creationDate: currentTask[12],\n        process: currentTask[4],\n        categoryName: tasksMap.process || tasksMap.categoryName || \"Offline\",\n        displayName: tasksMap.displayName || \"Offline\",\n        radNumber: currentTask.systemColumns && currentTask.systemColumns.radnumber ? currentTask.systemColumns.radnumber : currentTask[0],\n        wfClassDisplayName: \"\",\n        // closed: false,\n        isOfflineForm: true,\n        formsRenderVersion: 2,\n        isOpen: true,\n        workItems: [\n        {\n          idWorkItem: currentTask[1],\n          idTask: currentTask[2],\n          idCase: currentTask[0],\n          colorState: currentTask.taskstate,\n          State: currentTask.taskstate,\n          TaskName: currentTask[5] }],\n\n\n        systemColumns: currentTask.systemColumns };\n\n      saveQueue.add(self.saveOrUpdateTask(id, offlineCase));\n    }\n    return saveQueue.execute();\n  },\n\n  saveStartCase: function saveStartCase(caseId, offlineCase) {\n    return bizagi.util.db.saveDocument(this.dbStartData, offlineCase);\n  },\n\n  saveTask: function saveTask(offlineId, offlineCase) {\n    return bizagi.util.db.saveDocument(this.dbActivities, offlineCase);\n  },\n\n  saveOrUpdateTask: function saveOrUpdateTask(internalTaskId, offlineCase) {\n    var def = new $.Deferred();\n    var self = this;\n    $.when(bizagi.util.db.getDocument(self.dbActivities, internalTaskId)).\n    then(function (currentDocument) {\n      $.extend(true, currentDocument, offlineCase);\n      return bizagi.util.db.saveDocument(self.dbActivities, currentDocument);\n    }).\n    then(function () {\n      def.resolve();\n    }).\n    fail(function (err) {\n      $.when(bizagi.util.db.saveDocument(self.dbActivities, offlineCase)).\n      then(function () {\n        def.resolve();\n      }).\n      fail(function (saveError) {\n        def.reject(saveError);\n      });\n    });\n\n    return def.promise();\n  },\n\n  cleanTaskDataActions: function cleanTaskDataActions(internalTaskId) {\n    var def = new $.Deferred();\n    var self = this;\n    $.when(bizagi.util.db.getDocument(self.dbActivityData, internalTaskId)).\n    then(function (currentDocument) {\n      if (currentDocument != undefined && currentDocument.data != undefined && currentDocument.data.h_actions != undefined) {\n        currentDocument.data.retry_h_actions = currentDocument.data.h_actions;\n        currentDocument.data.h_actions = [];\n      }\n      return bizagi.util.db.saveDocument(self.dbActivityData, currentDocument);\n    }).\n    always(function () {\n      def.resolve();\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Returns a task\r\n      * @param {} internalTaskId (idCase-idWorkitem)\r\n      */\n  getTask: function getTask(internalTaskId) {\n    return bizagi.util.db.getDocument(this.dbActivities, internalTaskId);\n  },\n\n  /**\r\n      * Save or update the headers and their metadata for the workflow specified\r\n      * @param {*} workflowId \r\n      * @param {*} headers \r\n      */\n  saveProcessCustomColumnsHeaders: function saveProcessCustomColumnsHeaders(workflowId, headers) {\n    var db = this.dbProcessColumns;\n    var doc = {\n      _id: workflowId,\n      headers: headers };\n\n    return bizagi.util.db.saveDocument(db, doc);\n  },\n\n  /**\r\n     * Save or update the headers and their metadata for the workflow specified\r\n     * @param {*} workflowId \r\n     * @param {*} headers \r\n     */\n  saveSmartInboxCustomColumnsHeaders: function saveSmartInboxCustomColumnsHeaders(smartInboxId, headers) {\n    var db = this.dbProcessColumns;\n    var doc = {\n      _id: smartInboxId,\n      headers: headers };\n\n    return bizagi.util.db.saveDocument(db, doc);\n  },\n\n  /**\r\n      * Returns an Array with the Custom Columns\r\n      * @param {*} workflowId \r\n      */\n  getProcessCustomColumnsHeaders: function getProcessCustomColumnsHeaders(workflowId) {\n    var self = this;\n    var db = this.dbProcessColumns;\n    var deferred = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(db, workflowId.toString())).\n    then(function (doc) {\n      deferred.resolve({ headers: doc.headers, type: workflowId != -1 ? \"process\" : \"system\" });\n    }).\n    fail(function (processErr) {\n      $.when(bizagi.util.db.getDocument(db, \"-1\")).\n      then(function (doc) {\n        deferred.resolve({ headers: doc.headers, type: \"system\" });\n      }).\n      fail(function (systemErr) {\n        deferred.reject(systemErr);\n      });\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Returns an Array with the Custom Columns\r\n      * @param {*} smartInboxId \r\n      */\n  getSmartInboxCustomColumnsHeaders: function getSmartInboxCustomColumnsHeaders(smartInboxId) {\n    var db = this.dbProcessColumns;\n    var deferred = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(db, smartInboxId.toString())).\n    then(function (doc) {\n      deferred.resolve({ headers: doc.headers, type: \"smartinbox\" });\n    }).\n    fail(function () {\n      $.when(bizagi.util.db.getDocument(db, \"-1\")).\n      then(function (doc) {\n        deferred.resolve({ headers: doc.headers, type: \"system\" });\n      }).\n      fail(function (systemErr) {\n        deferred.reject(systemErr);\n      });\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Generates the executable query based in the parameters.\r\n      * The query allows filtering by idWfClass and isOpen (inbox or outbox) properties\r\n      * The query allows ordering the rows based in the process or application custom columns.\r\n      */\n  generateSortedCasesQuery: function generateSortedCasesQuery(params) {\n    var idWfClass = params.idWfClass || -1;\n    var smartInboxId = params.smartInboxId;\n    var openStatus = params.isOpen;\n    var queryAcrossCustomColums = params.queryAcrossCustomColums || false;\n    var customColumnsType = params.customColumnsType || \"system\";\n\n    //Default statements\n    var filterStatement = \"doc != undefined\";\n    var emitStatement = \"doc._id\";\n    var argumentsObject = {\n      include_docs: true };\n\n\n    //Supported filters\n    if (idWfClass > 0) {\n      filterStatement = appendStatement(filterStatement, \"(doc.idWfClass != undefined && doc.idWfClass == \" + idWfClass + \")\", \"&&\");\n    } else\n    if (!bizagi.util.isEmpty(smartInboxId)) {\n      filterStatement = appendStatement(filterStatement, \"(doc.smartInboxColumns != undefined && doc.smartInboxColumns['\" + smartInboxId + \"'] !== undefined)\", \"&&\");\n    }\n    if (openStatus != undefined) {\n      filterStatement = appendStatement(filterStatement, \"doc.isOpen == \" + openStatus, \"&&\");\n    }\n\n    //RadNumber OR idCase\n    var idCase = params.idCase;\n    var radNumber = params.radNumber;\n    var caseIdFilterStatement = \"\";\n    if (idCase != undefined) {\n      caseIdFilterStatement = appendStatement(caseIdFilterStatement, \"doc.idCase != undefined && doc.idCase == \" + idCase, \"&&\");\n    }\n    if (radNumber != undefined) {\n      caseIdFilterStatement = appendStatement(caseIdFilterStatement, \"doc.radNumber != undefined \" +\n      \"&& doc.radNumber.toString().trim() == \\\"\" + (\"\" + radNumber).trim() + \"\\\"\", \"||\");\n    }\n    if (caseIdFilterStatement.trim().length > 0) {\n      filterStatement = appendStatement(filterStatement, \"(\" + caseIdFilterStatement + \")\", \"&&\");\n    }\n\n    //Sorting\n    var sortData = params.sortData;\n    if (sortData && sortData.sortFieldName) {\n      //var customColumnsType = idWfClass > 0 ? \"process\" : \"application\";\n      if (smartInboxId != null) {\n        emitStatement = \"doc.\" + (queryAcrossCustomColums ? \"smartInboxColumns['\" + smartInboxId + \"'].\" : \"\") + sortData.sortFieldName;\n      } else\n      {\n        emitStatement = \"doc.\" + (queryAcrossCustomColums ? customColumnsType + \"Columns.\" : \"\") + sortData.sortFieldName;\n      }\n      var orderType = sortData.sortDirection == 'asc' ? 0 : 1;\n      if (orderType == 0) {\n        argumentsObject[\"descending\"] = true;\n      }\n    }\n\n    var queryString = \"if(\" + filterStatement + \"){\" +\n    \"   emit(\" + emitStatement + \");\" +\n    \"}\";\n    var queryFunction = new Function(\"doc\", \"emit\", queryString);\n\n    return {\n      query: queryFunction,\n      args: argumentsObject };\n\n\n    function appendStatement(currentStatement, newStatement, operator) {\n      if (currentStatement.trim().length != 0) {\n        currentStatement += \" \" + operator + \" \";\n      }\n      currentStatement += \" \" + newStatement + \" \";\n      return currentStatement;\n    }\n  },\n\n  getCustomColumnsData: function getCustomColumnsData(params) {\n    var db = this.dbActivities;\n    var offlineType = \"task\";\n\n    if (params.inputtray == \"drafts\" || params.inputtray == \"outbox-new\") {\n      db = this.dbStartData;\n      offlineType = \"start\";\n    }\n\n    var deferred = new $.Deferred();\n    params.idWfClass = params.idWfClass || -1;\n\n    if (params.sortData) {\n      params.queryAcrossCustomColums = true;\n      //TODO Support for applicationCustomColumns\n      params.customColumnsType = params.customColumnsType || \"system\";\n    }\n\n    var generatedQuery = this.generateSortedCasesQuery(params);\n    var queryExecutionPromise = bizagi.util.db.executeQuery(db, generatedQuery.query, generatedQuery.args);\n\n    $.when(queryExecutionPromise).\n    then(function (queryResponse) {\n      var queryRows = queryResponse.rows;\n      deferred.resolve(queryRows.map(function (row) {\n        var item = row.doc;\n        var headers = params.headers || [];\n        var responseItem = {};\n        headers.forEach(function (headerObject) {\n          if (headerObject && headerObject.eval) {\n            try {\n              headerObject.eval = headerObject.eval.replaceAll(headerObject.varSymbol, \"item\");\n              responseItem[headerObject.fieldName] = eval(headerObject.eval);\n            }\n            catch (evalError) {\n              bizagi.util.console.error(\"ERROR in getProcessCustomColumnsData\", headerObject.eval + \" could not be evaluated in \", item);\n            }\n          } else\n          if (headerObject && headerObject.fieldName) {\n            var fieldName = headerObject.fieldName.toLowerCase();\n            var objetKeyForFieldName = Object.keys(item).find(function (key) {\n              return key.toLowerCase() == fieldName;\n            });\n            if (objetKeyForFieldName) {\n              responseItem[headerObject.fieldName] = item[objetKeyForFieldName];\n            }\n          }\n        });\n        //Columns retrieved from server\n        var customColumns = {};\n        switch (params.customColumnsType) {\n          case \"system\":\n            customColumns = item.systemColumns || {};\n            break;\n          case \"process\":\n            customColumns = item.processColumns || {};\n            break;\n          case \"smartinbox\":\n            customColumns = item.smartInboxColumns[params.smartInboxId] || {};\n            break;\n          case \"app\":\n            customColumns = item.applicationColumns || {};\n            break;\n          default:\n            customColumns = {};}\n\n        //Override with server columns\n        $.extend(responseItem, customColumns);\n        //OfflineDefaultValues\n        responseItem.isOfflineForm = true;\n        responseItem.offlineType = offlineType;\n        responseItem.isDraft = offlineType == \"start\" && responseItem.isOpen;\n        return responseItem;\n      }));\n    }).\n    fail(function (queryError) {\n      deferred.reject(queryError);\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Update the custom columns property based in the specified type and values\r\n      * @param {String in format \"caseId-WorkItemId\"} internalTaskId \r\n      * @param {\"app\"||\"process\"} customColumnsType \r\n      * @param {Array with values} customColumnsValues \r\n      */\n  updateTaskWorkItemCustomColumnsByType: function updateTaskWorkItemCustomColumnsByType(internalTaskId, customColumnsType, customColumnsValues, smartInboxId) {\n    var def = new $.Deferred();\n    var self = this;\n\n    var customColumnProperty;\n    switch (customColumnsType) {\n      case \"process\":\n        customColumnProperty = \"processColumns\";\n        break;\n      case \"smartinbox\":\n        customColumnProperty = \"smartInboxColumns\";\n        break;\n      case \"application\":\n        customColumnProperty = \"applicationColumns\";\n        break;\n      default:\n        def.reject(customColumnsType + \"is not a valid type for customColumnsType\");\n        return def.promise();}\n    ;\n\n    $.when(bizagi.util.db.getDocument(self.dbActivities, internalTaskId)).\n    then(function (currentDocument) {\n      if (customColumnsType != \"smartinbox\") {\n        currentDocument[customColumnProperty] = customColumnsValues;\n      } else {\n        if (bizagi.util.isEmpty(currentDocument[customColumnProperty])) currentDocument[customColumnProperty] = {};\n        currentDocument[customColumnProperty][smartInboxId] = customColumnsValues;\n      }\n      return bizagi.util.db.saveDocument(self.dbActivities, currentDocument);\n    }).\n    then(function () {\n      def.resolve(true);\n    }).\n    fail(function (err) {\n      def.resolve(false);\n    });\n    return def.promise();\n  },\n\n\n  /**\r\n      * Clean all tasks\r\n      * @returns {} promise \r\n      */\n  cleanOfflineTasks: function cleanOfflineTasks() {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbActivities.get(STOREOBJECTNAME, function (err, doc) {\n      if (!err) {\n        self.dbStartData.remove(doc, function (error, response) {\n          if (!error) {\n            def.resolve(response);\n          } else {\n            bizagi.log(\"Error erasing tasks\");\n            def.reject(err);\n          }\n        });\n\n      } else {\n        bizagi.log(\"Error, no offline tasks\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n  /**\r\n      * Get all offline tasks\r\n      * @returns {} promise \r\n      */\n  getOfflineCases: function getOfflineCases(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (params.sortData) {\n      params.queryAcrossCustomColums = true;\n      params.customColumnsType = \"system\";\n    }\n\n    var generatedQuery = self.generateSortedCasesQuery(params);\n    var queryExecutionPromise = bizagi.util.db.executeQuery(self.dbActivities, generatedQuery.query, generatedQuery.args);\n    $.when(queryExecutionPromise).\n    then(function (queryResponse) {\n      var cases = {\n        \"page\": 1,\n        \"totalPages\": 1,\n        \"elements\": [] };\n\n      var queryRows = queryResponse.rows;\n      var totalRows = queryRows != undefined ? queryRows.length : 0;\n      if (totalRows > 0) {\n        queryRows.forEach(function (row) {\n          var localCase = [\n          row.doc.idCase,\n          row.doc.workItems[0][\"idWorkItem\"] || \"\",\n          row.doc.workItems[0][\"idTask\"] || \"\",\n          row.doc.creationDate,\n          row.doc.process,\n          row.doc.workItems[0][\"TaskName\"],\n          [\n          [\"Case No\", row.doc.idCase],\n          [\"Process\", row.doc.process],\n          [\"Process creation date\", bizagi.util.formatDateTime(row.doc.creationDate)]],\n\n          row.doc.isOfflineForm,\n          row.doc.isOpen,\n          row.doc.isFavorite,\n          row.doc.idWfClass,\n          row.doc.atRiskTime,\n          row.doc.creationDate];\n\n          localCase.isEdited = row.doc.isEdited;\n          localCase.offlineType = 'task';\n          localCase.endDate = row.doc.endDate;\n          localCase.group = row.doc.group;\n          localCase.icon = row.doc.icon;\n          localCase.shortEndDate = row.doc.shortEndDate;\n          localCase.state = row.doc.state;\n          localCase.taskState = row.doc.taskState;\n          localCase.type = row.doc.type;\n          localCase.wfClassDisplayName = row.doc.wfClassDisplayName;\n          localCase.syncStatus = row.doc.syncStatus;\n          localCase.radNumber = row.doc.radNumber;\n          if (row.doc.systemColumns) {\n            localCase.systemColumns = row.doc.systemColumns;\n          }\n          if (row.doc.processColumns) {\n            localCase.processColumns = row.doc.processColumns;\n          }\n          if (!bizagi.util.isEmpty(row.doc.syncStatus)) {\n            localCase.hasSyncError = true;\n            localCase.syncError = row.doc.syncDetails;\n          }\n\n          cases.elements.push(localCase);\n        });\n      }\n      def.resolve(cases);\n    }).\n    fail(function (err) {\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * Returns a map with the local activities in the db\r\n      */\n  getLocalActivities: function getLocalActivities() {\n    var def = new $.Deferred();\n    var self = this;\n    self.dbActivities.allDocs({ include_docs: true }, function (err, resp) {\n      if (err) {\n        def.reject();\n      } else\n      {\n        var len = resp.total_rows;\n        var activities = {};\n        for (var i = 0; i < len; i++) {\n          var currentRow = resp.rows[i].doc;\n          activities[currentRow._id] = currentRow;\n        }\n        def.resolve(activities);\n      }\n    });\n    return def.promise();\n  },\n\n  updateCaseSyncStatus: function updateCaseSyncStatus(params) {\n\n    var self = this;\n    var docId = params.id;\n    if (params.type === \"start\") {\n      return updateSyncAttribute(self.dbStartData, docId);\n    } else\n    {\n      return updateSyncAttribute(self.dbActivityData, docId).\n      then(function () {\n        return updateSyncAttribute(self.dbActivities, docId);\n      });\n    }\n\n    function updateSyncAttribute(db, docId) {\n      return $.when(bizagi.util.db.getDocument(db, docId)).\n      then(function (doc) {\n        doc.syncStatus = params.syncStatus;\n        doc.syncDetails = params.syncDetails;\n        return $.when(bizagi.util.db.saveDocument(db, doc));\n\n      }).\n      then(function (saveResp) {\n        return saveResp;\n      });\n\n    }\n  },\n\n  validateLocalDataForTaskExists: function validateLocalDataForTaskExists(offlineTaskId) {\n    var deferred = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(this.dbActivityData, offlineTaskId)).\n    then(function (localActivityData) {\n      deferred.resolve(localActivityData.data != undefined);\n    }).\n    fail(function (getLocalActivityError) {\n      deferred.resolve(false);\n    });\n    return deferred.promise();\n  },\n\n  openOfflineTask: function openOfflineTask(offlineTaskId) {\n    var isOpenOverride = {\n      isOpen: true,\n      isEdited: true };\n\n    return this.saveOrUpdateTask(offlineTaskId, isOpenOverride);\n  },\n\n  closeOfflineTask: function closeOfflineTask(params) {\n    var offlineTaskId = params.idCase + '-' + params.idWorkitem;\n    var isOpenOverride = {\n      isOpen: false,\n      isEdited: true };\n\n    return this.saveOrUpdateTask(offlineTaskId, isOpenOverride);\n  },\n\n  updateTaskDatachangeset: function updateTaskDatachangeset(documentId, dataChangeset) {\n    var dataChangesetOverride = {\n      dataChangeset: dataChangeset };\n\n    return this.saveOrUpdateTask(documentId, dataChangesetOverride);\n  },\n\n  updateTaskIsEdited: function updateTaskIsEdited(documentId, isEdited) {\n    var isEditedOverride = {\n      isEdited: isEdited };\n\n    return this.saveOrUpdateTask(documentId, isEditedOverride);\n  },\n\n  saveAvailableSmartInboxes: function saveAvailableSmartInboxes(data) {\n    var self = this;\n\n    var docHierarchy = {\n      _id: self.globalId + \"-smartinboxes\",\n      doc: data };\n\n\n    return bizagi.util.db.saveDocument(self.dbProcessesHierarchy, docHierarchy).\n    fail(function (err) {\n      return $.Deferred.fail(\"Could not save available smartinboxes:\" + err).promise();\n    });\n  },\n\n  saveAvailableOfflineSmartInboxes: function saveAvailableOfflineSmartInboxes(data) {\n    var self = this;\n\n    var docHierarchy = {\n      _id: self.globalId + \"-smartinboxes-offline\",\n      doc: data };\n\n\n    return bizagi.util.db.saveDocument(self.dbProcessesHierarchy, docHierarchy).\n    fail(function (err) {\n      return $.Deferred.fail(\"Could not save available offline smartinboxes:\" + err).promise();\n    });\n  },\n\n  markSmartInboxAsAvailableOffline: function markSmartInboxAsAvailableOffline(id) {\n    var self = this;\n\n    self.getAvailableOfflineSmartInboxes().\n    then(function (data) {\n      if (data.indexOf(id) == -1) {\n        data.push(id);\n        self.saveAvailableOfflineSmartInboxes(data);\n      }\n    });\n  },\n\n  getAvailableSmartInboxes: function getAvailableSmartInboxes() {\n    var self = this;\n    var id = self.globalId + \"-smartinboxes\";\n\n    return bizagi.util.db.getDocument(self.dbProcessesHierarchy, id).\n    then(function (res) {return res.doc;},\n    function () {return $.Deferred().resolve([]).promise();});\n  },\n\n  getAvailableOfflineSmartInboxes: function getAvailableOfflineSmartInboxes() {\n    var self = this;\n    var id = self.globalId + \"-smartinboxes-offline\";\n\n    return bizagi.util.db.getDocument(self.dbProcessesHierarchy, id).\n    then(function (res) {return res.doc;},\n    function () {return $.Deferred().resolve([]).promise();});\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: oscaro\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler oll db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\nbizagi.workportal.services.db.extend(\"bizagi.workportal.services.db\", {}, {\n\n  /**\r\n                                                                             * This method return the form for a new case to offline status\r\n                                                                             * @param {} idWFClass\r\n                                                                             * @returns {} Returns a promise\r\n                                                                             */\n  getFormData: function getFormData(idWFClass) {\n    var self = this;\n    var def = new $.Deferred();\n\n    setTimeout(\n    function () {\n      self.dbStartForms.get(idWFClass, function (err, doc) {\n        if (!err) {\n          if (typeof doc.form !== \"undefined\") {\n            def.resolve({ form: doc.form, type: \"form\" });\n          } else {\n            var responseText = {\n              errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n              message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n            def.reject(JSON.stringify(responseText));\n          }\n        } else {\n          def.reject(err);\n        }\n      });\n\n    }, 300);\n    return def.promise();\n  },\n\n  /**\r\n      * This method merge the form and the data to result form\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  mergeForm: function mergeForm(doc, form, options) {\n\n    var self = this;\n    var def = new $.Deferred();\n\n    $.when(form).done(function (form) {\n      if (!doc.data) {\n        def.resolve(form);\n      } else {var\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        fillForm = function fillForm(element, data) {\n          if (Array.isArray(element)) {\n            for (var i = 0, len = element.length; i < len; i++) {\n              fillForm(element[i], data);\n            }\n          } else {\n            if (element.container) {\n              fillForm(element.container.elements, data);\n            } else {\n              // If it case is in outbox or closed, make all renders in the form not editable\n              if (!doc.isOpen) {\n                element.render.properties.editable = false;\n              }\n\n              if (element.render.properties.xpath == data.key) {\n                if (element.render.properties.type === \"grid\") {\n                  self.setRenderGridValues(element.render);\n                }\n                self.setRenderValues(element.render.properties, data.value, options);\n              }\n\n            }\n          }\n        }; // If it case is in outbox or closed, hide buttons in the form\n        if (!doc.isOpen) {form.form.buttons = [];if (Object.keys(doc.data).length === 0) {fillForm(form.form.elements, { key: \"read-only-form\", value: \"\" });}}options.formProperties = form.form.properties;for (prop in doc.data) {fillForm(form.form.elements, { key: prop, value: doc.data[prop] });}\n        def.resolve(form);\n      }\n    }).fail(function (cause) {\n      if (!cause.responseText)\n      var responseText = {\n        errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n        message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n      cause.responseText = JSON.stringify(responseText);\n\n      def.reject(cause);\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Set render Grid values\r\n      * @param {} render\r\n      * @returns {}\r\n      */\n  setRenderGridValues: function setRenderGridValues(render) {\n    render.properties.data.columns = [];\n    for (var i = 0, length = render.elements.length; i < length; i++) {\n      render.properties.data.columns.push(render.elements[i].render.properties.xpath);\n    }\n  },\n\n  /**\r\n      * This function sets the type of each xpath\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  setDataType: function setDataType(doc, form) {\n\n  },\n\n  /**\r\n      *  This method return the categories like the services if exists in the database\r\n      * @param {} params\r\n      * @param {} data\r\n      * @returns {} Returns a promise\r\n      */\n  setRenderValues: function setRenderValues(params, data, options) {\n    var type = params.type;\n\n    if (!type) type = \"label\";\n\n    var typeGroupBasic = [\"text\", \"label\", \"number\", \"money\", \"date\", \"boolean\", \"geolocation\", \"hidden\", \"upload\"];\n    var typeGroupCombo = [\"combo\", \"cascadingCombo\", \"radio\", \"list\"];\n\n    if (typeGroupBasic.indexOf(type) !== -1) {\n      params.value = data.value;\n      return;\n    }\n\n    if (typeGroupCombo.indexOf(type) !== -1) {\n      for (var i = 0, len = params.data.length; i < len; i++) {\n        if (params.data[i].id == data.value) {\n          params.value = [{ id: data.value, value: params.data[i].value }];\n        }\n      }\n\n      return;\n    }\n\n    if (type === \"search\") {\n      for (var j = 0, lengthData = params.data.length; j < lengthData; j++) {\n        if (params.data[j].id == data.value.id) {\n          params.value = data.value;\n        }\n      }\n      return;\n    }\n\n    if ([\"image\", \"signature\"].includes(type)) {\n      params.value = [[0, data.value.name]];\n      params.binaryValue = data.value;\n      return;\n    }\n\n    if (type === \"grid\") {\n      //New complex object for grids\n      params[\"offline-files\"] = data.value[\"offline-files\"] ? data.value[\"offline-files\"] : {};\n      params[\"deleted-records\"] = data.value[\"deleted-records\"] ? data.value[\"deleted-records\"] : {};\n      params[\"edited-images\"] = data.value[\"edited-images\"] ? data.value[\"edited-images\"] : {};\n\n\n      var isTaskForm = options.formProperties ? options.formProperties.isTaskForm : undefined;\n      var hasSyncErrors = options.hasSyncError === true;\n      if (isTaskForm === true && options.online === true && !hasSyncErrors) {\n        // This means that a sync was performed, therefore we must trust the server\n        return;\n      }\n      var storedDataRows = data.value.rows || [];\n\n      params.data.records = storedDataRows.length;\n      params.data.total = 1;\n      params.data.page = 1;\n\n      var lengthColumns = params.data.columns.length;\n      var tmpEditAndVisible = [];\n      var lengthRows = storedDataRows.length;\n      params.data.rows = [];\n      for (var row = 0; row < lengthRows; row++) {\n        // Add random value\n        var details = storedDataRows[row][storedDataRows[row].length - 1] && storedDataRows[row][storedDataRows[row].length - 1].idRow ? storedDataRows[row][storedDataRows[row].length - 1] : undefined;\n        var idRow = details ? details.idRow : bizagi.util.randomNumber();\n\n        var tmpElement = [];\n        var tempRow = [];\n        tmpElement[0] = idRow;\n\n        for (var col = 0; col < lengthColumns; col++) {\n          var index = -1;\n          if (storedDataRows[row][col]) {\n            if (storedDataRows[row][col].xpath) {\n              index = params.data.columns.indexOf(storedDataRows[row][col].xpath);\n              tempRow[index] = storedDataRows[row][col];\n            } else\n            if (!storedDataRows[row][col].changes) {\n              tempRow[col] = storedDataRows[row][col];\n            }\n          }\n          tempRow[col] = tempRow[col] != undefined ? tempRow[col] : null;\n          tmpElement[tmpElement.length] = \"true\";\n        }\n        var mergedRow = $.merge([idRow], tempRow);\n        params.data.rows.push(mergedRow);\n        tmpEditAndVisible[tmpEditAndVisible.length] = tmpElement;\n      }\n\n      params.data.editable = tmpEditAndVisible;\n      params.data.visible = tmpEditAndVisible;\n      return;\n    }\n\n    // No type supported\n    try {\n      params.value = data.value;\n    } catch (e) {\n    }\n\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  },\n\n  /**\r\n      * This method simulate a summary response\r\n      * @param {} params\r\n      * @returns {} Returns a promise\r\n      */\n  getSummary: function getSummary(params) {\n    var self = this;\n    var def = new $.Deferred();\n    if (params.offlineType && params.offlineType === \"task\") {\n      var activityCaseId = params.idCase + \"-\" + params.idWorkitem;\n      self.dbActivities.get(activityCaseId, function (err, doc) {\n        if (!err)\n        def.resolve($.extend(doc, {\n          processPath: \"/\",\n          currentState: doc.workItems,\n          countAssigness: 0,\n          countEvents: 0,\n          isOpen: doc.isOpen.toString(),\n          countSubProcesses: 0 }));else\n\n\n        def.reject(err);\n      });\n    } else\n    {\n      self.dbStartData.get(params.idCase, function (err, doc) {\n        if (!err)\n        def.resolve($.extend(doc, {\n          processPath: \"/\",\n          currentState: doc.workItems,\n          countAssigness: 0,\n          countEvents: 0,\n          isOpen: doc.isOpen.toString(),\n          countSubProcesses: 0 }));else\n\n\n        def.reject(err);\n      });\n    }\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save the image as an attachment to the form.\r\n      * This function only is called for store locally images in tasks \r\n      * that already exists in the server. For save new images use the saveActivityDataImage function.\r\n      * @param {*} params \r\n      * @param {*} image The blob corresponding to the image\r\n      */\n  saveActivityFormImage: function saveActivityFormImage(params, image) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var mimeType = \"image/png\";\n    return bizagi.util.db.saveAttachment(self.dbActivityForms, documentId, attachmentId, mimeType, image, true);\n  },\n\n  /**\r\n      * Save the image as an attachment to the Activity Data.\r\n      * This function only is called for store images uploaded in offline mode. \r\n      * @param {*} params \r\n      * @param {*} image The blob corresponding to the image\r\n      */\n  saveActivityDataImage: function saveActivityDataImage(params, image, type) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var mimeType = type || \"image/png\";\n    return bizagi.util.db.saveAttachment(self.dbActivityData, documentId,\n    attachmentId, mimeType, image, true);\n  },\n\n  getActivityDataImage: function getActivityDataImage(params, fileType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, \"image/png\");\n  },\n\n  getActivityImage: function getActivityImage(params, fileType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var mimeType = \"image/png\";\n\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, mimeType).\n    then(function (dataResult) {\n      if (dataResult !== undefined && dataResult != null) {\n        return dataResult;\n      }\n      return bizagi.util.db.getAttachment(self.dbActivityForms, documentId, attachmentId, fileType, mimeType);\n    });\n  },\n\n  /**\r\n      * Save the image as an attachment to the Start Form Data.\r\n      * This function only is called for store images uploaded in offline mode. \r\n      * @param {*} params \r\n      * @param {*} image The blob corresponding to the image\r\n      */\n  saveStartDataImage: function saveStartDataImage(params, image) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    var mimeType = \"image/png\";\n    return bizagi.util.db.saveAttachment(self.dbStartData, documentId, attachmentId, mimeType, image, true);\n  },\n\n  getStartDataImage: function getStartDataImage(params, fileType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    return bizagi.util.db.getAttachment(self.dbStartData, documentId, attachmentId, fileType, \"image/png\");\n  },\n\n  saveActivityFormFile: function saveActivityFormFile(params, file, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.saveAttachment(self.dbActivityForms, documentId, attachmentId, mimeType, file, true);\n  },\n\n  saveActivityDataFile: function saveActivityDataFile(params, file, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.saveAttachment(self.dbActivityData, documentId, attachmentId, mimeType, file, true);\n  },\n\n  getActivityDataFile: function getActivityDataFile(params, fileType, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, mimeType);\n  },\n\n  getActivityFile: function getActivityFile(params, fileType, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, mimeType).\n    then(function (dataResult) {\n      if (dataResult !== undefined && dataResult != null) {\n        return dataResult;\n      }\n      return bizagi.util.db.getAttachment(self.dbActivityForms, documentId, attachmentId, fileType, mimeType);\n    });\n  },\n\n  /**\r\n      * Save the file as an attachment to the Start Form Data.\r\n      * This function only is called for store files uploaded in offline mode. \r\n      * @param {*} params \r\n      * @param {*} file The blob corresponding to the file\r\n      */\n  saveStartDataFile: function saveStartDataFile(params, file, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    return bizagi.util.db.saveAttachment(self.dbStartData, documentId,\n    attachmentId, mimeType, file, true);\n  },\n\n  getStartDataFile: function getStartDataFile(params, fileType, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    return bizagi.util.db.getAttachment(self.dbStartData, documentId, attachmentId, fileType, mimeType);\n  },\n\n  /**\r\n      * Prepare data for upload control\r\n      */\n  convertUploadOnlineValueInOfflineValue: function convertUploadOnlineValueInOfflineValue(uploadControlValue) {\n    var offlineValue = [];\n    if (uploadControlValue && Array.isArray(uploadControlValue)) {\n      uploadControlValue.forEach(function (singleFileValue) {\n        var fileName = singleFileValue[1];\n        var fileExtension = bizagi.util.media.getFileExtension(fileName).toLowerCase();\n        offlineValue.push(\n        {\n          id: singleFileValue[0],\n          fileName: fileName,\n          mimeType: bizagi.util.media.getMIMETypeByExtension(fileExtension),\n          status: \"existent\" });\n\n\n      });\n    }\n    return offlineValue;\n  },\n\n\n  /**\r\n      * Save the form with all xpaths resolved\r\n      * @param {R} params, workitem id, case id\r\n      * @param {*} data: form data\r\n      */\n  saveTaskForm: function saveTaskForm(params, formData) {\n    var db = this.dbActivityForms;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var dataChangeset = formData && formData.form && formData.form.DataChangesetVersion != undefined ?\n    formData.form.DataChangesetVersion : params.dataChangeset;\n    formData._id = documentId;\n    var deferred = new $.Deferred();\n    var updatePromise = undefined;\n    if (dataChangeset != undefined) {\n      params.dataChangeset = dataChangeset;\n      formData.dataChangeset = dataChangeset;\n      updatePromise = this.updateTaskDatachangeset(documentId, dataChangeset);\n    }\n    $.when(updatePromise).always(function () {\n      $.when(bizagi.util.db.saveDocument(db, formData)).\n      then(function (resultSave) {\n        deferred.resolve(resultSave);\n      }).fail(function (errorSave) {\n        deferred.reject(errorSave);\n      });\n    });\n    return deferred.promise();\n  },\n\n  getTaskForm: function getTaskForm(params) {\n    var db = this.dbActivityForms;\n    var docId = params.idCase + '-' + params.idWorkitem;\n    var def = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(db, docId)).\n    then(function (data) {\n      if (data && data.form) {\n        def.resolve(data);\n      } else\n      {\n        var responseText = {\n          errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n          message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n        def.reject({ responseText: JSON.stringify(responseText) });\n      }\n    }).\n    fail(function (err) {\n      var responseText = {\n        errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n        message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n      def.reject({ responseText: JSON.stringify(responseText) });\n    });\n\n    return def.promise();\n  },\n\n  deleteTaskForm: function deleteTaskForm(params) {\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var db = this.dbActivityForms;\n    return bizagi.util.db.deleteDocument(db, documentId);\n  },\n\n  updateTaskForm: function updateTaskForm(params, formData) {\n    this.saveTaskForm(params, formData);\n  },\n\n  getFileAttachmentsFromLocalTaskForm: function getFileAttachmentsFromLocalTaskForm(params) {\n    var def = new $.Deferred();\n    this.getTaskForm(params).\n    then(function (localForm) {\n      def.resolve(localForm._attachments || {});\n    }, function () {\n      def.resolve({});\n    });\n    return def.promise();\n  },\n\n\n  getStartForm: function getStartForm(params) {\n    var db = this.dbStartForms;\n    var docId = params.idProcess.toString();\n    return bizagi.util.db.getDocument(db, docId);\n  },\n\n  saveStartForm: function saveStartForm(params, form) {\n    var db = this.dbStartForms;\n    form._id = params.idProcess;\n    return bizagi.util.db.saveDocument(db, form);\n  },\n\n  mergeTaskAction: function mergeTaskAction(oldAction, newAction) {\n\n    var self = this;\n    var result = self.mergeObject(oldAction, newAction, { depth: 3 });\n    result = self.reduceLocalGridDeletions(result);\n    return result;\n  },\n\n  mergeObject: function mergeObject(a, b, options) {\n    var self = this;\n    if (_typeof(b) !== \"object\" || bizagi.util.isArray(b)) {\n      a = b;\n      return a;\n    }\n    if (b === null || b === undefined) return a;\n\n    Object.keys(b).forEach(function (key) {\n      if (_typeof(b[key]) == \"object\" && !bizagi.util.isArray(b[key])) {\n        a[key] = a[key] || {};\n        if (options.depth === undefined || options.depth <= 0)\n        bizagi.util.extend(a[key], b[key]);else\n\n        self.mergeObject(a[key], b[key], { depth: options.depth - 1 });\n      } else\n\n      a[key] = b[key];\n    });\n    return a;\n  },\n\n  reduceLocalGridDeletions: function reduceLocalGridDeletions(data) {\n    Object.keys(data).forEach(function (key) {\n      var item = data[key] && data[key].value ? data[key].value : data[key];\n      if (item !== undefined && item[\"deleted-records\"] && item[\"new-records\"]) {\n        Object.keys(item[\"new-records\"]).forEach(function (i) {\n          if (item[\"deleted-records\"][i]) {\n            delete item[\"new-records\"][i];\n            delete item[\"deleted-records\"][i];\n          }\n        });\n      }\n    });\n    return data;\n\n  },\n\n  /*\r\n     *   This method save the form data of the created case\r\n     *   Returns a promise\r\n     */\n  saveTaskData: function saveTaskData(params, data) {\n    var self = this;\n    var def = new $.Deferred();\n    var docId = params.idCase + '-' + params.idWorkitem;\n    var db = self.dbActivityData;\n    $.when(bizagi.util.db.getDocument(db, docId)).\n    then(function (document) {\n      // only add new actions\n      if (document.data) {\n\n        var unifiedActions = document.data.h_actions || [];\n        if (params.actions) {\n          Object.keys(params.actions).forEach(function (actionKey) {\n            var currentAction = params.actions[actionKey];\n            if (currentAction != undefined) {\n              if (self.canAddActionInList(currentAction, unifiedActions)) {\n                unifiedActions.push(currentAction);\n              }\n            }\n          });\n        }\n        document.data.h_actions = unifiedActions;\n      } else {\n        data.h_actions = params.actions;\n      }\n\n      var dataUpdated = document.data ?\n      self.mergeTaskAction(document.data, data) :\n      data;\n\n      self.performSaveTaskData(def, dataUpdated, docId, params, db);\n    })\n    //First save => and the actions are saved\n    .fail(function () {\n      data.h_actions = params.actions;\n      self.performSaveTaskData(def, data, docId, params, db);\n    });\n\n    return def.promise();\n  },\n\n  performSaveTaskData: function performSaveTaskData(def, dataToSave, docId, params, db) {\n    var self = this;\n    var doc = {\n      _id: docId,\n      data: dataToSave,\n      idForm: params.idForm };\n\n    $.when(bizagi.util.db.saveDocument(db, doc)).\n    then(function (saveResult) {\n      var markTaskPromise;\n\n      if (params.action === \"next\" || params.action === \"nextWithoutValidations\")\n      {\n        markTaskPromise = self.closeOfflineTask(params);\n      } else\n\n      {\n        markTaskPromise = self.markTaskEdited(params);\n      }\n\n      $.when(markTaskPromise).\n      then(function (markResponse) {\n        def.resolve(markResponse);\n      }).\n      fail(function (markError) {\n        def.reject(markError);\n      });\n    }).\n    fail(function (saveError) {\n      def.reject(saveError);\n    });\n  },\n\n  canAddActionInList: function canAddActionInList(action, actionList) {\n    var result = true;\n\n    // validate if action added before\n    actionList.forEach(function (actionStored) {\n      if (actionStored.h_action && action.h_action) {\n        if (actionStored.h_idRender && action.h_idRender) {\n          if (actionStored.h_action == action.h_action && actionStored.h_idRender == action.h_idRender) {\n            result = false;\n          }\n        } else\n        {\n          if (actionStored.h_action == action.h_action) {\n            result = false;\n          }\n        }\n      }\n    });\n\n    return result;\n  },\n\n  separateComplexControls: function separateComplexControls(params, data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var mergePromise;\n    if (params.offlineType && params.offlineType !== \"task\") {\n      mergePromise = new $.Deferred(),\n      mergePromise.resolve(data);\n    } else\n    {\n      mergePromise = self.mergeDataDocument(data, self.getTaskForm(params));\n    }\n    $.when(mergePromise).\n    done(function (mergeRes) {\n      var images = [];\n      var uploads = [];\n      var grids = [];\n      Object.keys(mergeRes).forEach(function (key) {\n        var value = mergeRes[key];\n        if (value && value.renderId && value.type && [\"image\", \"signature\"].includes(value.type)) {\n          value.xpath = key;\n          images.push(value);\n          delete data[key];\n        } else\n        if (value && value.renderId && value.type && value.type === \"upload\") {\n          value.xpath = key;\n          uploads.push(value);\n          delete data[key];\n        } else\n        if (value && value.renderId && value.type && value.type === \"grid\") {\n          value.xpath = key;\n          grids.push(value);\n          delete data[key];\n        }\n      });\n      def.resolve({\n        data: data,\n        images: images,\n        uploads: uploads,\n        grids: grids });\n    }).\n    fail(function (mergeError) {\n      def.reject(mergeError);\n    });\n\n    return def.promise();\n  },\n\n  markTaskEdited: function markTaskEdited(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var db = self.dbActivities;\n    var docId = params.idCase + '-' + params.idWorkitem;\n\n    $.when(bizagi.util.db.getDocument(db, docId)).\n    then(function (document) {\n      document.isEdited = true;\n      $.when(bizagi.util.db.saveDocument(db, document)).\n      then(function (updateResponse) {\n        def.resolve(updateResponse);\n      }).\n      fail(function (updateErr) {\n        def.reject(updateErr);\n      });\n    }).\n    fail(function (getErr) {\n      def.reject(getErr);\n    });\n\n    return def.promise();\n  },\n\n  getTaskData: function getTaskData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var id = params.idCase + '-' + params.idWorkitem;\n    self.dbActivityData.get(id, function (err, resp) {\n      if (!err)\n      def.resolve(resp);else\n\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n  deleteTaskData: function deleteTaskData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var id = params.idCase + '-' + params.idWorkitem;\n    var deleteAttachments = params.deleteAttachments === true;\n    $.when(bizagi.util.db.getDocument(self.dbActivityData, id)).\n    then(function (currentTaskData) {\n      var deletePromise;\n      if (deleteAttachments) {\n        deletePromise = bizagi.util.db.deleteDocument(self.dbActivityData, id);\n      } else\n      {\n        var emptyTaskData = {\n          _id: id };\n\n        deletePromise = bizagi.util.db.saveDocument(self.dbActivityData, emptyTaskData);\n      }\n      $.when(deletePromise).\n      then(function (deleteResponse) {\n        def.resolve();\n      }).\n      fail(function (deleteError) {\n        def.reject(deleteError);\n      });\n    }).\n    fail(function (getDocError) {\n      //Local document doesn't exist so delete is unnecessary\n      def.resolve();\n    });\n    return def.promise();\n  },\n\n  /*\r\n     *   This method saves the form info in the db\r\n     *   Returns a promise\r\n     */\n  saveStartData: function saveStartData(params, data) {\n    var self = this;\n\n    return $.when(bizagi.util.db.getDocument(self.dbStartData, params.idCase)).\n    then(function (doc) {\n      return self.mergeDataDocument(data, bizagi.util.db.getDocument(self.dbStartForms, doc.idWfClass.toString())).\n      then(function (resp) {\n        doc = self.mergeData(data, doc, resp);\n        if (params.idForm) {\n          doc.idForm = params.idForm;\n        }\n        return bizagi.util.db.saveDocument(self.dbStartData, doc);\n      });\n    });\n  },\n\n  filterXpathsByType: function filterXpathsByType(form, type) {\n    var xpaths = [];\n    var elements = form.form.elements;\n    extractRenderElements(elements, xpaths);\n\n    function extractRenderElements(elements, xpaths) {\n      if (elements) {\n        for (var i = 0; i < elements.length; i++) {\n          var isContainer = elements[i].container;\n          if (isContainer) {\n            extractRenderElements(elements[i].container.elements, xpaths);\n          } else\n          {\n            extractXpathFromRenderProperties(elements[i].render.properties, xpaths);\n          }\n        }\n      }\n    }\n\n    function extractXpathFromRenderProperties(renderProperties, xpaths) {\n      if (renderProperties.xpath && renderProperties.type === type) {\n        xpaths.push({\n          xpath: renderProperties.xpath,\n          renderId: renderProperties.id,\n          value: renderProperties.value });\n\n      }\n    }\n\n    return xpaths;\n\n  },\n\n  filterXpathsByTypeMap: function filterXpathsByTypeMap(form, typeMap) {\n    var self = this;\n    var xpaths = [];\n    var elements = form.form.elements;\n    extractRenderElements(elements, xpaths);\n\n    function extractRenderElements(elements, xpaths) {\n      if (elements) {\n        for (var i = 0; i < elements.length; i++) {\n          var isContainer = elements[i].container;\n          if (isContainer) {\n            extractRenderElements(elements[i].container.elements, xpaths);\n          } else\n          {\n            var renderProperties = elements[i].render.properties;\n            if (renderProperties.type === \"grid\") {\n              if (renderProperties.data && renderProperties.data.records > 0) {\n                var filteredColumns = [];\n                //filterCols\n                for (var k = 0; k < elements[i].render.elements.length; k++) {\n                  var renderColumn = elements[i].render.elements[k];\n                  renderColumn.position = k + 1;\n                  if (typeMap[renderColumn.render.properties.type]) {\n                    filteredColumns.push(renderColumn);\n                  }\n                }\n                if (filteredColumns.length > 0) {\n                  var rows = renderProperties.data.rows;\n                  for (var j = 0; j < rows.length; j++) {\n                    var currentRow = rows[j];\n                    filteredColumns.forEach(function (column) {\n                      xpaths.push({\n                        xpath: column.render.properties.xpath,\n                        renderId: column.render.properties.id,\n                        value: currentRow[column.position],\n                        xpathContext: renderProperties.xpath + self.buildCellXpathFilter(currentRow[0]),\n                        gridXpath: renderProperties.xpath,\n                        columnXpath: column.render.properties.xpath,\n                        idRow: currentRow[0],\n                        type: column.render.properties.type });\n\n                    });\n                  }\n                }\n              }\n            } else {\n              extractXpathFromRenderProperties(renderProperties, xpaths);\n            }\n          }\n        }\n      }\n    }\n\n    function extractXpathFromRenderProperties(renderProperties, xpaths) {\n      if (renderProperties.xpath && typeMap[renderProperties.type]) {\n        xpaths.push({\n          xpath: renderProperties.xpath,\n          renderId: renderProperties.id,\n          value: renderProperties.value,\n          type: renderProperties.type });\n\n      }\n    }\n\n    return xpaths;\n\n  },\n\n  buildCellXpathFilter: function buildCellXpathFilter(key) {\n    if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\n    return \"[id='\" + key + \"']\";\n  },\n\n  mergeDataDocument: function mergeDataDocument(data, form) {\n    var defer = new $.Deferred();\n    var response = {};\n\n    $.when(form).done(function (resp) {\n\n      for (prop in data) {\n        if (prop != \"h_action\" && prop != \"h_actions\") {\n          response[prop] = {};\n          response[prop].value = data[prop];\n          fillForm(resp.form.elements, {\n            key: prop,\n            value: data[prop] });\n\n        }\n      }\n\n      function fillForm(element, datafill) {\n        if (Array.isArray(element)) {\n          for (var i = 0, len = element.length; i < len; i++) {\n            fillForm(element[i], datafill);\n          }\n        } else {\n          if (element.container) {\n            fillForm(element.container.elements, datafill);\n          } else {\n            if (element.render.properties.xpath == datafill.key) {\n              response[datafill.key].DataType = element.render.properties.dataType || \"\";\n              response[datafill.key].type = element.render.properties.type || \"\";\n              response[datafill.key].renderId = element.render.properties.id;\n            }\n          }\n        }\n      }\n\n      defer.resolve(response);\n    });\n\n    return defer.promise();\n  },\n\n  mergeData: function mergeData(data, doc, resp) {\n    var self = this;\n    if (data.h_action == \"next\" || data.h_action == \"nextWithoutValidations\") {\n      doc.isOpen = false;\n    }\n\n    doc.data = doc.data || {};\n    var dataUpdated = self.mergeTaskAction(doc.data, resp);\n    doc.data = dataUpdated;\n    return doc;\n\n  },\n\n  nativeSaveFormInfo: function nativeSaveFormInfo(data, doc, form) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.mergeDataDocument(data, form).\n    done(function (resp) {\n      doc = self.mergeData(data, doc, resp);\n      def.resolve(doc);\n    });\n\n    return def.promise();\n  },\n\n  deleteNextButton: function deleteNextButton(data) {\n    if (data.form && data.form.buttons) {\n\n      data.form.buttons = data.form.buttons.filter(function (value) {\n        var properties = value.button.properties;\n        if (properties) {\n          return !(properties.caption && properties.caption === \"render-form-button-next\");\n        }\n        return true;\n      });\n    }\n    return data;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author:Bizagi Mobile Team\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n$.Class.extend(\"bizagi.workportal.services.fetchWorker\", {}, {\n  init: function init(params) {\n    var self = this;\n    self.services = params;\n    self.db = params.database;\n    self.maxOfflineCases = 100;\n    self.secondsBeforeAllowFetchAgain = 2;\n    self.tasksSyncDelta = 8;\n    self.startSyncDelta = 8;\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n\n    self.fetchInProgress = false;\n\n  },\n\n  triggerOfflineSyncEvent: function triggerOfflineSyncEvent(params) {\n    if (bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()) {\n      bizagiapp.synchronizeDownloadOfflineState(params);\n    } else {\n      bizagi.webpart.publish(\"offline.sync\", params);\n    }\n  },\n\n  fetch: function fetch(argument) {\n    var self = this;\n\n    var timeBeforeFetch = self.secondsBeforeAllowFetchAgain * 1000;\n    if (self.lastFetch) {\n      if (self.lastFetch + timeBeforeFetch < Date.now() && !self.fetchInProgress) {\n        executeFetch();\n      }\n    } else\n    if (!self.fetchInProgress) {\n      executeFetch();\n    }\n\n    function executeFetch() {\n      self.triggerOfflineSyncEvent({ type: \"download-started\" });\n      self.fetchInProgress = true;\n      self.fetchInProgressPromise = new $.Deferred();\n\n      var getOfflineTasksProm = self.services.callServiceWithNetworkRetries(self.services, self.services.getOfflineTasks, [], 5, 2000);\n      var getOfflineProcessesProm = self.services.callServiceWithNetworkRetries(self.services, self.services.getOfflineProcessesHierarchy, [], 5, 2000);;\n      var formsToDownloadCountPromise = new $.Deferred();\n\n      var downloadStartFormsPromise;\n      var downloadTaskFormsPromise;\n\n      var offlineWorkAvailable = 0;\n\n      $.when(getOfflineProcessesProm, getOfflineTasksProm).\n      then(function (offlineProcessesHierarchy, offlineTasksResponse) {\n\n        var offlineProcessesList = self.getProcessesListFromHierarchy(offlineProcessesHierarchy);\n\n        var serializedOfflineActivities = self.serializeActivities(offlineTasksResponse);\n\n        offlineWorkAvailable = offlineProcessesList.length + Object.keys(serializedOfflineActivities).length;\n\n        $.when(self.getTasksToDownload(serializedOfflineActivities), self.getStartFormsToDownload(offlineProcessesList)).\n        then(function (tasksToDownloadResponse, startFormsToDownload) {\n          downloadTaskFormsPromise = self.processTasksToFetchForms(serializedOfflineActivities, tasksToDownloadResponse.items);\n          downloadStartFormsPromise = self.fetchStartForms(offlineProcessesHierarchy, startFormsToDownload);\n          formsToDownloadCountPromise.resolve(startFormsToDownload.length + tasksToDownloadResponse.count);\n        }).\n        fail(function (getTasksToDownloadErr, getStartFormsToDownloadErr) {\n          formsToDownloadCountPromise.reject({ tasks: getTasksToDownloadErr, start: getStartFormsToDownloadErr });\n        });\n      }).\n      fail(function (startFormsSyncNeededError, offlineTasksError) {\n        console.log(\"Forms download fails\", startFormsSyncNeededError, offlineTasksError);\n        formsToDownloadCountPromise.reject();\n      });\n\n      $.when(formsToDownloadCountPromise).\n      then(function (count) {\n        if (count > 0) {\n          self.triggerOfflineSyncEvent({ type: \"update-total-downloads\", argument: count });\n        } else\n        {\n          if (offlineWorkAvailable > 0) {\n            self.triggerOfflineSyncEvent({ type: \"up-to-date\", argument: offlineWorkAvailable });\n          }\n        }\n        return $.when.apply($, [downloadStartFormsPromise, downloadTaskFormsPromise]);\n      }).\n      then(function () {\n        self.lastFetch = Date.now();\n        self.fetchInProgressPromise.resolve(true);\n        self.fetchInProgress = false;\n        self.triggerOfflineSyncEvent({ type: \"download-finished\" });\n        $(document).trigger(\"offline-notify-form-sync-event\", { type: \"download-finished\" });\n      }).\n      fail(function () {\n        //Wait for all downloads ends, because can fail only downloading start forms but not tasks or vice\n        $.when(downloadStartFormsPromise).\n        always(function (startResult) {\n          $.when(downloadTaskFormsPromise).\n          always(function (tasksResult) {\n            self.fetchInProgressPromise.reject(\"Error executing fetch v2\");\n            self.fetchInProgress = false;\n            self.triggerOfflineSyncEvent({ type: \"download-error\" });\n            $(document).trigger(\"offline-notify-form-sync-event\", { type: \"download-error\" });\n          });\n        });\n      });\n\n      $.when(self.services.getRecentOfflineProcesses()).\n      then(function (recentProcceses) {\n        self.saveRecentProcesses(recentProcceses);\n      });\n    }\n\n    return self.fetchInProgressPromise.promise();\n  },\n\n  fetchStartForms: function fetchStartForms(offlineProcessTree, processesList) {\n    var def = new $.Deferred();\n    var self = this;\n    var offlineProcessTree;\n    $.when(self.saveProcessesHierarchy(offlineProcessTree)).\n    then(function () {\n      return self.downloadStartForms(processesList);\n    }).\n    then(function () {\n      def.resolve();\n    }).\n    fail(function (err) {\n      console.log(\"Sv2: Problem downloading any offline start form\", err);\n      def.reject();\n    });\n    return def.promise();\n  },\n\n  getProcessesListFromHierarchy: function getProcessesListFromHierarchy(offlineProcessTree) {\n    var processes = [];\n\n    for (var i = 0; i < offlineProcessTree.length; i++) {\n      var currentApplication = offlineProcessTree[i];\n      var categories = currentApplication.categories;\n      for (var j = 0; j < categories.length; j++) {\n        getProcessesFromCategory(categories[j]);\n      }\n    }\n\n    function getProcessesFromCategory(category) {\n      if (category.isProcess === \"true\" && category.hasOfflineForm) {\n        processes.push(category.idCategory);\n      } else\n      if (category.subCategories) {\n        for (var k = 0; k < category.subCategories.length; k++) {\n          var subCategory = category.subCategories[k];\n          getProcessesFromCategory(subCategory);\n        }\n      }\n    }\n    return processes;\n  },\n\n  getStartFormsToDownload: function getStartFormsToDownload(processes) {\n    var self = this;\n    var def = new $.Deferred();\n    var checksQueue = new bizagiQueue();\n    var processesToDownload = [];\n    processes.forEach(function (idProcess) {\n      var checkProm = self.checkIfStartFormNeedsSync(idProcess);\n      $.when(checkProm).\n      then(function (isSyncNeeded) {\n        if (isSyncNeeded) {\n          processesToDownload.push(idProcess);\n        }\n      });\n      checksQueue.add(checkProm);\n    });\n\n    $.when(checksQueue.execute()).\n    always(function () {\n      def.resolve(processesToDownload);\n    });\n    return def.promise();\n  },\n\n  checkIfStartFormNeedsSync: function checkIfStartFormNeedsSync(idProcess) {\n    var def = new $.Deferred();\n    var self = this;\n    $.when(self.services.database.getStartForm({ idProcess: idProcess })).\n    then(function (localForm) {\n      var isHardRefreshNeeded = false;\n      var isFirstDayDownload = false;\n\n      var lastSync = localForm.lastSynchronization;\n      if (lastSync != undefined) {\n        var currentTime = Date.now();\n        isHardRefreshNeeded = lastSync + self.startSyncDelta * 60 * 60 * 1000 < currentTime;\n      } else\n      {\n        isHardRefreshNeeded = true;\n      }\n      if (new Date().getDate() != (bizagi.util.getSyncTimeStamp() || new Date()).getDate()) {\n        isFirstDayDownload = true;\n      }\n      def.resolve(isFirstDayDownload || isHardRefreshNeeded);\n    }).\n    fail(function () {\n      def.resolve(true);\n    });\n    return def.promise();\n  },\n\n  downloadStartForms: function downloadStartForms(processes) {\n    var self = this;\n    var def = new $.Deferred();\n    var downloadFormsQueue = new bizagiQueue();\n\n    var formsSuccessCount = 0;\n    var formsFailedCount = 0;\n\n    for (var i = 0; i < processes.length; i++) {\n      var downloadProm = self.services.downloadOfflineStartForm({\n        idProcess: processes[i] });\n\n      $.when(downloadProm).\n      then(function () {\n        self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"success\" });\n        formsSuccessCount++;\n        checkIfDownloadStartFormsEnds();\n      }).\n      fail(function () {\n        self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"error\" });\n        formsFailedCount++;\n        checkIfDownloadStartFormsEnds();\n      });\n      downloadFormsQueue.add(downloadProm);\n    }\n    $.when(downloadFormsQueue.execute()).\n    always(function () {\n      checkIfDownloadStartFormsEnds();\n    });\n\n    function checkIfDownloadStartFormsEnds() {\n      if (formsFailedCount + formsSuccessCount == processes.length) {\n        if (formsFailedCount > 0) {\n          def.reject();\n        } else\n        {\n          def.resolve();\n        }\n      }\n    }\n\n    return def.promise();\n  },\n\n  serializeActivities: function serializeActivities(offlineTasksResponse) {\n    var self = this;\n    var elementsMap = {};\n\n    var row,i = -1;\n    var actualDate = new Date();\n    var statusFunction = offlineTasksResponse.advanceSearch ? self.services.defineActivityStateByTaskState : self.services.defineActivityStateByDate;\n\n    while (row = offlineTasksResponse.rows[++i]) {\n      var tempElementOriginalValues = {},el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\", \"\", \"\"];\n      var systemColumns = {};\n      var field,j = -1;\n      while (field = offlineTasksResponse.headers[++j]) {\n        tempElementOriginalValues[field.fieldName.toLowerCase()] = {\n          \"displayName\": field.displayName.trim(),\n          \"value\": row[j] };\n\n        if (self.services.isInboxHeaderASystemColumn(field.fieldName)) {\n          systemColumns[field.fieldName] = row[j];\n        }\n        self.services.serializeActivity(el, field.fieldName.toLowerCase(), tempElementOriginalValues[field.fieldName.toLowerCase()]);\n      }\n\n      var tmpElement = el;\n      var status = {};\n\n      status = statusFunction(tmpElement[3], tmpElement.taskstate);\n\n      // Time to atRiskTimeDelta\n      if (tmpElement.length >= 10 && parseInt(tmpElement[11], 10) > 0) {\n        var tmpEndDate = new Date(tmpElement[3]);\n\n        if (actualDate.getTime() > tmpEndDate.getTime()) {\n          status.state = \"red\";\n        } else {\n          if (actualDate.getTime() > tmpEndDate.getTime() - parseInt(tmpElement[11], 10) * 60000) {\n            status.state = \"yellow\";\n          } else {\n            status.state = \"green\";\n          }\n        }\n      }\n\n      //Tasks are offline\n      // When the activity has the property isOffline it should be mapped\n      tmpElement[7] = !bizagi.util.isEmpty(tempElementOriginalValues.isoffline) ? tempElementOriginalValues.isoffline.value : true;\n      tmpElement = $.extend({}, tmpElement, status, {\n        \"endDate\": tmpElement[3],\n        \"idworkitem\": tmpElement[1],\n        \"idwfclass\": !bizagi.util.validateFeatureSupport(\"advancedSearch\") ? tmpElement[7] : tmpElement[10],\n        \"systemColumns\": systemColumns });\n\n\n      var idCase = tmpElement[0];\n      var idWorkitem = tmpElement[1];\n      var internalId = idCase + \"-\" + idWorkitem;\n\n      //Only the offline activities should be included in the response\n      if (tmpElement[7] === true) {\n        elementsMap[internalId] = tmpElement;\n      }\n    }\n\n    return elementsMap;\n  },\n\n  getTasksToDownload: function getTasksToDownload(serverActivities) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.services.database.getLocalActivities()).\n    then(function (localCases) {\n      var itemsToDownload = {};\n      var itemsCount = 0;\n\n      Object.keys(serverActivities).forEach(function (servTaskId) {\n        var servTask = serverActivities[servTaskId];\n        var matchingLocalTask = localCases[servTaskId];\n        if (self.taskFormNeedsRefresh(servTask, matchingLocalTask)) {\n          itemsToDownload[servTaskId] = {\n            idCase: servTask[0],\n            idWorkitem: servTask[1],\n            syncDelda: self.tasksSyncDelta,\n            dataChangeset: servTask.dataChangeset };\n\n          itemsCount++;\n        }\n      });\n      def.resolve({\n        items: itemsToDownload,\n        count: itemsCount });\n\n      if (itemsCount > 0) {\n        var formNotificationParams = {\n          type: \"fetch-tasks-started\",\n          tasks: itemsToDownload };\n\n        $(document).trigger(\"offline-notify-form-sync-event\", formNotificationParams);\n      }\n    }).\n    fail(function () {\n      def.reject();\n    });\n    return def.promise();\n  },\n\n  taskFormNeedsRefresh: function taskFormNeedsRefresh(serverTask, localTask) {\n    var timeBeforeNextHardRefresh = 1000 * 60 * 60 * this.tasksSyncDelta;\n    var updateIsRequired = false;\n    var hardRefreshIsRequired = false;\n    var isFirstDayDownload = false;\n    if (localTask == undefined || localTask.dataChangeset == undefined || serverTask.dataChangeset !== localTask.dataChangeset) {\n      updateIsRequired = true;\n    } else\n    if (localTask.lastFullSync == undefined || localTask.lastFullSync + timeBeforeNextHardRefresh < Date.now()) {\n      hardRefreshIsRequired = true;\n    }\n    if (new Date().getDate() != (bizagi.util.getSyncTimeStamp() || new Date()).getDate()) {\n      isFirstDayDownload = true;\n    }\n    return updateIsRequired || hardRefreshIsRequired || isFirstDayDownload;\n  },\n\n  processTasksToFetchForms: function processTasksToFetchForms(serverTasks, tasksToDownload) {\n    var self = this;\n    var def = new $.Deferred();\n    var queueReadyToProcess = new $.Deferred();\n    var processOfflineFormsQueue = new bizagiQueue();\n\n    var tasksSuccessfulCount = 0;\n    var tasksFailedCount = 0;\n    var tasksToDownloadCount = 0;\n\n    //Si el task fue trabajado y tiene error de sincronizacin no se actualiza.\n    $.when(self.db.getOutboxTaskCasesFilteredBySyncStatus(\"any\", false)).\n    then(function (result) {\n      for (var i = 0; i < result.length; i++) {\n        delete tasksToDownload[result[i].id];\n        delete serverTasks[result[i].id];\n      }\n      return true;\n    })\n    //Buscar las actividades que estn en el inbox offline\n    .then(function () {\n      var localActivitiesProm = new $.Deferred();\n      self.db.dbActivities.allDocs({ include_docs: false }, function (err, response) {\n        if (err)\n        localActivitiesProm.reject();else\n\n        localActivitiesProm.resolve(response.rows);\n      });\n      return localActivitiesProm.promise();\n    })\n    //Si una actividad ya no est disponible (est local pero no en la lista del server) se debe eliminar la actividad, la forma y el caso\n    .then(function (localActivities) {\n      for (var i = 0; i < localActivities.length; i++) {\n        localActivityInternalId = localActivities[i].id;\n        var isActivityAvailable = serverTasks[localActivityInternalId] ? true : false;\n        if (!isActivityAvailable) {\n          processOfflineFormsQueue.add(self.deleteLocalDataIfActivityWasNotWorked(localActivityInternalId));\n        }\n      }\n      queueReadyToProcess.resolve();\n    }).\n    fail(function (error) {\n      console.log(\"Diff algorithm error\", error);\n      queueReadyToProcess.resolve();\n    });\n\n    $.when(queueReadyToProcess).\n    then(function () {\n      return self.services.database.saveOfflineTasks(serverTasks);\n    }).\n    then(function (saveResponse) {\n      self.services.downloadOfflineCustomizedColumns();\n      Object.keys(tasksToDownload).forEach(function (key) {\n        var internalId = key;\n        var downloadTaskParams = tasksToDownload[internalId];\n        tasksToDownloadCount++;\n        $.extend(downloadTaskParams, { bulkDownload: true });\n        var processFormProm = self.services.downloadOfflineTaskForm(downloadTaskParams);\n        $.when(processFormProm).\n        then(function () {\n          return self.updateActivityDatachangesetAndSyncTimestamp(internalId, downloadTaskParams.dataChangeset);\n        }).\n        then(function () {\n          self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"success\" });\n          tasksSuccessfulCount++;\n          checkIfDownloadTaskFormsEnds();\n        }).\n        fail(function () {\n          self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"error\" });\n          tasksFailedCount++;\n          checkIfDownloadTaskFormsEnds();\n        });\n        processOfflineFormsQueue.add(processFormProm);\n      });\n      return processOfflineFormsQueue.execute();\n    }).\n    then(function () {\n      checkIfDownloadTaskFormsEnds();\n    }).\n    fail(function (err) {\n      if (tasksToDownloadCount == 0) {\n        def.reject(err);\n        console.log(\"Error in tasks download's differential algorithm:\", err);\n      } else\n      {\n        checkIfDownloadTaskFormsEnds();\n      }\n    });\n\n\n    function checkIfDownloadTaskFormsEnds() {\n      if (tasksFailedCount + tasksSuccessfulCount == tasksToDownloadCount) {\n        if (tasksFailedCount > 0) {\n          console.log(\"Download of tasks forms finished with ERRORS\");\n          def.reject();\n        } else\n        {\n          def.resolve();\n        }\n      }\n    }\n\n    return def.promise();\n  },\n\n  deleteLocalDataIfActivityWasNotWorked: function deleteLocalDataIfActivityWasNotWorked(internalId) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.db.validateLocalDataForTaskExists(internalId)).\n    then(function (localDataExists) {\n      if (!localDataExists) {\n        var deleteTaskDataParams = {\n          idCase: internalId.split(\"-\")[0],\n          idWorkitem: internalId.split(\"-\")[1],\n          deleteAttachments: true };\n\n        var deleteFullActivityData = self.db.deleteTaskData(deleteTaskDataParams);\n        var deleteActivity = self.db.deleteTask(deleteTaskDataParams);\n        var deleteActivityForm = self.db.deleteTaskForm(deleteTaskDataParams);\n        $.when(deleteActivity, deleteActivityForm, deleteFullActivityData).\n        then(function () {\n          def.resolve();\n        }).\n        fail(function (deleteActivityError, deleteFormError, deleteFullActivityDataError) {\n          // If those items are already deleted, it doesn't matter\n          if (deleteActivityError && deleteActivityError.status == 404) deleteActivityError = undefined;\n          if (deleteFormError && deleteFormError.status == 404) deleteActivityError = undefined;\n          if (deleteFullActivityDataError && deleteFullActivityDataError.status == 404) deleteActivityError = undefined;\n\n          if (bizagi.util.isEmpty(deleteActivityError) &&\n          bizagi.util.isEmpty(deleteFormError) &&\n          bizagi.util.isEmpty(deleteFullActivityDataError)) {\n\n            def.resolve();\n            return;\n          }\n\n          var error = {\n            type: \"error\",\n            errorType: \"offlineDiffAlgorithmError\",\n            message: \"Problem removing local case and data\",\n            technicalNote: \"Problem in deleteLocalDataIfActivityWasNotWorked\",\n            deleteActivityError: deleteActivityError,\n            deleteFormError: deleteFormError,\n            deleteFullActivityDataError: deleteFullActivityDataError };\n\n          def.reject(error);\n        });\n      } else\n      {\n        def.resolve();\n      }\n    }).\n    fail(function (validateLocalDataError) {\n      def.reject(validateLocalDataError);\n    });\n    return def.promise();\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // Only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n\n    return objects;\n  },\n\n\n  /**\r\n      * Save in the db the user permitions to create cases\r\n      * @param {} hierarchy \r\n      * @returns {} \r\n      */\n  saveProcessesHierarchy: function saveProcessesHierarchy(hierarchy) {\n    var self = this;\n    var db = self.db.dbProcessesHierarchy;\n    var docHierarchy = {\n      _id: self.globalId,\n      doc: hierarchy,\n      lastSynchronization: Date.now() };\n\n    return bizagi.util.db.saveDocument(db, docHierarchy);\n  },\n\n  /**\r\n      * Save in the db the user recent processes to create cases\r\n      * @param {} processes \r\n      * @returns {} \r\n      */\n  saveRecentProcesses: function saveRecentProcesses(processes) {\n    var self = this;\n    var db = self.db.dbRecentProcesses;\n    processes._id = self.globalId;\n    return bizagi.util.db.saveDocument(db, processes);\n  },\n\n\n  /**\r\n      * \r\n      */\n  updateActivityDatachangesetAndSyncTimestamp: function updateActivityDatachangesetAndSyncTimestamp(caseId, dataChangeset) {\n    var self = this;\n    var def = new $.Deferred();\n    var db = self.db.dbActivities;\n    $.when(bizagi.util.db.getDocument(db, caseId)).\n    then(function (activity) {\n      if (activity.dataChangeset == undefined || dataChangeset > activity.dataChangeset) {\n        activity.dataChangeset = dataChangeset;\n      }\n      activity.lastFullSync = Date.now();\n      return bizagi.util.db.saveDocument(db, activity);\n    }).\n    then(function (saveResult) {\n      def.resolve();\n    }).\n    fail(function (error) {\n      def.reject(error);\n    });\n    return def.promise();\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Ricardo Perez\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n//$.Class.extend\n$.Class(\"bizagi.workportal.services.db.old\", {}, {\n  /* \r\n                                                   *   Constructor\r\n                                                   */\n  init: function init() {\n    var self = this;\n\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    if (!self.disabledb) {\n      self.dbProcessRecent = new PouchDB(\"DataProcessesRecent\"); // Recent process\n      self.dbProcessHierarchy = new PouchDB(\"DataProcessesHierarchy\"); // Process hierarchy to new cases creation\n      self.dbForms = new PouchDB(\"DataRenderForms\"); // To save all forms for server\n      self.dbCases = new PouchDB(\"DataRenderCases\"); // Save the data from forms            \n    }\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    BIZAGI_USER.toLowerCase() + \"-\" + BIZAGI_PROXY_PREFIX.toLowerCase() + \"-\" + BIZAGI_DOMAIN.toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  /*\r\n     * Delete all Documents (databases)\r\n     * Example for callback : function (err, info) { }\r\n     * \r\n     */\n  _destroy: function _destroy(callback) {\n    var self = this;\n    if (typeof callback === \"undefined\") {\n      callback = function callback(err, info) {\n      };\n    }\n\n    PouchDB.destroy(\"DataRenderForms\", callback);\n    PouchDB.destroy(\"DataRenderCases\", callback);\n    PouchDB.destroy(\"DataProcessesHierarchy\", callback);\n    PouchDB.destroy(\"DataProcessesRecent\", callback);\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n    return objects;\n  },\n\n  /*\r\n     *   This method return all the open cases for the user authenticated from de DB\r\n     *   Returns a promise\r\n     */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbCases.query({ map: map }, { reduce: false }, function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author:Bizagi Mobile Team\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n$.Class.extend(\"bizagi.workportal.services.fetchWorker.old\", {}, {\n  init: function init(params) {\n    var self = this;\n    self.services = params;\n\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    if (!self.disabledb) {\n      self.dbForms = new PouchDB(\"DataRenderForms\");\n      self.dbCases = new PouchDB(\"DataRenderCases\");\n      self.dbProcessHierarchy = new PouchDB(\"DataProcessesHierarchy\");\n      self.dbProcessRecent = new PouchDB(\"DataProcessesRecent\");\n    }\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    BIZAGI_USER.toLowerCase() + \"-\" + BIZAGI_PROXY_PREFIX.toLowerCase() + \"-\" + BIZAGI_DOMAIN.toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  fetch: function fetch(argument) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (self.disabledb) {\n      def.reject(\"Disable Sync\");\n      return def.promise();\n    }\n\n    $.when(self.services.processesHierarchy()).\n    done(function (dataCategory, dataRecents) {\n      $.when(self.saveProcessesHierarchy(dataCategory),\n      self.processesHierarchyTofetchForms(),\n      self.services.getRecentOfflineProcesses()).\n      done(function (data1, data2, dataRecents) {\n        self.saveRecentProcesses(dataRecents);\n        def.resolve(\"All data fetched\");\n      }).fail(function (data1, data2, data3) {\n        if (data1 === \"nothing\") {\n          def.reject(0);\n        } else {\n          def.reject(\"Error fetching data\");\n        }\n      });\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save in the db the user permitions to create cases\r\n      * @returns {} \r\n      */\n  processesHierarchyTofetchForms: function processesHierarchyTofetchForms() {\n    var self = this;\n    var def = new $.Deferred();\n\n    var changeset = bizagi.util.getItemLocalStorage(\"formChangeset\" + self.globalId);\n    if (changeset === null || typeof changeset === \"undefined\") {\n      changeset = 0;\n    }\n\n    self.callSyncForms({\n      changeSet: changeset }).\n    done(function (data) {\n      console.log(data, \"Sync forms\");\n      def.resolve(data);\n    }).fail(function (error) {\n      if (error === \"nothing\") {\n        console.log(\"Nothing to sync\");\n      } else {\n        console.log(error, \"Error sync forms\");\n      }\n      def.reject(error);\n    });\n\n    return def.promise();\n  },\n\n  callSyncForms: function callSyncForms(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var changeSet = params.changeSet;\n\n    self.services.processesHierarchyTofetchForms(params).\n    done(function (data) {\n      if (data.changeSet > changeSet) {\n        // Add code to validate if form and save\n        var prom = null;\n        if (data.changeSetType === 1) // Form \n          prom = self.saveProcessesHierarchyTofetchForms(data.result);\n        if (data.changeSetType === 4) {// Grant acess\n          prom = self.saveProcessInHierarchy(data.result);\n        }\n\n        $.when(prom).done(function () {\n          self.callSyncForms({\n            changeSet: data.changeSet }).\n          done(function (resp) {\n            def.resolve(resp);\n          }).fail(function (error) {\n            def.reject(error);\n          });\n        }).fail(function (err) {\n          def.reject(err);\n        });\n      } else {\n        // Set the variable changeset in localStorage\n        bizagi.util.setItemLocalStorage(\"formChangeset\" + self.globalId, data.changeSet);\n        changeSet = parseInt(changeSet);\n        if (data.changeSet === 0 && changeSet === 0) {\n          // Nothing to sync                    \n          def.reject(\"nothing\");\n        } else {\n          def.resolve(\"succesfully\");\n        }\n      }\n    }).fail(function (error) {\n      def.reject(error);\n    });\n\n    return def.promise();\n  },\n\n  saveProcessInHierarchy: function saveProcessInHierarchy(data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    def.resolve(\"\");\n\n    return def.promise();\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // Only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n\n    return objects;\n  },\n\n  /**\r\n      * Save in the db the user Forms\r\n      * @param {} result \r\n      * @returns {} \r\n      */\n  saveProcessesHierarchyTofetchForms: function saveProcessesHierarchyTofetchForms(result) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var docHierarchy = {\n      _id: result.wfClass.toString() + \"-\" + result.wfClass.toString() + \"-\" + self.globalId,\n      globalid: self.globalId,\n      idWfClass: result.wfClass,\n      idWorkFlow: result.workFlow,\n      form: result.data.form };\n\n\n    self.dbForms.get(docHierarchy._id, function (err, doc) {\n      // If error, then the doc doesn't exists and it's added\n      if (err) {\n        // If it does not exist then add\n        self.dbForms.put(docHierarchy, function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not add the document\");\n          }\n        });\n      } else {\n        // If no error, then the doc exists and must be replaced if is outdated\n        self.dbForms.put({\n          _rev: doc._rev,\n          _id: doc._id,\n          form: docHierarchy.form },\n        function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not update the document\");\n          }\n        });\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save in the db the user permitions to create cases\r\n      * @param {} hierarchy \r\n      * @returns {} \r\n      */\n  saveProcessesHierarchy: function saveProcessesHierarchy(hierarchy) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var docHierarchy = {\n      _id: self.globalId,\n      doc: hierarchy };\n\n\n    // Try to search de doc\n    self.dbProcessHierarchy.get(docHierarchy._id, function (err, doc) {\n      // If error, then the doc doesn't exists and it's add\n      if (err) {\n        // If it does not exist then add\n        self.dbProcessHierarchy.put(docHierarchy, function callback(err, result) {\n          if (!err) {\n\n            def.resolve(result);\n          } else {\n\n            def.reject(\"Could not add the document\");\n          }\n        });\n      } else {\n        // If not error, then the doc exists and must be replaced if is outdated\n        self.dbProcessHierarchy.put({\n          _id: doc._id,\n          _rev: doc._rev,\n          doc: hierarchy },\n        function callback(err, result) {\n\n          if (!err) {\n\n            def.resolve(result);\n          } else {\n\n            def.reject(\"Could not update the document\");\n          }\n        });\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save in the db the user recent processes to create cases\r\n      * @param {} processes \r\n      * @returns {} \r\n      */\n  saveRecentProcesses: function saveRecentProcesses(processes) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var docRecent = {\n      _id: self.globalId,\n      doc: processes };\n\n\n    self.dbProcessRecent.get(docRecent._id, function (err, doc) {\n      // If error, then the doc does not exists and it's added\n      if (err) {\n        // If it does not exist then add\n        self.dbProcessRecent.put(docRecent, function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not add the document\");\n          }\n        });\n      } else {\n        // If no error, then the doc exists and must be replaced if is outdated\n        self.dbProcessRecent.put({\n          _rev: doc._rev,\n          _id: doc._id,\n          doc: processes },\n        function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not update the document\");\n          }\n        });\n      }\n    });\n\n    return def.promise();\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra (based on Edward Morales version)\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to workportal REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {}, {\n  /*\r\n                                                                                       *   Constructor\r\n                                                                                       */\n  init: function init(params) {\n    // Call base\n    var self = this;\n    self.shouldSynchronize = !(bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice() && params.module !== \"offlineServices\");\n    self.isOfflineFormsV2Supported = bizagi.util.isOfflineFormsV2Supported();\n    self._super(params);\n\n    // Create instance of database services\n    if (!params.oldOfflineServicesAlreadyEnabled) {\n      self.database = typeof bizagi.workportal.services.db !== \"undefined\" && !bizagi.util.isMashupContext() ? new bizagi.workportal.services.db() : null;\n      self.configureOfflineEvents();\n    }\n\n    if (self.isOfflineFormsV2Supported) {\n      //Workflow context let us access to rendering services to retrieve offline forms\n      params.context = \"workflow\";\n      params.database = self.database;\n      self.multiactionService = new bizagi.render.services.multiactionservice(this);\n      self.renderDataService = typeof bizagi.render.services.service !== \"undefined\" ? new bizagi.render.services.service(params) : bizagi.render.services.service;\n      self.formService = self.renderDataService.getFormService();\n      self.syncService = self.renderDataService.getSyncService();\n\n      self.fetchWorker = new bizagi.workportal.services.fetchWorker(this);\n      self.pullWorker = new bizagi.workportal.services.pullWorker(this);\n\n      if (self.shouldSynchronize) {\n        self.configureOfflineHandlers();\n      }\n      self.configurePushCaseHandler();\n    }\n\n    if (bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice() && bizagi.getNativeComponent() === \"offline\") {\n      bizagiapp.offlineModuleReady();\n    }\n  },\n\n  /*\r\n     *   Return the multiaction-service\r\n     */\n  multiaction: function multiaction() {\n    return this.multiactionService;\n  },\n\n  /*************************************************************************************************\r\n      *          MAIN HANDLERS\r\n      *************************************************************************************************/\n\n  /**\r\n                                                                                                          * Configure events handler specifically for native devices\r\n                                                                                                          * @returns {}\r\n                                                                                                          */\n  configureOfflineHandlers: function configureOfflineHandlers() {\n    var self = this;\n\n    $(document).on(\"fetch-offline-processes\", $.proxy(self.fetchOfflineData, self));\n    $(document).on(\"get-offline-categories\", $.proxy(self.getOfflineCategoriesHandler, self));\n    $(document).on(\"get-offline-recent-processes\", $.proxy(self.getRecentProcessesHandler, self));\n    $(document).on(\"create-startform-case\", $.proxy(self.createStartFormHandler, self));\n    $(document).on(\"get-offline-cases\", $.proxy(self.getOfflineCasesHandler, self));\n    $(document).on(\"get-offline-case-workitems\", $.proxy(self.getOfflineWorkitemsHandler, self));\n    $(document).on(\"delete-offline-case\", $.proxy(self.getOfflineWorkitemsHandler, self));\n\n    // Execute this trigger in render on next event\n    $(document).off(\"tryPushData.offline\");\n    $(document).on(\"tryPushData.offline\", $.proxy(self.pushOfflineDataHandler, self));\n\n    //Clean databases\n    $(document).off(\"cleanDatabases.offline\");\n    $(document).on(\"cleanDatabases.offline\", $.proxy(self.cleanDatabasesHandler, self));\n\n    // Retry download\n    $(document).off(\"retry-download-offline-forms\");\n    $(document).on(\"retry-download-offline-forms\", $.proxy(self.fetchOfflineData, self));\n    // Get Sync Error\n    $(document).off(\"routing-get-offline-task-sync-error\");\n    $(document).on(\"routing-get-offline-task-sync-error\", function (_, params) {\n      self.getTaskSyncError(params);\n    });\n\n    // Sync errors\n    $(document).on(\"get-sync-errors-list\", $.proxy(self.getSyncErrorsListHandler, self));\n    $(document).off(\"get-inbox-sync-errors\");\n    $(document).on(\"get-inbox-sync-errors\", $.proxy(self.getInboxSyncErrorsHandler, self));\n    $(document).off(\"retry-sync-single-offline-case\");\n    $(document).on(\"retry-sync-single-offline-case\", function (_, params) {\n      self.retrySyncSingleOfflineCaseNative(params);\n    });\n  },\n\n  //Manage sync case if user has connection\n  configurePushCaseHandler: function configurePushCaseHandler() {\n    var self = this;\n    $(document).off(\"tryPushCase.offline\");\n    $(document).on(\"tryPushCase.offline\", function (_, params) {\n      var deferred = params.deferred || new $.Deferred();\n      self.tryPushOfflineCaseHandler(params).\n      then(function (response) {\n        deferred.resolve(response);\n      }, function (error) {\n        deferred.reject(error);\n      });\n    });\n    $(document).off(\"retrySyncCase.offline\");\n    $(document).on(\"retrySyncCase.offline\", function (_, params) {\n      var deferred = params.deferred || new $.Deferred();\n      params.isRetry = true;\n      self.tryPushOfflineCaseHandler(params).\n      then(function (response) {\n        deferred.resolve(response);\n      }, function (error) {\n        deferred.reject(error);\n      });\n    });\n  },\n\n  configureOfflineEvents: function configureOfflineEvents() {\n    var self = this;\n\n    if (bizagi.isMobileDevice()) {\n      if (typeof navigator.connection != \"undefined\") {\n        if (typeof Connection !== \"undefined\" && (\n        navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")) {\n          self.online = false;\n        } else {\n          self.online = true;\n        }\n      } else {\n        var queryString = bizagi.readQueryString();\n        var queryoffline = queryString && queryString[\"online\"] ? eval(queryString[\"online\"]) : true;\n        self.online = queryoffline;\n      }\n\n      $(document).off(\"online.services\");\n      $(document).on(\"online.services\", $.proxy(self.onlineServicesHandler, self));\n      $(document).off(\"offline.services\");\n      $(document).on(\"offline.services\", $.proxy(self.offlineServicesHandler, self));\n\n      window.addEventListener('online', function () {\n        self.online = true;\n      });\n\n      window.addEventListener('offline', function () {\n        self.online = false;\n      });\n    }\n  },\n\n  getOfflineCategoriesHandler: function getOfflineCategoriesHandler(_, params) {\n    var self = this;\n\n    params = params || {};\n    params.enableOfflineForm = true;\n    self.getCategories(params).\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineCategories(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting offline categories\");\n    });\n  },\n\n  getRecentProcessesHandler: function getRecentProcessesHandler() {\n    var self = this;\n\n    self.getRecentProcesses().\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineRecentProcesses(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting recent processes\");\n    });\n  },\n\n  createStartFormHandler: function createStartFormHandler(e, params) {\n    var self = this;\n    params = params || {};\n    params.categoryName = \"\";\n    params.isOfflineForm = true;\n\n    self.createNewCase(params).\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.openCreatedStartForm(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error creating a new case with start form\");\n    });\n  },\n\n  getOfflineCasesHandler: function getOfflineCasesHandler(_, param) {\n    var self = this;\n    var params = {};\n    params.enableOfflineForm = true;\n    params.inputtray = param;\n\n    self.getCasesListBeta(params).\n    then(function (resp) {\n      resp.inboxType = param;\n      bizagiapp.setOfflineInboxCases(resp);\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting offline cases\");\n    });\n  },\n\n  getOfflineWorkitemsHandler: function getOfflineWorkitemsHandler(_, params) {\n    var self = this;\n    var params = params || {};\n    params.isOfflineForm = params.isOfflineForm || true;\n    params.idCase = params.idCase || \"\";\n\n    self.getWorkitems(params).\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.openCreatedStartForm(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting offline workitems\");\n    });\n  },\n\n  deleteOfflineCaseHandler: function deleteOfflineCaseHandler(_, params) {\n    var self = this;\n    var params = params || {};\n    params.idCase = params.idCase || \"\";\n\n    self.deleteCase(params).\n    then(function () {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.offlineCaseDeleted(\"success\");\n      }\n    }).fail(function (e) {\n      bizagiapp.offlineCaseDeleted(\"error\");\n      self.defaultErrorHandler(e, \"error deleting an offline case\");\n    });\n  },\n\n  pushOfflineDataHandler: function pushOfflineDataHandler(_) {\n    var self = this;\n    if (self.online) {\n      self.pushOfflineData();\n    }\n  },\n\n  cleanDatabasesHandler: function cleanDatabasesHandler() {\n    var self = this;\n    self.database.restartDatabases().\n    then(function () {\n      var isIphoneNative = bizagi.util.isiOSSmartphoneDevice() && bizagi.util.isNativePluginSupported();\n      if (!isIphoneNative) {\n        bizagi.webpart.publish(\"bz-summary-item-clear\");\n        self.showTaskFeed();\n        if (!self.online) {\n          $(document).trigger(\"offline.inbox\");\n        }\n        bizagi.webpart.publish(\"bz-update-list-sync-errors-cases\");\n      }\n    }).\n    fail(function (e) {\n      self.defaultErrorHandler(e, \"error cleaning database\");\n    });\n  },\n\n  tryPushOfflineCaseHandler: function tryPushOfflineCaseHandler(params) {\n    var self = this;\n\n    if (self.online && params) {\n      return self.syncSingleOfflineCase(params).\n      then(function (syncResponse) {\n        if (params.offlineType === \"task\") {\n          syncResponse.IdCase = params.idCase;\n        }\n        return syncResponse;\n      }).\n      fail(function (e) {\n        self.defaultErrorHandler(e, \"error trying to push offline case\");\n      });;\n    }\n\n    // No connection\n    var networkErrorMsg = bizagi.localization.getResource(\"workportal-login-network-error\", \"The internet connection appears to be offline. Please verify and try again\");\n    var error = JSON.stringify({\n      error: { errorType: \"NetworkError\", message: networkErrorMsg },\n      message: networkErrorMsg,\n      type: \"error\" });\n\n    return $.Deferred().reject(error).promise();\n  },\n\n  syncSingleOfflineCase: function syncSingleOfflineCase(params) {\n    var self = this;\n\n    return params.offlineType === \"task\" ?\n    self.pullWorker.syncSingleOfflineTaskCase(params) :\n    self.pullWorker.syncSingleOfflineStartCase(params);\n  },\n\n  onlineServicesHandler: function onlineServicesHandler() {\n    var self = this;\n    if (self.lastOnlineTimestamp !== undefined && Date.now() - self.lastOnlineTimestamp < 100) {\n      return;\n    }\n\n    self.online = true;\n    if (self.isOfflineFormsV2Supported && self.shouldSynchronize) {\n      self.returnOnlineStatus();\n      self.lastOnlineTimestamp = Date.now();\n    }\n  },\n\n  offlineServicesHandler: function offlineServicesHandler() {\n    var self = this;\n    self.online = false;\n  },\n\n  getSyncErrorsListHandler: function getSyncErrorsListHandler() {\n    var self = this;\n    self.getSyncErrorsList().\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineSyncErrorList(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"Error getting sync error list\");\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineSyncErrorList([]);\n      }\n    });\n  },\n\n  getInboxSyncErrorsHandler: function getInboxSyncErrorsHandler() {\n    $.when(this.getInboxSyncErrors()).\n    then(function (syncErrors) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineInboxSyncErrors(syncErrors);\n      }\n    }).\n    fail(function (e) {\n      bizagiapp.setOfflineInboxSyncErrors({});\n      this.defaultErrorHandler(e, \"Error getting inbox sync errors\");\n    });\n\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n\n  showTaskFeed: function showTaskFeed() {\n    var params = { updateDataList: true, page: 1 };\n    var lastConfiguration = bizagi.util.getLastProcessInbox();\n    if (!bizagi.util.isEmpty(lastConfiguration) && !bizagi.util.isEmpty(lastConfiguration.processInfo)) {\n      if (lastConfiguration.processInfo.idWorkflow != -1) params.idWorkflow = lastConfiguration.processInfo.idWorkflow;else\n      if (!bizagi.util.isEmpty(lastConfiguration.processInfo.smartInboxId)) params.smartInboxId = lastConfiguration.processInfo.smartInboxId;\n    }\n    // Update TaskFeed \n    bizagi.webpart.publish(\"bz-update-list-cases\", params);\n  },\n  getOutboxCasesCount: function getOutboxCasesCount() {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = 0;\n    $.when(self.database.getOutboxCases()).\n    then(function (response) {\n      cases += response.rows ? response.rows.length : 0;\n    }).\n    always(function () {\n      var syncStatusCriteria = \"none\";\n      $.when(self.database.getOutboxTaskCasesFilteredBySyncStatus(syncStatusCriteria, true)).\n      done(function (responses) {\n        cases += responses.length;\n      }).\n      always(function () {\n        def.resolve(cases);\n      });\n    });\n    return def.promise();\n  },\n\n  returnOnlineStatus: function returnOnlineStatus() {\n    var self = this;\n\n    return self.saveWorkInProgress().always(function () {\n      return self.getOutboxCasesCount().\n      then(function (outboxCasesCount) {\n        if (outboxCasesCount > 0) {\n          if (bizagi.util.isNativePluginSupported()) {\n            bizagiapp.openSyncDialog();\n          }\n          return self.pushOfflineData();\n        }\n        return;\n      }).\n      always(function () {\n        var lastProcessInbox = bizagi.util.getLastProcessInbox();\n        var smartInboxId = lastProcessInbox.processInfo.smartInboxId;\n\n        if (!bizagi.util.isiOSSmartphoneDevice()) {\n          bizagi.webpart.publish(\"bz-update-list-cases\", { updateDataList: true, smartInboxId: smartInboxId || undefined });\n          if (bizagi.util.isOfflineErrorsViewSupported()) {\n            bizagi.webpart.publish(\"bz-update-list-sync-errors-cases\");\n          }\n        } else\n        {\n          self.fetchOfflineData();\n        }\n      });\n    });\n  },\n\n  /*\r\n      * Get all data from server : new case structure, forms data\r\n      */\n  fetchOfflineData: function fetchOfflineData() {\n    var self = this;\n    if (!self.isOfflineFormsV2Supported) {\n      return;\n    }\n    self.fetchWorker.fetch();\n  },\n\n  /*\r\n      * Push all data to server : new case structure, forms data\r\n      */\n  pushOfflineData: function pushOfflineData() {\n    var self = this;\n    if (!self.isOfflineFormsV2Supported) return;\n    return self.pullWorker.pull().\n    then(function (success) {\n      self.showSyncMessage(success);\n      return success;\n    }).\n    fail(function (error) {\n      //It is necessary to not show error windows on native when is a business error\n      var notAnError = error && error.type ? true : false;\n      self.showSyncMessage(false, notAnError);\n      return error;\n    });\n  },\n\n  /*\r\n      *   Gets the current working user\r\n      */\n  getCurrentUser: function getCurrentUser(params) {\n    var self = this;\n\n    if (self.online) return self._super(params);\n\n    return $.when({\n      idUser: 1,\n      user: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n      userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n      domain: typeof BIZAGI_DOMAIN !== \"undefined\" ? BIZAGI_DOMAIN : \"domain\",\n      delegateUserName: \"\",\n      idDelegateUser: -1,\n      groupSeparator: \",\",\n      language: \"en-US\",\n      decimalSeparator: \".\",\n      decimalDigits: \"2\",\n      symbol: \"$\",\n      ShortDateFormat: \"M/d/yyyy\",\n      TimeFormat: \"h:mm tt\",\n      LongDateFormat: \"dddd, MMMM d, yyyy\",\n      twoDigitYearMax: 2029,\n      twoDigitYearMaxDelta: 13,\n      uploadMaxFileSize: \"1048576\",\n      isMultiOrganization: \"false\",\n      associatedStakeholders: [],\n      sUserProperties: [] });\n\n  },\n\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getAllProcesses: function getAllProcesses(params) {\n    var self = this;\n    params.inputtray = params.inputtray || \"inbox\";\n    if (self.online && params.inputtray == \"inbox\") return self._super(params);\n\n    return self.database.getAllProcesses(params).\n    then(function (response) {\n      response = JSON.parse(response);\n\n      // Aggrupate workflows by categories \n      if (!!params.skipAggrupate) {\n        self.includeAllProcessesItem(response);\n        return response;\n      }\n\n      var responseData = {};\n\n      // Create a default category\n      var categories = self.createDefaultCategories(params, response);\n\n      // Build result array once grouped\n      responseData.categories = [];\n      for (key in categories) {\n        responseData.categories.push({\n          name: key,\n          workflows: categories[key].workflows });\n\n      }\n      return responseData;\n    });\n  },\n\n  getAllSmartInbox: function getAllSmartInbox() {\n    var self = this;\n    if (!bizagi.util.isMobileSmartInboxEnabled()) return $.Deferred().resolve([]).promise();\n    if (self.online) {\n      return self._super().then(function (data) {\n        self.database.saveAvailableSmartInboxes(data);\n        return data;\n      });\n    }\n    return self.database.getAvailableSmartInboxes().\n    then(function (data) {\n      self.availableSmartInboxes = data;\n      return self.database.getAvailableOfflineSmartInboxes();\n    }).then(function (offline) {\n      return $.map(self.availableSmartInboxes, function (item) {return $.extend(item, { offline: offline.indexOf(item.id) != -1 });});\n    });\n  },\n  markSmartInboxAsAvailableOffline: function markSmartInboxAsAvailableOffline(id) {\n    var self = this;\n    return self.database.markSmartInboxAsAvailableOffline(id);\n  },\n  /**\r\n      * get last process inbox workflow\r\n      * @return {workflow} \r\n      */\n  getLastProcessInboxWorkflow: function getLastProcessInboxWorkflow() {\n    var self = this;\n    if (self.online) return self._super();\n    return bizagi.util.getLastProcessInboxProcessInfo();\n  },\n\n  /*\r\n      *   Returns all the cases for the current user filtered by a workflow\r\n      */\n  getCasesByWorkflow: function getCasesByWorkflow(params) {\n    var self = this;\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (params.inputtray === \"inbox\") {\n      if (self.online) return self._super(params);\n      return self.getCasesByWorkflowForInboxOffline(params);\n    }\n    return self.getCasesByWorkflowForOtherTrays(params);\n  },\n\n  getCasesByWorkflowForInboxOffline: function getCasesByWorkflowForInboxOffline(params) {\n    var self = this;\n\n    return self.getCustomizedColumnsDataTasks(params).\n    then(function (response) {\n      response = JSON.parse(response);\n      $.each(response.cases.rows, function (key, value) {\n        var newFieldsValue = [];\n\n        //  Set id of case to radnumber\n        response.cases.rows[key][\"radnumber\"] = value.radNumber;\n        $.each(value.fields, function (fieldsKey, fieldsValue) {\n          // when delete element from fields array, each function lose key value\n          if (fieldsValue != undefined) {\n            // Radnumber\n            try {\n              if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == \"true\") {\n                response.cases.rows[key][\"radnumber\"] = fieldsValue.Value;\n              } else if (fieldsValue.workitems != undefined) {\n                response.cases.rows[key][\"workitems\"] = fieldsValue.workitems;\n              } else {\n                newFieldsValue.push(fieldsValue);\n              }\n            } catch (e) {}\n          }\n        });\n\n        // Update Fields\n        response.cases.rows[key]['fields'] = newFieldsValue;\n      });\n\n      return response.cases;\n    });\n  },\n\n  getCasesByWorkflowForOtherTrays: function getCasesByWorkflowForOtherTrays(params) {\n    var self = this;\n    return self.database.getCustomizedColumnsData(params).\n    then(function (response) {\n      response = JSON.parse(response);\n      $.each(response.cases.rows, function (key, value) {\n        var newFieldsValue = [];\n\n        //  Set id of case to radnumber\n        response.cases.rows[key][\"radnumber\"] = value.id;\n        $.each(value.fields, function (fieldsKey, fieldsValue) {\n          // when delete element from fields array, each function lose key value\n          if (fieldsValue != undefined) {\n            // Radnumber\n            try {\n              if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == \"true\") {\n                response.cases.rows[key][\"radnumber\"] = fieldsValue.Value;\n              } else if (fieldsValue.workitems != undefined) {\n                response.cases.rows[key][\"workitems\"] = fieldsValue.workitems;\n              } else {\n                newFieldsValue.push(fieldsValue);\n              }\n            } catch (e) {\n            }\n          }\n        });\n\n        // Update Fields\n        response.cases.rows[key]['fields'] = newFieldsValue;\n      });\n      return response.cases;\n    });\n  },\n\n  /*\r\n      * Get columns data from offline tasks\r\n      */\n  getCustomizedColumnsDataTasks: function getCustomizedColumnsDataTasks(params) {\n    var self = this;\n    var headers, headersType;\n    var idWfClass = -1;\n    params.idWorkflow = params.idWorkflow || params.idWfClass;\n\n    if (params.radnumber || params.radNumber) params[\"radNumber\"] = params.radnumber ? params.radnumber : params.radNumber;\n    if (params.idcase || params.idCase) params[\"radNumber\"] = params.idcase ? params.idcase : params.idCase;\n    if (params.idWorkflow != undefined && bizagi.util.validateFeatureSupport(\"offlineCustomizedColumns\")) idWfClass = params.idWorkflow;\n\n    // Get custom column headers\n    return self.database.getProcessCustomColumnsHeaders(idWfClass).\n    then(function (headersResponse) {\n      headers = headersResponse.headers;\n      headersType = headersResponse.type;\n      var getOfflineCasesParams = $.extend({ isOpen: true }, params);\n      return self.database.getOfflineCases(getOfflineCasesParams);\n    }).\n    then(function (resp) {\n      return self.parseCustomizedColumnDataTaskResponse(params, resp, headers, headersType);\n    });\n  },\n\n  parseCustomizedColumnDataTaskResponse: function parseCustomizedColumnDataTaskResponse(params, response, headers, headersType) {\n    var self = this;\n    var tasks = response.elements;\n    var cases = { cases: { rows: [], totalPages: 1, page: 1, lstIdCases: [] } };\n\n    for (var i = 0, len = tasks.length; i < len; i++) {\n      var currTask = tasks[i];\n\n      if (self.isValidRadNumber(params.radNumber, currTask)) {\n        var localCase = self.buildCaseData(currTask);\n        var dataFields = currTask.systemColumns;\n        var defaultSystemHeaders = self.buildDefaultSystemHeaders();\n        if (headersType == \"process\") dataFields = currTask.processColumns;\n\n        if (dataFields != undefined) {\n          localCase.fields = [];\n          headers.forEach(function (header) {\n            if (header.fieldName == \"radnumber\") {\n              localCase.casenumberdisplayname = header.displayName;\n            } else\n            {\n              var includeHeader = headersType == \"process\" ? header.isCustomColumn == true :\n              defaultSystemHeaders[header.fieldName] == true;\n              if (includeHeader) {\n                localCase.fields.push({\n                  Value: dataFields[header.fieldName] || \"\",\n                  DisplayName: header.displayName,\n                  DataType: header.type,\n                  isRadNumber: header.fieldName == \"radnumber\" });\n\n              }\n            }\n          });\n        }\n        cases.cases.rows.push(localCase);\n        cases.cases.lstIdCases.push(currTask[0]);\n      }\n    }\n\n    // Update counter\n    cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n    return JSON.stringify(cases);\n  },\n\n  buildCaseData: function buildCaseData(task) {\n    return {\n      id: task[0],\n      radNumber: task.radNumber,\n      idWFClass: task[10],\n      idWorkFlow: task[10],\n      taskState: task.taskState,\n      isFavorite: task[9],\n      isEdited: task.isEdited,\n      offlineType: 'task',\n      isOpen: true,\n      isOfflineForm: true,\n      fields: [\n      {\n        Value: task.wfclsdisplayname,\n        DisplayName: task.wfclsdisplayname,\n        DataType: \"VarChar\",\n        isRadNumber: false },\n      {\n        Value: task[12],\n        DisplayName: \"Process creation date\",\n        DataType: \"DateTime\",\n        isRadNumber: false }] };\n\n\n\n  },\n\n  /*\r\n      *  Get Menu Authorization\r\n      */\n  getMenuAuthorization: function getMenuAuthorization() {\n    var self = this;\n\n    if (self.online) return self._super();\n    return $.when({\n      \"permissions\": [\n      { \"Cases\": [\"NewCase\", \"Pending\", \"Closed\", \"Search\"] },\n      {\n        \"AnalysisReports\": [\n        \"BAMProcess\", \"BAMTask\", \"AnalyticsProcess\", \"AnalyticsTask\", \"AnalyticsSensor\",\n        \"AnalysisQueries\", \"BAMResourceMonitor\"] },\n\n      {\n        \"Admin\": [\n        \"UserAdmin\", \"Licenses\", \"EntityAdmin\", \"CaseAdmin\", \"AlarmAdmin\", \"EncryptionAdmin\",\n        \"MobileUpdatesAdmin\", \"AsynchronousWorkitemRetries\", \"UserPendingRequests\",\n        \"AuthenticationLogQuery\", \"BusinessPolicies\", \"Profiles\", \"UserDefaultAssignation\",\n        \"GRDimensionAdmin\", \"ThemeBuilder\"] },\n\n      { \"CurrentUserAdministration\": [\"CurrentUser\"] }, { \"LogOut\": [] }, { \"Search\": [] },\n      { \"SmartFolders\": [] }, { \"CustomFolders\": [] }, { \"BizagiQueries\": [] }, { \"AnalysisQueries\": [] },\n      { \"StateLog\": [] }, { \"PrintableVersion\": [] }] });\n\n\n  },\n\n  /*\r\n      *   Gets the inbox summary for the current logged user\r\n      *   Returns a promise of the data being retrieved\r\n      */\n  getInboxSummary: function getInboxSummary(params) {\n    var self = this;\n    var enableDefaultMethod = self.online;\n    if (params && (params.inputtray == \"false\" || params.inputtray == \"true\")) {\n      enableDefaultMethod = false;\n    }\n    if (enableDefaultMethod) return self._super(params);\n    return $.when({ inboxSummary: { Red: 7, Yellow: 0, Green: 0, Black: 0, All: 7 } });\n  },\n\n  /*\r\n      *   Returns the available categories filtered by a parent category\r\n      *   If not parent category is sent, it will return the base categories\r\n      */\n  getCategories: function getCategories(params) {\n    var self = this;\n    if (self.online) return self._super(params);\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    // Required params\n    if (params.idCategory)\n    data[\"idCategory\"] = params.idCategory;\n    if (params.idApp)\n    data[\"idApp\"] = params.idApp;\n\n    data[\"enableOfflineForm\"] = params.enableOfflineForm || false;\n    data[\"groupByApp\"] = params.groupByApp || false;\n\n    // Call ajax and returns promise\n    return self.database.getCategories(data);\n  },\n\n  /*\r\n      * Create new case\r\n      */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n    return self.database.createNewCase(params);\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n\n    if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getCase !== \"undefined\")\n    return self.getNativeWorkItems(params);\n\n    return self.database.getWorkitems(params);\n  },\n\n  getNativeWorkItems: function getNativeWorkItems(params) {\n    var defer = new $.Deferred();\n    bizagiapp.getCase(params.idCase, function (response) {\n      var workItems = JSON.parse(response);\n      defer.resolve(workItems);\n    }, function (response) {\n      defer.reject(response);\n    });\n\n    return defer.promise();\n  },\n\n  getCaseSummary: function getCaseSummary(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n    return self.database.getSummary(params);\n  },\n\n  /*\r\n      *   Delete offline cases created localy\r\n      *   return a promise\r\n      */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    params = params || {};\n\n    return self.database.deleteCase(params);\n  },\n\n  /*\r\n      *   Get subprocesses\r\n      *   return a promise\r\n      */\n  getCaseSubprocesses: function getCaseSubprocesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n    return $.when({ subProcesses: [] });\n  },\n\n  /**\r\n      * This service get all overrides keys within configuration project\r\n      *\r\n      * @return {json}\r\n      */\n  getOverrides: function getOverrides() {\n    return {};\n  },\n\n  /**\r\n      * Return all the available cases in bizagi and thinking for mobile response\r\n      * @param {} params: inputtray:  inbox | outbox-new | outbox-finished | drafts \r\n      * @returns {}\r\n      */\n  getCasesListBeta: function getCasesListBeta(params) {\n    var self = this;\n    params = params || {};\n    params.inputtray = params.inputtray || \"inbox\";\n    if (params.inputtray === \"inbox\") {\n      if (self.online) {\n\n        $.when(self.saveWorkInProgress()).then(function () {\n          self.fetchOfflineData();\n        }).fail(function () {\n          console.log('getCasesListBeta => Error in saveWorkInProgress promise');\n        });\n\n        return self._super(params);\n      }\n      return self.getCasesListBetaForInbox(params);\n    } else if (params.inputtray === \"drafts\" || params.inputtray === \"outbox-new\") {\n      return self.getCasesListBetaForDraftsOrOutBox(params);\n    }\n    return self.getCasesListBetaForOtherTrays(params);\n  },\n\n  getCasesListBetaForInbox: function getCasesListBetaForInbox(params) {\n    var self = this;\n\n    //Bring work items from db that contain offlineform\n    params.isOpen = true;\n    params.idWfClass = params.idWfClass != undefined ? params.idWfClass : -1;\n    return $.when(self.getProcessCustomColumnsHeaders(params), self.database.getOfflineCases(params)).\n    then(function (headersResponse, tasks) {\n      var taskFeedData = self.getTaskFeedData(tasks);\n      if (headersResponse && headersResponse.headers)\n      taskFeedData.headers = headersResponse.headers;\n      return taskFeedData;\n    });\n    ;\n  },\n\n  getCasesListBetaForDraftsOrOutBox: function getCasesListBetaForDraftsOrOutBox(params) {\n    var self = this;\n\n    return self.database.getCasesList(params).\n    then(function (response) {\n      var taskFeedData = self.getTaskFeedData(response);\n      return taskFeedData;\n    });\n  },\n\n  getCasesListBetaForOtherTrays: function getCasesListBetaForOtherTrays(params) {\n    var self = this;\n    params.isOpen = false;\n\n    return self.database.getOfflineCases(params).\n    then(function (tasks) {\n      var taskFeedData = self.getTaskFeedData(tasks);\n      return taskFeedData;\n    });\n  },\n\n  getLastSelectionCustomColumns: function getLastSelectionCustomColumns() {\n    var self = this;\n    var lastProcessInbox = bizagi.util.getLastProcessInbox();\n    var workflowId = lastProcessInbox.processInfo.idWorkflow;\n    var smartInboxId = lastProcessInbox.processInfo.smartInboxId;\n    if (!bizagi.util.isEmpty(lastProcessInbox.processColumnsInfo) && !bizagi.util.isEmpty(lastProcessInbox.processColumnsInfo.processColumns))\n    return $.Deferred().resolve(lastProcessInbox.processColumnsInfo.processColumns).promise();\n    var service = $.Deferred().resolve(undefined).promise();\n    if (smartInboxId != null) service = self.getSmartInboxCustomColumnsHeaders({ smartInboxId: smartInboxId });else\n    service = self.getProcessCustomColumnsHeaders({ idWfClass: workflowId });\n    return service.then(function (data) {\n      bizagi.util.setLastProcessInboxProcessColumns(data.headers);\n      return data.headers;\n    });\n  },\n  getProcessCustomColumnsHeaders: function getProcessCustomColumnsHeaders(params) {\n    var self = this;\n    return self.database.getProcessCustomColumnsHeaders(params.idWfClass);\n  },\n\n  getSmartInboxCustomColumnsHeaders: function getSmartInboxCustomColumnsHeaders(params) {\n    var self = this;\n    return params.smartInboxId != null ?\n    self.database.getSmartInboxCustomColumnsHeaders(params.smartInboxId) :\n    undefined;\n  },\n\n  getMobileCasesList: function getMobileCasesList(params) {\n    var self = this;\n\n    if (params.inputtray === \"inbox\") return self._super(params);\n    return getCasesListBeta(params);\n  },\n\n  /*\r\n      * Customize Columns\r\n      */\n  getTaskFeedData: function getTaskFeedData(response) {\n    var self = this;\n    var overdue = bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n    var today = bizagi.localization.getResource(\"workportal-taskfeed-today\");\n    var tomorrow = bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n    var upcoming = bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n    var groupedData = { elements: [], page: response.page, totalPages: response.totalPages, advanceSearch: false };\n    var actualDate = new Date();\n    var actualMonth = actualDate.getMonth();\n    var actualDay = actualDate.getDate();\n    var actualYear = actualDate.getFullYear();\n\n    for (var counter = 0; response.elements.length > counter; counter++) {\n      var tmpElement = response.elements[counter];\n      if (tmpElement.offlineType !== undefined && tmpElement.offlineType === \"task\") tmpElement[3] = tmpElement.endDate;\n      var status = {};\n      var originalEndDate = tmpElement[3];\n\n      if (tmpElement[3] !== \"\") {\n        var tmpdate = new Date(tmpElement[3]);\n        var tmpDay = tmpdate.getDate();\n        var tmpMonth = tmpdate.getMonth();\n        var tmpYear = tmpdate.getFullYear();\n        var dateDiff = new Date(tmpYear, tmpMonth, tmpDay, 0, 0, 0) - new Date(actualYear, actualMonth, actualDay, 0, 0, 0);\n\n        if (dateDiff < 0) {\n          tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd | hh:mm tt\");\n          status = self.getTaskFeedStatus(\"1|\" + overdue, \"red\", \"overdue\", \"overdue\");\n\n        } else {\n          if (actualMonth === tmpMonth && actualDay === tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n\n            // Define if the case is overdue\n            if (tmpdate.getTime() < actualDate.getTime()) {\n              status = self.getTaskFeedStatus(\"2|\" + today + \", \" + bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"), \"red\", \"today\", \"overdue\");\n            } else {\n              status = self.getTaskFeedStatus(\"2|\" + today + \", \" + bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"), \"yellow\", \"today\", \"ontime\");\n            }\n          } else if (actualMonth === tmpMonth && actualDay + 1 === tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n            status = self.getTaskFeedStatus(\"3|\" + tomorrow, \"yellow\", \"tomorrow\", \"ontime\");\n          } else {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd | hh:mm tt\");\n            status = self.getTaskFeedStatus(\"4|\" + upcoming, \"green\", \"upcoming\", \"upcoming\");\n          }\n\n          if (status && tmpElement.taskstate) {\n            status.state = tmpElement.taskstate;\n          }\n        }\n      } else {\n        tmpElement[3] = \"--\";\n        status = self.getTaskFeedStatus(\"1|\" + overdue, \"red\", \"overdue\", \"overdue\");\n      }\n\n      groupedData.elements.push($.extend({}, tmpElement, status, { \"endDate\": originalEndDate, \"idworkitem\": tmpElement[1] }));\n    }\n    return groupedData;\n  },\n\n  getTaskFeedStatus: function getTaskFeedStatus(group, state, type, icon) {\n    return status = {\n      group: group,\n      state: state,\n      type: type,\n      icon: icon };\n\n  },\n\n  /*\r\n      * Render Details\r\n      * @param idWorkitem\r\n      */\n  summaryCaseDetails: function summaryCaseDetails(options) {\n    var self = this;\n    var params = options || {};\n    var idWorkitem = options[\"idWorkitem\"] || 0;\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (!params.isOfflineForm) return self._super(params);\n    return self.getCaseSummaryDataContent(options).\n    done(function (data) {\n\n      data.currentState = data.currentState || [];\n      var dataCurrentStateLength = data.currentState.length;\n\n      // Show or hide tabs\n      data[\"showEvents\"] = data[\"countEvents\"] >= 1 ? true : false;\n      data[\"showParentProcess\"] = data[\"idParentCase\"] >= 1 ? true : false;\n      data[\"parentProcess\"] = { 'displayName': data[\"parentDisplayName\"], 'idCase': data[\"idParentCase\"] };\n      data[\"isClosed\"] = data[\"isOpen\"] == \"true\" ? false : true;\n      data[\"showAssignees\"] = data[\"countAssigness\"] >= 1 ? true : false;\n      data[\"showSubProcess\"] = data[\"countSubProcesses\"] >= 1 ? true : false;\n      data[\"showForm\"] = data[\"hasGlobalForm\"] == \"true\" ? true : false;\n      data[\"allowsReassign\"] = \"false\";\n\n      for (var i = 0; i < dataCurrentStateLength; i++) {\n        if (data[\"currentState\"][i][\"idWorkItem\"] == idWorkitem) {\n          data[\"allowsReassign\"] = data[\"currentState\"][i][\"allowsReassign\"];\n        }\n      }\n\n      // edit original data, no show events in activities tab\n      var currentStateTypes = [];\n      var m = 0; // counter for new activities array\n      for (var j = 0; j < data[\"currentState\"].length; j++) {\n        if (data[\"currentState\"][j][\"isEvent\"] == \"false\" &&\n        data[\"currentState\"][j][\"assignToCurrentUser\"] == \"true\" &&\n        data[\"currentState\"][j][\"idWorkItem\"] != idWorkitem) {\n          currentStateTypes[m++] = data[\"currentState\"][j];\n        }\n      }\n\n      data[\"currentStateTypes\"] = currentStateTypes;\n      data[\"showActivities\"] = currentStateTypes.length >= 1 ? true : false;\n\n      return data;\n    });\n  },\n\n  /**\r\n      *  Get json from cases service\r\n      */\n  getCaseSummaryDataContent: function getCaseSummaryDataContent(options) {\n    var self = this;\n\n    return self.getCaseSummary(options).\n    then(function (data) {\n      // Completes data\n      data.taskState = self.icoTaskState;\n      data.process = data.process ? data.process : \"\";\n\n      if (data.createdBy) {\n        data.createdByName = data.createdBy.Name;\n        data.createdByUserName = data.createdBy.userName;\n        data.caseDescription = data.caseDescription == '' ? '' : data.caseDescription;\n        data.processPath = data.processPath.replace(/\\//g, ' > ') + data.process;\n        data.showWorkOnIt = true;\n      }\n\n      return data;\n    });\n  },\n\n  /*\r\n      *   Returns the data for the inbox grid view\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (params.inputtray === \"inbox\") return self._super(params);\n    return self.database.getCustomizedColumnsNewData(params).\n    then(function (response) {\n      return JSON.parse(response);\n    });\n  },\n\n  /*\r\n      *   Returns the recent process\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return self.database.getRecentProcesses(params);\n  },\n\n  /*\r\n      *   Start process in BizAgi\r\n      */\n  startProcess: function startProcess(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return $.when({\n      hasStartForm: false,\n      idProcess: params.idProcess,\n      displayName: params.displayName,\n      caseInfo: {} });\n\n  },\n\n  /**\r\n      * Get stakeholder shortCurts\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  getShortCuts: function getShortCuts(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return $.when([]);\n  },\n\n  /**\r\n      * Returns the available list of searches\r\n      * @returns {}\r\n      */\n  getSearchLists: function getSearchLists() {\n    var self = this;\n\n    if (self.online) return self._super();\n    return $.when([]);\n  },\n\n  /**\r\n      * Get the icon of a given collection\r\n      * @param params\r\n      */\n  getCollectionIcon: function getCollectionIcon(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return $.when([]);\n  },\n\n  /**\r\n      * Returns the recent process\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  getRecentOfflineProcesses: function getRecentOfflineProcesses(params) {\n    var self = this;\n    params = params || {};\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('process-handler-getRecentProcesses'),\n      data: params,\n      dataType: 'json',\n      type: 'GET',\n      avoidLoader: true }).\n\n    then(function (data) {\n\n      var processes = data[\"processes\"] || [];\n      var recentProcess = { \"processes\": [] };\n\n      if (!bizagi.util.isObjectEmpty(processes)) {\n        var item;\n        var counter = -1;\n        while (item = processes[++counter]) {\n          if (item.hasOfflineForm) {\n            recentProcess.processes.push(item);\n          }\n        }\n      }\n\n      return recentProcess;\n    });\n  },\n\n  /*\r\n      * Retreives the process  from Hierarchy\r\n      *\r\n      */\n  getOfflineProcessesHierarchy: function getOfflineProcessesHierarchy() {\n    var self = this;\n    var data = {};\n    data['removeOnlineItems'] = 'true';\n    return $.ajax({\n      url: self.serviceLocator.getUrl('offline-getProcessTree'),\n      data: data,\n      dataType: 'json',\n      type: 'GET',\n      avoidLoader: true });\n\n  },\n\n  getOfflineTasks: function getOfflineTasks() {\n    var self = this;\n    var data = {};\n    data[\"pageSize\"] = self.maxOfflineCases;\n    data[\"page\"] = 1;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"offline-tasks\"),\n      data: data,\n      dataType: 'json',\n      type: 'GET',\n      avoidLoader: true });\n\n  },\n\n\n  serializeOfflineCustomizedColumns: function serializeOfflineCustomizedColumns(headers, rows) {\n    var activities = [];\n    rows.forEach(function (row) {\n      var activityObject = {};\n      headers.forEach(function (header, headerIndex) {\n        if (header.fieldName) {\n          activityObject[header.fieldName] = row[headerIndex];\n        }\n      });\n      activities.push(activityObject);\n    });\n    return activities;\n  },\n\n  deserializeOfflineCustomizedColumns: function deserializeOfflineCustomizedColumns(headers, rows) {\n    var activities = [];\n    rows.forEach(function (rowObject, rowIndex) {\n      var activityRow = activities[rowIndex];\n      if (activityRow == undefined) {\n        activityRow = [];\n      }\n      headers.forEach(function (headerObject, headerIndex) {\n        activityRow[headerIndex] = rowObject[headerObject.fieldName];\n      });\n      activities[rowIndex] = activityRow;\n    });\n    return activities;\n  },\n\n  addEvalPropertyToOfflineHeaders: function addEvalPropertyToOfflineHeaders(headers) {\n    var onlineToOfflineMapping = {\n      \"taskstate\": \"*VAR*.workItems[0].State\",\n      \"wfclsdisplayname\": \"*VAR*.categoryName\",\n      \"currenttask\": \"*VAR*.workItems[0].TaskName\",\n      \"cascreationdate\": \"*VAR*.creationDate\",\n      \"wiestimatedsolutiondate\": \"*VAR*.endDate\",\n      \"idworkitem\": \"*VAR*.workItems[0].idWorkItem\",\n      \"taskid\": \"*VAR*.workItems[0].idTask\",\n      \"hassyncerror\": \"!bizagi.util.isEmpty(*VAR*.syncStatus)\",\n      \"syncerror\": \"bizagi.util.isEmpty(*VAR*.syncStatus) ? undefined : *VAR*.syncDetails\" };\n\n\n    return headers.map(function (currentHeader) {\n      if (onlineToOfflineMapping[currentHeader.fieldName]) {\n        currentHeader.eval = onlineToOfflineMapping[currentHeader.fieldName];\n        currentHeader.varSymbol = \"*VAR*\";\n      }\n      return currentHeader;\n    });\n  },\n\n  getOfflineSystemHeaders: function getOfflineSystemHeaders() {\n\n    var offlineHeaders = [\"isEdited\", \"isOpen\", \"syncStatus\", \"isDraft\",\n    \"syncDetails\", \"formsRenderVersion\", \"isOfflineForm\", \"offlineType\", \"hassyncerror\", \"syncerror\"];\n    return offlineHeaders.map(function (header) {\n      return {\n        displayName: header,\n        fieldName: header };\n\n    });\n  },\n\n  getCardViewCustomizedColumns: function getCardViewCustomizedColumns(params) {\n    var self = this;\n    var response = { headers: [], rows: [], currentPage: 1, totalPages: 1, totalRecords: 0 };\n\n    params.inputtray = params.inputtray || \"inbox\";\n    if (self.online && params.inputtray === \"inbox\") {\n\n      $.when(self.saveWorkInProgress()).then(function () {\n        self.fetchOfflineData();\n      }).fail(function () {\n        console.log('getCardViewCustomizedColumns => Error in saveWorkInProgress promise');\n      });\n\n      return self._super(params);\n    }\n\n    if (params.inputtray === \"inbox\") params.isOpen = true;else\n    {\n      params.idWfClass = -1;\n      params.isOpen = params.inputtray === \"drafts\";\n      delete params.sortData;\n    }\n\n    var headers;\n\n    var service = params.smartInboxId != null ? self.database.getSmartInboxCustomColumnsHeaders(params.smartInboxId) : self.database.getProcessCustomColumnsHeaders(params.idWfClass);\n    return service.then(function (headersResponse) {\n      headers = headersResponse.headers;\n      headers = headers.concat(self.getOfflineSystemHeaders());\n      headers = self.addEvalPropertyToOfflineHeaders(headers);\n      params.headers = headers;\n      params.customColumnsType = headersResponse.type;\n      return self.database.getCustomColumnsData(params);\n    }, function (error) {\n      self.defaultErrorHandler(error, \"OFFLINE: getCardViewCustomizedColumns => Error retrieving headers\");\n      console.warn();\n      return response;\n    }).\n    then(function (rows) {\n      response.headers = headers;\n\n      response.rows = self.deserializeOfflineCustomizedColumns(headers, rows);\n      response.pageSize = rows.length;\n      response.totalRecords = rows.length;\n      return response;\n    }, function (headersErr, rowsErr) {\n      self.defaultErrorHandler({ headersErr: headersErr, rowsErr: rowsErr }, \"OFFLINE: getCardViewCustomizedColumns => Error retrieving rows\");\n      console.warn();\n      return response;\n    });\n  },\n\n  downloadOfflineCustomizedColumns: function downloadOfflineCustomizedColumns() {\n    var self = this;\n    if (!this.online || !this.isOfflineFormsV2Supported) return;\n\n    //Only will be stored the process custom Columns. \n    //Application Custom Columns is out of Scope\n    var lastProcessInfo = bizagi.util.getLastProcessInboxProcessInfo();\n    var workflowId = -1;\n    var smartInboxId = null;\n\n    // If the server does not support custom columns the system columns should be \n    // stored to show the summary view\n    if (bizagi.util.validateFeatureSupport(\"offlineCustomizedColumns\") && lastProcessInfo && lastProcessInfo.idWorkflow) {\n      workflowId = lastProcessInfo.idWorkflow;\n    }\n    var getCustomColumnsParams = { pageSize: 100, page: 1, avoidLoader: true };\n    if (workflowId != -1) getCustomColumnsParams.idWfClass = workflowId;\n    if (lastProcessInfo.smartInboxId != -1) getCustomColumnsParams.smartInboxId = smartInboxId = lastProcessInfo.smartInboxId;\n\n    return this.getCardViewCustomizedColumns(getCustomColumnsParams).\n    then(function (response) {\n      var headers = response.headers;\n      var rows = response.rows;\n      if (!headers || !rows)\n      return $.Deferred().reject(\"Headers or rows are missing in the custom columns service response\").promise();\n\n      var updatesQueue = new bizagiQueue();\n      updatesQueue.add(self.database.saveProcessCustomColumnsHeaders(-1, self.filterSystemHeaders(headers)));\n      if (workflowId != -1) updatesQueue.add(self.database.saveProcessCustomColumnsHeaders(workflowId, headers));else\n      if (smartInboxId != null) updatesQueue.add(self.database.saveSmartInboxCustomColumnsHeaders(smartInboxId, headers));\n      var serializedActivities = self.serializeOfflineCustomizedColumns(headers, rows);\n      serializedActivities.forEach(function (activityCustomColumns) {\n        var caseId = activityCustomColumns.idcase;\n        var workitemId = activityCustomColumns.idworkitem;\n        var internalId = caseId + \"-\" + workitemId;\n        var updateCustomColumnsPromise;\n        if (workflowId != -1) updateCustomColumnsPromise = self.database.updateTaskWorkItemCustomColumnsByType(internalId, \"process\", activityCustomColumns);else\n        if (smartInboxId != null) updateCustomColumnsPromise = self.database.updateTaskWorkItemCustomColumnsByType(internalId, \"smartinbox\", activityCustomColumns, smartInboxId);\n        if (updateCustomColumnsPromise != null) updatesQueue.add(updateCustomColumnsPromise);\n      });\n\n      return updatesQueue.execute();\n    }).\n    fail(function (err) {\n      return self.defaultErrorHandler(err, \"Error downloading the customized columns.\");\n    });\n  },\n\n  getMobileOfflineActivities: function getMobileOfflineActivities(params) {\n    var self = this;\n    var casesListResponse;\n    return self.isActivityAlreadyDownloaded(params.idCase, params.idWorkitem).\n    then(function (isAlreadyDownloaded) {\n      if (isAlreadyDownloaded) return null;\n\n      bizagi.util.console.log(\"Force offline => Task is NOT already downloaded. Downloading...\");\n      var getCaseParams = {\n        radNumber: params.radNumber,\n        idWorkitem: params.idWorkitem || null };\n\n      return self.getMobileActivities(getCaseParams);\n    }).\n    then(function (casesListResponse) {\n      if (casesListResponse == null) return null;\n\n      var serverActivities = self.fetchWorker.serializeActivities(casesListResponse);\n      var offlineActivityId = params.idCase + \"-\" + params.idWorkitem;\n      var serverActivity = serverActivities[offlineActivityId];\n      if (serverActivity === undefined) {\n        return $.Deferred().reject({\n          type: \"error\",\n          message: \"Problem retrieving the activity from the server\" }).\n        promise();\n      }\n\n      var activityToSave = {};\n      serverActivity.isOnDemand = true;\n      activityToSave[offlineActivityId] = serverActivity;\n      return self.database.saveOfflineTasks(serverActivities);\n\n    }).then(function (response) {\n      if (response == null) return null;\n      return self.updateCustomColumns(params, casesListResponse);\n    });\n  },\n\n  updateCustomColumns: function updateCustomColumns(params, casesListResponse) {\n    var self = this;\n    if (bizagi.util.isEmpty(params.idWfClass)) return undefined;\n\n    var headers = casesListResponse.headers;\n    var rows = casesListResponse.rows;\n    var customColumnsActivites = self.serializeOfflineCustomizedColumns(headers, rows);\n    var updateCustomColumnsQueue = new bizagiQueue();\n\n    if (!bizagi.util.isEmpty(params.idWorkflow)) {\n      updateCustomColumnsQueue.add(self.database.saveProcessCustomColumnsHeaders(-1, self.filterSystemHeaders(headers)));\n      updateCustomColumnsQueue.add(self.database.saveProcessCustomColumnsHeaders(params.idWorkflow, headers));\n    }\n\n    customColumnsActivites.forEach(function (activityCustomColumns) {\n      var caseId = activityCustomColumns.idcase;\n      var workitemId = activityCustomColumns.idworkitem;\n      var internalId = caseId + \"-\" + workitemId;\n      var updateCustomColumsPromise = self.database.updateTaskWorkItemCustomColumnsByType(internalId, \"process\", activityCustomColumns);\n      updateCustomColumnsQueue.add(updateCustomColumsPromise);\n    });\n\n    return updateCustomColumnsQueue.execute();\n  },\n\n  downloadActivityOnDemand: function downloadActivityOnDemand(params) {\n    var self = this;\n\n    bizagi.loading.start();\n\n    return self.getMobileOfflineActivities(params).\n    then(function () {\n      return self.isTaskFormAlreadyDownloaded(params.idCase, params.idWorkitem);\n    }).\n    then(function (isFormAlreadyDownloaded) {\n\n      if (!isFormAlreadyDownloaded) return true;\n      if (!params.executeOfflineEntryPipeline) return false;\n\n      //If has entry pipeline the form should be downloaded again\n      return self.formService.verifyFormEntryPipeline(params);\n    }).\n    then(function (shouldDownloadForm) {\n      if (!shouldDownloadForm) return { wasFormDownloaded: false, hasEntryPipeline: false, wasPipelineExecuted: false };\n\n      return $.when(self.formService.downloadOfflineTaskForm({\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        executeOfflineEntryPipeline: params.executeOfflineEntryPipeline }));\n\n    }).\n    always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  downloadStartFormOnDemand: function downloadStartFormOnDemand(idProcess) {\n    var self = this;\n    return self.isStartFormAlreadyDownloaded(idProcess).\n    then(function (isFormDownloaded) {\n      if (isFormDownloaded || self.online === false) return;\n\n      return self.formService.downloadOfflineStartForm({ idProcess: idProcess });\n    });\n  },\n\n  /*************************************************************************************************\r\n      *          UTIL METHODS\r\n      *************************************************************************************************/\n\n  showSyncMessage: function showSyncMessage(success, notAnError) {\n    var message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-successful\") ?\n    bizagi.localization.getResource(\"workportal-mobile-offline-sync-successful\") :\n    \"Synchronization successful\";\n    var type = \"success\";\n    if (!success) {\n      message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-fail\") ?\n      bizagi.localization.getResource(\"workportal-mobile-offline-sync-fail\") :\n      \"Synchronization failed\";\n      type = notAnError && !bizagi.util.isNativePluginSupported() ? \"\" : \"error\";\n    }\n    if (bizagi.util.isNativePluginSupported()) {\n      bizagiapp.synchronizationFinished(type);\n    } else\n    {\n      bizagi.util.showNotification({ text: message, type: type });\n    }\n  },\n\n  defaultErrorHandler: function defaultErrorHandler(error, message) {\n    if (_typeof(error) == \"object\")\n    bizagi.util.console.error(message, error);else\n\n    bizagi.util.console.error(message + \":\" + error);\n    return error;\n  },\n\n  createDefaultCategories: function createDefaultCategories(params, response, categories) {\n    var categories = {};\n    var allProcesses = bizagi.localization.getResource(\"workportal-widget-inbox-all-processes\");\n    var allCases = {\n      name: bizagi.localization.getResource(\"workportal-widget-inbox-all-cases\"),\n      path: \"\",\n      category: allProcesses,\n      isFavorite: params.onlyFavorites || false,\n      guidFavorite: \"\",\n      idworkflow: \"\",\n      guidWFClass: \"\",\n      count: 0 };\n\n\n    categories[allProcesses] = [];\n    categories[allProcesses].workflows = [];\n    categories[allProcesses].workflows.push(allCases);\n    if (response.workflows) {\n      $.each(response.workflows.workflow, function (_, workflow) {\n        // Creates the category if it doesn't exist\n        if (!categories[workflow.category]) {\n          categories[workflow.category] = [];\n          categories[workflow.category].workflows = [];\n        }\n\n        // Push the workflow\n        categories[workflow.category].workflows.push(workflow);\n\n        // Sum the cases count\n        allCases.count += Number(workflow.count);\n      });\n    }\n  },\n\n  isActivityAlreadyDownloaded: function isActivityAlreadyDownloaded(idCase, idWorkitem) {\n    return this.database.getTask(idCase + \"-\" + idWorkitem).\n    then(function () {\n      return true;\n    }, function () {\n      return $.Deferred().resolve(false).promise();\n    });\n  },\n\n  isTaskFormAlreadyDownloaded: function isTaskFormAlreadyDownloaded(idCase, idWorkitem) {\n    return this.database.getTaskForm({\n      idCase: idCase,\n      idWorkitem: idWorkitem }).\n\n    then(function () {\n      return true;\n    }, function () {\n      return $.Deferred().resolve(false).promise();\n    });\n  },\n\n  isStartFormAlreadyDownloaded: function isStartFormAlreadyDownloaded(idProcess) {\n    return this.database.getStartForm({\n      idProcess: idProcess }).\n\n    then(function () {\n      return true;\n    }, function () {\n      return $.Deferred().resolve(false).promise();\n    });\n  },\n\n  isValidRadNumber: function isValidRadNumber(radNumber, task) {\n    return typeof radNumber === \"undefined\" ||\n    radNumber.toString() === \"\" ||\n    radNumber.toString() === task[0] ||\n    radNumber == task[0] ||\n    radNumber.toString() == task.radNumber ||\n    radNumber == task.radNumber;\n  },\n\n  buildDefaultSystemHeaders: function buildDefaultSystemHeaders() {\n    return {\n      \"radnumber\": true,\n      \"wfclsdisplayname\": true,\n      \"cascreationdate\": true,\n      \"wiestimatedsolutiondate\": true,\n      \"cassolutiondate\": true };\n\n  },\n\n  filterSystemHeaders: function filterSystemHeaders(headers) {\n    var systemHeaders = [];\n    var self = this;\n    headers.forEach(function (header) {\n      if (self.isInboxHeaderASystemColumn(header.fieldName)) {\n        systemHeaders.push(header);\n      }\n    });\n    return systemHeaders;\n  },\n\n  updateSyncErrorsStatus: function updateSyncErrorsStatus() {\n    this.getSyncErrorsList().\n    then(function (errorsList) {\n      var errors = bizagi.util.isEmpty(errorsList) ? 0 : errorsList.length;\n      $(document).trigger(\"update-sync-errors-icon\", { errors: errors });\n    });\n  },\n  saveWorkInProgress: function saveWorkInProgress() {\n    var self = this;\n    var deferred = new $.Deferred();\n    if (self.activeForm !== undefined && self.activeForm.params && self.activeForm.params.offlineType === \"task\" && self.activeForm.params.isOfflineForm === true) {\n      document.activeElement.blur();\n      return self.activeForm.saveWorkInProgress();\n    } else\n    {\n      deferred.resolve();\n    }\n    return deferred.promise();\n  },\n\n  retrySyncSingleOfflineCaseNative: function retrySyncSingleOfflineCaseNative(infoCase) {\n    var self = this;\n\n    infoCase.isSingleSync = infoCase.isSingleSync || true;\n    infoCase.isRetry = infoCase.isRetry || true;\n\n    self.syncSingleOfflineCase(infoCase).\n    then(function () {\n      // Sucess\n      bizagi.util.showMobileToast({\n        type: \"success\",\n        message: bizagi.localization.getResource(\"workportal-offline-sync-success\") });\n\n    }).\n    fail(function (syncResponse) {\n      bizagi.util.showMobileToast({\n        type: \"error\",\n        message: bizagi.localization.getResource(\"workportal-offline-sync-failed\") });\n\n    }).\n    always(function () {\n      //Wait to persists the error in db before to refresh the view\n      setTimeout(function () {\n        // Update native view\n        self.getSyncErrorsListHandler();\n      }, 100);\n    });\n\n  },\n  /*************************************************************************************************\r\n      *          BRIDGE METHODS\r\n      *************************************************************************************************/\n\n  downloadOfflineTaskForm: function downloadOfflineTaskForm(params) {return this.formService.downloadOfflineTaskForm(params);},\n  downloadOfflineStartForm: function downloadOfflineStartForm(params) {return this.formService.downloadOfflineStartForm(params);},\n  syncOfflineStartCase: function syncOfflineStartCase(params) {return this.syncService.syncOfflineStartCase(params);},\n  syncOfflineTaskCase: function syncOfflineTaskCase(params) {return this.syncService.syncOfflineTaskCase(params);},\n\n  getInboxSyncErrors: function getInboxSyncErrors() {return this.database.getInboxSyncErrors();},\n  getSyncErrorsList: function getSyncErrorsList() {return this.database.getSyncErrorsList();},\n  getTaskSyncError: function getTaskSyncError(params) {return this.database.getTaskSyncError(params);} });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name:   Bizagi diagnostics service\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Bryan Alejandro Cubillos Prieto\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Date:   09/21/2020\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   =>      This is a new service base for Bizagi diagnostics, required for centralized behavior\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\nbizagi.workportal.services.service.extend(\n\"bizagi.workportal.services.service\",\n{\n  /*************************************************************************************************\r\n   *          COMPONENT LOCAL DATA\r\n   *************************************************************************************************/\n  DIAGNOSTICS_COMPONENT_NAME: \"bizagi.workportal.services.service.diagnostics\",\n  DIAGNOSTICS_SYNC_AJAX_PARAMS: {\n    TYPE: \"POST\",\n    DATATYPE: \"json\" },\n\n  DIAGNOSTICS_PACKAGE_MAX_ERRORS: 15,\n  DIAGNOSTICS_PACKAGE_SYNC_INTERVAL: 60000,\n  DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB: 3,\n  DIAGNOSTICS_PACKAGE_MAX_RETRY: 3 },\n\n{\n  /*************************************************************************************************\r\n   *          CONSTRUCTOR\r\n   *************************************************************************************************/\n  init: function init(params) {\n    // Call base\n    var self = this;\n    self._super(params);\n\n    self.device = bizagi.util.detectDevice();\n\n    // flag\n    self.diagnosticsServiceEnabled = bizagi.util.isMobileErrorTracesEnabled();\n\n    if (self.diagnosticsServiceEnabled) {\n\n      // Behavior\n      self.configureDiagnosticsHandlers();\n\n      // set default variables\n      self.setDiagnosticsDefaultData();\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          LIFE CYCLE\r\n      *************************************************************************************************/\n  setDiagnosticsDefaultData: function setDiagnosticsDefaultData() {\n    var self = this;\n\n    self.lastSyncDatetime = null;\n    self.diagnosticstErrorsDb = self.getDiagnosticsDatabaseInstance();\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n  configureDiagnosticsHandlers: function configureDiagnosticsHandlers() {\n    var self = this;\n\n    // Create a interval every DIAGNOSTICS_PACKAGE_SYNC_INTERVAL seconds to call sync Diagnostics package error\n    setInterval(function () {\n      self.syncDiagnosticsError();\n    }, self.Class.DIAGNOSTICS_PACKAGE_SYNC_INTERVAL);\n  },\n\n  addDiagnosticsError: function addDiagnosticsError(error, message, source, line, stackTrace) {\n    var self = this;\n\n    var newError = self.createDiagnosticsErrorInstance(error, message, source, line, stackTrace);\n\n    if (newError) {\n      self.saveDiagnosticsErrorInDatabase(newError);\n    }\n  },\n\n  createDiagnosticsErrorInstance: function createDiagnosticsErrorInstance(error, message, source, line, stackTrace) {\n    var self = this;\n\n    if (self.validateDiagnosticsError(error)) {\n      return newError = {\n        error: error,\n        message: bizagi.util.escapeHtml(message),\n        source: source,\n        line: line,\n        stackTrace: stackTrace,\n        componentType: self.getCurrentDiagnosticsEventComponentType(),\n        queueEvents: self.getCurrentDiagnosticsEventsQueue(),\n        queueHTTP: self.getCurrentDiagnosticsHttpQueue(),\n        userAgent: window.navigator.userAgent,\n        when: bizagi.util.getCurrentDatetime(),\n        timestamp: bizagi.util.getCurrentDatetimestamp(),\n        retryCount: 0 };\n\n    } else {\n      console.log(\"ERROR: => Don't possible throw error (error is required) \", self.Class.DIAGNOSTICS_COMPONENT_NAME);\n\n      return null;\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE FUNCTIONS\r\n      *************************************************************************************************/\n  getCurrentDiagnosticsHttpQueue: function getCurrentDiagnosticsHttpQueue() {\n    return bizagi.services.ajax ? bizagi.services.ajax.mobileHttpQueue : undefined;\n  },\n\n  getCurrentDiagnosticsEventsQueue: function getCurrentDiagnosticsEventsQueue() {\n    var self = this;\n    return self.getDataservice() ? self.getDataservice().getQueueListEvents() : undefined;\n  },\n  getCurrentDiagnosticsEventComponentType: function getCurrentDiagnosticsEventComponentType() {\n    var self = this;\n    var listEvents = self.getDataservice() ? self.getDataservice().getQueueListEvents() : undefined;\n    var lastEvent = null;\n\n    if (listEvents.length > 0) {\n      lastEvent = listEvents[listEvents.length - 1];\n    }\n\n    return lastEvent ? lastEvent.componentType : undefined;\n  },\n\n  getDataservice: function getDataservice() {\n    return bizagiWorkportal.deviceFactory.workportal.dataService;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE DATABASE POUCH DB\r\n      *************************************************************************************************/\n  getDiagnosticsDatabaseInstance: function getDiagnosticsDatabaseInstance() {\n    return _typeof(bizagi.workportal.diagnostics.db) != undefined && !bizagi.util.isMashupContext() ? new bizagi.workportal.diagnostics.db() : undefined;\n  },\n\n  getDiagnosticsErrorInDatabase: function getDiagnosticsErrorInDatabase(errorId) {\n    var self = this;\n    return self.diagnosticstErrorsDb.getError(errorId);\n  },\n\n  saveDiagnosticsErrorInDatabase: function saveDiagnosticsErrorInDatabase(newError) {\n    var self = this;\n    return self.diagnosticstErrorsDb.saveError(newError.timestamp, newError);\n  },\n\n  deleteDiagnosticsErrorInDatabase: function deleteDiagnosticsErrorInDatabase(error) {\n    var self = this;\n    return self.diagnosticstErrorsDb.deleteError(error.timestamp);\n  },\n\n  deleteDiagnosticsErrorListInDatabase: function deleteDiagnosticsErrorListInDatabase(errorPackageList) {\n    var self = this;\n    var deletePromisesArray = [];\n    for (var i = 0; i < errorPackageList.length; i++) {\n      // Research Rest require name 'Message'\n      deletePromisesArray.push(self.deleteDiagnosticsErrorInDatabase(errorPackageList[i].Message));\n    }\n    return $.when.apply(deletePromisesArray);\n  },\n\n  updateOrDeleteDiagnosticsErrorInDatabase: function updateOrDeleteDiagnosticsErrorInDatabase(errorPackage) {\n    var self = this;\n\n    // Research Rest require name 'Message'\n    var updateError = errorPackage.Message;\n\n    if (updateError.retryCount >= self.Class.DIAGNOSTICS_PACKAGE_MAX_RETRY) {\n      return self.diagnosticstErrorsDb.deleteError(updateError.timestamp);\n    } else\n    {\n      updateError.retryCount = updateError.retryCount + 1;\n      return self.diagnosticstErrorsDb.saveError(updateError.timestamp, updateError);\n    }\n  },\n\n  updateOrDeleteDiagnosticsErrorListInDatabase: function updateOrDeleteDiagnosticsErrorListInDatabase(errorPackageList) {\n    var self = this;\n    var deletePromisesArray = [];\n    for (var i = 0; i < errorPackageList.length; i++) {\n      deletePromisesArray.push(self.updateOrDeleteDiagnosticsErrorInDatabase(errorPackageList[i]));\n    }\n    return $.when.apply(deletePromisesArray);\n  },\n\n  getCurrentDiagnosticsErrorList: function getCurrentDiagnosticsErrorList() {\n    var self = this;\n    return self.diagnosticstErrorsDb.getErrorsList(self.Class.DIAGNOSTICS_PACKAGE_MAX_ERRORS);\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE VALIDATIONS\r\n      *************************************************************************************************/\n  validateDiagnosticsError: function validateDiagnosticsError(error) {\n    var self = this;\n    var result = false;\n\n    if (error && self.diagnosticsServiceEnabled) {\n      result = true;\n    }\n\n    return result;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE SYNC\r\n      *************************************************************************************************/\n  syncDiagnosticsError: function syncDiagnosticsError() {\n    var self = this;\n\n    // Clean error list\n    self.getCurrentDiagnosticsErrorList().\n    then(function (currentErrorList) {\n      if (currentErrorList.length > 0) {\n        // 1st => Convert diagnostics error list to array (contains 10 errors)\n        var errorPackage = self.getDiagnosticsPackageErrors(currentErrorList);\n        // 2nd => Send error package []\n        self.sendDiagnosticsErrorPackage(errorPackage);\n      }\n    });\n  },\n\n  getDiagnosticsSystemErrorURL: function getDiagnosticsSystemErrorURL() {\n    var self = this;\n    return self.serviceLocator.getUrl(\"diagnostics-sync-system-error\");\n    //return self.control ? self.serviceLocator.getUrl(\"diagnostics-sync-system-error\") : \"http://dev-franciscomb/BizagiLog/api/ErrorLogs/Import2\";\n  },\n\n  getDiagnosticsPackageErrors: function getDiagnosticsPackageErrors(errorsList) {\n    var self = this;\n    var packageSize = 0;\n    var packageErrors = [];\n\n    for (var i = 0; i < errorsList.length && i < self.Class.DIAGNOSTICS_PACKAGE_MAX_ERRORS && packageSize < self.Class.DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB; i++) {\n\n      var currentError = errorsList[i];\n\n      var systemErrorInstance = {\n        DateTime: currentError.when,\n        Username: bizagi.currentUser.user,\n        Source: self.device,\n        Title: currentError.message,\n        Message: currentError // JSON => for security errors in workportal\n      };\n\n      var requestSize = bizagi.util.getSizeJsonObjectInMegaBytes(systemErrorInstance);\n      if (packageSize + requestSize < self.Class.DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB || packageErrors.length == 0) {\n        // Only push error when don't exceed limit size\n        packageErrors.push(systemErrorInstance);\n        // Current package size\n        packageSize = packageSize + requestSize;\n      }\n    }\n\n    return packageErrors;\n  },\n\n  sendDiagnosticsErrorPackage: function sendDiagnosticsErrorPackage(errorPackage) {\n    var self = this;\n    var dataServiceInstance = self.getDataservice();\n\n    // This is a hack for sync system errors size\n    if (dataServiceInstance && dataServiceInstance.online) {\n      var syncSystemErrorPromise = $.ajax({\n        url: self.getDiagnosticsSystemErrorURL(),\n        data: JSON.stringify(errorPackage),\n        dataType: self.Class.DIAGNOSTICS_SYNC_AJAX_PARAMS.DATATYPE,\n        type: self.Class.DIAGNOSTICS_SYNC_AJAX_PARAMS.TYPE,\n        contentType: \"application/json\",\n        avoidLoader: true });\n\n\n      $.when(syncSystemErrorPromise).\n      then(function (response) {\n        console.log('sync system error was sended <Respose>: ', response, ' <error_package>: ', errorPackage);\n        return self.deleteDiagnosticsErrorListInDatabase(errorPackage);\n      }).\n      fail(function (errorRest) {\n        console.log('sync system error was NOT sended <error_in_rest>: ', errorRest, ' <error_package>: ', errorPackage);\n        return self.updateOrDeleteDiagnosticsErrorListInDatabase(errorPackage);\n      });\n    } else\n    {\n      console.log('Error in size request => ,', self.Class.DIAGNOSTICS_COMPONENT_NAME, ' Network status => ', dataServiceInstance.online);\n    }\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\nbizagi.workportal.services.db.extend(\"bizagi.workportal.services.db\", {\n  // STATIC METHODS\n},\n{\n  // INSTANCE METHODS\n  /**\r\n   * \r\n   * @param {*} params \r\n   */\n  getTaskSyncError: function getTaskSyncError(params) {\n    var offlineId = params.idCase + \"-\" + params.idWorkitem;\n    return this.getTask(offlineId).\n    then(function (taskObject) {\n      if (!bizagi.util.isEmpty(taskObject) && !bizagi.util.isEmpty(taskObject.syncDetails)) {\n        return $.Deferred().resolve(taskObject.syncDetails).promise();\n      }\n      return $.Deferred().resolve(undefined).promise();\n    },\n    function () {\n      //Error - 404\n      return $.Deferred().resolve(undefined).promise();\n    }).\n\n    then(function (syncError) {\n      if (params.deferred) {\n        params.deferred.resolve(syncError);\n      }\n      return syncError;\n    });\n  },\n\n  getInboxSyncErrors: function getInboxSyncErrors() {\n    return this.dbActivities.allDocs({ include_docs: true }).toJqueryPromise().\n    then(function (response) {\n      var casesMap = {};\n      var casesList = $.grep(response.rows, function (item) {\n        return !bizagi.util.isEmpty(item.doc.syncStatus) && !bizagi.util.isEmpty(item.doc.syncDetails);\n      });\n\n      casesList.forEach(function (item) {\n        var doc = item.doc;\n        casesMap[item.id] = doc.syncDetails;\n      });\n      return casesMap;\n    }).\n    fail(function (err) {\n      bizagi.util.console.error(\"Error getting inbox sync errors\", err);\n      return err;\n    });\n  },\n\n  /**\r\n      * Returns all the cases with sync errors\r\n      */\n  getSyncErrorsList: function getSyncErrorsList() {\n    var errors = [];\n    var self = this;\n\n    return self.dbStartData.allDocs({\n      include_docs: true,\n      attachments: false }).\n    toJqueryPromise().\n    then(function (startCasesResponse) {\n      var startErrors = $.grep(startCasesResponse.rows, function (item) {\n        return !bizagi.util.isEmpty(item.doc.syncStatus) && !bizagi.util.isEmpty(item.doc.syncDetails);\n      });\n      errors = errors.concat(startErrors.map(function (item) {\n        item = item.doc;\n        item.offlineType = \"start\";\n        return self.serializeError(item);\n      }));\n      return self.dbActivities.allDocs({\n        include_docs: true,\n        attachments: false }).\n      toJqueryPromise();\n    }).\n    then(function (tasksCasesResponse) {\n      var tasksErrors = $.grep(tasksCasesResponse.rows, function (item) {\n        return !bizagi.util.isEmpty(item.doc.syncStatus) && !bizagi.util.isEmpty(item.doc.syncDetails);\n      });\n      errors = errors.concat(tasksErrors.map(function (item) {\n        item = item.doc;\n        item.offlineType = \"task\";\n        return self.serializeError(item);\n      }));\n      return errors;\n    }).\n    fail(function (err) {\n      bizagi.log(\"Error loading data before syncronization\");\n      return err;\n    });\n  },\n\n  /**\r\n      * Serialize the error in order to unify the response between tables\r\n      * @param {} item The start case or activity to serialize\r\n      */\n  serializeError: function serializeError(item) {\n    return {\n      radnumber: item.radNumber,\n      idcase: item.idCase,\n      idworkitem: item.workItems[0].idWorkItem,\n      errortype: item.syncDetails.type,\n      synctimestamp: item.syncDetails.timestamp,\n      activity: item.offlineType === \"task\" ? item.workItems[0].TaskName : undefined,\n      activityduedate: item.offlineType === \"task\" ? item.endDate : undefined,\n      process: item.process,\n      offlinetype: item.offlineType === \"task\" ? \"task\" : \"start\",\n      isdraft: !(item.offlineType === \"task\"),\n      syncerror: item.syncDetails,\n      state: item.offlineType === \"task\" ? item.state : undefined };\n\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n$.Class.extend(\"bizagi.workportal.services.pullWorker\", {}, {\n  init: function init(params) {\n    var self = this;\n    var queryString = bizagi.readQueryString();\n\n    self.services = params;\n    self.database = params.database;\n\n    var querydisable = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n    self.disabledb = querydisable;\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  pull: function pull() {\n    var self = this;\n    if (self.disabledb) {\n      return false;\n    }\n\n\n    var getTasksBeforePushPromise = self.services.callServiceWithNetworkRetries(self.services, self.services.getOfflineTasks, [], 5, 2000);\n    return $.when(getTasksBeforePushPromise).\n    then(function () {\n      return self.syncOfflineCases();\n    }, function (getOfflineTasksError) {\n      bizagi.util.console.log(\"Error in getOfflineTasks before to push cases\", getOfflineTasksError);\n      //Resolve the promise with sucess=true in order to don't show error message\n      return $.Deferred().resolve(true).promise();\n    });\n\n\n  },\n\n  /**\r\n      * This function send to the server the offline cases created\r\n      * @param {} argument \r\n      * @returns {} \r\n      */\n  syncOfflineCases: function syncOfflineCases(argument) {\n    var self = this;\n    if (typeof self.database !== \"undefined\") {\n      self.synchronizing = self.synchronizing || false;\n\n      if (!self.synchronizing) {\n        self.synchronizing = true;\n        self.pushInProgressPromise = new $.Deferred();\n        var syncCasesQueue = new bizagiQueue();\n        var syncStarts = self.syncOfflineStartCases(syncCasesQueue);\n        var syncTasks = self.syncOfflineTaskCases(syncCasesQueue);\n\n        $.when(syncStarts, syncTasks).\n        then(function (startToSync, tasksToSync) {\n          if (tasksToSync && tasksToSync.count > 0) {\n            var syncInProgressParams = {\n              type: \"push-tasks-started\",\n              tasks: tasksToSync.tasks || {} };\n\n            $(document).trigger(\"offline-notify-form-sync-event\", syncInProgressParams);\n          }\n          return syncCasesQueue.execute();\n        }).\n        then(function () {\n          setTimeout(function () {\n            self.synchronizing = false;\n            self.pushInProgressPromise.resolve(true);\n          }, 1000);\n        }).\n        fail(function (error) {\n          setTimeout(function () {\n            console.log(\"Error pushing cases to server with errors\", error);\n            self.synchronizing = false;\n            $(document).trigger(\"offline-notify-form-sync-event\", { type: \"push-tasks-error\", message: self.parseSyncError(error) });\n            self.pushInProgressPromise.reject(error);\n          }, 1000);\n        });\n      }\n    }\n\n    return self.pushInProgressPromise.promise();\n  },\n\n  parseSyncError: function parseSyncError(err) {\n    if (err.message) return err.message;\n    if (err.length && err.length > 0 && err[err.length - 1].result && err[err.length - 1].result.messages.length && err[err.length - 1].result.messages.length > 0) return err[err.length - 1].result.messages[0];\n    return \"Unknown error\";\n  },\n\n  syncSingleOfflineTaskCase: function syncSingleOfflineTaskCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n    params.isSingleSync = true;\n    $.when(self.database.getTaskData(params)).\n    then(function (taskData) {\n      var syncCaseParams = {\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        data: taskData.data || {},\n        type: \"task\",\n        id: params.idCase + \"-\" + params.idWorkitem,\n        syncStatus: \"started\",\n        isSingleSync: params.isSingleSync,\n        isRetry: params.isRetry === true };\n\n      return self.generateSyncCasePromise(syncCaseParams);\n    }).\n    then(function (pushResult) {\n      var downloadFormAgainPromise = new $.Deferred();\n      var shouldDownloadFormAgain = false;\n\n      if (pushResult && !pushResult.containsNext) {\n        if (pushResult && pushResult.DataChangesetVersion != undefined) {\n          $.when(self.database.getTaskForm(params)).\n          then(function (localTaskForm) {\n            localTaskForm = localTaskForm.form;\n            if (localTaskForm.DataChangesetVersion != undefined && pushResult.DataChangesetVersion > localTaskForm.DataChangesetVersion) {\n              shouldDownloadFormAgain = true;\n              pushResult.shouldRefresh = true;\n            }\n          }).\n          fail(function (error) {\n            shouldDownloadFormAgain = true;\n          }).\n          always(function () {\n            downloadFormAgainPromise.resolve(shouldDownloadFormAgain, pushResult);\n          });\n        } else\n        {\n          shouldDownloadFormAgain = true;\n          downloadFormAgainPromise.resolve(shouldDownloadFormAgain, pushResult);\n        }\n      } else\n      {\n        downloadFormAgainPromise.resolve(shouldDownloadFormAgain, pushResult);\n      }\n      return downloadFormAgainPromise.promise();\n    }).\n    then(function (shouldDownloadFormAgain, pushResult) {\n      if (shouldDownloadFormAgain) {\n        return $.when(self.services.downloadOfflineTaskForm(params)).\n        then(function (downloadResult) {\n          return pushResult;\n        });\n      } else\n      {\n        return pushResult;\n      }\n    }).\n    then(function (pushResult) {\n      def.resolve(pushResult);\n    }).\n    fail(function (syncTaskError) {\n      if (params.isRetry !== true) {\n        def.reject(syncTaskError);\n      } else\n      {\n        syncTaskError = self.services.renderDataService.parseServiceError(arguments);\n        var internalSyncError = self.services.syncService.buildSyncErrorObject(syncTaskError);\n        var errorResponse = {\n          _internalSyncError: internalSyncError,\n          message: internalSyncError != undefined && internalSyncError.message ? internalSyncError.message : undefined };\n\n        $.extend(errorResponse, syncTaskError);\n        def.reject(errorResponse);\n      }\n    });\n    return def.promise();\n  },\n\n  syncSingleOfflineStartCase: function syncSingleOfflineStartCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.database.getCase(params.idCase)).\n    then(function (newCase) {\n      var syncCaseParams = {\n        idCase: newCase.idCase,\n        data: newCase.data || {},\n        idProcess: newCase.idWorkFlow,\n        type: \"start\",\n        id: newCase.idCase,\n        syncStatus: \"started\",\n        isRetry: params.isRetry === true };\n\n      return self.generateSyncCasePromise(syncCaseParams);\n    }).\n    then(function (syncResponse) {\n      def.resolve(syncResponse);\n    }).\n    fail(function (syncCaseError) {\n      syncCaseError = self.services.renderDataService.parseServiceError(arguments);\n      var internalSyncError = self.services.syncService.buildSyncErrorObject(syncCaseError);\n      var errorResponse = {\n        _internalSyncError: internalSyncError,\n        message: internalSyncError != undefined && internalSyncError.message ? internalSyncError.message : undefined };\n\n      $.extend(errorResponse, syncCaseError);\n      def.reject(errorResponse);\n    });\n    return def.promise();\n  },\n\n  syncOfflineStartCases: function syncOfflineStartCases(synchCasesQueue) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.database.getOutboxCases()).\n    done(function (response) {\n      for (var i = 0; i < response.rows.length; i++) {\n        var newCase = response.rows[i].value;\n\n        if (newCase.syncStatus) {\n          continue;\n        }\n\n        var syncCaseParams = {\n          idCase: newCase.idCase,\n          data: newCase.data || {},\n          idProcess: newCase.idWorkFlow,\n          type: \"start\",\n          id: newCase.idCase,\n          syncStatus: \"started\" };\n\n\n        synchCasesQueue.add(self.generateSyncCasePromise(syncCaseParams));\n      }\n      def.resolve({ \"count\": response.rows.length });\n    }).\n    fail(function (err) {\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n\n  syncOfflineTaskCases: function syncOfflineTaskCases(synchCasesQueue) {\n    var def = new $.Deferred();\n    var self = this;\n    var syncStatusCriteria = \"none\";\n    self.database.getOutboxTaskCasesFilteredBySyncStatus(syncStatusCriteria, true).done(\n    function (responses) {\n      var tasks = {};\n      for (var i = 0; i < responses.length; i++) {\n        var caseData = responses[i].doc;\n        var itemId = responses[i].id;\n        var id = itemId.split('-');\n        var syncCaseParams = {\n          idCase: id[0],\n          idWorkitem: id[1],\n          data: caseData.data || {},\n          type: \"task\",\n          id: itemId,\n          syncStatus: \"started\" };\n\n        tasks[itemId] = true;\n        synchCasesQueue.add(self.generateSyncCasePromise(syncCaseParams));\n      }\n      def.resolve({ \"tasks\": tasks, \"count\": responses.length });\n    }).\n\n    fail(function (err) {\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n\n  generateSyncCasePromise: function generateSyncCasePromise(syncCaseParams) {\n    var self = this;\n    if (syncCaseParams.type === \"start\" || syncCaseParams.data && (syncCaseParams.data.h_action ||\n    syncCaseParams.data.h_actions || syncCaseParams.data.retry_h_actions)) {\n\n      return self.database.updateCaseSyncStatus(syncCaseParams).\n      then(function () {\n        var syncPromise;\n        if (syncCaseParams.type == \"start\")\n        syncPromise = self.services.syncOfflineStartCase(syncCaseParams);else\n\n        syncPromise = self.services.syncOfflineTaskCase(syncCaseParams);\n        return syncPromise;\n      });\n    } else\n    {\n      //The h_action was not specified.\n      bizagi.util.console.log(\"This case will not be synchronized. No actions found\", syncCaseParams);\n      return $.Deferred().resolve(\"This case will not be synchronized. No actions found\").promise();\n    }\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\n\nbizagi.workportal.services.db.old.extend(\"bizagi.workportal.services.db.old\", {}, {\n\n  /**\r\n                                                                                     * This method create a new case in the db to offline status\r\n                                                                                     * @param {} params \r\n                                                                                     * @returns {} promise\r\n                                                                                     */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    var idWfClass = params.idWfClass,\n    id = new Date().toISOString(),\n    def = new $.Deferred();\n\n    var offlineCase = {\n      _id: id,\n      idWfClass: idWfClass.toString(),\n      idWorkFlow: idWfClass.toString(),\n      idCase: id,\n      isFavorite: false,\n      globalId: self.globalId,\n      createdBy: {\n        Name: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n        userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n      creationDate: new Date(),\n      process: params.process || \"Offline\",\n      categoryName: params.process || params.categoryName || \"Offline\",\n      displayName: params.displayName || \"Offline\",\n      radNumber: id,\n      // closed: false,\n      isOfflineForm: true,\n      formsRenderVersion: 2,\n      syncronized: false,\n      isOpen: true,\n      workItems: [\n      {\n        idWorkItem: Math.guid(),\n        idTask: Math.guid(),\n        idCase: id,\n        colorState: \"Green\",\n        State: \"Green\",\n        TaskName: params.process || \"Offline\" }] };\n\n\n\n\n    self.dbCases.put(offlineCase, function callback(err, result) {\n      if (!err) {\n        def.resolve(offlineCase);\n      } else {\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Delete case\r\n      * @param {} params \r\n      * @returns {} promise \r\n      */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err) {\n        self.dbCases.remove(doc, function (error, response) {\n          if (!error) {\n            def.resolve(response);\n          } else {\n            bizagi.log(\"Error erasing case\");\n            def.reject(err);\n          }\n        });\n\n      } else {\n        bizagi.log(\"Error, the case do not exist\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this,\n    def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err) {\n        def.resolve(doc);\n      } else {\n\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the categories as the services if exists in the database\r\n      * @param {} data \r\n      * @returns {} promise\r\n      */\n  getCategories: function getCategories(data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (!data.enableOfflineForm) {\n      def.resolve({});\n    }\n\n    self.dbProcessHierarchy.get(self.globalId, function (err, doc) {\n      if (!err) {\n        self.categories = doc.doc;\n\n        if (data.idApp || data.idCategory) {\n          var groupCategory = getGroup(self.categories, data);\n          def.resolve({\n            category: groupCategory,\n            totalApps: data.idApp ? groupCategory.length : 0 });\n\n        } else {\n          var tempCategories = self.categories;\n          while (tempCategories.length == 1 && (\n          tempCategories[0].categories || tempCategories[0].subCategories)) {\n            tempCategories = getGroup(\n            tempCategories,\n            tempCategories[0].appId ? { idApp: tempCategories[0].appId } :\n            { idCategory: tempCategories[0].idCategory });\n\n          }\n\n          def.resolve({\n            category: tempCategories,\n            totalApps: tempCategories[0] && tempCategories[0].appId ? tempCategories.length : 0 });\n\n        }\n      } else {\n        def.reject(\"could not extract this document\");\n      }\n    });\n\n    return def.promise();\n\n    /**\r\n                           * Get the group for new cases similar to service \r\n                           * @param {} categories \r\n                           * @param {} data \r\n                           * @returns {} \r\n                           */\n    function getGroup(categories, data) {\n      for (var i = 0, len = categories.length; i < len; i++) {\n        if (categories[i].appId && categories[i].appId == data.idApp) {\n          return categories[i].categories;\n        }\n        if (categories[i].idCategory && categories[i].idCategory == data.idCategory) {\n          return categories[i].subCategories;\n        } else {\n          if (categories[i].categories) {\n            var cat = getGroup(categories[i].categories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n\n          if (categories[i].subCategories) {\n            var cat = getGroup(categories[i].subCategories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n        }\n      }\n    }\n  },\n\n  /**\r\n      * This method return all the open cases for the user authenticated from de DB\r\n      * @returns {} promise\r\n      */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbCases.query({\n      map: map },\n    {\n      reduce: false },\n    function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get case by id\r\n      * @param {} idCase \r\n      * @returns {} \r\n      */\n  getCase: function getCase(idCase) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(idCase, function (err, doc) {\n      if (!err) {\n        def.resolve(doc);\n      } else {\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    if (params.radnumber || params.radNumber) {\n      params[\"radNumber\"] = params.radnumber ? params.radnumber : params.radNumber;\n    }\n\n    if (params.idcase || params.idCase) {\n      params[\"radNumber\"] = params.idcase ? params.idcase : params.idCase;\n    }\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.globalId, doc);\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber)) {\n            var localCase = {\n              id: resp.rows[i].id,\n              idWFClass: resp.rows[i].idWFClass,\n              idWorkFlow: resp.rows[i].id,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isOfflineForm: true,\n              fields: [\n              {\n                Value: resp.rows[i].value.process,\n                DisplayName: resp.rows[i].value.process,\n                DataType: \"VarChar\",\n                isRadNumber: false },\n              {\n                Value: resp.rows[i].value.creationDate,\n                DisplayName: \"Process creation date\",\n                DataType: \"DateTime\",\n                isRadNumber: false }] };\n\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local data base\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n  getAllProcesses: function getAllProcesses(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (typeof params.inputtray === \"undefined\") {\n      params.inputtray = true;\n    }\n\n    // params.inputtry: draft | outbox | inbox disable\n    var response = {\n      \"workflows\": {\n        \"taskstate\": \"\",\n        \"workflow\": [] } };\n\n\n\n    //Reduce and rereduce functions search in http://docs.couchdb.org/en/latest/ddocs.html#view-functions\n    var queryFun = {\n      map: function map(doc) {\n        //Trae los documentos del usuario segun el filtro de all, o si estan en favorites etc\n        if (doc.idWfClass && doc.globalId) {\n          emit({\n            idWf: doc.idWfClass,\n            gId: doc.globalId,\n            isOpen: doc.isOpen.toString() },\n          1);\n        }\n      },\n      reduce: \"_count\" };\n\n\n    self.dbProcessHierarchy.get(self.globalId, function (err, doc) {\n      if (!err) {\n\n        self.dbCases.query(queryFun, {\n          reduce: true },\n        function (error, resp) {\n          if (!error) {\n            for (var i = 0, len = resp.total_rows; i < len; i++) {\n              if (resp.rows[i].key.gId == self.globalId && resp.rows[i].key.isOpen == params.inputtray.toString()) {\n                // Revisar si es necesario agregar aqui el parametro\n                var cat = self.getHierarchyObjects(doc, \"idCategory\", resp.rows[i].key.idWf);\n                response.isOpen = params.inputtray;\n                response.workflows.workflow.push({\n                  category: \"Offline Procesess\",\n                  name: cat[0] ? cat[0].categoryName : \"\",\n                  idworkflow: resp.rows[i].key.idWf,\n                  count: resp.rows[i].value,\n                  isFavorite: false });\n\n              }\n            };\n            def.resolve(JSON.stringify(response));\n          } else {\n            def.reject(\"error\");\n          }\n        });\n      } else {\n        def.reject(\"error\");\n      }\n    });\n    return def.promise();\n  },\n\n  getOutboxCases: function getOutboxCases() {\n    // body\n    var self = this;\n    var def = new $.Deferred();\n\n    var queryFun = {\n      map: function map(doc) {\n        // Get the user documents according to filter all, or if its are in favorites etc.\n        if (!doc.isOpen) {\n          //  emit({ idWfClass: doc.idWfClass, isOpen: doc.isOpen.toString() }, doc);\n          emit(doc.globalId, doc);\n        }\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n\n    function (err, doc) {\n      if (!err) {\n        def.resolve(doc);\n      } else {\n        bizagi.log(\"Error loading data before syncronization\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {}  Returns a promise\r\n      *  Struct: [\r\n      *   idCase, idWorkItem, idTask,\r\n      *   dueDate, processName, activityName,\r\n      *   customzedColumns: [key, value],\r\n      *   isOfflineForm, isOpen\r\n      * ]\r\n      */\n  getCasesList: function getCasesList(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"page\": 1,\n      \"totalPages\": 1,\n      \"elements\": [] };\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.globalId, doc);\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          resp.rows[i].value.radNumber.toString().indexOf(params.radNumber.toString()) != -1)) {\n\n            var localCase = [\n            resp.rows[i].value.idCase,\n            resp.rows[i].value.workItems[0][\"idWorkItem\"][0] || \"\",\n            resp.rows[i].value.workItems[0][\"idTask\"][0] || \"\",\n            resp.rows[i].value.creationDate,\n            resp.rows[i].value.categoryName,\n            resp.rows[i].value.displayName,\n            [\n            [\"Case No\", resp.rows[i].value.idCase],\n            [\"Process\", resp.rows[i].value.process],\n            [\"Process creation date\", bizagi.util.formatDateTime(resp.rows[i].value.creationDate)]],\n\n            resp.rows[i].value.isOfflineForm,\n            resp.rows[i].value.isOpen];\n\n\n            cases.elements.push(localCase);\n          }\n        }\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n  /*\r\n     *   This method return the cases created offline by idWorkflow\r\n     *   Returns a promise\r\n     */\n  getCustomizedColumnsNewData: function getCustomizedColumnsNewData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.globalId, doc);\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber)) {\n            var localCase = {\n              id: resp.rows[i].value.idCase,\n              idWFClass: resp.rows[i].value.idWfClass,\n              idWorkFlow: resp.rows[i].value.idWorkFlow,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isAborted: false,\n              isOfflineForm: true,\n              fields: [\n              resp.rows[i].value.idCase,\n              resp.rows[i].value.process,\n              {\n                \"workitems\": resp.rows[i].value.workItems },\n\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate),\n              \"\",\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate)] };\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get recent processes\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    var deferred = new $.Deferred();\n    var recent = { \"processes\": [] };\n\n    if (!self.recentProcesses) {\n      self.dbProcessRecent.get(self.globalId, function (error, doc) {\n        if (!error) {\n          self.recentProcesses = doc.doc;\n          deferred.resolve(self.recentProcesses);\n        } else {\n          bizagi.log(\"Could not extract this document\");\n          deferred.reject(error);\n        }\n      });\n    } else {\n      deferred.resolve(self.recentProcesses);\n    }\n\n    return deferred.promise();\n  } });","/*\r\n*   Name: BizAgi Database Plugin\r\n*   Author: oscaro\r\n*   Comments:\r\n*   -   This script creates a plugin to handler oll db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\nbizagi.workportal.services.db.old.extend(\"bizagi.workportal.services.db.old\", {}, {\n\n  /**\r\n                                                                                     * This method return the form for a new case to offline status\r\n                                                                                     * @param {} idWFClass\r\n                                                                                     * @returns {} Returns a promise\r\n                                                                                     */\n  getFormData: function getFormData(idWFClass) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbForms.get(idWFClass + \"-\" + idWFClass + \"-\" + self.globalId, function (err, doc) {\n      if (!err) {\n        if (typeof doc.form !== \"undefined\") {\n          setTimeout(function () {\n            def.resolve({ form: doc.form, type: \"form\" });\n          }, 300);\n        } else {\n          var responseText = {\n            errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n            message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n          def.reject(JSON.stringify(responseText));\n        }\n      } else {\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * This method merge the form and the data to result form\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  mergeForm: function mergeForm(doc, form) {\n\n    var self = this;\n    var def = new $.Deferred();\n\n    $.when(form).done(function (form) {\n      if (!doc.data) {\n        def.resolve(form);\n      } else {var\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        fillForm = function fillForm(element, data) {\n          if (element.length && element.length > 0) {\n            for (var i = 0, len = element.length; i < len; i++) {\n              fillForm(element[i], data);\n            }\n          } else {\n            if (element.container) {\n              fillForm(element.container.elements, data);\n            } else {\n              // If it case is in outbox or closed, make all renders in the form not editable\n              if (!doc.isOpen) {\n                element.render.properties.editable = false;\n              }\n\n              if (element.render.properties.xpath == data.key) {\n                if (element.render.properties.type === \"grid\") {\n                  self.setRenderGridValues(element.render);\n                }\n                self.setRenderValues(element.render.properties, data.value);\n              }\n\n            }\n          }\n        }; // If it case is in outbox or closed, hide buttons in the form\n        if (!doc.isOpen) {form.form.buttons = [];if (Object.keys(doc.data).length === 0) {fillForm(form.form.elements, { key: \"read-only-form\", value: \"\" });}}for (prop in doc.data) {fillForm(form.form.elements, { key: prop, value: doc.data[prop] });}\n        def.resolve(form);\n      }\n    }).fail(function (cause) {\n      if (!cause.responseText)\n      var responseText = {\n        errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n        message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n      cause.responseText = JSON.stringify(responseText);\n\n      def.reject(cause);\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Set render Grid values\r\n      * @param {} render\r\n      * @returns {}\r\n      */\n  setRenderGridValues: function setRenderGridValues(render) {\n    render.properties.data.columns = [];\n    for (var i = 0, length = render.elements.length; i < length; i++) {\n      render.properties.data.columns.push(render.elements[i].render.properties.xpath);\n    }\n  },\n\n  /**\r\n      * This function sets the type of each xpath\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  setDataType: function setDataType(doc, form) {\n\n  },\n\n  /**\r\n      *  This method return the categories like the services if exists in the database\r\n      * @param {} params\r\n      * @param {} data\r\n      * @returns {} Returns a promise\r\n      */\n  setRenderValues: function setRenderValues(params, data) {\n    var type = params.type;\n\n    if (!type) type = \"label\";\n\n    var typeGroupBasic = [\"text\", \"label\", \"number\", \"money\", \"date\", \"boolean\", \"geolocation\", \"hidden\", \"upload\"];\n    var typeGroupCombo = [\"combo\", \"cascadingCombo\", \"radio\", \"list\"];\n\n    if (typeGroupBasic.indexOf(type) !== -1) {\n      params.value = data.value;\n      return;\n    }\n\n    if (typeGroupCombo.indexOf(type) !== -1) {\n      for (var i = 0, len = params.data.length; i < len; i++) {\n        if (params.data[i].id == data.value) {\n          params.value = [{ id: data.value, value: params.data[i].value }];\n        }\n      }\n\n      return;\n    }\n\n    if (type === \"search\") {\n      for (var j = 0, lengthData = params.data.length; j < lengthData; j++) {\n        if (params.data[j].id == data.value.id) {\n          params.value = data.value;\n        }\n      }\n      return;\n    }\n\n    if (type === \"image\") {\n      params.value = data;\n      return;\n    }\n\n    if (type === \"grid\") {\n      params.data.records = data.value.length;\n      params.data.total = 1;\n      params.data.page = 1;\n\n      var lengthColumns = params.data.columns.length;\n      var tmpEditAndVisible = [];\n      var lengthRows = data.value.length;\n\n      for (var row = 0; row < lengthRows; row++) {\n        // Add random value\n        var idRow = bizagi.util.randomNumber();\n\n        var tmpElement = [];\n        var tempRow = [];\n\n        tmpElement[tmpElement.length] = idRow;\n\n        for (var col = 0; col < lengthColumns; col++) {\n          var index = typeof data.value[row][col] !== \"undefined\" ? params.data.columns.indexOf(data.value[row][col].xpath) : -1;\n\n          if (index != -1) {\n            tempRow[index] = data.value[row][col];\n          }\n\n          tempRow[col] = typeof tempRow[col] === \"undefined\" ? {} : tempRow[col];\n          tmpElement[tmpElement.length] = \"true\";\n        }\n\n        params.data.rows.push($.merge([idRow], tempRow));\n        tmpEditAndVisible[tmpEditAndVisible.length] = tmpElement;\n      }\n\n      params.data.editable = tmpEditAndVisible;\n      params.data.visible = tmpEditAndVisible;\n\n      return;\n    }\n\n    // No type supported\n    try {\n      params.value = data.value;\n    } catch (e) {\n    }\n\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  },\n\n  /**\r\n      * This method simulate a summary response\r\n      * @param {} params\r\n      * @returns {} Returns a promise\r\n      */\n  getSummary: function getSummary(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err)\n      def.resolve($.extend(doc, {\n        processPath: \"/\",\n        currentState: doc.workItems,\n        countAssigness: 0,\n        countEvents: 0,\n        isOpen: doc.isOpen.toString(),\n        countSubProcesses: 0 }));else\n\n\n      def.reject(err);\n    });\n\n    return def.promise();\n  },\n\n  /*\r\n     *   This method save the form info in the DB\r\n     *   Returns a promise\r\n     */\n  saveFormInfo: function saveFormInfo(params, data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err) {\n        self.mergeDataDocument(data, doc, self.getFormData(doc.idWfClass.toString())).\n        done(function (resp) {\n\n          doc = self.mergeData(data, doc, resp);\n\n          self.dbCases.put(doc, function (error, response) {\n            if (!error)\n            def.resolve(response);else\n\n            def.reject(error);\n          });\n        });\n\n      } else {\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  mergeDataDocument: function mergeDataDocument(data, doc, form) {\n    var defer = new $.Deferred();\n    var response = {};\n\n    $.when(form).done(function (resp) {\n\n      for (prop in data) {\n        if (prop != \"h_action\") {\n          response[prop] = {};\n          response[prop].value = data[prop];\n          fillForm(resp.form.elements, {\n            key: prop,\n            value: data[prop] });\n\n        }\n      }\n\n      function fillForm(element, datafill) {\n        if (element.length && element.length > 0) {\n          for (var i = 0, len = element.length; i < len; i++) {\n            fillForm(element[i], datafill);\n          }\n        } else {\n          if (element.container) {\n            fillForm(element.container.elements, datafill);\n          } else {\n            if (element.render.properties.xpath == datafill.key) {\n              response[datafill.key].DataType = element.render.properties.dataType || \"\";\n              response[datafill.key].type = element.render.properties.type || \"\";\n\n              // Remove empty object of the Collection\n              if (!bizagi.util.isEmpty(response[datafill.key])) {\n                var lengthRows = response[datafill.key].value.length;\n\n                for (var row = 0; row < lengthRows; row++) {\n                  if (!bizagi.util.isEmpty(response[datafill.key].value[row])) {\n\n                    if (response[datafill.key].type === \"image\") {\n                      var url = response[datafill.key].value[row] || \"\";\n\n                      response[datafill.key].value = url.replace(/^data:.*;base64,/, \"\");\n                    } else {\n                      var tempDataColumn = [];\n                      var lengthCols = response[datafill.key].value[row].length;\n\n                      for (var col = 0; col < lengthCols; col++) {\n                        if (!bizagi.util.isEmpty(response[datafill.key].value[row][col])) {\n                          tempDataColumn.push(response[datafill.key].value[row][col]);\n                        }\n                      }\n\n                      response[datafill.key].value[row] = tempDataColumn;\n                    }\n                  }\n                }\n              }\n            }\n\n          }\n        }\n      }\n\n      defer.resolve(response);\n    });\n\n    return defer.promise();\n  },\n\n  mergeData: function mergeData(data, doc, resp) {\n\n    if (data.h_action == \"next\") {\n      doc.isOpen = false;\n    }\n\n    doc.data = doc.data || {};\n\n    for (var i in resp) {\n\n      var assigned = false;\n\n      for (var j in doc.data) {\n\n        if (i == j) {\n\n          if (bizagi.util.isEmpty(resp[i]) || bizagi.util.isEmpty(resp[i].value)) {\n            delete doc.data[j];\n            assigned = true;\n          } else {\n            doc.data[j] = resp[i];\n            assigned = true;\n          }\n        }\n      }\n\n      if (!assigned) {\n        doc.data[i] = resp[i];\n      }\n    }\n\n    return doc;\n\n  },\n\n  nativeSaveFormInfo: function nativeSaveFormInfo(data, doc, form) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.mergeDataDocument(data, doc, form).\n    done(function (resp) {\n      doc = self.mergeData(data, doc, resp);\n      def.resolve(doc);\n    });\n\n    return def.promise();\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n$.Class.extend(\"bizagi.workportal.services.pullWorker.old\", {}, {\n  init: function init(params) {\n    var self = this;\n    var queryString = bizagi.readQueryString();\n\n    self.services = params;\n    self.database = params.database;\n\n    var querydisable = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n    self.disabledb = querydisable;\n\n    if (!self.disabledb) {\n      self.dbForms = new PouchDB(\"DataRenderForms\");\n      self.dbCases = new PouchDB(\"DataRenderCases\");\n      self.dbProcessHierarchy = new PouchDB(\"DataProcessesHierarchy\");\n      self.dbProcessRecent = new PouchDB(\"DataProcessesRecent\");\n    }\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    BIZAGI_USER.toLowerCase() + \"-\" + BIZAGI_PROXY_PREFIX.\n    toLowerCase() + \"-\" + BIZAGI_DOMAIN.toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  pull: function pull() {\n    var self = this;\n\n    if (self.disabledb) {\n      return false;\n    }\n\n    return $.when(self.syncOfflineCases()).\n    done(function () {\n      return true;\n    });\n  },\n\n  /**\r\n      * This function send to the server the offline cases created\r\n      * @param {} argument \r\n      * @returns {} \r\n      */\n  syncOfflineCases: function syncOfflineCases(argument) {\n    var self = this;\n\n    if (typeof self.database !== \"undefined\") {\n      self.synchronizing = self.synchronizing || false;\n\n      if (!self.synchronizing) {\n        self.synchronizing = true;\n        return self.database.getOutboxCases().done(function (response) {\n          var array_cases = [];\n          for (var i = 0; i < response.total_rows; i++) {\n            var obj = response.rows[i].value;\n            var objToSend = [];\n            for (var item in obj.data) {\n              if (item != \"h_action\") {\n                objToSend.push({\n                  \"domain\": typeof BIZAGI_DOMAIN !== \"undefined\" ? BIZAGI_DOMAIN : \"domain\",\n                  \"user\": typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n                  \"xpath\": item,\n                  \"value\": self.processDataValues(obj.data[item].value, obj.data[item].type),\n                  \"DataType\": obj.data[item].DataType,\n                  \"type\": obj.data[item].type });\n\n              }\n            }\n\n            obj = $.extend(obj, { \"objToSend\": objToSend });\n\n            // idWfClass\n            array_cases.push(\n            self.services.syncOfflineCases(obj).pipe(\n            function (rta) {\n              var formData = decodeURIComponent(this.data).split('&');\n              for (var i = formData.length - 1; i >= 0; i--) {\n                var pivot = formData[i].split(\"=\");\n                if (pivot[0] == \"idCase\") {\n                  return self.database.deleteCase({\n                    idCase: pivot[1] });\n\n                }\n              }\n              // When it returns \"yes\" then remove the case of database\n            }, function (fail) {\n              bizagi.log(fail);\n            }));\n\n\n          }\n\n          return $.when.apply($, array_cases).pipe(function () {\n            // Show message to successfully synchronization\n            self.synchronizing = false;\n            return true;\n          });\n        });\n      }\n    }\n  },\n\n  processDataValues: function processDataValues(data, fileType) {\n    var self = this;\n    if ($.type(data) == \"array\" && fileType == \"upload\") {\n\n      for (var i = 0; i < data.length; i++) {\n        data[i] = data[i].filter(function (element) {\n          return element[\"xpath\"] != \"mimeType\";\n        });\n      }\n\n      return data;\n    }\n\n    if ($.type(data) == \"object\") {\n      // For search\n      if (data.hasOwnProperty(\"id\")) {\n        data = data.id;\n      }\n    }\n\n    if (fileType == \"grid\") {\n      for (var rowPos = 0; rowPos < data.length; rowPos++) {\n        var row = data[rowPos];\n        for (var cellPos = 0; cellPos < row.length; cellPos++) {\n          var cell = row[cellPos];\n          cell.value = self.processDataValues(cell.value);\n        }\n      }\n    }\n\n    return data;\n  } });","/*\r\n*   Name: BizAgi Rendering Services\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {}, {\n  /* \r\n                                                                                      *   Constructor\r\n                                                                                      */\n  init: function init(params) {\n    // Call base\n    var self = this;\n\n    if (params && typeof params.oldOfflineServicesAlreadyEnabled != \"undefined\") {\n      params.oldOfflineServicesAlreadyEnabled = !bizagi.util.isOfflineFormsV2Supported();\n    }\n\n    self._super(params);\n\n    // Create instance of database services\n    if (!bizagi.util.isOfflineFormsV2Supported()) {\n      if (typeof bizagi.workportal.services.db.old !== \"undefined\") {\n        self.database = new bizagi.workportal.services.db.old();\n      }\n      self.enableOfflineEvents();\n    }\n  },\n\n  enableOfflineEvents: function enableOfflineEvents() {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      self._super();\n    } else\n    {\n      if (bizagi.util.isTabletDevice()) {\n        if (typeof navigator.connection != \"undefined\") {\n          if (typeof Connection !== \"undefined\" && (\n          navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")) {\n            self.online = false;\n          } else\n          {\n            self.online = true;\n          }\n        } else\n        {\n          var queryString = bizagi.readQueryString();\n          var queryoffline = queryString && queryString[\"online\"] ? eval(queryString[\"online\"]) : true;\n          self.online = queryoffline;\n        }\n\n        $(document).off(\"online.services\");\n        $(document).on(\"online.services\", function () {\n          self.online = true;\n          bizagi.log(\"online.services\");\n          self.returnOnlineStatus();\n        });\n\n        $(document).off(\"offline.services\");\n        $(document).on(\"offline.services\", function () {\n          bizagi.log(\"offline.services\");\n          self.online = false;\n        });\n\n      }\n\n      // Execute this trigger in render on next event        \n      $(document).off(\"tryPushData.offline\");\n      $(document).on(\"tryPushData.offline\", function (e) {\n        if (self.online) {\n          self.pushOfflineData();\n        }\n      });\n    }\n  },\n\n  returnOnlineStatus: function returnOnlineStatus() {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      this._super();\n    } else\n    {\n      var self = this;\n      $.when(self.logoutUser()).always(function () {\n        $.when(self.authenticatedUser()).always(function () {\n          $.when(self.pushOfflineData()).always(function (pushStatus) {\n            self.fetchOfflineData(pushStatus);\n          });\n        });\n      });\n    }\n  },\n\n  /*\r\n     * Get all data from server : new case structure, forms data\r\n     */\n  fetchOfflineData: function fetchOfflineData(v2Param) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      this._super(v2Param);\n    } else\n    if (bizagi.util.hasOfflineFormsEnabled()) {\n      var synObject = new bizagi.workportal.services.fetchWorker.old(this);\n      var message = \"\";\n\n      $.when(synObject.fetch()).done(function (data) {\n        bizagi.log(\"Sync Completed\");\n        if (bizagi.util.isTabletDevice()) {\n          message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-successful\") ?\n          bizagi.localization.getResource(\"workportal-mobile-offline-sync-successful\") :\n          \"Successful Synchronization\";\n\n          bizagi.util.showNotification({ text: message, type: \"success\" }); // Localizar texto\n        }\n      }).fail(function (data) {\n        bizagi.log(\"Sync Failed\");\n\n        if (bizagi.util.isTabletDevice()) {\n          if (data !== 0) {\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-fail\") ?\n            bizagi.localization.getResource(\"workportal-mobile-offline-sync-fail\") :\n            \"Failed Synchronization\";\n            bizagi.util.showNotification({ text: message, type: \"error\" });\n          }\n        }\n      });\n    }\n  },\n\n  /*\r\n     * put all data to server : new case structure, forms data\r\n     */\n  pushOfflineData: function pushOfflineData() {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super();\n    } else\n    if (bizagi.util.hasOfflineFormsEnabled()) {\n      var self = this;\n      var pullObject = new bizagi.workportal.services.pullWorker.old(this);\n      return $.when(pullObject.pull()).\n      then(function (data) {\n        bizagi.log(\"Offline cases syncronized, all data sended\");\n      }, function (cause) {\n        bizagi.log(\"Error syncronizing cases\");\n      });\n    }\n  },\n\n  /*\r\n      * this function send to the server the offline cases created\r\n      */\n  syncOfflineCases: function syncOfflineCases(params) {\n    var self = this;\n    return $.ajax({\n      url: self.serviceLocator.getUrl('offline-sendForm'),\n      data: {\n        idCase: params.idCase,\n        idWFClass: params.idWfClass,\n        awCaseCreationContext: JSON.stringify(params.objToSend),\n        idWorkflow: params.idWfClass },\n\n      type: 'POST',\n      dataType: 'json',\n      serviceType: 'LOAD' });\n\n  },\n\n  /*\r\n     * Retreives Form structure + Form data\r\n     *\r\n     */\n  processesHierarchyTofetchForms: function processesHierarchyTofetchForms(params) {\n    var self = this;\n    var data = {};\n    data['idChangeSet'] = params.changeSet;\n    return $.ajax({\n      url: self.serviceLocator.getUrl('offline-getForms'),\n      data: data,\n      dataType: 'json' });\n\n  },\n\n  /*\r\n     *   Gets the current working user\r\n     */\n  getCurrentUser: function getCurrentUser(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(params);\n    } else\n    {\n      var self = this;\n\n      if (self.online) {\n        return self._super(params);\n      } else\n      {\n        var defer = new $.Deferred();\n\n        // Call ajax and returns promise\n        // save this response in the local storage and get when offline\n        var data = {\n          idUser: 1,\n          user: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n          userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n          domain: typeof BIZAGI_DOMAIN !== \"undefined\" ? BIZAGI_DOMAIN : \"domain\",\n          delegateUserName: \"\",\n          idDelegateUser: -1,\n          groupSeparator: \",\",\n          language: \"en-US\",\n          decimalSeparator: \".\",\n          decimalDigits: \"2\",\n          symbol: \"$\",\n          ShortDateFormat: \"M/d/yyyy\",\n          TimeFormat: \"h:mm tt\",\n          LongDateFormat: \"dddd, MMMM d, yyyy\",\n          twoDigitYearMax: 2029,\n          twoDigitYearMaxDelta: 13,\n          uploadMaxFileSize: \"1048576\",\n          isMultiOrganization: \"false\",\n          associatedStakeholders: [],\n          sUserProperties: [] };\n\n\n        defer.resolve(data);\n\n        return defer.promise();\n      }\n    }\n  },\n\n  /*\r\n     *   Return all the available processes in bizagi\r\n     */\n  getAllProcesses: function getAllProcesses(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(params);\n    } else\n    {\n      var self = this;\n      params.inputtray = params.inputtray || \"inbox\";\n      if (params.inputtray == \"inbox\") {\n        return self._super(params);\n      } else\n      {\n        return $.when(self.database.getAllProcesses(params)).pipe(function (response) {\n          response = JSON.parse(response);\n          // Aggrupate workflows by categories\n          if (!!params.skipAggrupate)\n          return response;\n          var responseData = {};\n          var categories = {};\n          var allProcesses = bizagi.localization.getResource(\"workportal-widget-inbox-all-processes\");\n          var allCases = {\n            name: bizagi.localization.getResource(\"workportal-widget-inbox-all-cases\"),\n            path: \"\",\n            category: allProcesses,\n            isFavorite: params.onlyFavorites || false,\n            guidFavorite: \"\",\n            idworkflow: \"\",\n            guidWFClass: \"\",\n            count: 0 };\n\n\n          // Create a default category\n          categories[allProcesses] = [];\n          categories[allProcesses].workflows = [];\n          categories[allProcesses].workflows.push(allCases);\n          if (response.workflows) {\n            $.each(response.workflows.workflow, function (i, workflow) {\n              // Creates the category if it doesn't exist\n              if (!categories[workflow.category]) {\n                categories[workflow.category] = [];\n                categories[workflow.category].workflows = [];\n              }\n\n              // Push the workflow\n              categories[workflow.category].workflows.push(workflow);\n\n              // Sum the cases count                        \n              allCases.count += Number(workflow.count);\n            });\n          }\n\n          // Build result array once grouped\n          responseData.categories = [];\n          for (key in categories) {\n            responseData.categories.push({\n              name: key,\n              workflows: categories[key].workflows });\n\n          }\n          return responseData;\n        });\n\n      }\n    }\n  },\n  /*\r\n     *   Returns all the cases for the current user filtered by a workflow\r\n     */\n  getCasesByWorkflow: function getCasesByWorkflow(params) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(params);\n    } else\n    {\n      params.inputtray = params.inputtray || \"inbox\";\n\n      if (params.inputtray === \"inbox\") {\n        if (self.online) {\n          return self._super(params);\n        } else\n        {\n          var deferred = new $.Deferred();\n\n          var cases = {\n            \"rows\": [],\n            \"totalPages\": 0,\n            \"page\": 1,\n            \"lstIdCases\": [] };\n\n\n          deferred.resolve(cases);\n          return deferred.promise();\n        }\n      } else\n      {\n        var defer = new $.Deferred();\n        $.when(self.database.getCustomizedColumnsData(params)).pipe(function (response) {\n          response = JSON.parse(response);\n          $.each(response.cases.rows, function (key, value) {\n            var newFieldsValue = [];\n\n            //  Set id of case to radnumber\n            response.cases.rows[key][\"radnumber\"] = value.id;\n            $.each(value.fields, function (fieldsKey, fieldsValue) {\n              // when delete element from fields array, each function lose key value\n              if (fieldsValue != undefined) {\n                // Radnumber\n                try {\n                  if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == \"true\") {\n                    response.cases.rows[key][\"radnumber\"] = fieldsValue.Value;\n                  } else if (fieldsValue.workitems != undefined) {\n                    response.cases.rows[key][\"workitems\"] = fieldsValue.workitems;\n                  } else {\n                    newFieldsValue.push(fieldsValue);\n                  }\n                } catch (e) {\n                }\n              }\n            });\n\n            // Update Fields \n            response.cases.rows[key]['fields'] = newFieldsValue;\n          });\n          defer.resolve(response.cases);\n        });\n        return defer.promise();\n      }\n    }\n  },\n  /*\r\n     *  Get Menu Authorization\r\n     */\n  getMenuAuthorization: function getMenuAuthorization() {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super();\n    } else\n    {\n      var self = this;\n\n      if (self.online) {\n        return self._super();\n      } else {\n        // Call ajax and returns promise\n        var defer = new $.Deferred();\n        var data = {\n          \"permissions\": [\n          { \"Cases\": [\"NewCase\", \"Pending\", \"Closed\", \"Search\"] },\n          {\n            \"AnalysisReports\": [\n            \"BAMProcess\", \"BAMTask\", \"AnalyticsProcess\", \"AnalyticsTask\", \"AnalyticsSensor\",\n            \"AnalysisQueries\", \"BAMResourceMonitor\"] },\n\n          {\n            \"Admin\": [\n            \"UserAdmin\", \"Licenses\", \"EntityAdmin\", \"CaseAdmin\", \"AlarmAdmin\", \"EncryptionAdmin\",\n            \"MobileUpdatesAdmin\", \"AsynchronousWorkitemRetries\", \"UserPendingRequests\",\n            \"AuthenticationLogQuery\", \"BusinessPolicies\", \"Profiles\", \"UserDefaultAssignation\",\n            \"GRDimensionAdmin\", \"ThemeBuilder\"] },\n\n          { \"CurrentUserAdministration\": [\"CurrentUser\"] }, { \"LogOut\": [] }, { \"Search\": [] },\n          { \"SmartFolders\": [] }, { \"CustomFolders\": [] }, { \"BizagiQueries\": [] }, { \"AnalysisQueries\": [] },\n          { \"StateLog\": [] }, { \"PrintableVersion\": [] }] };\n\n\n\n        defer.resolve(data);\n\n        return defer.promise();\n      }\n    }\n  },\n  /*\r\n     *   Gets the inbox summary for the current logged user\r\n     *   Returns a promise of the data being retrieved\r\n     */\n  getInboxSummary: function getInboxSummary(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super();\n    } else\n    {\n      var self = this;\n      var enableDefaultMethod = self.online;\n      if (params && (params.inputtray == \"false\" || params.inputtray == \"true\")) {\n        enableDefaultMethod = false;\n      }\n      if (enableDefaultMethod) {\n        return self._super(params);\n      } else {\n        // Call ajax and returns promise\n        var defer = new $.Deferred();\n        $.when('{\"inboxSummary\":{\"Red\":7,\"Yellow\":0,\"Green\":0,\"Black\":0,\"All\":7}}').pipe(function (response) {\n          var data = JSON.parse(response);\n          defer.resolve(data[\"inboxSummary\"]);\n        });\n        return defer.promise();\n      }\n    }\n  },\n  /*\r\n     *   Returns the available categories filtered by a parent category\r\n     *   If not parent category is sent, it will return the base categories\r\n     */\n  getCategories: function getCategories(params) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(params);\n    } else\n    {\n      if (self.online) {\n        return self._super(params);\n      } else\n      {\n        // Define data\n        params = params || {};\n        var data = {};\n\n        // Required params\n        if (params.idCategory)\n        data[\"idCategory\"] = params.idCategory;\n        if (params.idApp)\n        data[\"idApp\"] = params.idApp;\n\n        data[\"enableOfflineForm\"] = params.enableOfflineForm || false;\n\n\n        data[\"groupByApp\"] = params.groupByApp || false;\n\n        // Call ajax and returns promise\n        return self.database.getCategories(data);\n      }\n    }\n  },\n\n  /* \r\n     * CREATE NEW CASES\r\n     */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      return self.database.createNewCase(params);\n    }\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getCase !== \"undefined\") {\n        return self.getNativeWorkItems(params);\n      } else\n      {\n        return self.database.getWorkitems(params);\n      }\n    }\n  },\n\n  getNativeWorkItems: function getNativeWorkItems(params) {\n    var defer = new $.Deferred();\n\n    bizagiapp.getCase(params.idCase, function (response) {\n\n      var workItems = JSON.parse(response);\n\n      defer.resolve(workItems);\n\n    }, function (response) {\n      defer.reject(response);\n    });\n\n    return defer.promise();\n  },\n\n  getCaseSummary: function getCaseSummary(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      return self.database.getSummary(params);\n    }\n  },\n\n  /*\r\n     *   Delete offline cases created localy\r\n     *   return a promise\r\n     */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(params);\n    } else\n    {\n      return self.database.deleteCase(params);\n    }\n  },\n\n  /*\r\n     *   Get subprocesses\r\n     *   return a promise\r\n     */\n  getCaseSubprocesses: function getCaseSubprocesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n      defer.resolve({ subProcesses: [] });\n      return defer.promise();\n    }\n  },\n\n  /**\r\n     * This service get all overrides keys within configuration project\r\n     *\r\n     * @return {json}\r\n     */\n  getOverrides: function getOverrides() {\n    return {};\n  },\n\n  /**\r\n      * Return all the available cases in bizagi and thinking for mobile response\r\n      * @param {} params: inputtray:  inbox | outbox (false) | drafts (true)\r\n      * @returns {} \r\n      */\n  getCasesListBeta: function getCasesListBeta(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(params);\n    } else\n    {\n      var self = this;\n      params = params || {};\n\n      params.inputtray = params.inputtray || \"inbox\";\n\n      if (params.inputtray === \"inbox\" || params.inputtray == \"outbox-finished\") {\n        if (self.online && params.inputtray === \"inbox\") {\n          return self._super(params);\n        } else {\n          var deferred = new $.Deferred();\n\n          var response = { \"page\": 1, \"totalPages\": 1, \"elements\": [] };\n          deferred.resolve(response);\n\n          return deferred.promise();\n        }\n      } else\n      {\n        var defer = new $.Deferred();\n        $.when(self.database.getCasesList(params)).\n        pipe(function (response) {\n          response = JSON.parse(response);\n\n          var taskFeedData = self.getTaskFeedData(response);\n\n          defer.resolve(taskFeedData);\n        });\n\n        return defer.promise();\n      }\n    }\n  },\n\n  getMobileCasesList: function getMobileCasesList(params) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported() || params.inputtray === \"inbox\") {\n      return self._super(params);\n    } else\n    {\n      return getCasesListBeta(params);\n    }\n  },\n\n  /*\r\n     * Customize Columns\r\n     */\n  getTaskFeedData: function getTaskFeedData(response) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(response);\n    } else\n    {\n      var overdue = bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n      var today = bizagi.localization.getResource(\"workportal-taskfeed-today\");\n      var tomorrow = bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n      var upcoming = bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n\n      var groupedData = {\n        elements: [],\n        page: response.page,\n        totalPages: response.totalPages,\n        advanceSearch: false };\n\n\n      var actualDate = new Date();\n      var actualMonth = actualDate.getMonth();\n      var actualDay = actualDate.getDate();\n      var actualYear = actualDate.getFullYear();\n\n      for (var counter = 0; response.elements.length > counter; counter++) {\n        var tmpElement = response.elements[counter];\n        var status = {};\n\n        var originalEndDate = tmpElement[3];\n\n        if (tmpElement[3] !== \"\") {\n          var tmpdate = new Date(tmpElement[3]);\n          var tmpDay = tmpdate.getDate();\n          var tmpMonth = tmpdate.getMonth();\n          var tmpYear = tmpdate.getFullYear();\n          var dateDiff = new Date(tmpYear, tmpMonth, tmpDay, 0, 0, 0) -\n          new Date(actualYear, actualMonth, actualDay, 0, 0, 0);\n\n          if (dateDiff < 0) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]),\n            \"MMMM dd | hh:mm tt\");\n            status = { group: \"1|\" + overdue, state: \"red\", type: \"overdue\", icon: \"overdue\" };\n          } else {\n            if (actualMonth === tmpMonth && actualDay === tmpDay) {\n              tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n\n              // Define if the case is overdue\n              if (tmpdate.getTime() < actualDate.getTime()) {\n                status = {\n                  group: \"2|\" + today + \", \" +\n                  bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"),\n                  state: \"red\",\n                  type: \"today\",\n                  icon: \"overdue\" };\n\n              } else {\n                status = {\n                  group: \"2|\" + today + \", \" +\n                  bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"),\n                  state: \"yellow\",\n                  type: \"today\",\n                  icon: \"ontime\" };\n\n              }\n            } else if (actualMonth === tmpMonth && actualDay + 1 === tmpDay) {\n              tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n              status = {\n                group: \"3|\" + tomorrow + \", \" +\n                bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd\"),\n                state: \"yellow\",\n                type: \"tomorrow\",\n                icon: \"ontime\" };\n\n            } else {\n              tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd | hh:mm tt\");\n              status = { group: \"4|\" + upcoming, state: \"green\", type: \"upcoming\", icon: \"upcoming\" };\n            }\n          }\n        } else {\n          tmpElement[3] = \"--\";\n          status = { group: \"1|\" + overdue, state: \"red\", type: \"overdue\", icon: \"overdue\" };\n        }\n\n        groupedData.elements.push($.extend({}, tmpElement, status,\n        { \"endDate\": originalEndDate, \"idworkitem\": tmpElement[1] }));\n      }\n\n      return groupedData;\n    }\n  },\n\n  /*\r\n     * Render Details\r\n     * @param idWorkitem\r\n     */\n  summaryCaseDetails: function summaryCaseDetails(options) {\n    var self = this;\n    var params = options || {};\n\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else {\n      var def = $.Deferred();\n      var idWorkitem = options[\"idWorkitem\"] || 0;\n\n      $.when(self.getCaseSummaryDataContent(options)).\n      done(function (data) {\n\n        data.currentState = data.currentState || [];\n        var dataCurrentStateLength = data.currentState.length;\n\n        // Show or hide tabs\n        data[\"showEvents\"] = data[\"countEvents\"] >= 1 ? true : false;\n        data[\"showParentProcess\"] = data[\"idParentCase\"] >= 1 ? true : false;\n        data[\"parentProcess\"] = {\n          'displayName': data[\"parentDisplayName\"],\n          'idCase': data[\"idParentCase\"] };\n\n\n        data[\"isClosed\"] = data[\"isOpen\"] == \"true\" ? false : true;\n        data[\"showAssignees\"] = data[\"countAssigness\"] >= 1 ? true : false;\n        data[\"showSubProcess\"] = data[\"countSubProcesses\"] >= 1 ? true : false;\n        data[\"showForm\"] = data[\"hasGlobalForm\"] == \"true\" ? true : false;\n        data[\"allowsReassign\"] = \"false\";\n\n        for (var i = 0; i < dataCurrentStateLength; i++) {\n          if (data[\"currentState\"][i][\"idWorkItem\"] == idWorkitem) {\n            data[\"allowsReassign\"] = data[\"currentState\"][i][\"allowsReassign\"];\n          }\n        }\n\n        // edit original data, no show events in activities tab\n        var currentStateTypes = [];\n        var m = 0; // counter for new activities array\n        for (var j = 0; j < data[\"currentState\"].length; j++) {\n          if (data[\"currentState\"][j][\"isEvent\"] == \"false\" &&\n          data[\"currentState\"][j][\"assignToCurrentUser\"] == \"true\" &&\n          data[\"currentState\"][j][\"idWorkItem\"] != idWorkitem) {\n            currentStateTypes[m++] = data[\"currentState\"][j];\n          }\n        }\n\n        data[\"currentStateTypes\"] = currentStateTypes;\n        data[\"showActivities\"] = currentStateTypes.length >= 1 ? true : false;\n\n        def.resolve(data);\n      });\n\n      return def.promise();\n    }\n  },\n\n  /**\r\n     *  Get json from cases service\r\n     */\n  getCaseSummaryDataContent: function getCaseSummaryDataContent(options) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(options);\n    } else\n    {\n      var promise = new $.Deferred();\n\n      $.when(self.getCaseSummary(options)).\n      done(function (data) {\n        // Completes data\n        data.taskState = self.icoTaskState;\n        data.process = data.process ? data.process : \"\";\n\n        if (data.createdBy) {\n          data.createdByName = data.createdBy.Name;\n          data.createdByUserName = data.createdBy.userName;\n          data.caseDescription = data.caseDescription == '' ? '' : data.caseDescription;\n          data.processPath = data.processPath.replace(/\\//g, ' > ') + data.process;\n          data.showWorkOnIt = true;\n        }\n\n        promise.resolve(data);\n      });\n      return promise.promise();\n    }\n  },\n\n  /*\r\n     *   Returns the data for the inbox grid view\r\n     */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (bizagi.util.isOfflineFormsV2Supported() || params.inputtray === \"inbox\") {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n\n      $.when(self.database.getCustomizedColumnsNewData(params)).\n      pipe(function (response) {\n        defer.resolve(JSON.parse(response));\n      });\n\n      return defer.promise();\n    }\n  },\n  /*\r\n     *   Returns the recent process\r\n     */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      return self.database.getRecentProcesses(params);\n    }\n  },\n\n  /*\r\n     *   Start process in BizAgi\r\n     */\n  startProcess: function startProcess(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n\n      var data = {\n        hasStartForm: false,\n        idProcess: params.idProcess,\n        displayName: params.displayName,\n        caseInfo: {} };\n\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  },\n\n  /**\r\n      * Get stakeholder shortCurts\r\n      * @param {} params \r\n      * @returns {} \r\n      */\n  getShortCuts: function getShortCuts(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n      var data = [];\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  },\n\n  /**\r\n      * Returns the available list of searches\r\n      * @returns {} \r\n      */\n  getSearchLists: function getSearchLists() {\n    var self = this;\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super();\n    } else\n    {\n      var defer = new $.Deferred();\n      var data = [];\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  },\n\n  /**\r\n      * Get the icon of a given collection\r\n      * @param params\r\n      */\n  getCollectionIcon: function getCollectionIcon(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n      var data = [];\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  } });","/**\r\n* Routing service\r\n*\r\n* @author Edward J Morales\r\n* @description This class has been created based on jira story DRAGON-4943\r\n*/\n\nbizagi.workportal.services.routing.extend(\"bizagi.workportal.services.routing\", {}, {\n  /**\r\n                                                                                      * Main method\r\n                                                                                      *\r\n                                                                                      * @param params <object> json with parameters to route\r\n                                                                                      * @return object deferred\r\n                                                                                      */\n  init: function init(args) {\n    this._super(args);\n  },\n\n  /**\r\n     * Define the next route to take\r\n     * @param params object\r\n     * @return deferred with specific path\r\n     */\n  getRoute: function getRoute(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    // Params Override\n    self.params = params ? params : self.params;\n\n    if (typeof params.offlineAction !== \"undefined\" && (params.offlineAction === \"next\" || params.offlineAction === \"nextWithoutValidations\")) {\n      var routeWithoutData = self.routeToGlobalFormWithoutData();\n      $.extend(routeWithoutData.moduleParams, params);\n      bizagi.loading.stop();\n      return $.Deferred().resolve(routeWithoutData).promise();\n    } else\n    {\n      return self._super(params);\n    }\n  } });","/*\r\n*   Name: BizAgi Diagnostisc Dabase Plugin\r\n*   Author: Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handle Mobile diagnostics db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\nbizagi.workportal.diagnostics = bizagi.workportal.diagnostics || {};\n$.Class.extend(\"bizagi.workportal.diagnostics.db\", {}, {\n  /**\r\n                                                          * Constructor\r\n                                                          */\n  init: function init() {\n    this.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n    this.createDatabases();\n  },\n\n  /**\r\n      * Create all the tables required\r\n      */\n  createDatabases: function createDatabases() {\n    var globalIdHash = this.globalId.hashCode();\n    this.dbErrors = new PouchDB(\"Diag_Errors_\" + globalIdHash, { auto_compaction: true });\n  },\n\n  /**\r\n      * Destroy all databases\r\n      * Returns a promise that is resolved when all databases were successfully destroyed\r\n      */\n  deleteDatabases: function deleteDatabases() {\n    var deferred = $.Deferred();\n    var databases = [\n    this.dbErrors];\n\n\n    var deletedDatabasesCount = 0;\n    var destroyCallback = function destroyCallback(err, info) {\n      if (err) {\n        deferred.reject(err);\n      } else\n      {\n        deletedDatabasesCount++;\n        if (deletedDatabasesCount == databases.length) {\n          deferred.resolve();\n        }\n      }\n    };\n\n    databases.forEach(function (currentDatabase) {\n      currentDatabase.destroy(destroyCallback);\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Destroy an recreate empty tables\r\n      */\n  restartDatabases: function restartDatabases() {\n    var self;\n    return self.deleteDatabases().\n    always(function () {\n      self.createDatabases();\n    });\n  } });","/**\r\n * Extension for bizagi.workportal.diagnostics.db\r\n * All the functionalities related with diagnostics errors in db\r\n */\n\nbizagi.workportal.diagnostics.db.extend(\"bizagi.workportal.diagnostics.db\", {}, {\n\n  /**\r\n                                                                                   * Save an error with their correct id\r\n                                                                                   * @param {*} id \r\n                                                                                   * @param {*} error \r\n                                                                                   */\n  saveError: function saveError(id, error) {\n    try {\n      error = JSON.parse(JSON.stringify(error));\n      error._id = \"\" + id;\n      return bizagi.util.db.saveDocument(this.dbErrors, error);\n    }\n    catch (e) {\n      bizagi.util.console.error(this.Class.fullName + \": Error parsing the error object\", e, error);\n    }\n\n  },\n\n  /**\r\n      * Get an error by their id\r\n      * @param {} id \r\n      */\n  getError: function getError(id) {\n    return bizagi.util.db.getDocument(this.dbErrors, \"\" + id);\n  },\n\n  getErrorsList: function getErrorsList(maxErrors) {\n    var getErrorsQuery = {\n      map: function map(error) {\n        if (error.timestamp) {\n          emit(error.timestamp);\n        }\n      } };\n\n\n    var queryArgs = {\n      include_docs: true,\n      limit: maxErrors,\n      conflicts: false,\n      descending: false };\n\n\n    return bizagi.util.db.executeQuery(this.dbErrors, getErrorsQuery, queryArgs).\n    then(function (queryRes) {\n      return queryRes.rows.map(function (row) {\n        if (row.doc) {\n          delete row.doc._id;\n          delete row.doc._rev;\n        }\n        return row.doc;\n      });\n    });\n  },\n\n  /**\r\n      * Delete an error by their id\r\n      * @param {*} id \r\n      */\n  deleteError: function deleteError(id) {\n    return bizagi.util.db.deleteDocument(this.dbErrors, \"\" + id);\n  } });","/**\r\n *   Name:   Bizagi diagnostics service\r\n *   Author: Bryan Alejandro Cubillos Prieto\r\n *   Date:   09/21/2020\r\n *   Comments:\r\n *   =>      This is a new service for Bizagi diagnostics observer, required for centralized behavior\r\n */\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {\n\n  /*************************************************************************************************\r\n                                                                                   *          COMPONENT LOCAL DATA\r\n                                                                                   *************************************************************************************************/\n  DIAGNOSTICS_OBSERVER_COMPONENT_NAME: 'bizagi.workportal.services.service.diagnostics.observer',\n  DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED: document.body,\n  DIAGNOSTICS_OBSERVER_MAX_EVENTS_IN_QUEUE: 10,\n  DIAGNOSTICS_OBSERVER_MAX_PATH_EVENT: 5,\n  DIAGNOSTICS_OBSERVER_OBSERVER_OPTIONS: {\n    attributes: true,\n    childList: true,\n    characterData: true,\n    subtree: true },\n\n  DIAGNOSTICS_OBSERVER_MAX_SIZE_HTML_EVENT_MB: 1,\n  DIAGNOSTICS_OBSERVER_COMPONENT_TYPES: {\n    FORM: 'form',\n    DISCUSSIONS: 'discussions',\n    ACTION_SHEET: 'action-sheet',\n    FILES: 'files',\n    MAIN_MENU: 'main-menu',\n    SUMMARY_CASE: 'summary-case' } },\n\n{\n  /*************************************************************************************************\r\n   *          CONSTRUCTOR\r\n   *************************************************************************************************/\n  init: function init(params) {\n\n    // Call base\n    var self = this;\n    self._super(params);\n\n    // flag\n    self.diagnosticsServiceEnabled = bizagi.util.isMobileErrorTracesEnabled();\n\n    if (self.diagnosticsServiceEnabled) {\n\n      // set default variables\n      self.setDiagnosticsObserverDefaultData();\n\n      // Behavior\n      self.configureDiagnosticsObserverHandlers();\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          LIFE CYCLE\r\n      *************************************************************************************************/\n  setDiagnosticsObserverDefaultData: function setDiagnosticsObserverDefaultData() {\n    var self = this;\n    self.diagnosticsObserverEventsQueue = [];\n    self.MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n  configureDiagnosticsObserverHandlers: function configureDiagnosticsObserverHandlers() {\n    var self = this;\n\n    // Is required to get the first avents before DOM is ready\n    self.setTouchEndObserver();\n\n    // Observer\n    self.eventsObserver();\n  },\n\n  setTouchEndObserver: function setTouchEndObserver() {\n    var self = this;\n    window.ontouchend = null;\n    window.ontouchend = function (element) {\n      self.addDiagnosticsObsercerEvent(self.getEventObject(element));\n    };\n  },\n\n  eventsObserver: function eventsObserver() {\n    var self = this;\n\n    $(self.Class.DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED).ready(function () {\n      var observer = new self.MutationObserver(function () {\n        self.setTouchEndObserver();\n      });\n      observer.observe(self.Class.DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED, self.Class.DIAGNOSTICS_OBSERVER_OBSERVER_OPTIONS);\n    });\n  },\n\n  getQueueListEvents: function getQueueListEvents() {\n    var self = this;\n    return self.diagnosticsObserverEventsQueue;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE FUNCTIONS\r\n      *************************************************************************************************/\n  getEventObject: function getEventObject(element) {\n    var self = this;\n    return {\n      type: element.type,\n      componentType: element.composedPath ? self.getDiagnosticsElementComponentType(element.composedPath()) : undefined,\n      dateTime: bizagi.util.getCurrentDatetime(),\n      srcElement: element.composedPath ? self.getDiagnosticsElementPath(element.composedPath()) : undefined };\n\n  },\n\n  addDiagnosticsObsercerEvent: function addDiagnosticsObsercerEvent(element) {\n    var self = this;\n    if (self.diagnosticsObserverEventsQueue.length >= self.Class.DIAGNOSTICS_OBSERVER_MAX_EVENTS_IN_QUEUE) {\n      self.diagnosticsObserverEventsQueue.shift();\n    }\n    self.diagnosticsObserverEventsQueue.push(element);\n  },\n\n  getDataservice: function getDataservice() {\n    return bizagiWorkportal.deviceFactory.workportal.dataService;\n  },\n\n  getDiagnosticsElementPath: function getDiagnosticsElementPath(sourcePath) {\n    var self = this;\n    var pathList = [];\n\n    for (j = 0; j < sourcePath.length && j < self.Class.DIAGNOSTICS_OBSERVER_MAX_PATH_EVENT; j++) {\n\n      var parent = $(sourcePath[j]);\n\n      var parentProperties = {\n        id: parent.prop(\"id\"),\n        \"class\": parent.prop(\"class\"),\n        text: parent.prop(\"innerText\") };\n\n\n      pathList.push(parentProperties);\n    }\n\n    // This is a hack for size html events\n    var sizeEventHtml = bizagi.util.getSizeJsonObjectInMegaBytes(pathList);\n\n    return sizeEventHtml < self.Class.DIAGNOSTICS_OBSERVER_MAX_SIZE_HTML_EVENT_MB ? pathList : [];\n  },\n\n  getDiagnosticsElementComponentType: function getDiagnosticsElementComponentType(sourcePath) {\n    var self = this;\n    var validateElement = self.validateDiagnosticsIfContainsElement;\n\n    for (j = 0; j < sourcePath.length; j++) {\n      var parent = $(sourcePath[j]);\n\n      var type = self.getDiagnosticsElementComponentTypeByClass(parent);\n      if (type) {\n        return type;\n      }\n\n      type = self.getDiagnosticsElementComponentTypeById(parent);\n      if (type) {\n        return type;\n      }\n\n      if (self.validateDiagnosticsKendoView(parent) && validateElement('>div.km-content', parent)) {\n        if (validateElement('>div.km-content >div.bz-form', parent)) {\n          return self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FORM;\n        } else if (validateElement('>div.km-content div.bz-wp-box-discussion', parent) || validateElement('>div.km-content div.ui-bz-wp-discussions-box-main', parent)) {\n          return self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.DISCUSSIONS;\n        } else if (validateElement('>div.km-content div.bz-wp-box-files', parent)) {\n          return self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FILES;\n        }\n      }\n    }\n\n    return bizagi.util.getLastProcessInboxInputTray();\n  },\n\n  getDiagnosticsElementComponentTypeByClass: function getDiagnosticsElementComponentTypeByClass(parent) {\n    var self = this;\n    var type = undefined;\n\n    if (parent.hasClass(\"bz-form\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FORM;\n    } else if (parent.hasClass(\"summary-case\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.SUMMARY_CASE;\n    } else if (parent.hasClass(\"bz-action-sheet\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.ACTION_SHEET;\n    } else if (parent.hasClass(\"bz-wp-box-discussion\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.DISCUSSIONS;\n    } else if (parent.hasClass(\"bz-wp-box-files\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FILES;\n    } else if (parent.hasClass(\"menu-content\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.MAIN_MENU;\n    }\n    return type;\n  },\n\n  getDiagnosticsElementComponentTypeById: function getDiagnosticsElementComponentTypeById(parent) {\n    var self = this;\n    var type = undefined;\n\n    if (parent.attr('id') == 'summary-case') {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.SUMMARY_CASE;\n    } else if (parent.attr('id') == 'menu-content') {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.MAIN_MENU;\n    }\n    return type;\n  },\n\n  validateDiagnosticsKendoView: function validateDiagnosticsKendoView(parent) {\n    return parent.hasClass(\"km-view\") && parent.attr(\"data-role\") == 'view';\n  },\n\n  validateDiagnosticsIfContainsElement: function validateDiagnosticsIfContainsElement(element, parent) {\n    return $(element, parent).length > 0;\n  } });","/**\r\n *   Name:   Bizagi diagnostics service\r\n *   Author: Bryan Alejandro Cubillos Prieto\r\n *   Date:   09/25/2020\r\n *   Comments:\r\n *   =>      This is a new service base for Bizagi diagnostics, required for centralized behavior\r\n */\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {\n\n  /*************************************************************************************************\r\n                                                                                   *          COMPONENT LOCAL DATA\r\n                                                                                   *************************************************************************************************/\n  DIAGNOSTICS_COMPONENT_NAME: 'bizagi.workportal.services.service.diagnostics.error.observer',\n  DIAGNOSTICS_WAIT_APPLICATION_STARTED: 45000 },\n{\n\n  /*************************************************************************************************\r\n   *          CONSTRUCTOR\r\n   *************************************************************************************************/\n  init: function init(params) {\n\n    // Call base\n    var self = this;\n    self._super(params);\n\n    // flag\n    self.diagnosticsServiceEnabled = bizagi.util.isMobileErrorTracesEnabled();\n    if (self.diagnosticsServiceEnabled) {\n\n      // Behavior\n      self.configureDiagnosticsErrorObserverHandlers();\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n  configureDiagnosticsErrorObserverHandlers: function configureDiagnosticsErrorObserverHandlers() {\n    var self = this;\n\n    // for catch any error in jQuery\n    window.onerror = function (message, source, line, col, error) {\n      self.sendDiagnosticsError(error, message, source, line);\n    };\n\n    // for read any error in ajax\n    setTimeout(function () {\n      self.getErrorsInAjaxImplementation();\n    }, self.Class.DIAGNOSTICS_WAIT_APPLICATION_STARTED);\n  },\n\n  sendDiagnosticsError: function sendDiagnosticsError(error, message, source, line) {\n    var self = this;\n    var dataserviceInstance = self.getDataservice();\n\n    // for collect all error when application don't already start\n    if (dataserviceInstance && dataserviceInstance.diagnosticstErrorsDb != undefined) {\n      dataserviceInstance.addDiagnosticsError(error, message, source, line);\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE FUNCTIONS\r\n      *************************************************************************************************/\n  getDataservice: function getDataservice() {\n    return bizagiWorkportal.deviceFactory.workportal.dataService;\n  },\n\n  getJqueryAjax: function getJqueryAjax() {\n    return bizagi.services.ajax;\n  },\n\n  getErrorsInAjaxImplementation: function getErrorsInAjaxImplementation() {\n    var self = this;\n    var ajaxInstance = self.getJqueryAjax();\n\n    if (ajaxInstance && ajaxInstance.mobileHttpErrorsQueue && ajaxInstance.mobileHttpErrorsQueue.length > 0) {\n      for (var i = 0; i < ajaxInstance.mobileHttpErrorsQueue.length; i++) {\n        self.sendDiagnosticsError(ajaxInstance.mobileHttpErrorsQueue[i]);\n      }\n    }\n  } });"]}