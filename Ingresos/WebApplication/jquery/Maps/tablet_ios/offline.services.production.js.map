{"version":3,"sources":["jquery/rendering/js/services/bizagi.render.services.service.js","jquery/rendering/js/services/bizagi.render.services.multiactionservice.js","jquery/offline/js/services/database/bizagi.clientdb.js","jquery/rendering/js/services/bizagi.render.services.endPoints.js","jquery/rendering/js/services/bizagi.render.services.context.js","jquery/offline/js/services/bizagi.render.services.service.offline.js","jquery/offline/js/services/bizagi.file.services.service.offline.js","jquery/offline/js/services/bizagi.sync.services.service.offline.js","jquery/offline/js/services/bizagi.grid.services.service.offline.js","jquery/offline/js/services/bizagi.form.services.service.offline.js","jquery/rendering/js/services/bizagi.render.services.metadataMultiactionservice.js","jquery/offline/js/services/database/bizagi.clientdb.cases.js","jquery/offline/js/services/database/bizagi.clientdb.forms.js","jquery/offline/js/services/database/bizagi.clientdb.fetchWorker.js","jquery/offline.old/js/services/database/bizagi.clientdb.js","jquery/offline.old/js/services/database/bizagi.clientdb.fetchWorker.js","jquery/workportalflat/common/services/bizagi.workportal.services.endPoints.js","jquery/workportalflat/common/services/bizagi.workportal.services.service.js","jquery/offline/js/services/bizagi.workportal.services.service.offline.js","jquery/bizagidiagnostics/mobile/js/services/bizagi.workportal.services.service.diagnostics.js","jquery/offline/js/services/database/bizagi.clientdb.syncErrors.js","jquery/offline/js/services/database/bizagi.clientdb.pullWorker.js","jquery/offline.old/js/services/database/bizagi.clientdb.cases.js","jquery/offline.old/js/services/database/bizagi.clientdb.forms.js","jquery/offline.old/js/services/database/bizagi.clientdb.pullWorker.js","jquery/workportalflat/common/services/bizagi.workportal.services.context.js","jquery/offline.old/js/services/bizagi.workportal.services.service.offline.js","jquery/bizagidiagnostics/mobile/js/database/bizagi.workportal.diagnostics.db.js","jquery/bizagidiagnostics/mobile/js/database/bizagi.workportal.diagnostics.db.errors.js","jquery/bizagidiagnostics/mobile/js/services/bizagi.workportal.services.service.diagnostics.event.observer.js","jquery/bizagidiagnostics/mobile/js/services/bizagi.workportal.services.service.diagnostics.error.observer.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","bizagi","render","services","endPoints","getEndPoints","params","renderHandlerPathRest","context","form-get-data","proxyPrefix","form-submit-data","form-submit-data-upload","render-property-refresh","render-multiaction","render-upload-cancel-image","render-upload-data-url","render-upload-add-url","render-upload-delete-url","render-ecm-upload-url","render-multiaction-metadata","render-grid-edit-url","render-grid-save-url","render-grid-add-url","render-grid-rollback-url","render-grid-commit-url","render-grid-checkpoint-url","render-save-entity","render-stakeholder-associated","render-search-default-image","render-search-form-get-data","render-search-advanced-url","render-letter-notEditable-url","render-letter-content-url","render-letter-save-url","render-letter-content-icons","render-userfield-definition","render-document-generate","render-document-generateAllDocuments","render-processes-startform","render-processes-getstartform","render-entity-layout-image64","render-entity-layout-imageByteArray","getXSRFToken","render-entity-layout-upload-files","render-query-getUsersList","case-handler-getCaseSummary","case-handler-getCaseSummaryByGuid","case-handler-getCaseAssignees","case-handler-getWorkItems","case-handler-getWorkItemsByGuid","admin-getUsersList","admin-getUsersList-FromPreferences","admin-getUsersList-ForStakeholders","admin-getUsersList-ForXpathIdBossUser","admin-getUsersList-ForXpathIdDelegate","admin-getUsersForAssignation","admin-users-config","admin-usersform","admin-GenerateDataToSendByEmail","admin-sendUserEmail","sharepointProxyPrefix","alert","$","Class","extend","init","this","util","isEmpty","getUrl","service","setProxyPrefix","BA_ACTION_PARAMETER_PREFIX","BA_CONTEXT_PARAMETER_PREFIX","BA_PAGE_CACHE","BA_MULTIACTION_WITH_LIMIT_NUMBER","BA_MULTIACTION_WITH_LIMIT_QUEUE","serviceLocator","multiactionService","multiactionservice","multiactionServiceWithLimit","guid","Math","override","enableECMMetadataMultiaction","multiactionMetadataService","metadatamultiactionservice","userfieldRequests","deviceType","isSmartphoneDevice","deviceEnum","smartphone","isTabletDevice","tablet","desktop","deviceCode","getDeviceCode","multiaction","multiactionWithLimit","metadataECMMultiaction","getFormData","data","action","idProcess","idForm","idEntity","surrogateKey","idRender","xpathContext","requestedForm","recordXPath","summaryForm","idCase","idWorkitem","idTask","idPageCache","contextType","guidEntity","isRefresh","isActionStartForm","additionalXpaths","idStartScope","readOnlyForm","printversion","recordXpath","downloadOfflineForm","editable","prepare","chrono","initAndStart","ajaxParams","url","type","dataType","serviceType","avoidLoader","ajax","pipe","response","stopAndLog","form","properties","transformGridDataToReadOnly","_data","hasOwnProperty","id","allowAdd","allowDelete","allowEdit","allowGrouping","allowMore","allowSearch","each","key","value","e","getSearchFormData","xpath","idSearchForm","processDataValues","o","submitData","resolveData","contexttype","transitions","surrogatekey","forcePlanCompletion","actionType","toString","toUpperCase","debug","beforeSend","xhr","status","renderingService","name","newName","isEmptyObject","search","substr","getPropertyData","extra","property","sessionId","guidentity","pxpath","prows","ppage","undefined","pfilter","psort","porder","pcaseId","pguidEntity","psurrogatedKey","pactionXpath","ptemplateGuid","pparameters","multiactionConnection","push","getData","getSearchData","term","getCollapseData","collapseState","getGridData","sort","order","page","rows","searchFilter","getGridDataExclusivesSelected","xpathfilter","getUploadCancelImage","pathToBase","getUploadFileUrl","fileId","verifyPathToBase","jQuery","param","downloadFile","self","fileUrl","queue","processData","then","binary_file","readFileAsJSON","arguments","contentType","getResponseHeader","media","byteArrayToBlob","stringToByteArray","def","Deferred","reader","FileReader","onloadend","reject","responseText","result","readAsText","promise","binary","getUploadFileEntityUrl","isContextContainerWidgetRender","xpathActions","getUploadAddUrl","getUploadAddFileUrl","isUserPreferences","deleteImage","deleteUploadFile","getECMMetadata","idFileUpload","xPath","idAttrib","interceptor","intercept","source","checkOutFile","cancelCheckOut","deleteECMFile","updateECMFileContent","metaValues","updateECMMetadata","getFileProperties","getFile","uploadECMFile","fileUpload","fileName","getECMFileUrl","p_sessionId","isFileOnECM","idUpload","read","editGridRecord","addGridRecord","addGridRecordData","saveGridRecord","disableServerGridValidations","deleteGridRecord","getFlipAssociation","flipstate","parseJSON","rollbackGridAction","getSearchDefaultImage","processDataCriteria","criteria","submitSearch","JSON","encode","allowFullSearch","maxRecords","associateStakeholder","associatedUser","refreshAssociateStakeholder","getLetterNotEditableUrl","getLetterContent","getCanGenerateLetter","saveLetterContent","content","fullUrl","getLetterEditorIconsPath","executeButton","getFilePrintUrl","disposition","editLinkForm","saveLinkForm","rollbackLinkForm","commitLinkForm","commitGridAction","sendCheckpoint","sendCheckpointAction","getUserfieldDefinition","userfield","guidUserfield","device","refreshControl","refreshGridCell","column","typeRender","executeRule","rule","create","executeInterface","executeSAPConnector","guidsap","executeConnector","guidConnector","executePipeline","pipeline","generateDocumentTemplate","append","h_pageCacheId","contextXpath","xpathcontext","groupMappingId","groupMapping","xpathAttribute","controlId","getAllDocumentsDownloadUrl","idWorkItem","getCaseNumber","replace","isMobile","getCaseAssignees","getWorkitems","onlyUserWorkItems","getGridExportUrl","exportType","sendEmail","to","subject","message","selected","invalidatePageCache","getUsersList","getUsersListFromQueryForm","getUsersListFromPreferences","getUsersListForXpathIdBossUser","getUsersListForXpathIdDelegate","getUsersListForStakeholders","getUsersForAssignation","getUsersForm","generateDataToSendByEmail","sendUserEmail","eMailTo","body","getConfiguration","indexOf","getTemplate","forcePersonalizedColumns","templateType","templateGuid","isDefaultTemplate","detectDevice","hasStartForm","guidWFClass","getStartForm","guidprocess","surrogatedKey","mappingstakeholders","cache","editActionForm","getActions","extendParams","ptags","pmaxitems","executeActions","pguidConstructor","pguidAction","getPolymorphicActions","serializePolymorphicActions","values","actions","getParents","node","parents","fillTree","list","children","getChildren","child","displayName","hasConstructor","guidObject","guidConstructor","length","getEntityImage64","width","height","entity","getFilesDataForLayoutUploadControl","processUploadFile","verifyMobilePathToBase","formData","isMashupContext","replaceAll","_super","database","gridService","grid","renderDataService","fileService","file","syncService","sync","formService","getFileService","getSyncService","getGridService","getFormService","isOfflineForm","workitemstate","online","alreadyMarkedAsActive","isNativePluginSupported","bizagiapp","getNativeFormData","getFormDataFromNative","mergeForm","offlineType","isEdited","isOpen","when","getTaskData","syncStatus","syncError","hasSyncError","formPromise","getTaskForm","mergeDataDocument","done","complexData","object","mergedForm","resolve","getCase","idWfClass","trim","getOfflineImage","fileType","getActivityImage","getStartDataImage","getOfflineActivityDataImage","fileFormat","getActivityDataImage","saveOfflineImage","image","operationType","saveActivityFormImage","saveActivityDataImage","saveStartDataImage","saveOfflineFile","mimeType","saveActivityFormFile","saveActivityDataFile","saveStartDataFile","getOfflineFile","getActivityFile","getStartDataFile","getOfflineActivityDataFile","getActivityDataFile","caseInfo","parse","error","toLowerCase","saveNativeFormInfo","sanityDataForSaveInDB","saveTaskData","saveStartData","deferreds","nativesaveStartData","doc","saveFormData","removeStartCaseSyncError","updatedStartCase","startCase","syncDetails","saveStartCase","removeTaskCaseSyncError","updatedTaskCase","offlineId","getTask","taskCase","saveTask","taskData","h_action","retry_h_actions","parseServiceError","callbackArguments","stringError","internalError","errorType","stringify","parsingError","loaders","isLoading","setLoading","internalBuildOfflineFileLoadingKey","clearLoading","EMPTY_IMAGE","control","buildOfflineFileLoadingKey","getFormContainer","getParams","downloadFormImages","imageControls","filterXpathsByTypeMap","columnImage","signature","promises","forEach","imageControl","buildOfflineImageId","localFiles","downloadImage","isVersion2OrSuperior","compatibilityVersion","getPropertyDataParams","renderId","pageCacheId","downloadImageVersion2","downloadImageVersion1","getUploadFileUrlParams","bulkDownload","ensureImageIsPersistedLocally","always","counter","console","log","getOfflineImageParams","loadImageFromForm","invokeAgain","db","AttachmentType","Blob","blob","sleepFor","base64Image","saveParams","downloadFormFiles","upload","columnUpload","downloadFilesInUploadControl","Array","apply","convertUploadOnlineValueInOfflineValue","uploadControl","isArray","singleFileValue","fullXpath","downloadSingleFile","downloadBinaryFile","binaryFile","getFileUrlParams","uploadFormImages","imageValues","uploadImage","uploadFormGridImages","imagesByRow","entityMap","rowKeys","Object","keys","k","row","imagesKeys","l","imageInfo","isNew","newKey","gridXpath","buildCellXpathFilter","columnXpath","uploadParams","addParams","buildAddParamsForUpload","uploadFileName","randomNumber","uploadKey","uploadAddUrl","FormData","item","isSignature","b64toBlob","resp","fail","uploadAndDeleteFormFiles","uploadValues","uploadControlValue","uploadAndDeleteFiles","uploadFormGridFiles","filesByRow","filesKeys","fileInfo","deleteActions","files","fileMimeType","uploadFile","deleteParams","deleteAction","deleteFile","attachmentId","blobFile","uploadFileParams","uploadBinaryFile","res","getFileParams","isNumeric","isStartForm","isEmptyValue","getOfflineImageName","forceChange","changeOfflineImageName","imageName","resolveBlobFromPath","path","blobPromise","isCordovaSupported","isAndroidDevice","getImagePath","normalizeIOSFilePath","errorHandler","window","resolveLocalFileSystemURL","fileEntry","readAsArrayBuffer","BIZAGI_SESSION_NAME","queueID","encodeXpath","logKey","syncTraces","getCurrentSyncStep","currentStep","setCurrentSyncStep","step","stepParameters","trace","traceAlreadyAdded","steps","addSyncStepResponse","stepName","stepResponse","stepObject","find","warn","addCurrentSyncStepResponse","clearTrace","printTrace","traceLogKey","stepIndex","printAndClearTrace","setTimeout","syncOfflineStartCase","serverResponse","loadFormParams","separateComplexControls","separatedCaseData","formId","performSyncOfflineCase","performSyncResponse","updateSyncStatusError","syncOfflineTaskCase","sData","gridActions","collectedFormActions","gridPromises","createCheckpoint","checkpointResponse","processGridRecords","gridActionsResponse","parseGridAdditionsResponse","processUploads","processMultiAction","processMultiactionresponse","lastAction","manageError","collectedActions","gridValues","grids","uploadGridData","bizAdditions","bizDeletions","gridVallues","execute","i","IdEntity","uploadPromises","images","uploads","bizImages","bizFiles","syncActionTagResponse","multiactionResponse","commitResponse","wasActionPerformed","syncAction","getSyncAction","isNextAction","includes","prepareMultiActionData","wasMultiActionPerformed","performCommit","deleteOfflineCase","DataChangesetVersion","containsNext","grep","cleanTaskDataActions","isRetry","performRollback","multiActionData","convertStartFormDataToStandardFormat","submitDataDone","replaceGridChangesWithAddedRows","buttonActions","addButtonActions","trySaveorTryNextAction","addTrySaveOrTryNextAction","matches","match","oldKey","addedKey","oldXpath","newXpath","button_actions","h_actions","submitDataAction","tag","h_action_item","submitDoneBefore","actionParams","deleteCase","deleteCaseResponse","updateCaseSyncStatus","updateSyncStatusResponse","updateTaskIsEdited","updateIsEditedResponse","deleteTaskDataParams","deleteAttachments","deleteTaskData","deleteTaskDataResponse","deleteTaskForm","deleteTaskFormResponse","deleteTask","deleteTaskIfNextResponse","deleteError","details","args","map","err","rollbackResponse","cleanTaskDataActionsResponse","openOfflineTask","openOfflineTaskResponse","identifier","syncErrorDetails","buildSyncErrorObject","syncErrorType","performActionObject","singleError","messages","concat","actionResponse","timestamp","Date","now","gridsData","promisesResponse","currentGridData","processNewRecords","processDeletedRecords","processImages","processFiles","newRecords","gridNewRecords","rowData","creationTimestamp","a","b","newRecord","offlineFiles","deletedRecords","getServerTaskForm","hasEntryPipeline","wasPipelineExecuted","executeOfflineEntryPipelineAndReloadForm","pipelineExecutionResponse","getFileAttachmentsFromLocalTaskForm","deleteNextButton","dataChangeset","filePromises","imagePromises","downloadAttachmentsPromises","resolvedForm","executeOfflineEntryPipeline","formProperties","hasFormEntryPipeline","loadExecution","getFormDataResponse","localAttachments","downloadOfflineStartForm","isTaskForm","buttons","addFormDefaultButtons","lastSynchronization","saveStartForm","downloadOfflineTaskForm","saveTaskForm","isSingleSync","formNotificationParams","document","trigger","wasFormDownloaded","button","caption","verifyFormEntryPipeline","parseBoolean","limit","batch","batchTimer","maxNumberOfActions","deferredBatchExecuting","disabledRequests","circularDependencies","replicateServiceMethods","getService","eval","proxyMethod","method","parameters","originalPrepare","add","makeCircularDependenciesError","messageTmpl","localization","getResource","printf","dependencyFrom","dependencyTo","deferred","detectCircularDependencies","addNode","clearTimeout","batchTimeout","singleAction","fn","resolveDependencies","multiactionError","fire","rejectDeferreds","responses","errorMessage","finalResponse","disableRequests","validateIfBatchIsExecuting","queryString","readQueryString","disabledb","globalId","BIZAGI_USER","BIZAGI_PROXY_PREFIX","BIZAGI_DOMAIN","createDatabases","_destroy","callback","deleteDatabases","globalIdHash","hashCode","dbRecentProcesses","PouchDB","auto_compaction","dbProcessesHierarchy","dbStartForms","dbStartData","dbActivities","dbActivityForms","dbActivityData","dbProcessColumns","databases","databasesDeleted","info","destroy","restartDatabases","getHierarchyObjects","val","objects","lastIndexOf","getAllOpenCases","query","closed","createdBy","userName","emit","reduce","STOREOBJECTNAME","_defineProperty","defineProperty","enumerable","configurable","writable","workportal","createNewCase","toISOString","offlineCase","_id","idWorkFlow","isFavorite","Name","creationDate","process","categoryName","radNumber","formsRenderVersion","workItems","uniqueID","colorState","State","TaskName","get","remove","documentId","deleteDocument","fromWorkItemId","getCategories","enableOfflineForm","getDocument","processesHierarchyDoc","categories","idApp","idCategory","groupCategory","getGroup","category","totalApps","tempCategories","subCategories","appId","len","cat","getCustomizedColumnsData","cases","totalPages","lstIdCases","inputtray","radnumber","idcase","allDocs","include_docs","total_rows","localCase","idWFClass","taskState","guidFavorite","fields","Value","DisplayName","DataType","isRadNumber","getAllProcesses","workflows","taskstate","workflow","activeProcessesQueryFun","executeQueryPromise","executeQuery","group","queryResponse","responseRows","casesCount","idworkflow","count","queryErr","getOutboxCases","attachments","toJqueryPromise","getOutboxTaskCases","getOutboxTaskCasesFilteredBySyncStatus","pSyncStatus","includeDocs","queryMap","emitValue","filterParameters","existantCase","getCasesList","elements","queryFun","formatDateTime","getCustomizedColumnsNewData","isAborted","workitems","getRecentProcesses","recentProcesses","processes","saveOfflineTasks","tasksMap","saveQueue","bizagiQueue","currentTask","endDate","icon","state","shortEndDate","atRiskTime","creatorFullName","systemColumns","wfClassDisplayName","saveOrUpdateTask","caseId","saveDocument","internalTaskId","currentDocument","saveError","saveProcessCustomColumnsHeaders","workflowId","headers","saveSmartInboxCustomColumnsHeaders","smartInboxId","getProcessCustomColumnsHeaders","processErr","systemErr","getSmartInboxCustomColumnsHeaders","generateSortedCasesQuery","openStatus","queryAcrossCustomColums","customColumnsType","filterStatement","emitStatement","argumentsObject","appendStatement","caseIdFilterStatement","sortData","sortFieldName","sortDirection","Function","currentStatement","newStatement","operator","getCustomColumnsData","generatedQuery","queryExecutionPromise","queryRows","responseItem","headerObject","varSymbol","fieldName","evalError","objetKeyForFieldName","customColumns","processColumns","smartInboxColumns","applicationColumns","isDraft","queryError","updateTaskWorkItemCustomColumnsByType","customColumnsValues","customColumnProperty","cleanOfflineTasks","getOfflineCases","getLocalActivities","activities","currentRow","docId","updateSyncAttribute","saveResp","validateLocalDataForTaskExists","offlineTaskId","localActivityData","getLocalActivityError","closeOfflineTask","updateTaskDatachangeset","dataChangesetOverride","isEditedOverride","saveAvailableSmartInboxes","docHierarchy","saveAvailableOfflineSmartInboxes","markSmartInboxAsAvailableOffline","getAvailableOfflineSmartInboxes","getAvailableSmartInboxes","getTaskSyncError","taskObject","getInboxSyncErrors","casesMap","getSyncErrorsList","errors","startCasesResponse","startErrors","serializeError","tasksCasesResponse","tasksErrors","idworkitem","errortype","synctimestamp","activity","activityduedate","offlinetype","isdraft","syncerror","options","fillForm","element","container","setRenderGridValues","setRenderValues","prop","cause","columns","setDataType","binaryValue","hasSyncErrors","storedDataRows","records","total","lengthColumns","tmpEditAndVisible","lengthRows","idRow","tmpElement","tempRow","col","changes","mergedRow","merge","visible","j","lengthData","getSummary","activityCaseId","processPath","currentState","countAssigness","countEvents","countSubProcesses","saveAttachment","getAttachment","dataResult","offlineValue","fileExtension","getFileExtension","getMIMETypeByExtension","updatePromise","resultSave","errorSave","updateTaskForm","localForm","_attachments","mergeTaskAction","oldAction","newAction","mergeObject","depth","reduceLocalGridDeletions","unifiedActions","actionKey","currentAction","canAddActionInList","dataUpdated","performSaveTaskData","dataToSave","saveResult","markTaskPromise","markTaskEdited","markResponse","markError","actionList","actionStored","h_idRender","mergePromise","mergeRes","mergeError","updateResponse","updateErr","getErr","currentTaskData","deletePromise","emptyTaskData","deleteResponse","getDocError","mergeData","filterXpathsByType","xpaths","extractXpathFromRenderProperties","renderProperties","extractRenderElements","typeMap","filteredColumns","renderColumn","position","defer","datafill","nativeSaveFormInfo","filter","querydisable","pull","getTasksBeforePushPromise","callServiceWithNetworkRetries","getOfflineTasks","syncOfflineCases","getOfflineTasksError","argument","synchronizing","pushInProgressPromise","syncCasesQueue","syncStarts","syncOfflineStartCases","syncTasks","syncOfflineTaskCases","startToSync","tasksToSync","syncInProgressParams","tasks","parseSyncError","syncSingleOfflineTaskCase","syncCaseParams","generateSyncCasePromise","pushResult","downloadFormAgainPromise","shouldDownloadFormAgain","localTaskForm","shouldRefresh","downloadResult","syncTaskError","internalSyncError","errorResponse","_internalSyncError","syncSingleOfflineStartCase","newCase","syncResponse","syncCaseError","synchCasesQueue","caseData","itemId","split","maxOfflineCases","secondsBeforeAllowFetchAgain","tasksSyncDelta","startSyncDelta","fetchInProgress","triggerOfflineSyncEvent","isiOSSmartphoneDevice","synchronizeDownloadOfflineState","webpart","publish","fetch","timeBeforeFetch","executeFetch","fetchInProgressPromise","downloadStartFormsPromise","downloadTaskFormsPromise","getOfflineTasksProm","getOfflineProcessesProm","getOfflineProcessesHierarchy","formsToDownloadCountPromise","offlineWorkAvailable","offlineProcessesHierarchy","offlineTasksResponse","offlineProcessesList","getProcessesListFromHierarchy","serializedOfflineActivities","serializeActivities","getTasksToDownload","getStartFormsToDownload","tasksToDownloadResponse","startFormsToDownload","processTasksToFetchForms","items","fetchStartForms","getTasksToDownloadErr","getStartFormsToDownloadErr","start","startFormsSyncNeededError","offlineTasksError","lastFetch","startResult","tasksResult","getRecentOfflineProcesses","recentProcceses","saveRecentProcesses","offlineProcessTree","processesList","saveProcessesHierarchy","downloadStartForms","getProcessesFromCategory","isProcess","hasOfflineForm","checksQueue","processesToDownload","checkProm","checkIfStartFormNeedsSync","isSyncNeeded","isHardRefreshNeeded","isFirstDayDownload","lastSync","currentTime","getDate","getSyncTimeStamp","downloadFormsQueue","formsSuccessCount","formsFailedCount","downloadProm","checkIfDownloadStartFormsEnds","elementsMap","actualDate","statusFunction","advanceSearch","defineActivityStateByTaskState","defineActivityStateByDate","field","tempElementOriginalValues","el","isInboxHeaderASystemColumn","serializeActivity","parseInt","tmpEndDate","getTime","isoffline","internalId","idwfclass","validateFeatureSupport","serverActivities","localCases","itemsToDownload","itemsCount","servTaskId","servTask","matchingLocalTask","taskFormNeedsRefresh","syncDelda","serverTask","localTask","timeBeforeNextHardRefresh","updateIsRequired","hardRefreshIsRequired","lastFullSync","serverTasks","tasksToDownload","queueReadyToProcess","processOfflineFormsQueue","tasksSuccessfulCount","tasksFailedCount","tasksToDownloadCount","checkIfDownloadTaskFormsEnds","localActivitiesProm","localActivities","localActivityInternalId","deleteLocalDataIfActivityWasNotWorked","saveResponse","downloadOfflineCustomizedColumns","downloadTaskParams","processFormProm","updateActivityDatachangesetAndSyncTimestamp","localDataExists","deleteFullActivityData","deleteActivity","deleteActivityForm","deleteActivityError","deleteFormError","deleteFullActivityDataError","technicalNote","validateLocalDataError","hierarchy","dbProcessRecent","dbProcessHierarchy","dbForms","dbCases","old","syncronized","put","idWf","gId","index","saveFormInfo","tempDataColumn","lengthCols","assigned","array_cases","objToSend","domain","user","rta","decodeURIComponent","pivot","rowPos","cellPos","cell","processesHierarchy","dataCategory","dataRecents","processesHierarchyTofetchForms","data1","data2","data3","changeset","getItemLocalStorage","callSyncForms","changeSet","prom","changeSetType","saveProcessesHierarchyTofetchForms","saveProcessInHierarchy","setItemLocalStorage","wfClass","globalid","workFlow","_rev","docRecent","_endPoints","user-handler","process-handler","query-handler","case-handler","query-form","query-form-edit","query-form-delete","query-form-delete-cube","favorites-handler","file-handler","login-handler","login-handlerv10","logoff-handler","logoff-handlerv1","authorization-handler-getMenuAuthorization","authorization-handler-isCaseCreationAuthorized","case-handler-releaseActivity","case-handler-getCasesList","case-handler-getActivityList","offline-getProcessTree","offline-tasks","offline-getForms","offline-sendForm","case-handler-getCaseTasks","case-handler-getCaseEvents","case-handler-getCaseSubprocesses","case-handler-getTaskAssignees","case-handler-getAsynchExecutionState","case-handler-addNewCase","case-handler-startProcess","handler-execute-action-start","case-handler-supportedLogTypes","case-handler-getActivityLog","case-handler-getActivityDetailLog","case-handler-getEntityLog","case-handler-getEntityDetailLog","case-handler-getUserLog","case-handler-getUserDetailLog","case-handler-getAdminLog","case-handler-getCaseFormsRenderVersion","case-handler-validateHasStartForm","favorites-handler-saveFavorite","favorites-handler-deleteFavorite","process-getIcon","collections-getIcon","bamAnalytics-handler-getAnalisysQueries","bamAnalytics-handler-updateQuery","inbox-handler-getInboxSummary","inbox-handler-getFullInboxSummary","MessageHandler-NewComment","MessageHandler-GetComments","MessageHandler-SetCategoryToComment","MessageHandler-RemoveComment","MessageHandler-ReplyComment","MessageHandler-RemoveReply","MessageHandler-GetCategoryColors","MessageHandler-RenameCategoryColor","MessageHandler-CountNewComments","process-handler-getAllProcesses","process-handler-getFavourites","process-handler-getFavouriteCases","process-handler-getCustomizedColumnsData","process-handler-getCategory","process-handler-getRecentProcesses","process-handler-getCustomizedColumnsDataInfo","process-handler-getOrganizations","process-handler-getOrganizationsByUser","smartinbox-entity-values","smartinbox-getAllInbox","smartinbox-user-tasks","smartinbox-user-tasks-process","process-handler-getMyStuff","process-handler-getIdCasesOfProcessEntities","templates-handler-getCollectionData","data-navigation-handler-collection","data-navigation-handler-entity","data-navigation-handler-entity-filters","action-handler-getProcessAddAction","my-search-getSearchLists","my-search-getFilters","my-search-getFiltersData","my-search-getData","templates-handler-getVirtualCollectionData","templates-handler-getMultipleActions","process-handler-getMapping","process-handler-getForm","process-handler-startform","process-handler-rule","process-action-execute","process-handler-getActivitiesData","process-handler-getPendingsData","entities-handler-getActions","entities-handler-getUsersAndEvents","entities-handler-getUsers","entities-handler-getEvents","entities-handler-getUsersImages","entities-handler-getShotCuts","query-handler-getqueries","query-handler-getQueryForm","user-handler-getCurrentUser","old-render","Reports","reports-handler-deleteQueries","folders-handler-getUserQueries","folders-associate-deleteSmartFolder","folders-handler","folders-associate","smartfolders-integration","AlarmAdmin","AnalyticsProcess","AnalyticsSensor","AnalyticsTask","AsynchronousWorkitemRetries","AuthenticationLogQuery","BAMProcess","BAMTask","BusinessPolicies","CaseAdmin","adminReassignCases","asyncECMUpload","CasesMonitor","Closed","CurrentUser","EncryptionAdmin","MobileUpdatesAdmin","EntityAdmin","LocationResources","NewCase","Pending","Profiles","Search","UserAdmin","UserDefaultAssignation","UserPendingRequests","ListPreferences","UserPreferencesUrl","GRDimensionAdmin","Licenses","AnalysisQueries","DocumentTemplates","ProcessAdmin","ResourceBAM","WorkPortalVersion","entities-administration","theme-handler-getLogoImagePath","logout","logoutDotNet","authenticationConfig","logout-oauth2","FederateLogoffUrl","oauth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo","massive-activity-assignments-getCasesByOrganization","massive-activity-assignments-reassignCases","massive-activity-assignments-searchUsers","async-ecm-upload-baseService","domains","getCurrentTheme","admin-getAuthenticationLog","admin-getAuthenticationDomains","admin-getAuthenticationEventsTypes","admin-getAuthenticationEventSubTypes","admin-EncryptString","admin-UserPendingRequests","admin-UserAuthenticationInfo","admin-updateUserAuthenticationInfo","admin-generateRandomPassword","admin-sendEmail","admin-getApplicationList","admin-getApplicationProcesses","admin-getProcessVersion","admin-getProcessTasks","admin-getTaskAlarms","admin-getLapseMode","admin-getRecurrMode","admin-getScheduleType","admin-getBossList","admin-addAlarm","admin-editAlarm","admin-deleteAlarm","admin-alarmRecipients","admin-deleteAlarmRecipients","admin-recipientToAlarm","admin-enableAlarm","admin-getCategoriesList","admin-getCasesList","admin-abortItems","admin-reassignItems","admin-getDefaultAssignationUserToAllProcess","admin-getDefaultAssignationUserToProcess","admin-setDefaultAssignationUserToProcess","admin-getProfilesTypes","admin-searchProfiles","admin-getUsersByProfile","admin-removeUserFromProfile","admin-addUserToProfile","admin-async-activities-get-activities","admin-async-activities-get-retry-now","admin-async-activities-get-activities-by-task","admin-async-activities-enable-execution","admin-async-activities-enable-multiple","admin-async-activities-async-execution","admin-async-activities-async-execution-log","admin-Licenses","admin-GetDimensions","admin-EditDimension","admin-CreateAdministrableDimension","admin-DeleteDimension","admin-EntityPathChildNodesAction","admin-GetActiveWFClasses","admin-document-templates-storeDocumentTemplates","admin-document-templates-restoreDocumentTemplates","admin-document-templates-uploadDocumentTemplate","admin-processes-workflowClasses","admin-processes-tasksByWorkflow","admin-processes-modifyProcessDuration","admin-processes-modifyTaskDuration","admin-language-resource","admin-language-languages","bam-resourcemonitor-myteam","reports-analysisquery","reports-analysisquery-update","reports-analysisquery-delete","processviewer-processdefinition","processviewer-processgraphicinfo","mobile-getLastUpdate","discussion-case","discussion-case-v1","get-users","new-discussion","count-comments","comment-case","new-comment","new-comment-attach","get-list-files","get-list-files-v1","project-resource-action","thumbnail-file","get-attachment","get-mobile-attachment","project-files-upload","count-files","count-files-v1","remove-comment","time-schemas-effectiveduration","getFeatureObject","ENTITIES_QUERY_PAGE_SIZE","normalizeUrl","RPproxyPrefix","pageSize","BIZAGI_INBOX_ROWS_PER_PAGE","activeForm","configureGlobalHandlers","endPoint","getOverrides","overrides","valueUppercase","authenticatedUser","urlSend","password","BIZAGI_PASSWORD","logoutUser","logOffUser","getCurrentUser","getInboxSummary","onlyFavorites","myActivities","myPendings","smartfoldersParameters","skipAggrupate","includeAllProcessesItem","responseData","allProcesses","allCases","Number","getUserWorkportalPreferences","_defer","_userPreferences","getPreferencesWorkportalCurrentUser","tryCatch","storeMobileFeatures","userPreferences","getUserPreferences","preference","mobFeatures","getMobileFeatures","localStorage","localStoragePreferences","getLastProcessInboxWorkflow","lastProcessInbox","getLastProcessInboxProcessInfo","isMobileInboxByProcessSupported","idWorkflow","setLastProcessInbox","processInfoName","mobileDevice","getAllSmartInbox","processesData","smartinboxes","idWorkFlowResult","_preferDefaultOpenInbox","defaultOpenInboxWorkflowId","_preferDefaultOpenSmartInbox","defaultOpenInboxSmartInboxId","_hasPreferDefaultOpenInbox","_hasPreferDefaultOpenSmartInbox","workflowFound","first","smartinboxFound","smartinbox","getFavourites","getMyStuff","getFavouriteCases","numberOfFields","elementToHtml","overdue","today","tomorrow","upcoming","actualMonth","getMonth","actualDay","actualYear","getYear","tmpdate","tmpDay","tmpMonth","tmpYear","dateFormatter","formatDate","getCasesListBeta","getMobileCasesList","adapterDataOfActivitiesToTemplate","getMobileActivities","tempElement","syncErrors","appendActivityElementSyncError","appendActivityRowsSyncError","currentPage","urlMobile","groupedData","adapterServerResponseTemplateBindingObject","activityDate","getFullYear","isEvent","caseSyncError","hassyncerror","getCurrentActivities","processActivitiesResponse","highlight","process_filter","highlightedNumber","highlightsString","processname","active","string","expresion","RegExp","offset","getDiscussionCase","globalParent","editDiscussion","update","getUsersDiscussion","getEffectiveDuration","getUsersData","getSummaryCaseTaskOptions","createNewDiscussion","createNewComment","updateProjectFile","createProjectFile","getFilesCount","getCommentCase","getCommentsByParent","getFilesList","getFilesThumbnail","guidAttachment","idAttachment","getMobileAttachment","getAllAdministrableEntities","kind","entities","getEntitiesList","getCasesByWorkflow","v","keyvalue","newFieldsValue","fieldsKey","fieldsValue","getOrganizationsList","getOrganizationsByUserList","orderFieldName","orderType","getCustomizedColumnsDataBeta","columnTitle","noResults","groupByApp","getCaseSummary","eventAsTasks","getCaseTasks","getCaseEvents","getCaseSubprocesses","getCaseFormsRenderVersion","getCaseFormsRenderVersionDataContent","getTaskAssignees","fromTask","getQueries","hashQueries","idElement","processQueries","queries","idParent","nodes","idOrganization","validateHasStartForm","processId","batchRequest","startProcess","entityMapping","mapping","idParentCase","isVersionSupported","oldParams","oldVersion","actionCreateCase","guidProcess","parentCaseId","getFirstParentPlan","searchCases","onlyUserCases","queryCases","outputxpath","queryEntities","getMenuAuthorization","isCaseCreationAuthorized","getAsynchExecutionState","idAsynchWorkitem","supportedLogTypes","getActivityLog","orden","idActualPage","getActivityDetailLog","idWorkItemFrom","getEntityLog","getEntityDetailLog","userFullName","attribDisplayName","getUserLog","getUserDetailLog","idUser","entDisplayName","getAdminLog","addFavorite","idObject","favoriteType","delFavorite","summaryAssigness","baseAssignees","assignees","assigneesLength","assigneesFix","showAssignees","events","assigneesEvents","assigneesActivities","assigneesEventsList","assigneesActivitiesList","substring","summarySubProcess","subprocess","n","summaryCaseEvents","summaryCaseDetails","getCaseSummaryDataContent","dataCurrentStateLength","showEvents","showParentProcess","parentProcess","parentDisplayName","isClosedForAllUsers","isClosed","showSubProcess","showForm","hasGlobalForm","allowsReassign","currentStateTypes","m","assignToCurrentUser","showActivities","releaseActivity","summaryActivities","icoTaskState","createdByName","createdByUserName","caseDescription","showWorkOnIt","getSmartFolders","idFolder","searchFolders","deleteSmartFolder","idSmartFolder","getFolders","folders","childs","getCasesByFolder","makeFolder","folderName","idParentFolder","updateFolder","associateCaseToFolder","idCustomFolder","dissasociateCaseFromFolder","deleteFolder","uploadId","entityId","entityKey","getComments","encodeURI","idColorCategory","pag","pagSize","picture","comments","users","Id","Picture","makeNewComment","comment","makeNewReply","idComment","Replies","removeMobileComment","removeComment","removeReply","idReply","renameCommentCategory","colorName","setCommentCategory","getCommentsCategories","getNewComments","getAnalisysQueries","updateQueries","idQuery","queryName","queryDescription","deleteQueries","queryId","QueryId","sessionStorage","removeItem","javaLogout","location","reload","logoutMobile","logoutData","sourceLogout","removeLastProcessInbox","redirectErrorPage","href","authenticationType","logOffURL","federationLogoutBindingProtocol","authenticationSubType","federateLogoffUrl","open","write","close","loader","nativeAjax","getPathUrl","jsonResponse","samlUrlRedirect","decodeURI","iframe","createElement","getElementsByTagName","appendChild","on","isIE8","contentWindow","text","src","logoutUrl","callbackUrl","homeUrl","loginPage","getOrganizationInfo","getCasesByOrganization","roles","skills","locations","reassignCases","searchUsers","fullName","getDomainList","getEcmAllScheduledJobs","retryECMPendingScheduledJob","getWorkPortalVersion","version","productBuild","getAuthenticationLogData","getAuthenticationLogResult","dtFrom","dtTo","eventSubType","eventType","encryptString","entry","userPendingRequests","userAuthenticationInfo","updateUserAuthenticationInfo","enable","expired","locked","generateRandomPassword","emailTo","getApplicationCategoriesList","filterStartEvent","getAdminCasesList","getApplicationProcesses","getProcessVersion","getProcessTasks","getTaskAlarms","getLapseMode","getRecurrMode","getScheduleType","getBossList","addAlarm","editAlarm","deleteAlarm","getAlarmRecipients","addRecipientToAlarm","deleteRecipientsFromAlarm","enableAlarm","abortReassignItems","asyncActivitiesServices","getDefaultAssignationUserToAllProcess","serviceAction","getDefaultAssignationUserToProcess","setDefaultAssignationUserToProcess","getProcessIcon","getCollectionIcon","collectionId","getProfilesTypes","searchProfiles","getUsersByProfile","removeUserFromProfile","addUserToProfile","licenses","getDimensions","editDimension","entityPath","description","createAdministrableDimension","deleteDimension","administrable","entityPathChildNodesAction","nodeType","idNode","nodeDisplayPath","nodePath","getActiveWFClasses","storeDocumentTemplates","restoreDocumentTemplates","Guid","getWorkFlowClasses","getTaskByWorkFlow","modifyProcessDuration","duration","modifyTaskDuration","getDataForMyTeam","getReporstAnalysisQuery","updateReportData","deleteReportData","getStoreLanguageTemplates","justActives","getLanguageTemplate","cultureName","processDefinition","graphicInfo","getLastUpdateByMobile","getCollectionData","idFact","filters","getVirtualCollectionData","guidVirtualCollection","guidSearch","calculateFilters","serializeEntityData","getCollectionEntityData","referenceType","defaultFilterApplied","reference","guidEntityCurrent","getFiltersEntityData","getProcessAddAction","getMultipleActions","getMapping","getForm","executeAction","ruleId","actionRule","getActivitiesData","pagsize","getPendingsData","getActionsData","getUsersAndEvents","idCases","getUsers","getEvents","getUsersImages","userIds","square","getPreferencesCurrentUser","getShortCuts","getSearchLists","getIdCasesOfProcessEntities","ids","server","lessThanOrEqualsTo","getQueryForm","defineFilterObject","filterObject","rangeQuery","searchType","min","max","typeSearch","setValues","clone","isDefaultFilter","defaultFilter","isNaN","getPlan","getActivities","updatePlan","putExecutePlan","deletePlan","closePlan","getWorkitemsPlan","getTransitionsByPlan","editActivityPlan","idPlan","getPlanByParent","getItemsByActivity","getPlanParent","serializedData","_buildNewObject","header","newObject","kRow","iCell","cells","kReturnObject","getCardViewCustomizedColumns","getLastProcessInboxSort","sortOrder","isMobileDevice","smartInboxGuid","liveFilterData","smartInboxFilter","encodeLiveFilter","setLastProcessInboxProcessColumns","includeSyncErrors","localSyncErrors","t","serializeFilter","CryptoJS","r","lib","Base","mixIn","$super","s","WordArray","words","sigBytes","clamp","ceil","call","slice","random","c","enc","Hex","join","f","Latin1","String","fromCharCode","charCodeAt","h","Utf8","escape","Error","unescape","encodeURIComponent","u","BufferedBlockAlgorithm","reset","_nDataBytes","_append","_process","blockSize","_minBufferSize","_doProcessBlock","splice","Hasher","cfg","_doReset","finalize","_doFinalize","_createHelper","_createHmacHelper","p","HMAC","algo","Base64","_map","charAt","abs","sin","MD5","_hash","d","y","_","g","B","x","S","z","D","w","C","floor","HmacMD5","EvpKDF","keySize","hasher","iterations","compute","Cipher","createEncryptor","_ENC_XFORM_MODE","createDecryptor","_DEC_XFORM_MODE","_xformMode","_key","ivSize","encrypt","decrypt","StreamCipher","mode","_iv","_prevBlock","BlockCipherMode","Encryptor","Decryptor","_cipher","processBlock","encryptBlock","decryptBlock","CBC","pad","Pkcs7","unpad","BlockCipher","padding","iv","_mode","CipherParams","formatter","format","OpenSSL","ciphertext","salt","SerializableCipher","algorithm","_parse","kdf","PasswordBasedCipher","AES","_nRounds","_keySchedule","_invKeySchedule","_doCryptBlock","encoded","allProcessItem","orderValue","unshift","isInboxSystemHeaderSortable","viewType","headersEnabled","wiestimatedsolutiondate","isfavorite","currenttask","wfclsdisplayname","disableProcessColumn","isSmartInbox","fieldFilterName","taskstateColor","cascreationdate","cassolutiondate","taskid","atrisktime","currentuser","currentfullname","guidfavorite","creatorfullname","validateCustomColumn","maxColumnsAllowedOnView","columnsAddedCount","isValid","selectedColumnsCount","isCustomColumn","off","getSpecificSmartInbox","settingName","owner","getAllProcessesSmartInbox","getAllCustomizedColumnsSmartInbox","createSmartInbox","updateSmartInbox","model","deleteSmartInbox","shareSmartInbox","getEntityValuesForInboxFilter","entityGuid","getUserTasksForInboxFilter","serviceInvocation","pArguments","maxRetries","delayBetweenRetry","currentRetry","currentDeferred","getAndSaveMobileFeaturesFromBizagiConfig","validateIfSaveMobileFeaturesIsEnabled","configuration","features","shouldSynchronize","module","isOfflineFormsV2Supported","oldOfflineServicesAlreadyEnabled","configureOfflineEvents","fetchWorker","pullWorker","configureOfflineHandlers","configurePushCaseHandler","getNativeComponent","offlineModuleReady","proxy","fetchOfflineData","getOfflineCategoriesHandler","getRecentProcessesHandler","createStartFormHandler","getOfflineCasesHandler","getOfflineWorkitemsHandler","pushOfflineDataHandler","cleanDatabasesHandler","getSyncErrorsListHandler","getInboxSyncErrorsHandler","retrySyncSingleOfflineCaseNative","tryPushOfflineCaseHandler","navigator","connection","Connection","NONE","queryoffline","onlineServicesHandler","offlineServicesHandler","addEventListener","setOfflineCategories","defaultErrorHandler","setOfflineRecentProcesses","openCreatedStartForm","inboxType","setOfflineInboxCases","deleteOfflineCaseHandler","offlineCaseDeleted","pushOfflineData","showTaskFeed","syncSingleOfflineCase","IdCase","networkErrorMsg","lastOnlineTimestamp","returnOnlineStatus","setOfflineSyncErrorList","setOfflineInboxSyncErrors","updateDataList","lastConfiguration","getLastProcessInbox","processInfo","getOutboxCasesCount","saveWorkInProgress","outboxCasesCount","openSyncDialog","isOfflineErrorsViewSupported","success","showSyncMessage","notAnError","delegateUserName","idDelegateUser","groupSeparator","language","decimalSeparator","decimalDigits","symbol","ShortDateFormat","TimeFormat","LongDateFormat","twoDigitYearMax","twoDigitYearMaxDelta","uploadMaxFileSize","isMultiOrganization","associatedStakeholders","sUserProperties","createDefaultCategories","isMobileSmartInboxEnabled","availableSmartInboxes","offline","getCasesByWorkflowForInboxOffline","getCasesByWorkflowForOtherTrays","getCustomizedColumnsDataTasks","headersType","headersResponse","getOfflineCasesParams","parseCustomizedColumnDataTaskResponse","currTask","isValidRadNumber","buildCaseData","dataFields","defaultSystemHeaders","buildDefaultSystemHeaders","casenumberdisplayname","task","permissions","Cases","AnalysisReports","Admin","CurrentUserAdministration","LogOut","SmartFolders","CustomFolders","BizagiQueries","StateLog","PrintableVersion","enableDefaultMethod","inboxSummary","Red","Yellow","Green","Black","All","getNativeWorkItems","subProcesses","getCasesListBetaForInbox","getCasesListBetaForDraftsOrOutBox","getCasesListBetaForOtherTrays","taskFeedData","getTaskFeedData","getLastSelectionCustomColumns","processColumnsInfo","originalEndDate","getTaskFeedStatus","recentProcess","isObjectEmpty","removeOnlineItems","serializeOfflineCustomizedColumns","activityObject","headerIndex","deserializeOfflineCustomizedColumns","rowObject","rowIndex","activityRow","addEvalPropertyToOfflineHeaders","onlineToOfflineMapping","currentHeader","getOfflineSystemHeaders","totalRecords","headersErr","rowsErr","lastProcessInfo","getCustomColumnsParams","updatesQueue","filterSystemHeaders","activityCustomColumns","updateCustomColumnsPromise","getMobileOfflineActivities","isActivityAlreadyDownloaded","isAlreadyDownloaded","getCaseParams","casesListResponse","offlineActivityId","serverActivity","isOnDemand","updateCustomColumns","customColumnsActivites","updateCustomColumnsQueue","updateCustomColumsPromise","downloadActivityOnDemand","loading","isTaskFormAlreadyDownloaded","isFormAlreadyDownloaded","shouldDownloadForm","stop","downloadStartFormOnDemand","isStartFormAlreadyDownloaded","isFormDownloaded","isValidResource","synchronizationFinished","showNotification","systemHeaders","updateSyncErrorsStatus","errorsList","activeElement","blur","infoCase","showMobileToast","enableOfflineEvents","pushStatus","v2Param","hasOfflineFormsEnabled","synObject","pullObject","awCaseCreationContext","diagnostics","dbErrors","deletedDatabasesCount","destroyCallback","currentDatabase","getError","getErrorsList","maxErrors","getErrorsQuery","queryArgs","conflicts","descending","queryRes","DIAGNOSTICS_COMPONENT_NAME","DIAGNOSTICS_SYNC_AJAX_PARAMS","TYPE","DATATYPE","DIAGNOSTICS_PACKAGE_MAX_ERRORS","DIAGNOSTICS_PACKAGE_SYNC_INTERVAL","DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB","DIAGNOSTICS_PACKAGE_MAX_RETRY","diagnosticsServiceEnabled","isMobileErrorTracesEnabled","configureDiagnosticsHandlers","setDiagnosticsDefaultData","lastSyncDatetime","diagnosticstErrorsDb","getDiagnosticsDatabaseInstance","setInterval","syncDiagnosticsError","addDiagnosticsError","line","stackTrace","newError","createDiagnosticsErrorInstance","saveDiagnosticsErrorInDatabase","validateDiagnosticsError","escapeHtml","componentType","getCurrentDiagnosticsEventComponentType","queueEvents","getCurrentDiagnosticsEventsQueue","queueHTTP","getCurrentDiagnosticsHttpQueue","userAgent","getCurrentDatetime","getCurrentDatetimestamp","retryCount","mobileHttpQueue","getDataservice","getQueueListEvents","listEvents","lastEvent","bizagiWorkportal","deviceFactory","dataService","getDiagnosticsErrorInDatabase","errorId","deleteDiagnosticsErrorInDatabase","deleteDiagnosticsErrorListInDatabase","errorPackageList","deletePromisesArray","Message","updateOrDeleteDiagnosticsErrorInDatabase","errorPackage","updateError","updateOrDeleteDiagnosticsErrorListInDatabase","getCurrentDiagnosticsErrorList","currentErrorList","getDiagnosticsPackageErrors","sendDiagnosticsErrorPackage","getDiagnosticsSystemErrorURL","packageSize","packageErrors","currentError","systemErrorInstance","DateTime","Username","currentUser","Source","Title","requestSize","getSizeJsonObjectInMegaBytes","dataServiceInstance","syncSystemErrorPromise","errorRest","DIAGNOSTICS_OBSERVER_COMPONENT_NAME","DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED","DIAGNOSTICS_OBSERVER_MAX_EVENTS_IN_QUEUE","DIAGNOSTICS_OBSERVER_MAX_PATH_EVENT","DIAGNOSTICS_OBSERVER_OBSERVER_OPTIONS","attributes","childList","characterData","subtree","DIAGNOSTICS_OBSERVER_MAX_SIZE_HTML_EVENT_MB","DIAGNOSTICS_OBSERVER_COMPONENT_TYPES","FORM","DISCUSSIONS","ACTION_SHEET","FILES","MAIN_MENU","SUMMARY_CASE","setDiagnosticsObserverDefaultData","configureDiagnosticsObserverHandlers","diagnosticsObserverEventsQueue","MutationObserver","WebKitMutationObserver","MozMutationObserver","setTouchEndObserver","eventsObserver","ontouchend","addDiagnosticsObsercerEvent","getEventObject","ready","observe","composedPath","getDiagnosticsElementComponentType","dateTime","srcElement","getDiagnosticsElementPath","shift","sourcePath","pathList","parent","parentProperties","class","validateElement","validateDiagnosticsIfContainsElement","getDiagnosticsElementComponentTypeByClass","getDiagnosticsElementComponentTypeById","validateDiagnosticsKendoView","getLastProcessInboxInputTray","hasClass","attr","DIAGNOSTICS_WAIT_APPLICATION_STARTED","configureDiagnosticsErrorObserverHandlers","onerror","sendDiagnosticsError","getErrorsInAjaxImplementation","dataserviceInstance","getJqueryAjax","ajaxInstance","mobileHttpErrorsQueue"],"mappings":"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","sourcesContent":["function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to rendering REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n$.Class.extend(\"bizagi.render.services.service\",\n{\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"pageCacheId\",\n  BA_MULTIACTION_WITH_LIMIT_NUMBER: 5,\n  BA_MULTIACTION_WITH_LIMIT_QUEUE: \"multiaction\" },\n\n{\n  /*\r\n   *   Constructor\r\n   */\n  init: function init(params) {\n    params = params || {};\n    params.context = params.context || \"workflow\";\n    params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    this.serviceLocator = new bizagi.render.services.context(params);\n    this.multiactionService = new bizagi.render.services.multiactionservice(this);\n    this.multiactionServiceWithLimit = new bizagi.render.services.multiactionservice(this, this.Class.BA_MULTIACTION_WITH_LIMIT_NUMBER, this.Class.BA_MULTIACTION_WITH_LIMIT_QUEUE);\n    this.guid = Math.guid();\n\n    if (bizagi.override.enableECMMetadataMultiaction) {\n      this.multiactionMetadataService = new bizagi.render.services.metadatamultiactionservice(this);\n    }\n\n    // Userfield definitions mini-cache\n    this.userfieldRequests = {};\n\n    this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone : bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet : bizagi.deviceEnum.desktop);\n    this.deviceCode = bizagi.util.getDeviceCode();\n  },\n\n  /*\r\n      *   Return the multiaction-service\r\n      */\n  multiaction: function multiaction() {\n    return this.multiactionService;\n  },\n\n  /*\r\n     *   Return the multiaction-service\r\n     */\n  multiactionWithLimit: function multiactionWithLimit() {\n    return this.multiactionServiceWithLimit;\n  },\n\n  metadataECMMultiaction: function metadataECMMultiaction() {\n    return bizagi.override.enableECMMetadataMultiaction ? this.multiactionMetadataService : this;\n  },\n  /*\r\n      *   SINGLE SERVICES METHODS\r\n      */\n\n  /*\r\n          *   Gets form data\r\n          *   Returns a promise of the data being retrieved\r\n          */\n  getFormData: function getFormData(params) {\n    var self = this;\n\n    // Check if the params contains mocked data\n    if (params && params.data) {\n      return params.data;\n    }\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action || \"LOADFORM\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\n\n    if (params.idProcess)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idProcess\"] = params.idProcess;\n    if (params.idForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\n    if (params.idEntity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idEntity\"] = params.idEntity;\n    if (params.surrogateKey)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\n    if (params.idRender)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    if (params.xpathContext)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.requestedForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"requestedForm\"] = params.requestedForm;\n    if (params.recordXPath)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordXPath\"] = params.recordXPath;\n    if (params.summaryForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"summaryForm\"] = params.summaryForm;\n    if (params.idCase)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\n    if (params.idWorkitem)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\n    if (params.idTask)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idTask\"] = params.idTask;\n    if (params.idPageCache)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.contextType)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contextType;\n    if (params.guidEntity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\n    if (!bizagi.util.isEmpty(params.isRefresh))\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isRefresh\"] = params.isRefresh;\n    if (params.isActionStartForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\n    if (params.additionalXpaths)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\n    if (params.idStartScope)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\n    if (typeof params.readOnlyForm !== \"undefined\")\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"readonlyform\"] = params.readOnlyForm;\n    if (typeof params.printversion !== \"undefined\")\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"printForm\"] = params.printversion;\n    if (typeof params.recordXpath !== \"undefined\")\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\n    if (params.guid)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guid\"] = params.guid;\n    if (params.downloadOfflineForm)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"downloadofflineform\"] = 1;\n\n    if (params.editable === false) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"DisplayFormAsReadOnly\"] = true;\n    }\n\n    // Support parameter from ui\n    // Parameters that affects all the same attributes of render\n    if (params.printversion) {\n      //Print limit grid rows\n      var BA_ALL_PARAMETER_PREFIX = \"all_\";\n\n      if (params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"]) {\n        data[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"] = params[self.Class.BA_ACTION_PARAMETER_PREFIX + BA_ALL_PARAMETER_PREFIX + \"rows\"];\n      }\n    }\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n\n    // Call ajax and returns promise\n    bizagi.chrono.initAndStart(\"data\");\n    var ajaxParams = {\n      url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: params.action || \"LOAD\" };\n\n    if (params.downloadOfflineForm) {\n      ajaxParams.avoidLoader = true;\n    }\n    return $.ajax(ajaxParams).\n    pipe(function (response) {\n      bizagi.chrono.stopAndLog(\"data\");\n\n      // Transform data for read only version\n      if (params.printversion) {\n        try {\n          response.form.properties.editable = \"False\";\n\n          var transformGridDataToReadOnly = function transformGridDataToReadOnly(_data) {\n            if (_data == null) {\n              return _data;\n            }\n            if (_data.hasOwnProperty('type') && _data.type == 'grid') {\n              _data.id = data.id + \"-print\";\n              _data.allowAdd = \"False\";\n              _data.allowDelete = \"False\";\n              _data.allowEdit = \"False\";\n              _data.allowGrouping = \"False\";\n              _data.allowMore = \"False\";\n              _data.allowSearch = \"False\";\n            } else {\n              $.each(data, function (key, value) {\n                if (_typeof(value) == 'object') {\n                  _data[key] = transformGridDataToReadOnly(_data[key]);\n                }\n              });\n            }\n            return _data;\n          };\n          response = transformGridDataToReadOnly(response);\n        } catch (e) {\n        }\n      }\n\n      return response;\n    });\n  },\n  /*\r\n      *   Gets a search form data\r\n      *   Returns a promise of the data being retrieved\r\n      */\n  getSearchFormData: function getSearchFormData(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHFORM\";\n    if (params.xpath)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    if (params.idRender)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    if (params.xpathContext)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.idSearchForm)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\n    if (params.idPageCache)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-search-form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SEARCHFORM\" });\n\n  },\n\n  processDataValues: function processDataValues(data) {\n    var o;\n    data = $.extend(true, {}, data);\n    for (o in data) {\n      if (data.hasOwnProperty(o) && $.type(data[o]) == \"object\") {\n        // for search\n        if (data[o].hasOwnProperty(\"id\")) {\n          data[o] = data[o].id;\n        }\n      }\n    }\n    return data;\n  },\n  /*\r\n      *   Sends a form action to the server\r\n      */\n  submitData: function submitData(params) {\n    var self = this;\n\n    // Define data\n    data = self.resolveData(params.data || {}, params.xpathContext);\n    data = self.processDataValues(data);\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = params.action;\n\n    // Fill optional parameters\n    params = params || {};\n    if (params.xpath)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    if (params.idRender)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    if (params.xpathContext)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.idPageCache)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.guidEntity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidEntity;\n    if (params.contexttype)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    if (params.transitions)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"transitions\"] = params.transitions;\n    if (params.surrogatekey)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\n    if (params.forcePlanCompletion)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"forcePlanCompletion\"] = params.forcePlanCompletion;\n\n    /* if (params.isActionStartForm)\r\n                                                                                                        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = params.isActionStartForm;\r\n                                                                                                        */\n    var actionType = params.action.toString().toUpperCase();\n\n    // Log submit data\n    bizagi.debug(\"Data sent\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: actionType,\n      beforeSend: function beforeSend(xhr, status) {\n        xhr.renderingService = true;\n      } });\n\n  },\n  /*\r\n      * Get data processing xpathcontext\r\n      */\n  resolveData: function resolveData(data, xpathContext) {\n    var name, newName, value;\n    if (!$.isEmptyObject(data) && xpathContext) {\n      if (xpathContext.search(/\\[id=\\d+\\]/) !== -1) {\n        for (name in data) {\n          if (name.search(/\\[id=\\d+\\]/) !== -1 && xpathContext == name.substr(0, name.search(/\\]/) + 1)) {\n            newName = name.substr(name.search(/\\]/) + 2);\n            value = data[name];\n            data[newName] = value;\n            delete data[name];\n          }\n        }\n      }\n    }\n    return data;\n  },\n  /*\r\n      *   Fetch a property from the server\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      *   -   property\r\n      */\n  getPropertyData: function getPropertyData(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\n\n    if (params.sessionId)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    if (params.contexttype)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    if (params.guidentity)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\n    if (params.surrogatekey)\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\n    if (params.pxpath)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpath\"] = params.pxpath;\n    if (params.prows)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.prows;\n    if (params.ppage)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.ppage;\n    if (params.pfilter != undefined && params.pfilter != null)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = params.pfilter;\n    /*else\r\n                                                                              data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"filter\"] = \"\";*/\n    if (params.psort != undefined && params.psort != null)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.psort;\n    if (params.porder)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.porder;\n    if (params.pcaseId)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"caseId\"] = params.pcaseId;\n    if (params.pguidEntity)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidEntity\"] = params.pguidEntity;\n    if (params.psurrogatedKey) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.psurrogatedKey;\n    }\n    if (params.pactionXpath) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"actionXpath\"] = params.pactionXpath;\n    }\n    if (params.ptemplateGuid) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"templateGuid\"] = params.ptemplateGuid;\n    }\n    if (params.pparameters) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"parameters\"] = params.pparameters;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    // TODO: change REST library in order to support extra HTTP parameters\n    // Please be careful with dataType parameter\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\",\n      beforeSend: function beforeSend(xhr, status) {\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } });\n\n\n  },\n  /*\r\n      *   Refresh the data property from the server\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      */\n  getData: function getData(params) {\n    return this.getPropertyData($.extend(params, {\n      property: \"data\" }));\n\n  },\n  /*\r\n      *   Refresh the data property from the server\r\n      *   This version is to fetch search data\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      *   -   term\r\n      */\n  getSearchData: function getSearchData(params) {\n    var self = this;\n    params.extra = params.extra || {};\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"term\"] = params.term;\n\n    return this.getPropertyData($.extend(params, {\n      property: \"data\" }));\n\n  },\n\n  /*\r\n      * Refresh tha data property from the server\r\n      * Params:\r\n      *   -   collapsestate\r\n      */\n  getCollapseData: function getCollapseData(params) {\n    var self = this;\n    params.extra = params.extra || {};\n\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"collapseState\"] = params.collapseState;\n\n    return this.getPropertyData($.extend(params, {\n      property: \"collapseState\" }));\n\n  },\n\n  /*\r\n      *   Refresh the data property from the server\r\n      *   This version is to fetch grid data\r\n      *   Params:\r\n      *   -   xpath\r\n      *   -   idRender\r\n      *   -   xpathContext\r\n      *   -   sort\r\n      *   -   page\r\n      *   -   rows\r\n      */\n  getGridData: function getGridData(params) {\n    var self = this;\n    params.extra = params.extra || {};\n\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"order\"] = params.order;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\n\n    return this.getPropertyData($.extend(params, {\n      property: \"data\" }));\n\n  },\n\n  getGridDataExclusivesSelected: function getGridDataExclusivesSelected(params) {\n    var self = this;\n    params.extra = params.extra || {};\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"rows\"] = params.rows;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"value\"] = params.value;\n    params.extra[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathfilter\"] = params.xpathfilter;\n    return this.getPropertyData($.extend(params, {\n      property: \"exclusivesSelected\" }));\n\n  },\n\n  /*\r\n      *   Returns the upload plugin cancel image\r\n      */\n  getUploadCancelImage: function getUploadCancelImage() {\n    return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-upload-cancel-image\");\n  },\n  /*\r\n      *   Returns the upload file url for each file\r\n      */\n  getUploadFileUrl: function getUploadFileUrl(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"fileContent\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n\n  downloadFile: function downloadFile(params) {\n    var self = this;\n    var fileUrl = self.getUploadFileUrl(params);\n\n    return $.ajax({\n      url: fileUrl,\n      type: \"GET\",\n      queue: params.queue,\n      dataType: \"binary\",\n      processData: false //Always false for binary dataType\n    }).\n    then(function (binary_file) {\n      if (binary_file.type == \"application/json\") {\n        return self.readFileAsJSON(binary_file);\n      }\n\n      if (typeof binary_file == \"string\") {\n        var xhr = arguments[2];\n        var contentType = xhr.getResponseHeader('Content-type');\n        binary_file = bizagi.util.media.byteArrayToBlob(self.stringToByteArray(binary_file), contentType);\n      }\n      return binary_file;\n    });\n  },\n\n  readFileAsJSON: function readFileAsJSON(binary_file) {\n    var def = new $.Deferred();\n    var reader = new FileReader();\n    reader.onloadend = function () {\n      def.reject({ responseText: reader.result });\n    };\n    reader.readAsText(binary_file);\n    return def.promise();\n  },\n\n  stringToByteArray: function stringToByteArray(binary) {\n    return bizagi.util.stringToByteArray(binary);\n  },\n\n\n  getUploadFileEntityUrl: function getUploadFileEntityUrl(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUETEMPLATE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"fileContent\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\n    if (params.isContextContainerWidgetRender) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"xpathactions\"] = params.xpathActions;\n    } else {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogatekey;\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\n    }\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n\n  /*\r\n      *   Returns the upload add url\r\n      */\n  getUploadAddUrl: function getUploadAddUrl() {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-add-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDFILE\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n  },\n  /*\r\n      *   Returns the upload add url\r\n      */\n  getUploadAddFileUrl: function getUploadAddFileUrl(isUserPreferences) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"form-submit-data-upload\");\n    var data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = isUserPreferences === true ? \"SAVEUSERIMAGE\" : \"savefile\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n  },\n\n  deleteImage: function deleteImage(params) {\n    var self = this;\n\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"DELETEUSERIMAGE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // Log submit data\n    bizagi.debug(\"Removing image '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n\n  /*\r\n      *   Returns the upload add url\r\n      */\n  deleteUploadFile: function deleteUploadFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // Log submit data\n    bizagi.debug(\"Removing file in upload '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-upload-delete-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n\n  },\n  /*\r\n      * Return file meta data\r\n      */\n  getECMMetadata: function getECMMetadata(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"getECMMetadata\";\n    data.idFileUpload = params.idFileUpload;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    if (params.sessionId) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    }\n    // Log submit data\n    bizagi.debug(\"Get file metadata '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      interceptor: {\n        intercept: true,\n        source: \"rendering_\" + self.guid } });\n\n\n\n  },\n  /*\r\n      * Checkout a file\r\n      **/\n  checkOutFile: function checkOutFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"checkOutFile\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n\n    // Log submit data\n    bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      * cancelCheckOut\r\n      **/\n  cancelCheckOut: function cancelCheckOut(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"cancelCheckOut\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"file checkout '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      * Checkout a file\r\n      **/\n  deleteECMFile: function deleteECMFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"delete\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"delete file'\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *  Update ECM file content\r\n      **/\n  updateECMFileContent: function updateECMFileContent(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"updateECMFileContent\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n\n    data.metaValues = params.metaValues;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"Update file content '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *  Update file content\r\n      **/\n  updateECMMetadata: function updateECMMetadata(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"updateECMMetadata\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n\n    data.metaValues = params.metaValues;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"Update file meta data '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  getFileProperties: function getFileProperties(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"getFileProperties\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n    // Log submit data\n    bizagi.debug(\"Get file properties '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      interceptor: {\n        intercept: true,\n        source: \"rendering_\" + self.guid } });\n\n\n  },\n  getFile: function getFile(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"fileContent\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"fileId\"] = params.fileId;\n\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || url,\n      data: jQuery.param(data),\n      type: \"POST\",\n      dataType: \"binary\",\n      processData: false });\n\n  },\n  uploadECMFile: function uploadECMFile(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data.action = \"uploadECMFile\";\n    data.fileUpload = params.fileUpload; // Content of file\n    data.xPath = params.xPath;\n\n    data.idAttrib = params.idAttrib;\n    data.fileName = params.fileName;\n    data.metaValues = params.metaValues;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n\n\n    // Log submit data\n    bizagi.debug(\"Upload ECM file '\" + params.xPath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  getECMFileUrl: function getECMFileUrl(params) {\n    var self = this;\n    var url = params.url || self.serviceLocator.getUrl(\"render-ecm-upload-url\") + \"File\";\n\n    // Define data\n    var data = params.extra || {};\n\n    data.action = \"viewECMFile\";\n    data.idFileUpload = params.idFileUpload;\n    data.xPath = params.xPath;\n    data.idAttrib = params.idAttrib;\n\n    data.fileName = params.fileName;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data.xpathContext = params.xpathContext;\n    if (params.sessionId) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    }\n    if (params.p_sessionId) {\n      data.p_sessionId = params.p_sessionId;\n    }\n\n\n    // Log submit data\n    bizagi.debug(\"View uploaded file '\" + params.xPath + \"'\", data);\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n  /*\r\n      *\r\n      */\n  isFileOnECM: function isFileOnECM(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    data[\"action\"] = \"isFileOnECM\";\n    data[\"idUpload\"] = params.idUpload;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"render-ecm-upload-url\"), data);\n  },\n  /*\r\n      *   Start a grid record edition\r\n      */\n  editGridRecord: function editGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EDITRELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending edit request for relation '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-edit-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"EDITRELATION\" });\n\n  },\n  /*\r\n      *   Sends a grid request to add a new row\r\n      *   The server returns the new row in json\r\n      */\n  addGridRecord: function addGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Log submit data\n    bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\n\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"ADDRELATION\" });\n\n  },\n  /*\r\n      *   Sends a grid request to add a new row, and sending the data at the same time\r\n      *   The server returns the new row in json\r\n      */\n  addGridRecordData: function addGridRecordData(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ADDRELATIONWITHDATA\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Build data to submit\n    var submitData = params.submitData || {};\n    for (key in submitData) {\n      data[key] = submitData[key];\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending add request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-add-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"ADDRELATIONWITHDATA\" });\n\n  },\n  /*\r\n      *   Submits the grid record data to the server\r\n      */\n  saveGridRecord: function saveGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVERELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disableServerGridValidations\"] = params.disableServerGridValidations || false;\n\n    // Send the submitted data page cache because it cointains the grid's form page cache\n    if (params.submitData.idPageCache) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\n      delete params.submitData.idPageCache;\n    }\n\n    var submitData = params.submitData || {};\n\n    // Build data to submit\n    submitData = self.processDataValues(submitData);\n\n    for (key in submitData) {\n      data[key] = submitData[key];\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SAVERELATION\" });\n\n  },\n  /*\r\n      *   Deletes a grid record in the server\r\n      */\n  deleteGridRecord: function deleteGridRecord(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REMOVERELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending delete request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"REMOVERELATION\" });\n\n  },\n\n  /*\r\n      * Get association flipped status\r\n      */\n  getFlipAssociation: function getFlipAssociation(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.id;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"flipped\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"flipstate\"] = params.flipstate;\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log request data\n    bizagi.debug(\"Sending request for flip association control '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"text\" }).\n    pipe(function (response) {\n      try {\n        // Try to attempt to parse JSON\n        return bizagi.services.ajax.parseJSON(response);\n      } catch (e) {\n        // If JSON is not valid we need to return the original text response\n        return response;\n      }\n    });\n  },\n  /*\r\n      *   Cancels an add or edit request for a grid\r\n      */\n  rollbackGridAction: function rollbackGridAction(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"ROLLBACK\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-rollback-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"ROLLBACK\" });\n\n  },\n  /*\r\n      *   Returns the search render default image\r\n      */\n  getSearchDefaultImage: function getSearchDefaultImage() {\n    return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-search-default-image\");\n  },\n\n  processDataCriteria: function processDataCriteria(criteria) {\n    var o;\n    criteria = $.extend(true, [], criteria);\n    for (o in criteria) {\n      if (criteria.hasOwnProperty(o) && criteria[o].hasOwnProperty(\"value\") && $.type(criteria[o].value) == \"object\") {\n        // for search\n        if (criteria[o].value.hasOwnProperty(\"id\") && criteria[o].value.hasOwnProperty(\"label\")) {\n          criteria[o].value = criteria[o].value.id;\n        }\n      }\n    }\n    return criteria;\n  },\n\n  /*\r\n      *   Perform entity search in the server\r\n      */\n  submitSearch: function submitSearch(params) {\n    var self = this,criteria;\n\n    // Define data\n    var data = params.extra || {};\n\n    var sort = params.sort && params.sort !== \"\" ? params.sort : \"\";\n\n    if (params.order && params.order !== \"\" && sort !== \"\")\n    sort += \" \" + params.order;\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SEARCHENTITYFORRENDER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchForm\"] = params.idSearchForm;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = sort;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"page\"] = params.page;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"pageSize\"] = params.rows;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchFilter\"] = params.searchFilter;\n\n    criteria = self.processDataCriteria(params.criteria);\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"searchCriteria\"] = JSON.encode(criteria);\n\n    // Optional search params\n    if (params.allowFullSearch)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"allowFullSearch\"] = params.allowFullSearch;\n    if (params.maxRecords)\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxRowsAllowed\"] = params.maxRecords;\n\n    // Log submit data\n    bizagi.debug(\"Performing advanced search\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-search-advanced-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SEARCHENTITYFORRENDER\" });\n\n  },\n\n  /*\r\n      *   Submits the stakeholder associated\r\n      */\n  associateStakeholder: function associateStakeholder(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"surrogateKey\"] = params.surrogateKey;\n    data[\"associatedUser\"] = params.associatedUser;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guidentity;\n\n    // Log submit data\n    bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    // TODO: change REST library in order to support extra HTTP parameters\n    // Please be careful with dataType parameter\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\" });\n\n  },\n\n  /*\r\n      *   Refresh the stakeholder associated list\r\n      */\n  refreshAssociateStakeholder: function refreshAssociateStakeholder(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Log submit data\n    bizagi.debug(\"Property refresh for '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    // TODO: change REST library in order to support extra HTTP parameters\n    // Please be careful with dataType parameter\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-stakeholder-associated\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\" });\n\n  },\n\n  /*\r\n      *   Gets the link to the letter\r\n      */\n  getLetterNotEditableUrl: function getLetterNotEditableUrl(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Call ajax and returns promise\n    var url = params.url || self.serviceLocator.getUrl(\"render-letter-notEditable-url\");\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n  },\n  /*\r\n      *   Gets the content for editable letters\r\n      */\n  getLetterContent: function getLetterContent(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"GETLETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-letter-content-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"html\" }).\n    pipe(function (response) {\n      try {\n        return bizagi.services.ajax.parseJSON(response);\n      } catch (e) {\n        return response;\n      }\n    });\n  },\n  /*\r\n      *   Get the can generate letter flag\r\n      */\n  getCanGenerateLetter: function getCanGenerateLetter(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CANGENERATELETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"render-letter-content-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *   Saves the content for editable letters\r\n      */\n  saveLetterContent: function saveLetterContent(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"UPDATELETTER\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // Define content\n    var content = params.content || \"\";\n\n    // Define url\n    var url = params.url || self.serviceLocator.getUrl(\"render-letter-save-url\");\n    var fullUrl = url + \"?\" + jQuery.param(data);\n\n    // Log submit data\n    bizagi.debug(\"Save request for letter sent to: \" + fullUrl, content);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: fullUrl,\n      data: content,\n      type: \"POST\",\n      dataType: \"html\" });\n\n  },\n  /*\r\n      *   Returns the icons path for the letter plugin\r\n      */\n  getLetterEditorIconsPath: function getLetterEditorIconsPath() {\n    return bizagi.services.ajax.pathToBase + this.serviceLocator.getUrl(\"render-letter-content-icons\");\n  },\n  /*\r\n      *   Executes a button action in the server\r\n      */\n  executeButton: function executeButton(params) {\n    return this.getPropertyData($.extend(params, {\n      property: \"buttonRule\" }));\n\n  },\n  /*\r\n      *   Executes a fileprint action in the server\r\n      */\n  getFilePrintUrl: function getFilePrintUrl(params) {\n\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-upload-data-url\");\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = \"data\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data);\n\n  },\n  /*\r\n      *   Start a link form edition\r\n      */\n  editLinkForm: function editLinkForm(params) {\n    // Actually it does the same than edit grid records\n    return this.editGridRecord(params);\n  },\n  /*\r\n      *   Saves the content of the link form\r\n      */\n  saveLinkForm: function saveLinkForm(params) {\n    // Actually it does the same than edit grid records\n    //return this.saveGridRecord(params);\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"SAVEFORMLINKRELATION\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Send the submitted data page cache because it cointains the grid's form page cache\n    if (params.submitData.idPageCache) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.submitData.idPageCache;\n      delete params.submitData.idPageCache;\n    }\n\n    var submitData = params.submitData || {};\n\n    // Build data to submit\n    submitData = self.processDataValues(submitData);\n\n    for (key in submitData) {\n      data[key] = submitData[key];\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending save request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-save-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"SAVEFORMLINKRELATION\" });\n\n  },\n  /*\r\n      *   Rollbacks the link form edition\r\n      */\n  rollbackLinkForm: function rollbackLinkForm(params) {\n    // Actually it does the same than rollback grid records\n    return this.rollbackGridAction(params);\n  },\n  /*   Commit the link form edition\r\n      */\n  commitLinkForm: function commitLinkForm(params) {\n    // Actually it does the same than rollback grid records\n    return this.commitGridAction(params);\n  },\n  /*   Sends schekpoint action\r\n      */\n  sendCheckpoint: function sendCheckpoint(params) {\n    // Actually it does the same than rollback grid records\n    return this.sendCheckpointAction(params);\n  },\n  /*\r\n      *   Loads the userfield definition\r\n      */\n  getUserfieldDefinition: function getUserfieldDefinition(params) {\n    var self = this;\n    params = params || {};\n\n    // Check in deferreds cache\n    if (self.userfieldRequests[params.userfield])\n    return self.userfieldRequests[params.userfield];\n\n    // Required params: idCase\n    self.userfieldRequests[params.userfield] = $.read(self.serviceLocator.getUrl(\"render-userfield-definition\"),\n    {\n      guidUserfield: params.userfield,\n      device: params.device || \"desktop\" });\n\n\n\n    // Return deferred\n    return self.userfieldRequests[params.userfield];\n  },\n  /**\r\n      *  Get render json for one render o container\r\n      *  @param {object} params object with idRender,idPageCache\r\n      */\n  refreshControl: function refreshControl(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESH\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n    params.idForm ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"PARTIALREFRESH\" });\n\n  },\n  /**\r\n      *  Get render json for one render o container\r\n      *  @param {object} params object with idRender,idPageCache\r\n      */\n  refreshGridCell: function refreshGridCell(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"REFRESHGRIDCELL\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidcolumn\"] = params.column;\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.idForm ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idForm\"] = params.idForm : \"\";\n    params.typeRender ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"typeRender\"] = params.typeRender : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /**\r\n      * Request to execute rule on server\r\n      * @param {object} params h_pageCacheId, guidrule\r\n      */\n  executeRule: function executeRule(params) {\n    var self = this;\n\n\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTERULE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidrule\"] = params.rule || \"\";\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n  /**\r\n      * Request to execute interface on server\r\n      * @param {object} params h_pageCacheId, guidinterface\r\n      */\n  executeInterface: function executeInterface(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEINTERFACE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidinterface\"] = params[\"interface\"] || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n  /**\r\n      * Request to execute SAP Connecor\r\n      * @param {object} params h_pageCacheId, guidinterface\r\n      */\n  executeSAPConnector: function executeSAPConnector(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTESAP\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidsap\"] = params.guidsap || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n  /**\r\n      * Request to execute a Bizagi connector\r\n      * @param params\r\n      * @return {{}}\r\n      */\n  executeConnector: function executeConnector(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTECONNECTOR\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidConnector\"] = params.guidConnector || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n\n  /**\r\n      * Request to execute pipeline on server\r\n      * @param {object} params h_pageCacheId, guidpipeline\r\n      */\n  executePipeline: function executePipeline(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"EXECUTEPIPELINE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidpipeline\"] = params.pipeline || \"\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext || \"\";\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-submit-data\"), data);\n  },\n\n  /*\r\n      *   Document Templates generate rest service\r\n      */\n  generateDocumentTemplate: function generateDocumentTemplate(params) {\n    var self = this;\n    params = params || {};\n    params.append = params.append ? params.append : false;\n\n    return $.create(\n    self.serviceLocator.getUrl(\"render-document-generate\"),\n    {\n      h_pageCacheId: params.idPageCache,\n      contextXpath: params.xpathcontext,\n      groupMappingId: params.groupMapping,\n      xpathAttribute: params.xpath,\n      append: params.append,\n      controlId: params.id });\n\n\n  },\n  /*\r\n      *   Document Templates generate rest service\r\n      */\n  getAllDocumentsDownloadUrl: function getAllDocumentsDownloadUrl(params) {\n    var self = this;\n    var url = this.serviceLocator.getUrl(\"render-document-generateAllDocuments\");\n    var data = {};\n    data[\"h_pageCacheId\"] = params.idPageCache;\n    data[\"contextXpath\"] = params.xpathContext;\n    data[\"xpathAttribute\"] = params.xpath;\n    data[\"idCase\"] = params.idCase;\n    data[\"idWorkItem\"] = params.idWorkItem;\n    data[\"p_sessionId\"] = params.sessionId;\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n\n  },\n\n\n  getCaseNumber: function getCaseNumber(params) {\n    var self = this;\n    //this function use sendEMail\n    //and not possible use dat ain ajax\n    //this is workaround (rhonyp)\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"case-handler-getCaseSummary\").replace(\"{idCase}\", params.idCase) + \"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice=\" + bizagi.isMobile(),\n      type: \"GET\",\n      dataType: \"json\" });\n\n  },\n\n  getCaseAssignees: function getCaseAssignees(params) {\n    var self = this;\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl(\"case-handler-getCaseAssignees\"), {\n      idCase: params.idCase }).\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    params = params || {};\n\n    return $.read(self.serviceLocator.getUrl(\"case-handler-getWorkItems\"), {\n      idCase: params.idCase,\n      onlyUserWorkItems: params.onlyUserWorkItems || \"\" });\n\n  },\n  /*\r\n      *   Executes a grid export action in the server\r\n      */\n  getGridExportUrl: function getGridExportUrl(params) {\n\n    var self = this,\n    url = this.serviceLocator.getUrl(\"render-upload-data-url\"),\n    data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.exportType; //\"data\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"disposition\"] = params.disposition;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sort\"] = params.sort;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"sessionId\"] = params.sessionId;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"idForm\"] = params.idForm;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    params.contexttype ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype : \"\";\n\n    return self.verifyPathToBase(bizagi.services.ajax.pathToBase, url) + \"?\" + jQuery.param(data) + \"&xsrf=\" + bizagi.getXSRFToken();\n  },\n\n  /*\r\n      * Executes a send email action in the server\r\n      */\n  sendEmail: function sendEmail(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {};\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"PROCESSPROPERTYVALUE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"propertyName\"] = params.property || \"sendEmail\";\n    params.xpathContext ? data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext : \"\";\n\n    // Email parameters\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"to\"] = params.to;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"subject\"] = params.subject;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"message\"] = params.message;\n    data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"selected\"] = JSON.encode(params.selected);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare) {\n      return data;\n    }\n\n    var url = params.url || self.serviceLocator.getUrl(\"form-get-data\");\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * Request to invalidates page cache in server, since it is no needed anymore\r\n      */\n  invalidatePageCache: function invalidatePageCache(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"INVALIDATEPAGECACHE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"form-submit-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"INVALIDATEPAGECACHE\" });\n\n  },\n\n  /*\r\n      * Search users usign parameters suchs as userName, fullName, domain and organization\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersList: function getUsersList(params) {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl(\"admin-getUsersList\"), params);\n  },\n  /*\r\n     * Search users usign parameters suchs as userName, fullName, domain and organization\r\n     * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n     * @return {deferred} ajax object with JSON content\r\n     */\n  getUsersListFromQueryForm: function getUsersListFromQueryForm(params) {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl(\"render-query-getUsersList\"), params);\n  },\n  /*\r\n      * Search users for preferences usign parameters suchs as userName, fullName, domain and organization\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersListFromPreferences: function getUsersListFromPreferences(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-FromPreferences\"), params);\n  },\n\n  /**\r\n      * Get Users when the context is the boss field and User Form\r\n      * @param {*} params \r\n      */\n  getUsersListForXpathIdBossUser: function getUsersListForXpathIdBossUser(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForXpathIdBossUser\"), params);\n  },\n\n  /**\r\n      * Get Users when the context is the delegate field and User Form\r\n      * @param {*} params \r\n      */\n  getUsersListForXpathIdDelegate: function getUsersListForXpathIdDelegate(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForXpathIdDelegate\"), params);\n  },\n\n  /*\r\n      * Search users for Stakeholders\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersListForStakeholders: function getUsersListForStakeholders(params) {\n    return $.read(this.serviceLocator.getUrl(\"admin-getUsersList-ForStakeholders\"), params);\n  },\n\n  /*\r\n      * Search users usign parameters suchs as userName, fullName, domain and organization\r\n      * @params { domain: (string), userName: (string), fullName: (string), organization: (string), page: (int), pageSize: (int) }\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getUsersForAssignation: function getUsersForAssignation(params) {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl(\"admin-getUsersForAssignation\"), params);\n  },\n\n  /**\r\n      * Get Users Creation/Edition Form\r\n      */\n  getUsersForm: function getUsersForm(params) {\n    var self = this;\n    return $.create(self.serviceLocator.getUrl(\"admin-usersform\"), params);\n  },\n  /**\r\n      *   Return generate Data To Send By Email\r\n      */\n  generateDataToSendByEmail: function generateDataToSendByEmail(params) {\n    var self = this;\n    params = params || {};\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"admin-GenerateDataToSendByEmail\"),\n      data: params,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /**\r\n      * Return generate Send user password Mail\r\n      */\n  sendUserEmail: function sendUserEmail(params) {\n    var self = this;\n    params = params || {};\n    var data = {\n      action: \"SendUserEmail\",\n      emailTo: params.eMailTo,\n      subject: params.subject,\n      body: params.body };\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"admin-sendUserEmail\"),\n      data: params,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n\n  /**\r\n      * Get bizagi configuration\r\n      * @param {Function}   type callback function when the file load is succed\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getConfiguration: function getConfiguration() {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"admin-users-config\");\n\n    return $.read(url);\n  },\n\n  /**\r\n      * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n      */\n  verifyPathToBase: function verifyPathToBase(pathToBase, url) {\n\n    if (url.indexOf(\"http\") != -1 && pathToBase != \"\") {\n      return url;\n    } else {\n      return pathToBase + url;\n    }\n\n  },\n\n  /**\r\n      * Get template of entity\r\n      * @param params { guid, prepare}\r\n      */\n  getTemplate: function getTemplate(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADTEMPLATE\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = \"entity\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidEntity\"] = params.guid;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isProcessData\"] = params.forcePersonalizedColumns;\n\n    if (params.templateType) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templatetype\"] = params.templateType;\n    }\n\n    if (params.templateGuid) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"templateguid\"] = params.templateGuid;\n    }\n\n    if (params.isDefaultTemplate != undefined) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isDefaultTemplate\"] = params.isDefaultTemplate;\n    }\n\n    // Fix device type since on mobility there are tablet_ios, tablet_android, smartphone_ios, smartphone_ios\n    // and the service recives either tablet or smartphone\n    var deviceType = bizagi.util.detectDevice();\n    if (bizagi.util.isTabletDevice()) {\n      deviceType = \"tablet\";\n    } else if (bizagi.util.isSmartphoneDevice()) {\n      deviceType = \"mobile\";\n    }\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = deviceType;\n\n    // When prepare is true just return data, this feature is used by multiaction service\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.create(self.serviceLocator.getUrl(\"form-get-data\"), data);\n  },\n\n  /**\r\n      * Chek if an entity has startform\r\n      * @param params\r\n      * @return {*}\r\n      */\n  hasStartForm: function hasStartForm(params) {\n    var self = this;\n    var data = {};\n\n    if (params.guidWFClass) {\n      data.guidWFClass = params.guidWFClass;\n    }\n\n    return $.read(self.serviceLocator.getUrl(\"render-processes-startform\"), data);\n  },\n\n  /**\r\n      * Get the start form of the case\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getStartForm: function getStartForm(params) {\n    var self = this;\n    var data = {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"LOADSTARTFORM\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"guidprocess\"] = params.guidprocess;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"isActionStartForm\"] = true;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\n\n    if (params.idStartScope) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\n    }\n    if (params.idCase) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idCase\"] = params.idCase;\n    }\n    if (params.idStartScope) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idStartScope\"] = params.idStartScope;\n    }\n    if (params.idWorkitem) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idWorkitem\"] = params.idWorkitem;\n    }\n    if (params.additionalXpaths) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\n    }\n    if (params.surrogatedKey) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"surrogatedKey\"] = params.surrogatedKey;\n    }\n    if (params.recordXpath) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"recordlauncherxpath\"] = params.recordXpath;\n    }\n    if (params.mappingstakeholders) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"mappingstakeholders\"] = params.mappingstakeholders;\n    }\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"form-get-data\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      cache: true });\n\n  },\n  /*\r\n      *   Start a link form edition\r\n      */\n  editActionForm: function editActionForm(params) {\n    // Actually it does the same than edit grid records\n    return this.editGridRecord(params);\n  },\n\n  /**\r\n      * Get list of actions in action launcher\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getActions: function getActions(params) {\n    var self = this;\n    var extendParams = $.extend(params, { prepare: true });\n\n    var data = self.getPropertyData(extendParams) || [];\n\n    if (params.ptags) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\n    }\n\n    if (params.pmaxitems) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"maxitems\"] = params.pmaxitems;\n    }\n\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\",\n      beforeSend: function beforeSend(xhr, status) {\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } });\n\n\n  },\n\n  /**\r\n      * Execute actions or constructors\r\n      * @param params\r\n      */\n  executeActions: function executeActions(params) {\n    var self = this;\n    var extendParams = $.extend({}, params, { prepare: true });\n    var data = self.getPropertyData(extendParams) || [];\n\n    if (params.pguidConstructor) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidConstructor\"] = params.pguidConstructor;\n    }\n\n    if (params.pguidAction) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"guidAction\"] = params.pguidAction;\n    }\n    if (params.prepare) {\n      return data;\n    }\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\" });\n\n\n  },\n\n  /**\r\n      * Get list of actions in action launcher\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getPolymorphicActions: function getPolymorphicActions(params) {\n    var self = this;\n    var extendParams = $.extend(params, { prepare: true });\n    var data = self.getPropertyData(extendParams) || [];\n\n    if (params.ptags) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"tags\"] = params.ptags;\n    }\n\n    if (params.additionalXpaths) {\n      data[self.Class.BA_ACTION_PARAMETER_PREFIX + \"additionalXpaths\"] = params.additionalXpaths;\n    }\n\n    if (params.prepare) {\n      return data;\n    }\n\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-property-refresh\"),\n      data: data,\n      type: \"POST\",\n      dataType: params.dataType || \"json\",\n      serviceType: \"PROCESSPROPERTYVALUE\" });\n\n  },\n\n  /**\r\n      * Make a JSON tree of polymorphic constructors categories\r\n      * @param values\r\n      * @return {Array}\r\n      */\n  serializePolymorphicActions: function serializePolymorphicActions(values) {\n    // json serializer\n    var actions = [];\n    var GUID_ENTITY = 0,DISPLAY_NAME = 1,XPATHCONTEXT = 2,TYPE = 3,GUID_OBJECT = 4,GUID_CONSTRUCTOR = 5,GUID_PARENT_ENTITY = 6;\n\n    /**\r\n                                                                                                                                 * Get children by guid of entity\r\n                                                                                                                                 * @param guid\r\n                                                                                                                                 * @return {Array}\r\n                                                                                                                                 */\n    var getChildren = function getChildren(guid) {\n      var children = [];\n      guid = guid || \"\";\n\n      $.each(values, function (key, value) {\n        if (value[GUID_PARENT_ENTITY] == guid) {\n          children.push(value);\n        }\n      });\n      return children;\n    };\n\n    /**\r\n        * Get parents by action object\r\n        * @param node\r\n        * @return {string}\r\n        */\n    var getParents = function getParents(node) {\n      node = node || {};\n      var parents = \"\";\n\n      $.each(values, function (key, value) {\n        if (value[GUID_ENTITY] == node[GUID_PARENT_ENTITY]) {\n          parents += getParents(value) + value[DISPLAY_NAME] + \" > \";\n        }\n      });\n      return parents;\n    };\n\n\n    /**\r\n        * Make a tree of actions\r\n        * @param list\r\n        * @param guid\r\n        * @return {*}\r\n        */\n    var fillTree = function fillTree(list, guid) {\n      var node;\n      var children = getChildren(guid);\n      $.each(children, function (key, value) {\n        var child = fillTree([], value[GUID_ENTITY]);\n        node = {\n          \"guidEntity\": value[GUID_ENTITY],\n          \"displayName\": value[DISPLAY_NAME],\n          \"hasConstructor\": value[GUID_CONSTRUCTOR] ? true : false,\n          \"type\": value[TYPE],\n          \"guidObject\": value[GUID_OBJECT],\n          \"guidConstructor\": value[GUID_CONSTRUCTOR],\n          \"xpathContext\": value[XPATHCONTEXT],\n          \"children\": child,\n          \"parents\": getParents(value) };\n\n        if (node.guidConstructor !== \"\" || node.children.length > 0) {\n          list.push(node);\n        }\n      });\n\n      return list;\n    };\n    fillTree(actions, \"\");\n    return actions;\n  },\n\n  /**\r\n      * Gets the image for an entity xpath\r\n      * @param params\r\n      */\n  getEntityImage64: function getEntityImage64(params) {\n    var self = this,\n    data = {\n      width: params.data,\n      height: params.height,\n      xpath: params.xpath },\n\n    url = self.serviceLocator.getUrl(\"render-entity-layout-image64\").replace(\"{entity}\", params.entity).replace(\"{surrogateKey}\", params.surrogateKey);\n\n    return $.ajax({\n      url: url,\n      data: data });\n\n  },\n\n  /**\r\n      * Get data files when user access from my stuff, because there is no scope\r\n      */\n  getFilesDataForLayoutUploadControl: function getFilesDataForLayoutUploadControl(params) {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl(\"render-entity-layout-upload-files\"), params);\n  },\n\n  /**\r\n      * Process an upload file into the server\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  processUploadFile: function processUploadFile(params) {\n    return $.ajax({\n      url: this.verifyMobilePathToBase(bizagi.services.ajax.pathToBase || \"\", params.url),\n      data: params.formData,\n      type: \"POST\",\n      contentType: false,\n      processData: false });\n\n  },\n\n  /**\r\n      * Commit an add or edit request for a grid\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  commitGridAction: function commitGridAction(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"COMMIT\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending rollback request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-commit-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"COMMIT\" });\n\n  },\n  /*\r\n      *   Commit an add or edit request for a grid\r\n      */\n  sendCheckpointAction: function sendCheckpointAction(params) {\n    var self = this;\n\n    // Define data\n    var data = params.extra || {};\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"CHECKPOINT\";\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpath\"] = params.xpath;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"idRender\"] = params.idRender;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"xpathContext\"] = params.xpathContext;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + self.Class.BA_PAGE_CACHE] = params.idPageCache;\n\n    if (params.contexttype) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"contexttype\"] = params.contexttype;\n    }\n\n    // Log submit data\n    bizagi.debug(\"Sending checkpoint request for grid '\" + params.xpath + \"'\", data);\n\n    // If the parameter \"prepare\" is true, only return the data, so we can use the multiaction request\n    if (params.prepare)\n    return data;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: params.url || self.serviceLocator.getUrl(\"render-grid-checkpoint-url\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"CHECKPOINT\" });\n\n  },\n\n  /**\r\n      * Validate if url has 'http' string, in that case is not necesary add the pathToBase prefix\r\n      */\n  verifyMobilePathToBase: function verifyMobilePathToBase(pathToBase, url) {\n    return bizagi.util.isMashupContext() ? (url || \"\").replaceAll(pathToBase, \"\") : url;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to multiaction rendering REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n$.Class.extend(\"bizagi.render.services.multiactionservice\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"pageCacheId\" },\n{\n\n  /* \r\n  *   Constructor\r\n  */\n  init: function init(service, limit, queue) {\n    this.service = service;\n    this.serviceLocator = service.serviceLocator;\n\n    // Multiaction - batch stuff\n    this.batch = {};\n    this.batchTimer = 50;\n    this.maxNumberOfActions = limit || 0;\n    this.queue = queue || null;\n    this.deferredBatchExecuting = $.Deferred();\n    this.deferredBatchExecuting.resolve();\n    this.disabledRequests = false;\n    this.circularDependencies = new bizagi.circularDependencies();\n\n    // Create proxyed version of methods\n    this.replicateServiceMethods();\n  },\n\n  /*\r\n     *   Returns the internal service\r\n     */\n  getService: function getService() {\n    return this.service;\n  },\n\n  /*\r\n     *   Create a proxied multiaction version for service calls\r\n     */\n  replicateServiceMethods: function replicateServiceMethods() {\n    var self = this;\n    for (var key in this.service.Class.prototype) {\n      // Omit the folowing methods\n      if (key == \"init\" || key == \"constructor\" || key == \"Class\" || key == \"multiaction\") continue;\n\n      // Replicate instance methods\n      self[key] = eval('var tmp = function(){ return this.proxyMethod(this.getService().' + key + ', arguments);};tmp');\n    }\n  },\n\n  /*\r\n     *   Perform the proxy call for each service method\r\n     */\n  proxyMethod: function proxyMethod(method, parameters) {\n    var service = this.service;\n\n    // Check if has only one argument, else execute directly\n    if (!parameters || parameters.length != 1) {\n      return method.apply(service, parameters);\n    }\n\n    // Check if the argument is object, else execute directly\n    if (_typeof(parameters[0]) != \"object\") {\n      return method.apply(service, parameters);\n    }\n\n    var params = parameters[0];\n\n    // If the caller is requesting a prepare call, just execute the method with the current parameters\n    if (params.prepare == true) return method.apply(service, parameters);\n\n    // Prepare the ajax instead of sending it\n    var originalPrepare = params.prepare;\n    params.prepare = true;\n\n    var action = method.apply(service, parameters);\n    if (originalPrepare === undefined || originalPrepare == null) delete params.prepare;else\n    params.prepare = originalPrepare;\n    return this.add(action);\n  },\n\n  /**\r\n     * This method make a standard error message\r\n     */\n  makeCircularDependenciesError: function makeCircularDependenciesError(error) {\n    var messageTmpl = bizagi.localization.getResource(\"render-actions-loop-validation\");\n\n    return printf(messageTmpl, error.dependencyFrom, error.dependencyTo);\n  },\n\n\n  /*\r\n     *   Add an action to be performed in a multiaction, and be resolved later\r\n     *   returns a deferred\r\n     */\n  add: function add(action) {\n    var self = this;\n    var deferred = new $.Deferred();\n\n    var name = action.h_action || \"unnamed\";\n\n    // Put here all actions to ignore in circular dependencies\n    var exceptionActions = [\"PROCESSPROPERTYVALUE\", \"LOADTEMPLATE\", \"ADDRELATIONWITHDATA\", \"GETFILE\"];\n\n    if (exceptionActions.indexOf(name) < 0 && bizagi.override.detectCircularDependencies) {\n      self.circularDependencies.addNode(name, action);\n    }\n\n    // First clear previous timeout\n    clearTimeout(self.batchTimeout);\n    var tag = action.tag = Math.guid();\n    var singleAction = { action: action, deferred: deferred };\n    self.batch[tag] = singleAction;\n\n    var fn = function fn() {\n      var resolveDependencies = self.circularDependencies.resolve();\n\n      if (resolveDependencies.error) {\n        // Reset Queue\n        for (var i in self.batch) {\n          var message = resolveDependencies.error.multiactionError;\n          self.batch[i].deferred.reject(message);\n        }\n        self.batch = {};\n      } else\n      if (!self.disabledRequests) {\n        self.deferredBatchExecuting = self.fire();\n      }\n    };\n\n    // Start a new timeout\n    self.batchTimeout = setTimeout(fn, self.batchTimer);\n\n    // If we have a limit, then fire it again\n    if (self.maxNumberOfActions != 0) {\n      if (Object.keys(self.batch).length >= self.maxNumberOfActions) {\n        clearTimeout(self.batchTimeout);\n        fn();\n      }\n    }\n\n    return deferred.promise();\n  },\n  /*\r\n     *   Fires up the multiaction\r\n     */\n  fire: function fire() {\n    var self = this;\n    var batch = {};\n\n    // Prepare actions and clone batch manually\n    var actions = [];\n    $.each(self.batch, function (tag, item) {\n      actions.push(item.action);\n      batch[tag] = item;\n    });\n\n    // Reset batch\n    self.batch = {};\n\n    // Fire ajax \n    return $.when(self.execute({ actions: actions, rejectDeferreds: false })).\n    done(function (responses) {\n\n      // Process each response\n      $.each(responses, function (i, response) {\n        var tag = response.tag;\n        if (!response.error) {\n          batch[tag].deferred.resolve(response.result);\n        } else {\n          batch[tag].deferred.reject(response.error, response, response.error.message);\n        }\n\n        // Remove paired tag from collection\n        delete batch[tag];\n      });\n\n      // Check if there are unpaired actions so we need to trigger fail deferred\n      $.each(batch, function (i, item) {\n        item.deferred.reject({ type: \"not-processed\", message: \"Operation didn't executed\" }, '', \"Operation didn't executed\");\n      });\n    }).fail(function (xhr, type, error) {\n\n      // Check if there are unpaired actions so we need to trigger fail deferred\n      var errorMessage = typeof error !== \"undefined\" ? error.message : error || \"Operation didn't executed\";\n      $.each(batch, function (i, item) {\n        item.deferred.reject({ type: \"not-processed\", message: errorMessage }, '', \"Operation didn't executed\");\n      });\n    });\n  },\n  /*\r\n     *   Sends a multiaction to the server\r\n     */\n  execute: function execute(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\n\n    // Check action tag\n    $.each(params.actions, function (i, action) {\n      action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\n      delete action.tag;\n    });\n\n    // Fill optional parameters\n    params = params || {};\n    if (params.actions) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\n    }\n\n    // Log submit data\n    bizagi.debug(\"Performing multi-action\", data);\n\n    // Call ajax and returns promise\n    var deferred = new $.Deferred();\n    $.ajax({\n      url: self.serviceLocator.getUrl(\"render-multiaction\"),\n      data: data,\n      queue: this.queue,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"MULTIACTION\",\n      beforeSend: function beforeSend(xhr, status) {\n        xhr.renderingService = true;\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } }).\n\n    done(function (responses) {\n      for (i in responses) {\n        if (typeof responses[i] !== \"function\") {\n          var response = responses[i];\n          if (response.error) {\n            if (rejectDeferreds) {\n              deferred.reject(response.error, \"servererror\", response);\n              return;\n            }\n\n          }\n        }\n      }\n      deferred.resolve(responses);\n\n    }).fail(function (xhr) {\n      var response = xhr.responseText || xhr;\n      var finalResponse = {};\n      // Try to parse the response\n      try {\n        finalResponse = JSON.parse(response);\n      } catch (e) {}\n      deferred.reject(xhr, \"servererror\", finalResponse);\n    });\n\n    return deferred.promise();\n  },\n\n  /**\r\n      * Disable the request, restart the form is mandatory who calls this method \r\n      * or unexpected behavior will happen on the form\r\n      */\n  disableRequests: function disableRequests() {\n    var self = this;\n    self.disabledRequests = true;\n  },\n\n  /**\r\n      * Identify if batch action is running, by default is resolved\r\n      * @returns Deferred object if batch action is running\r\n      */\n  validateIfBatchIsExecuting: function validateIfBatchIsExecuting() {\n    var self = this;\n    return self.deferredBatchExecuting;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Ricardo Perez\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n//$.Class.extend\n$.Class(\"bizagi.workportal.services.db\", {}, {\n  /* \r\n                                               *   Constructor\r\n                                               */\n  init: function init() {\n    var self = this;\n\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n\n    if (!self.disabledb) {\n      self.createDatabases();\n    }\n  },\n\n  /*\r\n     * Delete all Documents (databases)\r\n     * Example for callback : function (err, info) { }\r\n     * \r\n     */\n  _destroy: function _destroy(callback) {\n    this.deleteDatabases(callback);\n  },\n\n  createDatabases: function createDatabases() {\n    var self = this;\n    var globalIdHash = self.globalId.hashCode();\n\n    self.dbRecentProcesses = new PouchDB(\"RecentProcesses\" + globalIdHash, { auto_compaction: true }); // Recent process\n    self.dbProcessesHierarchy = new PouchDB(\"ProcessesHierarchy\" + globalIdHash, { auto_compaction: true }); // Process hierarchy to new cases creation\n    self.dbStartForms = new PouchDB(\"StartForms\" + globalIdHash, { auto_compaction: true }); // To save all forms for server\n    self.dbStartData = new PouchDB(\"StartData\" + globalIdHash, { auto_compaction: true }); // Save the data from forms    \n\n    //Offline forms in whole process\n    self.dbActivities = new PouchDB(\"Activities\" + globalIdHash, { auto_compaction: true }); // Save the offline tasks that can be worked with offline forms\n    self.dbActivityForms = new PouchDB(\"ActivityForms\" + globalIdHash, { auto_compaction: true });\n    self.dbActivityData = new PouchDB(\"ActivityData\" + globalIdHash, { auto_compaction: true }); // Cases in outbox that will be advanced\n    self.dbProcessColumns = new PouchDB(\"ProcessColumns\" + globalIdHash, { auto_compaction: true }); // Custom Columns (and metadata) for each Process\n  },\n\n  deleteDatabases: function deleteDatabases(callback) {\n    var def = new $.Deferred();\n    var self = this;\n\n    var databases = [\n    self.dbRecentProcesses,\n    self.dbProcessesHierarchy,\n    self.dbStartForms,\n    self.dbStartData,\n    self.dbActivities,\n    self.dbActivityForms,\n    self.dbActivityData,\n    self.dbProcessColumns];\n\n\n    var databasesDeleted = 0;\n    if (typeof callback === \"undefined\") {\n      callback = function callback(err, info) {\n        if (err) {\n          def.reject(err);\n        } else\n        {\n          databasesDeleted++;\n          if (databasesDeleted == databases.length) {\n            def.resolve(\"All db deleted successfully\");\n          }\n        }\n      };\n    }\n\n    databases.forEach(function (database) {\n      database.destroy(callback);\n    });\n\n    return def.promise();\n  },\n\n  restartDatabases: function restartDatabases() {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.deleteDatabases()).\n    done(function () {\n      self.createDatabases();\n      def.resolve();\n    }).\n    fail(function () {\n      self.createDatabases();\n      def.resolve();\n    });\n    return def.promise();\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n    return objects;\n  },\n\n  /*\r\n     *   This method return all the open cases for the user authenticated from de DB\r\n     *   Returns a promise\r\n     */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbStartData.query({ map: map }, { reduce: false }, function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  } });","/*\r\n*   Name: BizAgi Services Rendering End Points\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script defines all the end-points used to retrieve ajax stuff\r\n*   -   All urls must be relative to the base application\r\n*/\n\n// Create or define namespace\nbizagi.render = typeof bizagi.render !== \"undefined\" ? bizagi.render : {};\nbizagi.render.services = typeof bizagi.render.services !== \"undefined\" ? bizagi.render.services : {};\nbizagi.render.services.endPoints = [];\n\n// Creates a endpoint hash factory to resolve custom requirements\nbizagi.render.services.getEndPoints = function (params) {\n\n  var renderHandlerPathRest = \"Rest/Handlers/Render\";\n  var renderUploadHandlerPathRest = \"Rest/Handlers/Render/Upload\";\n  var renderFileHandlerPathRest = \"Rest/Handlers/RenderFile\";\n  var letterHandlerPathRest = \"Rest/Handlers/Letter\";\n  var multiActionHandlerPathRest = \"Rest/Handlers/MultiAction\";\n  var metadataHandlerPathRest = \"Rest/Handlers/Metadata\";\n  var metadataMultiactionHandlerPathRest = \"Rest/Handlers/MetadataMultiAction\";\n  // Default workportal end-points\n  if (params.context == \"workflow\") {\n    return {\n      \"form-get-data\": params.proxyPrefix + renderHandlerPathRest,\n      \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest,\n      \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest,\n      \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-multiaction\": params.proxyPrefix + multiActionHandlerPathRest,\n      \"render-upload-cancel-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest,\n      \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest,\n      \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-ecm-upload-url\": params.proxyPrefix + metadataHandlerPathRest,\n      \"render-multiaction-metadata\": params.proxyPrefix + metadataMultiactionHandlerPathRest,\n      \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-save-entity\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-search-default-image\": params.proxyPrefix + \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\",\n      \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest,\n      \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest,\n      \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-letter-content-icons\": params.proxyPrefix + \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\",\n      \"render-userfield-definition\": params.proxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\n      \"render-document-generate\": params.proxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\n      \"render-document-generateAllDocuments\": params.proxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\n      \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\n      \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\n      \"render-entity-layout-upload-files\": params.proxyPrefix + \"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}\",\n      \"render-query-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsersForQueryFormsById/{queryFormId}/\",\n      \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\",\n      \"case-handler-getCaseSummaryByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\n      \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\",\n      \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\n      \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\",\n      \"admin-getUsersList\": params.proxyPrefix + \"Rest/Users/SearchUsers\",\n      \"admin-getUsersList-FromPreferences\": params.proxyPrefix + \"Rest/Users/SearchUsersFromPreferences\",\n      \"admin-getUsersList-ForStakeholders\": params.proxyPrefix + \"Rest/Users/SearchUsersForStakeholders\",\n      \"admin-getUsersList-ForXpathIdBossUser\": params.proxyPrefix + \"Rest/Users/SearchUsersForBosses\",\n      \"admin-getUsersList-ForXpathIdDelegate\": params.proxyPrefix + \"Rest/Users/SearchUsersForDelegates\",\n      \"admin-getUsersForAssignation\": params.proxyPrefix + \"Rest/Users/UsersForAssignation\",\n      \"admin-users-config\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\n      //users administration\n      \"admin-usersform\": params.proxyPrefix + \"Rest/Handlers/Render\",\n      \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\n      \"admin-sendUserEmail\": params.proxyPrefix + \"Rest/Users/SendUserEmail\" };\n\n  }\n  // Sharepoint end-points (must be customized for each project)\n  if (params.context == \"sharepoint\" || params.context == \"portal\") {\n    if (typeof params.sharepointProxyPrefix === \"undefined\") alert(\"sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'\");\n    return {\n      \"form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"form-submit-data\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"form-submit-data-upload\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\n      \"render-property-refresh\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-multiaction\": params.sharepointProxyPrefix + multiActionHandlerPathRest,\n      \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.sharepointProxyPrefix + renderFileHandlerPathRest,\n      \"render-upload-add-url\": params.sharepointProxyPrefix + renderUploadHandlerPathRest,\n      \"render-upload-delete-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-ecm-upload-url\": params.sharepointProxyPrefix + metadataHandlerPathRest,\n      \"render-grid-edit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-add-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-rollback-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-commit-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-grid-checkpoint-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-save-entity\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-stakeholder-associated\": params.proxyPrefix + renderHandlerPathRest,\n      \"render-search-default-image\": \"jquery/css/bizagi/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.sharepointProxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.sharepointProxyPrefix + \"Rest/Handlers/Query\",\n      \"render-letter-notEditable-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\n      \"render-letter-content-url\": params.sharepointProxyPrefix + letterHandlerPathRest,\n      \"render-letter-save-url\": params.sharepointProxyPrefix + renderHandlerPathRest,\n      \"render-letter-content-icons\": \"jquery/css/plugins/other/images/nicEditorIcons.gif\",\n      \"render-userfield-definition\": params.sharepointProxyPrefix + \"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}\",\n      \"render-document-generate\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/CaseTemplates\",\n      \"render-document-generateAllDocuments\": params.sharepointProxyPrefix + \"Rest/DocumentTemplates/TemplatesConcatFilesToPDF\",\n      \"render-processes-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-processes-getstartform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      \"render-entity-layout-image64\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Base64\",\n      \"render-entity-layout-imageByteArray\": params.proxyPrefix + \"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&idcase={idcase}&idworkitem={idworkitem}&contextxpath={contextxpath}&h_={hash}\" + \"&xsrf=\" + bizagi.getXSRFToken(),\n      \"case-handler-getCaseSummary\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/Summary\",\n      \"case-handler-getCaseSummaryByGuid\": params.sharepointProxyPrefix + \"Rest/Cases/{guid}/SummaryByGuid\",\n      \"case-handler-getWorkItems\": params.sharepointProxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\n      \"case-handler-getWorkItemsByGuid\": params.proxyPrefix + \"Rest/Cases/{guid}/WorkItemsByGuid\" };\n\n  }\n\n  if (params.context == \"entitymanagement\") {\n    return {\n      \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=entity\",\n      \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=entity\",\n      \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\" };\n\n  }\n\n  if (params.context == \"search\") {\n    return {\n      \"form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"form-submit-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"form-submit-data-upload\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-property-refresh\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-upload-cancel-image\": \"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png\",\n      \"render-upload-data-url\": params.proxyPrefix + renderFileHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-upload-add-url\": params.proxyPrefix + renderUploadHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-upload-delete-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-edit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-add-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-rollback-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-commit-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-grid-checkpoint-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-default-image\": \"jquery/rendering/css/desktop/images/bizagi_xpress.png\",\n      \"render-search-form-get-data\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-search-advanced-url\": params.proxyPrefix + \"Rest/Handlers/Query\" + \"?h_contexttype=metadata\",\n      \"render-letter-notEditable-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-letter-content-url\": params.proxyPrefix + letterHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-letter-save-url\": params.proxyPrefix + renderHandlerPathRest + \"?h_contexttype=metadata\",\n      \"render-letter-content-icons\": \"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif\" };\n\n  }\n\n  return {};\n};","/*\r\n*   Name: BizAgi Rendering Service Context Factory\r\n*   Author: Diego Parra\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\n\n$.Class.extend(\"bizagi.render.services.context\", {}, {\n  /* \r\n                                                       *   Constructor\r\n                                                       */\n  init: function init(params) {\n    this.context = params.context;\n    this.endPoints = bizagi.render.services.getEndPoints(params);\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n  },\n\n  /*\r\n     *   Returns the given url for a specified service\r\n     */\n  getUrl: function getUrl(service) {\n    if (this.endPoints[service] == null) {\n      alert(\"No endpoint defined for: \" + service);\n    }\n    return this.endPoints[service];\n  },\n\n  setProxyPrefix: function setProxyPrefix(params) {\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    this.endPoints = bizagi.render.services.getEndPoints(params);\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\n\nbizagi.render.services.service.extend(\"bizagi.render.services.service\", {},\n{\n  /* \r\n   *   Constructor\r\n   */\n  init: function init(params) {\n    // Call base\n    var self = this;\n\n    self._super(params);\n    self.database = params.database;\n    self.gridService = new bizagi.grid.services.service({\n      renderDataService: this,\n      database: params.database });\n\n    self.fileService = new bizagi.file.services.service({\n      renderDataService: this,\n      database: params.database });\n\n    self.syncService = new bizagi.sync.services.service({\n      renderDataService: this,\n      database: params.database });\n\n    self.formService = new bizagi.form.services.service({\n      renderDataService: this,\n      database: params.database });\n\n  },\n\n  getFileService: function getFileService() {\n    var self = this;\n    return self.fileService;\n  },\n\n  getSyncService: function getSyncService() {\n    var self = this;\n    return self.syncService;\n  },\n\n  getGridService: function getGridService() {\n    var self = this;\n    return self.gridService;\n  },\n\n  getFormService: function getFormService() {\n    var self = this;\n    return self.formService;\n  },\n\n  getFormData: function getFormData(params) {\n    var self = this;\n\n    params = params || {};\n\n    if (!params.isOfflineForm) {\n      return self._super(params);\n    } else {\n      if (params.workitemstate == \"inactive\" && params.online && params.alreadyMarkedAsActive !== true) {\n        // Always call the backend service in order to mark the activity as opened  \n        self._super(params);\n      }\n      if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getNativeFormData !== \"undefined\") {\n        return self.getFormDataFromNative(params).\n        then(function (result) {\n          return self.database.mergeForm(result[1], result[0].data, { online: params.online });\n        });\n\n      } else {\n        if (params.offlineType === 'task') {\n          //It is not a start event\n          if (params.isEdited || !params.isOpen) {\n            var def = new $.Deferred();\n            $.when(self.database.getTaskData(params)).then(function (formData) {\n              var syncStatus = params.syncError || formData.syncStatus;\n              var hasSyncError = params.hasSyncError || !bizagi.util.isEmpty(syncStatus);\n              var formPromise = self.database.getTaskForm(params);\n              $.when(self.database.mergeDataDocument(formData.data, formPromise)).done(function (complexData) {\n                var object = {\n                  data: complexData,\n                  isOpen: params.isOpen };\n\n                self.database.mergeForm(object, formPromise, { online: params.online, hasSyncError: hasSyncError }).then(function (mergedForm) {\n                  def.resolve(mergedForm);\n                });\n              });\n\n            });\n            return def.promise();\n          } else\n\n          return self.database.getTaskForm(params);\n        } else\n        {\n          return $.when(self.database.getCase(params.idCase)).\n          then(function (response) {\n            var idWfClass = $.trim(response.idWfClass.toString());\n            return self.database.mergeForm(response, self.database.getFormData(idWfClass), { online: params.online });\n          });\n        }\n      }\n    }\n  },\n\n  getOfflineImage: function getOfflineImage(params, fileType) {\n    if (params.offlineType === \"task\")\n    return this.database.getActivityImage(params, fileType);else\n\n    return this.database.getStartDataImage(params, fileType);\n  },\n\n  getOfflineActivityDataImage: function getOfflineActivityDataImage(params, fileFormat) {\n    return this.database.getActivityDataImage(params, fileFormat);\n  },\n\n  saveOfflineImage: function saveOfflineImage(params, image) {\n    if (params.operationType === \"synchronization\")\n    return this.database.saveActivityFormImage(params, image);else\n    if (params.operationType === \"edition\") {\n      if (params.offlineType === \"task\")\n      return this.database.saveActivityDataImage(params, image);else\n\n      return this.database.saveStartDataImage(params, image);\n    } else\n\n    return null;\n  },\n\n  saveOfflineFile: function saveOfflineFile(params, file, mimeType) {\n    if (params.operationType === \"synchronization\")\n    return this.database.saveActivityFormFile(params, file, mimeType);else\n    if (params.operationType === \"edition\") {\n      if (params.offlineType === \"task\")\n      return this.database.saveActivityDataFile(params, file, mimeType);else\n\n      return this.database.saveStartDataFile(params, file, mimeType);\n    } else\n\n    return null;\n  },\n\n  getOfflineFile: function getOfflineFile(params, fileType, mimeType) {\n    if (params.offlineType === \"task\")\n    return this.database.getActivityFile(params, fileType, mimeType);else\n\n    return this.database.getStartDataFile(params, fileType, mimeType);\n  },\n\n  getOfflineActivityDataFile: function getOfflineActivityDataFile(params, fileType, mimeType) {\n    return this.database.getActivityDataFile(params, fileType, mimeType);\n  },\n\n  getFormDataFromNative: function getFormDataFromNative(params) {\n    var def = new $.Deferred();\n\n    bizagiapp.getNativeFormData(params, function (form) {\n\n      bizagiapp.getCase(params.idCase, function (caseInfo) {\n\n        var result = [JSON.parse(form), JSON.parse(caseInfo)];\n\n        def.resolve(result);\n\n      }, function (error) {\n\n        def.reject(error);\n\n      });\n\n\n    }, function (error) {\n      def.reject(error);\n    });\n\n    return def.promise();\n  },\n\n  submitData: function submitData(params) {\n    var self = this;\n\n    params = params || {};\n\n    if (!params.isOfflineForm) {\n      return self._super(params);\n    } else {\n\n      var data = self.resolveData(params.data || {}, params.xpathContext);\n      var action = (params.action || \"\").toLowerCase();\n      // current action (save, next or next without validations)\n      if (action != '' && (action == 'save' || action == 'next' || action == 'nextwithoutvalidations' || action == 'submitdata')) {\n        data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = action;\n      }\n\n      if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getNativeFormData !== \"undefined\") {\n        return self.saveNativeFormInfo(params, data);\n      }\n\n      if (params.offlineType === 'task') {\n        self.sanityDataForSaveInDB(data);\n\n        return self.database.saveTaskData(params, data);\n      } else\n      {\n        return self.database.saveStartData(params, data);\n      }\n    }\n  },\n\n  sanityDataForSaveInDB: function sanityDataForSaveInDB(data) {\n    delete data.deferreds;\n  },\n\n  saveNativeFormInfo: function saveNativeFormInfo(params, data) {\n    var self = this;\n\n    var def = new $.Deferred();\n\n    self.getFormDataFromNative(params).then(function (result) {\n      return self.database.nativesaveStartData(data, result[1], result[0].data).\n      done(function (doc) {\n        bizagiapp.saveFormData(params, doc);\n        def.resolve(doc);\n      });\n    });\n\n    return def.promise();\n  },\n\n\n  removeStartCaseSyncError: function removeStartCaseSyncError(params) {\n    var self = this;\n    var updatedStartCase;\n    return self.database.getCase(params.idCase).\n    then(function (startCase) {\n      startCase.isOpen = true;\n      delete startCase.syncDetails;\n      delete startCase.syncStatus;\n      updatedStartCase = startCase;\n      return self.database.saveStartCase(params.idCase, startCase);\n    }).\n    then(function () {\n      return updatedStartCase;\n    });\n  },\n\n  removeTaskCaseSyncError: function removeTaskCaseSyncError(params) {\n    var self = this;\n    var offlineId = params.idCase + \"-\" + params.idWorkitem;\n    var updatedTaskCase;\n    return self.database.getTask(offlineId).\n    then(function (taskCase) {\n      taskCase.isOpen = true;\n      taskCase.isEdited = true;\n      delete taskCase.syncDetails;\n      delete taskCase.syncStatus;\n      updatedTaskCase = taskCase;\n      return self.database.saveTask(offlineId, taskCase);\n    }).\n    then(function () {\n      return self.database.getTaskData(params);\n    }).\n    then(function (taskData) {\n      if (taskData && taskData.data != undefined) {\n        taskData.data.h_action = \"\";\n        delete taskData.data.retry_h_actions;\n        delete taskData.data.actions;\n      }\n      return self.database.saveTaskData(params, taskData.data);\n    }).\n    then(function () {\n      return updatedTaskCase;\n    });\n  },\n\n  parseServiceError: function parseServiceError(callbackArguments) {\n    var error = {};\n    var stringError;\n    if (callbackArguments == undefined) {\n      return;\n    }\n    if (callbackArguments.responseText) {\n      stringError = callbackArguments.responseText;\n    } else\n    if (callbackArguments.length == 1 && !callbackArguments[0].responseText) {\n      error = callbackArguments[0];\n    } else\n    if (callbackArguments.length > 0 && callbackArguments[0] && callbackArguments[0].responseText) {\n      stringError = callbackArguments[0].responseText;\n    } else if (callbackArguments.length == 3) {\n      var internalError = callbackArguments[2];\n      while (internalError != undefined && internalError.error) {\n        internalError = internalError.error;\n      };\n      if (internalError.errorType) {\n        error = internalError;\n      } else\n      {\n        error.type = \"error\";\n        error.errorType = callbackArguments[1];\n        error.message = callbackArguments[2];\n      }\n    } else\n    {\n      try {\n        stringError = JSON.stringify(callbackArguments);\n      } catch (parsingError) {}\n    }\n\n    if (stringError != undefined) {\n      try {\n        error = JSON.parse(stringError);\n      } catch (parsingError) {\n        error.type = \"error\";\n        error.errorType = \"parsingError\";\n        error.message = \"Error parsing the server response: \" + stringError;\n      }\n    }\n    return error;\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.file = bizagi.file || {};\nbizagi.file.services = bizagi.file.services || {};\nif (!bizagi.file.services.service) {\n  $.Class.extend(\"bizagi.file.services.service\", {\n    // STATIC METHODS\n    loaders: {},\n\n    isLoading: function isLoading(key) {\n      return this.loaders[key] || false;\n    },\n\n    setLoading: function setLoading(idCase, idWorkitem, xpathContext, xpath) {\n      var key = this.internalBuildOfflineFileLoadingKey(idCase, idWorkitem, xpathContext, xpath);\n      this.loaders[key] = true;\n    },\n\n    clearLoading: function clearLoading(idCase, idWorkitem, xpathContext, xpath) {\n      var key = this.internalBuildOfflineFileLoadingKey(idCase, idWorkitem, xpathContext, xpath);\n      this.loaders[key] = false;\n    },\n\n    internalBuildOfflineFileLoadingKey: function internalBuildOfflineFileLoadingKey(idCase, idWorkitem, xpathContext, xpath) {\n      var key = \"case:\" + idCase;\n      if (!bizagi.util.isEmpty(idWorkitem)) key += \"-\" + idWorkitem;\n      key += \"::\";\n\n      key += \"xpath:\";\n      if (!bizagi.util.isEmpty(xpathContext)) key += xpathContext + \".\";\n      key += xpath;\n\n      return key;\n    } },\n\n  {\n    EMPTY_IMAGE: \"R0lGODlhAQABAIAAAP7//wAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==\",\n\n    // INSTANCE METHODS\n    init: function init(params) {\n      var self = this;\n      self.renderDataService = params.renderDataService;\n      self.database = params.database;\n    },\n\n    isLoading: function isLoading(control)\n    {\n      return this.Class.isLoading(this.buildOfflineFileLoadingKey(control));\n    },\n\n    buildOfflineFileLoadingKey: function buildOfflineFileLoadingKey(control) {\n      var form = control.getFormContainer();\n      var idCase = form.getParams().idCase;\n      var idWorkitem = form.getParams().idWorkitem;\n\n      return this.Class.internalBuildOfflineFileLoadingKey(idCase, idWorkitem, control.properties.xpathContext, control.properties.xpath);\n    },\n\n    /*************************************************************************************************\r\n        *          DOWNLOAD IMAGE METHODS\r\n        *************************************************************************************************/\n    downloadFormImages: function downloadFormImages(form, params) {\n      var self = this;\n      var imageControls = self.database.filterXpathsByTypeMap(form, { image: true, columnImage: true, signature: true });\n      var promises = [];\n\n      // Create promises to add in multi-action\n      imageControls.forEach(function (imageControl) {\n        var id = self.buildOfflineImageId(imageControl.value, imageControl.xpathContext, imageControl.xpath);\n        if (params.localFiles[id]) return;\n\n        // In this case we won't wait for promise, because we wany async loading of this\n        promises.push(self.downloadImage(params, form.form, imageControl));\n      });\n\n      return promises;\n    },\n\n    downloadImage: function downloadImage(params, form, imageControl) {\n      var self = this;\n      var isVersion2OrSuperior = form.properties.compatibilityVersion >= 2;\n\n      if (isVersion2OrSuperior && bizagi.util.isEmpty(imageControl.value)) return $.Deferred().resolve(null).promise();\n\n      var getPropertyDataParams = {\n        xpath: imageControl.xpath,\n        idRender: imageControl.renderId,\n        xpathContext: imageControl.xpathContext || \"\",\n        idPageCache: form.pageCacheId,\n        sessionId: form.sessionId,\n        property: isVersion2OrSuperior ? \"fileBinaryContent\" : \"fileFullContent\" };\n\n\n      if (isVersion2OrSuperior) {\n        return self.downloadImageVersion2(params, getPropertyDataParams, form, imageControl);\n      }\n\n      return self.downloadImageVersion1(params, getPropertyDataParams, form, imageControl);\n    },\n\n    downloadImageVersion2: function downloadImageVersion2(params, getUploadFileUrlParams, form, imageControl) {\n      var self = this;\n      self.Class.setLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n      getUploadFileUrlParams.queue = params.bulkDownload ? \"offlineimages\" : undefined;\n\n      return self.renderDataService.downloadFile(getUploadFileUrlParams).\n      then(function (binary_file) {\n\n        binary_file.name = imageControl.xpath;\n        params.operationType = \"synchronization\";\n        params.id = self.buildOfflineImageId(imageControl.value, imageControl.xpathContext, imageControl.xpath);\n        return self.database.saveActivityFormImage(params, binary_file, binary_file.type);\n      }).\n      then(function () {\n        if (!params.bulkDownload) return self.ensureImageIsPersistedLocally(params);\n        return;\n      }).\n      always(function () {\n        self.Class.clearLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n      });\n    },\n\n    ensureImageIsPersistedLocally: function ensureImageIsPersistedLocally(params, counter) {\n      var self = this;\n      counter = counter || 3;\n      if (counter == 0) {\n        console.log(\"downloadImageVersion2::image not found after 3 retries '\" + params.id + \"'\", params);\n        return $.Deferred().resolve().promise();\n      }\n\n      // PERFORM A IMAGE LOADING IMMEDIATELY, TO MAKE SURE THE IMAGE IS THERE [BUG QA: 42953]\n      // **  ATTEMPT 3 TIMES WITH 200 ms of wait **\n      var getOfflineImageParams = {\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        id: params.id,\n        offlineType: \"task\",\n        loadImageFromForm: false };\n\n      var invokeAgain = false;\n      return self.renderDataService.getOfflineImage(getOfflineImageParams, bizagi.util.db.AttachmentType.Blob).\n      then(function (blob) {\n        if (blob == null) {\n          //bizagi.util.console.log(\"downloadImageVersion2::image not found '\" + params.id + \"' ... retrying \" + counter + \"more times\", params);\n          invokeAgain = true;\n          return bizagi.util.sleepFor(200);\n        }\n        return;\n      }).\n      then(function () {\n        if (invokeAgain) return self.ensureImageIsPersistedLocally(params, counter - 1);\n        return;\n      });\n    },\n\n    downloadImageVersion1: function downloadImageVersion1(params, getPropertyDataParams, form, imageControl) {\n      var self = this;\n      self.Class.setLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n\n      return self.renderDataService.multiaction().getPropertyData(getPropertyDataParams).\n      then(function (base64Image) {\n        if (base64Image == undefined) return;\n\n        var saveParams = {\n          id: imageControl.xpathContext ? imageControl.xpathContext + '.' + imageControl.xpath : imageControl.xpath,\n          idCase: params.idCase,\n          idWorkitem: params.idWorkitem,\n          operationType: \"synchronization\" };\n\n        return self.database.saveActivityFormImage(saveParams, base64Image);\n      }).\n      always(function () {\n        self.Class.clearLoading(params.idCase, params.idWorkitem, imageControl.xpathContext, imageControl.xpath);\n      });\n    },\n\n    /*************************************************************************************************\r\n        *          DOWNLOAD FILE METHODS\r\n        *************************************************************************************************/\n    downloadFormFiles: function downloadFormFiles(form, params) {\n      var self = this;\n      var data = {};\n      var promises = [];\n      var uploads = self.database.filterXpathsByTypeMap(form, { upload: true, columnUpload: true });\n      uploads.forEach(function (upload) {\n        var result = self.downloadFilesInUploadControl(params, form, upload);\n        Array.prototype.push.apply(promises, result);\n        if (upload.type !== \"columnUpload\") //Grid handles convertion by cell\n          data[upload.xpath] = self.database.convertUploadOnlineValueInOfflineValue(upload.value);\n      });\n\n      return {\n        data: data,\n        promises: promises };\n\n    },\n\n    downloadFilesInUploadControl: function downloadFilesInUploadControl(params, form, uploadControl) {\n      var self = this;\n      var promises = [];\n\n      if (uploadControl.value && Array.isArray(uploadControl.value)) {\n        uploadControl.value.forEach(function (singleFileValue) {\n          var fileId = singleFileValue[0];\n          var fileName = singleFileValue[1];\n          var fullXpath = (uploadControl.xpathContext ? uploadControl.xpathContext + '.' : '') + uploadControl.xpath + '.' + fileId;\n          if (params.localFiles[fullXpath]) return;\n\n          // In this case we won't wait for promise, because we wany async loading of this\n          promises.push(self.downloadSingleFile(params, form, uploadControl, fileId, fileName, fullXpath));\n        });\n      }\n      return promises;\n    },\n\n    downloadSingleFile: function downloadSingleFile(params, form, uploadControl, fileId, fileName, fullXpath) {\n      var self = this;\n      return self.downloadBinaryFile(params, form, uploadControl, fileId, fileName).\n      then(function (binaryFile) {\n        if (binaryFile) {\n          params.operationType = \"synchronization\";\n          params.id = fullXpath;\n          self.renderDataService.saveOfflineFile(params, binaryFile, binaryFile.type);\n        }\n      });\n    },\n\n    downloadBinaryFile: function downloadBinaryFile(params, form, uploadControl, fileId, fileName) {\n      var self = this;\n      var getFileUrlParams = {\n        xpath: uploadControl.xpath,\n        idRender: uploadControl.renderId,\n        xpathContext: uploadControl.xpathContext || \"\",\n        idPageCache: form.form.pageCacheId,\n        fileId: fileId,\n        sessionId: form.form.sessionId,\n        queue: params.bulkDownload ? \"offlinefiles\" : undefined };\n\n\n      return self.renderDataService.downloadFile(getFileUrlParams).\n      then(function (binary_file) {\n        binary_file.name = fileName;\n        return binary_file;\n      });\n    },\n\n\n\n    /*************************************************************************************************\r\n        *          UPLOAD IMAGE METHODS\r\n        *************************************************************************************************/\n    uploadFormImages: function uploadFormImages(params, imageValues) {\n      var self = this;\n      var promises = [];\n      imageValues.forEach(function (imageControl) {\n        var data = imageControl.value;\n        if (!data) return;\n\n        $.extend(params, imageControl);\n        promises.push(self.uploadImage(params, data));\n      });\n\n      return promises;\n    },\n\n    uploadFormGridImages: function uploadFormGridImages(params, imagesByRow, entityMap) {\n      var self = this;\n      var rowKeys = Object.keys(imagesByRow);\n      var promises = [];\n\n      for (var k = 0; k < rowKeys.length; k++) {\n        var row = imagesByRow[rowKeys[k]];\n        var imagesKeys = Object.keys(row);\n\n        for (var l = 0; l < imagesKeys.length; l++) {\n\n          if (imagesKeys[l] != \"isNew\") {\n            var imageInfo = row[imagesKeys[l]];\n            if (row.isNew) {\n              //Use created entity id\n              var newKey = entityMap[rowKeys[k]];\n              if (newKey === undefined) continue;\n              imageInfo.xpathContext = imageInfo.gridXpath + self.database.buildCellXpathFilter(newKey);\n            } else {\n              imageInfo.xpathContext = imageInfo.gridXpath + self.database.buildCellXpathFilter(rowKeys[k]);\n            }\n\n            if (!imageInfo) continue;\n\n            //Column image case\n            if (imageInfo.columnXpath) params.xpath = imageInfo.xpathContext + '.' + imageInfo.columnXpath;\n\n            uploadParams = $.extend({}, params, imageInfo);\n            promises.push(self.uploadImage(uploadParams, imageInfo));\n          }\n\n        }\n      }\n\n      return promises;\n    },\n\n    uploadImage: function uploadImage(params, data) {\n      var self = this;\n      var addParams = self.buildAddParamsForUpload(params, 'savefile');\n      var uploadFileName = !bizagi.util.isEmpty(data.name) ? data.name : \"offlineImage_\" + bizagi.util.randomNumber() + \".png\";\n      var uploadKey = params.xpath;\n      var uploadAddUrl = self.renderDataService.getUploadAddFileUrl(false);\n\n      var formData = new FormData();\n      $.each(addParams, function (key, item) {\n        formData.append(key, item);\n      });\n      return self.renderDataService.getOfflineImage({\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        id: data.offlineId,\n        offlineType: params.offlineType,\n        loadImageFromForm: false },\n      bizagi.util.db.AttachmentType.Blob).\n      then(function (binaryFile) {\n        if (data.isSignature && binaryFile == null)\n        binaryFile = bizagi.util.b64toBlob(self.EMPTY_IMAGE, \"image/png\");\n\n        if (binaryFile) {\n          formData.append(uploadKey, binaryFile, uploadFileName);\n          return $.ajax({ url: uploadAddUrl, type: \"POST\", contentType: false, processData: false, data: formData });\n        }\n\n        // Failed getOfflineImage\n        bizagi.util.console.error(\"UploadImage:: Missing local file\", params, data.offlineId);\n        return $.Deferred().reject({ type: \"error\", errorType: \"offlineUploadFileError\", message: \"Missing local file \" + data.offlineId }).promise();\n      }).\n      then(function (resp) {\n        if (resp.type && resp.type === \"error\") {\n          bizagi.util.console.error(\"UploadImage:: Server returned error\", params, resp);\n          return $.Deferred().reject(resp).promise();\n        }\n\n        bizagi.util.console.log(\"Image uploaded\", resp, uploadKey, uploadFileName);\n        return resp;\n      }).\n      fail(function (error) {\n        bizagi.util.console.error(\"UploadImage:: fail\", error);\n      });\n    },\n\n    /*************************************************************************************************\r\n        *          UPLOAD FILE METHODS\r\n        *************************************************************************************************/\n\n    uploadAndDeleteFormFiles: function uploadAndDeleteFormFiles(params, uploadValues, actions) {\n      var self = this;\n      var promises = [];\n      uploadValues.forEach(function (uploadControlValue) {\n        Array.prototype.push.apply(promises, self.uploadAndDeleteFiles(params, uploadControlValue, actions));\n      });\n\n      return promises;\n    },\n\n    uploadFormGridFiles: function uploadFormGridFiles(uploadParams, filesByRow, entityMap, actions) {\n      var self = this;\n      var promises = [];\n\n      var rowKeys = Object.keys(filesByRow);\n      for (var k = 0; k < rowKeys.length; k++) {\n        var row = filesByRow[rowKeys[k]];\n        var filesKeys = Object.keys(row);\n        for (var l = 0; l < filesKeys.length; l++) {\n          if (filesKeys[l] != \"isNew\") {\n            var fileInfo = row[filesKeys[l]];\n            if (row.isNew) {\n              //Use created entity id\n              var newKey = entityMap[rowKeys[k]];\n              if (newKey === undefined) continue;\n              fileInfo.xpathContext = fileInfo.gridXpath + self.database.buildCellXpathFilter(newKey);\n            } else {\n              fileInfo.xpathContext = fileInfo.gridXpath + self.database.buildCellXpathFilter(rowKeys[k]);\n            }\n            Array.prototype.push.apply(promises, self.uploadAndDeleteFiles(uploadParams, fileInfo, actions));\n          }\n\n        }\n      }\n\n      return promises;\n    },\n\n    uploadAndDeleteFiles: function uploadAndDeleteFiles(params, uploadControl, deleteActions) {\n      var promises = [];\n      var self = this;\n      var files = uploadControl.value;\n      if (!files || files.length == 0) {\n        return;\n      }\n\n      files.forEach(function (file) {\n        var status = file.status;\n        if (\"new\" === status) {\n          var uploadParams = {\n            fileId: file.id,\n            fileName: file.fileName,\n            fileMimeType: file.mimeType };\n\n          $.extend(uploadParams, params);\n          promises.push(self.uploadFile(uploadParams, uploadControl));\n\n        } else if (\"deleted\" === status) {\n          var deleteParams = {\n            renderId: uploadControl.renderId,\n            xpath: uploadControl.xpath,\n            fileId: file.id,\n            idPageCache: params.pageCacheId };\n\n          //Column file scenario\n          if (uploadControl.columnXpath) {\n            deleteParams.xpath = uploadControl.columnXpath;\n            deleteParams.xpathContext = uploadControl.xpathContext;\n          }\n          var deleteAction = self.deleteFile(deleteParams);\n          deleteActions.push(deleteAction);\n        }\n      });\n\n      return promises;\n    },\n\n    uploadFile: function uploadFile(params, uploadControl) {\n      var self = this;\n      var xpath = uploadControl.xpath;\n\n      //Column file scenario\n      if (uploadControl.columnXpath) {\n        xpath = uploadControl.columnXpath;\n        var xpathContext = uploadControl.xpathContext ? uploadControl.xpathContext + \".\" : \"\";\n        var attachmentId = xpathContext + xpath + '.' + params.fileId;\n        if (uploadControl.isNew && uploadControl.fullXpath) {\n          attachmentId = uploadControl.fullXpath + \".\" + params.fileId;\n        }\n      } else\n      {\n        var attachmentId = xpath + '.' + params.fileId;\n      }\n\n      return self.getOfflineFile(params, attachmentId).\n      then(function (blobFile) {\n        if (blobFile) {\n          var uploadFileParams = {\n            xpath: xpath,\n            renderId: uploadControl.renderId,\n            pageCacheId: params.pageCacheId,\n            sessionId: params.sessionId,\n            fileName: params.fileName,\n            xpathContext: uploadControl.xpathContext };\n\n          return self.uploadBinaryFile(uploadFileParams, blobFile);\n        }\n\n        bizagi.util.console.error(\"UploadFile:: Missing local file\", params, attachmentId);\n        return $.Deferred().reject({\n          type: \"error\",\n          errorType: \"offlineUploadFileError\",\n          message: \"Missing local file \" + attachmentId }).\n        promise();\n      });\n    },\n\n\n    uploadBinaryFile: function uploadBinaryFile(params, binaryFile) {\n      var self = this;\n      var addParams = self.buildAddParamsForUpload(params, 'addfile');\n      var formData = new FormData();\n      $.each(addParams, function (key, item) {\n        formData.append(key, item);\n      });\n      formData.append(params.xpath, binaryFile, params.fileName);\n\n      return self.renderDataService.processUploadFile({\n        url: self.renderDataService.getUploadAddUrl(),\n        formData: formData }).\n\n      then(function (res) {\n        if (res.type && res.type === \"error\") {\n          bizagi.util.console.error(\"UploadBinaryFile:: Server returned error\", params, res);\n          return $.Deferred().reject(res).promise();\n        } else\n        {\n          bizagi.util.console.log(\"File uploaded\", res, params.xpath, params.fileName);\n          return res;\n        }\n      });\n    },\n\n    getOfflineFile: function getOfflineFile(params, attachmentId) {\n      var self = this;\n      var offlineType = params.offlineType;\n      var getFileParams = {\n        id: attachmentId,\n        idCase: params.idCase };\n\n\n      if (offlineType && offlineType === \"start\") {\n        getFileParams.offlineType = params.offlineType;\n        return self.renderDataService.getOfflineFile(getFileParams, bizagi.util.db.AttachmentType.Blob, params.fileMimeType);\n      }\n\n      // Activity form\n      getFileParams.idWorkitem = params.idWorkitem;\n      return self.renderDataService.getOfflineActivityDataFile(getFileParams, bizagi.util.db.AttachmentType.Blob, params.fileMimeType);\n    },\n\n    deleteFile: function deleteFile(params) {\n      var self = this;\n      var fileId = params.fileId;\n      var fileXpath = params.xpath + (bizagi.util.isNumeric(fileId) ? \"[id=\" + fileId + \"]\" : \"[id='\" + fileId + \"']\");\n      var deleteParams = {\n        xpath: fileXpath,\n        idRender: params.renderId,\n        xpathContext: params.xpathContext || \"\",\n        idPageCache: params.idPageCache,\n        prepare: true };\n\n      return self.renderDataService.deleteUploadFile(deleteParams);\n    },\n\n    /*************************************************************************************************\r\n        *          UTIL METHODS\r\n        *************************************************************************************************/\n\n    buildOfflineImageId: function buildOfflineImageId(value, xpathContext, xpath, isVersion2OrSuperior, isStartForm) {\n      isVersion2OrSuperior = isVersion2OrSuperior || (isVersion2OrSuperior === undefined ? true : false);\n      if (bizagi.util.isEmptyValue(value)) value = null;\n      value = bizagi.util.isArray(value) && bizagi.util.isArray(value[0]) ? value[0][1] : value;\n\n      var result = (xpathContext ? xpathContext + '.' : '') + xpath;\n      if (isVersion2OrSuperior && !bizagi.util.isEmpty(value) && !isStartForm) {\n        result += '.' + value;\n      }\n      return result;\n    },\n\n    getOfflineImageName: function getOfflineImageName(value, forceChange) {\n      if (bizagi.util.isEmptyValue(value)) value = null;\n      var result = bizagi.util.isArray(value) && bizagi.util.isArray(value[0]) ? value[0][1] : null;\n      if (forceChange) {\n        result = \"offlineImage_\" + bizagi.util.randomNumber() + \".png\";\n      }\n      return result;\n    },\n\n    changeOfflineImageName: function changeOfflineImageName(value, imageName) {\n      if (bizagi.util.isEmptyValue(value)) return;\n      if (bizagi.util.isArray(value) && bizagi.util.isArray(value[0])) value[0][1] = imageName;\n    },\n\n    resolveBlobFromPath: function resolveBlobFromPath(path, fileName) {\n      var blobPromise = new $.Deferred();\n      var self = this;\n      var isNative = bizagi.util.isCordovaSupported();\n      if (isNative) {\n        if (!bizagi.util.isAndroidDevice()) {\n          path = bizagi.util.media.normalizeIOSFilePath(path);\n        } else\n        {\n          // Fix android 4.4 getting images from recent folder\n          path = bizagi.util.media.getImagePath(path);\n        }\n\n        var errorHandler = function errorHandler(error) {\n          bizagi.util.console.error('Error converting path to blob', error);\n          blobPromise.reject(error);\n        };\n\n        window.resolveLocalFileSystemURL(path, function (fileEntry) {\n          fileEntry.file(function (file) {\n            var reader = new FileReader();\n            reader.onloadend = function () {\n              var blob = new Blob([this.result], { type: file.type });\n              blob.name = fileName;\n              blobPromise.resolve(blob);\n            };\n            reader.readAsArrayBuffer(file);\n          }, errorHandler);\n        }, errorHandler);\n      } else\n      {\n        //In browser is the File\n        blobPromise.resolve(path);\n      }\n      return blobPromise;\n    },\n\n    buildAddParamsForUpload: function buildAddParamsForUpload(params, action) {\n      var addParams = {};\n      addParams[\"h_xpath\"] = params.xpath;\n      addParams[\"h_idRender\"] = params.renderId;\n      addParams[\"h_xpathContext\"] = params.xpathContext || \"\";\n      addParams[\"h_pageCacheId\"] = params.pageCacheId;\n      addParams[\"p_sessionId\"] = params.sessionId;\n      addParams[\"h_action\"] = action;\n\n      try {\n        BIZAGI_SESSION_NAME != undefined ?\n        addParams[BIZAGI_SESSION_NAME] = params.sessionId :\n        addParams[\"JSESSIONID\"] = params.sessionId;\n      } catch (e) {\n        addParams[\"JSESSIONID\"] = params.sessionId;\n      }\n      addParams.queueID = \"q_\" + bizagi.util.encodeXpath(params.xpath);\n      return addParams;\n    } });\n\n}","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.sync = bizagi.sync || {};\nbizagi.sync.services = bizagi.sync.services || {};\nbizagi.sync.services.service = bizagi.sync.services.service || {};\n$.Class.extend(\"bizagi.sync.services.service\", {\n  // STATIC METHODS\n  logKey: \"OFFLINE SYNC TRACES::\",\n  syncTraces: {},\n\n  getCurrentSyncStep: function getCurrentSyncStep(id) {\n    return this.syncTraces[id] ? this.syncTraces[id].currentStep : null;\n  },\n\n  setCurrentSyncStep: function setCurrentSyncStep(id, step, stepParameters) {\n    var trace = this.syncTraces[id] || {};\n    var traceAlreadyAdded = !bizagi.util.isEmpty(trace);\n    trace.currentStep = step;\n    trace.steps = trace.steps || [];\n    trace.steps.push({\n      step: step,\n      stepParameters: stepParameters });\n\n\n    if (!traceAlreadyAdded) {\n      this.syncTraces[id] = trace;\n    }\n  },\n\n  addSyncStepResponse: function addSyncStepResponse(id, stepName, stepResponse) {\n    var trace = this.syncTraces[id];\n    if (bizagi.util.isEmpty(trace)) {\n      console.error(\"OFFLINE SYNC TRACES::addCurrentSyncStepResponse:: Sync trace does not exist\", id);\n      return;\n    }\n    if (trace.steps == undefined) {\n      trace.steps = [];\n    }\n    var stepObject = trace.steps.find(function (value) {\n      return value.step == stepName;\n    });\n    if (bizagi.util.isEmpty(stepObject)) {\n      console.warn(\"OFFLINE SYNC TRACES::addCurrentSyncStepResponse:: step \" + stepName + \" does not exist\", stepName);\n      stepObject = {\n        step: \"not-found-\" + bizagi.util.randomNumber() + \"-\" + stepName };\n\n      trace.steps.push(stepObject);\n    }\n    stepObject.stepResponse = stepResponse;\n  },\n\n  addCurrentSyncStepResponse: function addCurrentSyncStepResponse(id, stepResponse) {\n    var trace = this.syncTraces[id];\n    if (bizagi.util.isEmpty(trace)) {\n      console.error(\"OFFLINE SYNC TRACES::addCurrentSyncStepResponse:: Sync trace does not exist\", id);\n      return;\n    }\n    this.addSyncStepResponse(id, trace.currentStep, stepResponse);\n  },\n\n  clearTrace: function clearTrace(id) {\n    if (!this.syncTraces[id]) return;\n    delete this.syncTraces[id].steps;\n  },\n\n  printTrace: function printTrace(id) {\n    var trace = this.syncTraces[id];\n    var traceLogKey = this.logKey + \"TRACE::\" + id + \"::\";\n    if (bizagi.util.isEmpty(trace)) return;\n    bizagi.util.console.log(traceLogKey + \" ** TRACE START **\", \"\");\n    bizagi.util.console.log(traceLogKey + \"LAST STEP:: \" + trace.currentStep, \"\");\n    (trace.steps || []).forEach(function (currentStep, stepIndex) {\n      bizagi.util.console.log(traceLogKey + (stepIndex + 1) + \"::\" + currentStep.step + \":: params\", currentStep.stepParameters);\n      bizagi.util.console.log(traceLogKey + (stepIndex + 1) + \"::\" + currentStep.step + \":: response\", currentStep.stepResponse);\n    });\n    bizagi.util.console.log(traceLogKey + \" ** TRACE END **\", \"\");\n  },\n\n  printAndClearTrace: function printAndClearTrace(id) {\n    var self = this;\n    setTimeout(function () {\n      self.printTrace(id);\n      self.clearTrace(id);\n    }, 1000);\n  } },\n\n\n{\n  // INSTANCE METHODS\n  init: function init(params) {\n    var self = this;\n    self.renderDataService = params.renderDataService;\n    self.database = params.database;\n    self.fileService = self.renderDataService.getFileService();\n    self.gridService = self.renderDataService.getGridService();\n  },\n\n  /*************************************************************************************************\r\n     *          MAIN SYNC METHODS\r\n     *************************************************************************************************/\n  syncOfflineStartCase: function syncOfflineStartCase(params) {\n    var self = this;\n    var serverResponse;\n    var offlineId = params.id || params.idCase;\n\n    var loadFormParams = {\n      action: \"LOADSTARTFORM\",\n      idProcess: params.idProcess,\n      downloadOfflineForm: true };\n\n\n    bizagi.util.console.log(\"SYNCHRONIZING Start Case\", params);\n    self.Class.setCurrentSyncStep(offlineId, \"getFormData\", params);\n    return self.renderDataService.getFormData(loadFormParams).\n    then(function (response) {\n      serverResponse = response;\n      self.Class.addCurrentSyncStepResponse(offlineId, response);\n      if (response.errorType) return $.Deferred().reject(response).promise();\n      if (!response.form) return $.Deferred().reject(\"Form not found in server response\").promise();\n      self.Class.setCurrentSyncStep(offlineId, \"separateComplexControls\", { data: params.data });\n      return self.database.separateComplexControls({ offlineType: \"start\" }, params.data);\n    }).\n    then(function (separatedCaseData) {\n      self.Class.addCurrentSyncStepResponse(offlineId, separatedCaseData);\n      params.pageCacheId = serverResponse.form.pageCacheId;\n      params.sessionId = serverResponse.form.sessionId;\n      params.formId = serverResponse.form.properties.id;\n      params.offlineType = \"start\";\n      return self.performSyncOfflineCase(params, separatedCaseData);\n    }).\n    then(function (performSyncResponse) {\n      //self.Class.printTrace(offlineId);\n      self.Class.clearTrace(offlineId);\n      return performSyncResponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(offlineId, error);\n      self.Class.printAndClearTrace(offlineId);\n      bizagi.util.console.error(\"START case sync failed\", error);\n      return self.updateSyncStatusError(error, \"start\", offlineId);\n    });\n  },\n\n  syncOfflineTaskCase: function syncOfflineTaskCase(params) {\n    var self = this;\n    var data = params.data;\n    var serverResponse;\n    delete params[\"data\"];\n    var offlineId = params.idCase + \"-\" + params.idWorkitem;\n\n    params.downloadOfflineForm = true;\n\n    //Retrieve the form from server in order to obtain a valid idPageCache\n    bizagi.util.console.log(\"SYNCHRONIZING Task Case\", params);\n    self.Class.setCurrentSyncStep(offlineId, \"getFormData\", params);\n    return self.renderDataService.getFormData(params).\n    then(function (response) {\n      serverResponse = response;\n      self.Class.addCurrentSyncStepResponse(offlineId, response);\n      if (response.errorType) return $.Deferred().reject(response).promise();\n      if (!response.form) return $.Deferred().reject(\"Form not found in server response\").promise();\n      self.Class.setCurrentSyncStep(offlineId, \"separateComplexControls\", { params: params, data: data });\n      return self.database.separateComplexControls(params, data);\n    }).\n    then(function (separatedCaseData) {\n      self.Class.addCurrentSyncStepResponse(offlineId, separatedCaseData);\n      params.pageCacheId = serverResponse.form.pageCacheId;\n      params.sessionId = serverResponse.form.sessionId;\n      params.offlineType = \"task\";\n      params.formId = serverResponse.form.properties.id;\n      params.id = offlineId;\n      return self.performSyncOfflineCase(params, separatedCaseData);\n    }).\n    then(function (performSyncResponse) {\n      //self.Class.printTrace(offlineId);\n      self.Class.clearTrace(offlineId);\n      return performSyncResponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(offlineId, error);\n      self.Class.printAndClearTrace(offlineId);\n      return self.updateSyncStatusError(error, \"task\", offlineId);\n    });\n  },\n\n  /*************************************************************************************************\r\n      *          INTERNAL METHODS\r\n      *************************************************************************************************/\n\n  performSyncOfflineCase: function performSyncOfflineCase(params, sData) {\n    var self = this;\n    var gridActions = [];\n    var collectedFormActions = [];\n    var entityMap;\n    params.gridPromises = null;\n    self.Class.setCurrentSyncStep(params.id, \"checkpoint\", params);\n    return self.createCheckpoint(params).\n    then(function (checkpointResponse) {\n      self.Class.addCurrentSyncStepResponse(params.id, checkpointResponse);\n      return self.processGridRecords(params, sData, gridActions, collectedFormActions);\n    }).\n    then(function (gridActionsResponse) {\n      entityMap = self.parseGridAdditionsResponse(gridActions, gridActionsResponse);\n      self.Class.addCurrentSyncStepResponse(params.id, { gridActionsResponse: gridActionsResponse, entityMap: entityMap });\n      return self.processUploads(params, sData, entityMap, collectedFormActions);\n    }).\n    then(function (result) {\n      self.Class.addSyncStepResponse(params.id, \"uploadPromises\", result);\n      return self.processMultiAction(params, sData.data, entityMap, collectedFormActions);\n    }).\n    then(function (processMultiactionresponse) {\n      self.Class.addSyncStepResponse(params.id, \"multiaction\", processMultiactionresponse);\n      return processMultiactionresponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(params.id, error);\n      var lastAction = self.Class.getCurrentSyncStep(params.id);\n      //Rollback for first checkpoint\n      return self.manageError(params, error, lastAction, arguments);\n    });\n  },\n\n  processGridRecords: function processGridRecords(params, data, gridActions, collectedActions) {\n    var self = this;\n    var gridValues = data.grids;\n\n    if (gridValues) {\n      params.gridPromises = gridPromises = self.gridService.uploadGridData(gridValues, params.pageCacheId);\n\n      if (gridPromises.bizAdditions && gridPromises.bizAdditions.length > 0)\n      Array.prototype.push.apply(gridActions, gridPromises.bizAdditions);\n\n      if (gridPromises.bizDeletions && gridPromises.bizDeletions.length > 0)\n      Array.prototype.push.apply(collectedActions, gridPromises.bizDeletions);\n    }\n    self.Class.setCurrentSyncStep(params.id, \"multiaction grid\", { gridVallues: gridValues, gridActions: gridActions });\n    return self.renderDataService.multiaction().execute({ actions: gridActions });\n  },\n\n  parseGridAdditionsResponse: function parseGridAdditionsResponse(gridActions, gridActionsResponse) {\n    var entityMap = {};\n\n    if (gridActions !== undefined && gridActions.length > 0) {\n      for (var i = 0; i < gridActions.length; i++) {\n        if (gridActionsResponse[i] && gridActionsResponse[i].result.type === \"success\")\n        entityMap[gridActions[i][\"offline-entityId\"]] = gridActionsResponse[i].result.IdEntity;\n      }\n    }\n    return entityMap;\n  },\n\n  processUploads: function processUploads(params, data, entityMap, actions) {\n    var self = this;\n    var uploadPromises = [];\n    var imageValues = data.images;\n    var uploadValues = data.uploads;\n\n    self.Class.setCurrentSyncStep(params.id, \"uploadPromises\", { imageValues: imageValues, uploadValues: uploadValues });\n    try {\n      if (uploadValues && uploadValues.length > 0)\n      Array.prototype.push.apply(uploadPromises, self.fileService.uploadAndDeleteFormFiles(params, uploadValues, actions));\n\n      if (imageValues && imageValues.length > 0)\n      Array.prototype.push.apply(uploadPromises, self.fileService.uploadFormImages(params, imageValues));\n\n      var gridPromises = params.gridPromises;\n      if (gridPromises) {\n        if (Object.keys(gridPromises.bizImages).length > 0)\n        Array.prototype.push.apply(uploadPromises, self.fileService.uploadFormGridImages(params, gridPromises.bizImages, entityMap, actions));\n\n        if (Object.keys(gridPromises.bizFiles).length > 0)\n        Array.prototype.push.apply(uploadPromises, self.fileService.uploadFormGridFiles(params, gridPromises.bizFiles, entityMap, actions));\n      }\n    } catch (e) {\n      return $.Deferred().reject(e).promise();\n    }\n    return $.when.apply($, uploadPromises);\n\n  },\n\n  processMultiAction: function processMultiAction(params, data, entityMap, actions) {\n    var self = this;\n    var offlineType = params.offlineType;\n    var syncAction = self.getSyncAction(offlineType, data);\n    var isNextAction = syncAction != undefined && syncAction.length > 0 && syncAction.toLowerCase().includes(\"next\");\n    var actions = self.prepareMultiActionData(params, data, entityMap, syncAction, actions);\n    var syncActionTagResponse, multiactionResponse, commitResponse, wasActionPerformed;\n    var lastAction = \"multiaction\";\n    self.Class.setCurrentSyncStep(params.id, lastAction, actions);\n\n    return self.renderDataService.multiaction().execute({ actions: actions }).\n    then(function (response) {\n      self.Class.addSyncStepResponse(params.id, \"multiaction\", response);\n\n      multiactionResponse = response;\n      wasActionPerformed = self.wasMultiActionPerformed(response);\n      syncActionTagResponse = response[response.length - 1].result;\n\n      if (!wasActionPerformed) return $.Deferred().reject(response).promise();\n\n      lastAction = \"commit-multiaction\";\n      self.Class.setCurrentSyncStep(params.id, \"commit-multiaction\");\n      return self.performCommit(params, isNextAction);\n    }).\n    then(function (response) {\n      commitResponse = response;\n      self.Class.addSyncStepResponse(params.id, \"commit-multiaction\", response);\n      return self.deleteOfflineCase(params, wasActionPerformed, isNextAction);\n    }).\n    then(function () {\n      if (!wasActionPerformed) return $.Deferred().reject(multiactionResponse).promise();\n\n      if (commitResponse != undefined && commitResponse.DataChangesetVersion != undefined) {\n        syncActionTagResponse.DataChangesetVersion = commitResponse.DataChangesetVersion;\n      }\n      syncActionTagResponse.containsNext = $.grep(actions, function (o) {return o.h_action.toLowerCase().includes(\"next\");}).length > 0;\n      return syncActionTagResponse;\n    }).\n    fail(function (error) {\n      self.Class.addCurrentSyncStepResponse(params.id, error);\n      var cleanTaskDataActions = lastAction == \"multiaction\" && !params.isRetry;\n      return self.performRollback(params, error, cleanTaskDataActions);\n    });\n  },\n\n  prepareMultiActionData: function prepareMultiActionData(params, data, entityMap, syncAction, actions) {\n    var self = this;\n    var multiActionData = self.convertStartFormDataToStandardFormat(data);\n    var submitDataDone = false;\n    self.replaceGridChangesWithAddedRows(multiActionData, entityMap);\n    var buttonActions = self.addButtonActions(params, multiActionData);\n    if (buttonActions !== null && buttonActions.length > 0) {\n      Array.prototype.push.apply(actions, buttonActions);\n      submitDataDone = true;\n    }\n    var trySaveorTryNextAction = self.addTrySaveOrTryNextAction(params, syncAction, multiActionData, submitDataDone);\n    if (!bizagi.util.isEmpty(trySaveorTryNextAction)) actions.push(trySaveorTryNextAction);\n\n    return actions;\n  },\n\n  replaceGridChangesWithAddedRows: function replaceGridChangesWithAddedRows(data, entityMap) {\n    if (bizagi.util.isEmpty(data)) return;\n\n    Object.keys(data).forEach(function (key) {\n      var matches = key.match(/\\[id=(\\d+)\\]/);\n      if (matches) {\n        var oldKey = matches[1];\n        var addedKey = entityMap[oldKey];\n        if (entityMap[oldKey] !== undefined) {\n          var oldXpath = key;\n          var newXpath = key.replace(oldKey, addedKey);\n          data[newXpath] = data[oldXpath];\n          delete data[oldXpath];\n        }\n      }\n    });\n  },\n\n  addButtonActions: function addButtonActions(params, data) {\n    var self = this;\n    var actions = [];\n\n    if (bizagi.util.isEmpty(data)) return [];\n    var button_actions = params.isRetry && data.retry_h_actions ? data.retry_h_actions : data.h_actions;\n    delete data.h_actions;\n    delete data.retry_h_actions;\n\n    if (!Array.isArray(button_actions) || button_actions.length < 1) return [];\n\n    var submitDataAction = self.renderDataService.submitData({\n      action: \"SUBMITDATA\",\n      data: data,\n      idPageCache: params.pageCacheId,\n      prepare: true });\n\n    submitDataAction.tag = \"submitData\";\n    actions.push(submitDataAction);\n\n    button_actions.forEach(function (h_action_item) {\n      if (h_action_item) {\n        h_action_item.h_pageCacheId = params.pageCacheId;\n        actions.push(h_action_item);\n      }\n    });\n\n    return actions;\n  },\n\n  addTrySaveOrTryNextAction: function addTrySaveOrTryNextAction(params, syncAction, data, submitDoneBefore) {\n    var self = this;\n    if (!bizagi.util.isEmpty(syncAction))\n    {\n      // object base without data\n      actionParams = {\n        action: syncAction,\n        idPageCache: params.pageCacheId,\n        prepare: true,\n        transitions: '' };\n\n\n      // add data only when is required\n      if (!submitDoneBefore) actionParams.data = data;\n\n      var result = self.renderDataService.submitData(actionParams);\n      result.tag = 'performAction';\n      return result;\n    }\n    return null;\n  },\n\n  deleteOfflineCase: function deleteOfflineCase(params, wasActionPerformed, isNextAction) {\n    var self = this;\n    var offlineType = params.offlineType;\n\n    if (offlineType === \"start\") {\n      self.Class.setCurrentSyncStep(params.id, \"deleteStartCase\", { params: params });\n      return self.database.deleteCase(params).\n      then(function (deleteCaseResponse) {\n        self.Class.addSyncStepResponse(params.id, \"deleteStartCase\", deleteCaseResponse);\n        return deleteCaseResponse;\n      });\n    }\n    // Regular activity form\n    self.Class.setCurrentSyncStep(params.id, \"removeSyncStatus\", { params: false });\n    return self.database.updateCaseSyncStatus({\n      type: offlineType,\n      id: params.id,\n      syncStatus: undefined,\n      syncDetails: undefined }).\n\n    then(function (updateSyncStatusResponse) {\n      self.Class.addSyncStepResponse(params.id, \"removeSyncStatus\", updateSyncStatusResponse);\n      self.Class.setCurrentSyncStep(params.id, \"updateTaskIsEdited\", { params: false });\n      return self.database.updateTaskIsEdited(params.id, false);\n    }).\n    then(function (updateIsEditedResponse) {\n      self.Class.addSyncStepResponse(params.id, \"updateTaskIsEdited\", updateIsEditedResponse);\n      var deleteTaskDataParams = isNextAction ? $.extend({ deleteAttachments: true }, params) : params;\n      self.Class.setCurrentSyncStep(params.id, \"deleteTaskData\", { deleteTaskDataParams: deleteTaskDataParams });\n      return self.database.deleteTaskData(deleteTaskDataParams);\n    }).\n    then(function (deleteTaskDataResponse) {\n      self.Class.addSyncStepResponse(params.id, \"deleteTaskData\", deleteTaskDataResponse);\n      if (offlineType === \"task\" && wasActionPerformed && isNextAction) {\n        self.Class.setCurrentSyncStep(params.id, \"deleteTaskForm\", { params: params });\n        return self.database.deleteTaskForm(params);\n      }\n      self.Class.setCurrentSyncStep(params.id, \"deleteTaskForm\", \"--skipped--\");\n    }).\n    then(function (deleteTaskFormResponse) {\n      self.Class.addSyncStepResponse(params.id, \"deleteTaskForm\", deleteTaskFormResponse);\n      if (offlineType === \"task\" && wasActionPerformed && isNextAction) {\n        self.Class.setCurrentSyncStep(params.id, \"deleteTaskIfNext\", { params: params });\n        return self.database.deleteTask(params);\n      }\n      self.Class.setCurrentSyncStep(params.id, \"deleteTaskIfNext\", \"--skipped--\");\n      return deleteTaskFormResponse;\n    }).\n    then(function (deleteTaskIfNextResponse) {\n      self.Class.addSyncStepResponse(params.id, \"deleteTaskIfNext\", deleteTaskIfNextResponse);\n      return deleteTaskIfNextResponse;\n    }).\n    fail(function (error) {\n      var deleteError = {\n        type: \"error\",\n        errorType: \"offlineSyncError\",\n        message: \"Local case could not be deleted\",\n        details: error };\n\n      self.Class.addCurrentSyncStepResponse(params.id, deleteError);\n      return $.Deferred().reject(deleteError).promise();\n    });\n  },\n\n  /*************************************************************************************************\r\n     *          UTIL METHODS\r\n     *************************************************************************************************/\n  convertStartFormDataToStandardFormat: function convertStartFormDataToStandardFormat(data) {\n    var result = {};\n    Object.keys(data).forEach(function (key) {\n      result[key] = data[key];\n      if (data[key].value !== undefined) {\n        result[key] = data[key].value;\n      }\n    });\n    return result;\n  },\n\n  getSyncAction: function getSyncAction(offlineType, data) {\n    if (offlineType === \"start\") return \"createnewcase\";else\n    if (data.h_action === \"save\") return \"trysave\";else\n    if (data.h_action === \"next\") return \"trynext\";\n    return data.h_action;\n  },\n\n  wasMultiActionPerformed: function wasMultiActionPerformed(res) {\n    return res.length > 0 && res[res.length - 1].result && res[res.length - 1].result.type === 'success';\n  },\n\n  createCheckpoint: function createCheckpoint(params) {\n    var self = this;\n    return self.renderDataService.sendCheckpoint({\n      idRender: params.formId,\n      xpath: \"\",\n      xpathContext: \"\",\n      idPageCache: params.pageCacheId });\n\n  },\n\n  performCommit: function performCommit(params, isNextAction) {\n    var self = this;\n    if (isNextAction) return $.Deferred().resolve(null).promise();\n\n    return self.renderDataService.commitGridAction({\n      idRender: params.formId,\n      xpath: \"\",\n      xpathContext: \"\",\n      idPageCache: params.pageCacheId });\n\n  },\n\n  manageError: function manageError(params, error, lastAction, args) {\n    var self = this;\n    if (lastAction != \"checkpoint\") {\n      if (Array.isArray(error)) {\n        error = error.map(function (err) {\n          return self.renderDataService.parseServiceError(err);\n        });\n      } else\n      {\n        error = self.renderDataService.parseServiceError(args);\n      }\n      return self.performRollback(params, error);\n    }\n    return self.updateSyncStatusError(args, params.offlineType, params.id);\n  },\n\n  performRollback: function performRollback(params, error, cleanTaskDataActions) {\n    var self = this;\n    self.Class.setCurrentSyncStep(params.id, \"rollback\", { params: params, error: error, cleanTaskDataActions: cleanTaskDataActions });\n    return self.renderDataService.rollbackGridAction({\n      idRender: params.formId,\n      xpath: \"\",\n      xpathContext: \"\",\n      idPageCache: params.pageCacheId }).\n\n    always(function (rollbackResponse) {\n      self.Class.addCurrentSyncStepResponse(params.id, rollbackResponse);\n      if (!cleanTaskDataActions) {\n        self.Class.setCurrentSyncStep(params.id, \"cleanTaskDataActions\", \"--skipped--\");\n        return;\n      }\n      self.Class.setCurrentSyncStep(params.id, \"cleanTaskDataActions\", { id: params.id });\n      return self.database.cleanTaskDataActions(params.id);\n    }).\n    then(function (cleanTaskDataActionsResponse) {\n      self.Class.addSyncStepResponse(params.id, \"cleanTaskDataActions\", cleanTaskDataActionsResponse);\n      if (params.offlineType == \"start\") {\n        self.Class.setCurrentSyncStep(params.id, \"openOfflineTask\", \"--skipped--\");\n        return;\n      }\n      self.Class.setCurrentSyncStep(params.id, \"openOfflineTask\", { id: params.id });\n      return self.database.openOfflineTask(params.id);\n    }).\n    then(function (openOfflineTaskResponse) {\n      self.Class.addSyncStepResponse(params.id, \"openOfflineTask\", openOfflineTaskResponse);\n      return $.Deferred().reject(error).promise();\n    });\n  },\n\n  updateSyncStatusError: function updateSyncStatusError(args, offlineType, identifier) {\n    var self = this;\n    var error = self.renderDataService.parseServiceError(args) || {};\n    var syncErrorDetails = self.buildSyncErrorObject(error);\n    return self.database.updateCaseSyncStatus({\n      type: offlineType,\n      id: identifier,\n      syncStatus: \"failed\",\n      syncDetails: syncErrorDetails }).\n\n    then(function () {\n      return $.Deferred().reject(error).promise();\n    });\n  },\n\n  buildSyncErrorObject: function buildSyncErrorObject(error) {\n    var syncErrorType = \"technical\";\n    var message = [];\n    var performActionObject = error;\n\n    if (Array.isArray(error)) {\n      error.forEach(function (singleError) {\n        if (singleError.result == undefined) return;\n        var responseType = (singleError.result.type || \"\").toLowerCase();\n        if (responseType.includes(\"message\")) {\n          syncErrorType = \"business\";\n          if (singleError.result.message) {\n            message.push(singleError.result.message);\n          }\n          if (Array.isArray(singleError.result.messages)) {\n            message = message.concat(singleError.result.messages);\n          }\n        }\n      });\n    } else\n    if (error != undefined && error.result != undefined) {\n      var responseType = (error.result.type || \"\").toLowerCase();\n      if (responseType.includes(\"message\")) {\n        syncErrorType = \"business\";\n        if (error.result.message) {\n          message.push(error.result.message);\n        }\n        if (Array.isArray(error.result.messages)) {\n          message = message.concat(error.result.messages);\n        }\n      }\n    } else\n    if (error.message) {\n      message.push(error.message);\n    }\n    return {\n      type: syncErrorType,\n      message: message.length == 1 ? message[0] : message,\n      actionResponse: performActionObject,\n      timestamp: Date.now() };\n\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.grid = bizagi.grid || {};\nbizagi.grid.services = bizagi.grid.services || {};\nbizagi.grid.services.service = bizagi.grid.services.service || {};\n$.Class.extend(\"bizagi.grid.services.service\", {\n  // STATIC METHODS\n},\n\n{\n  // INSTANCE METHODS\n  init: function init(params) {\n    var self = this;\n    self.renderDataService = params.renderDataService;\n    self.database = params.database;\n  },\n\n  uploadGridData: function uploadGridData(gridsData, idPageCache) {\n    var self = this;\n    var promisesResponse = {\n      bizAdditions: [],\n      bizDeletions: [],\n      bizImages: {},\n      bizFiles: {} };\n\n    gridsData.forEach(function (currentGridData) {\n\n      Array.prototype.push.apply(promisesResponse.bizAdditions, self.processNewRecords(currentGridData, idPageCache));\n      Array.prototype.push.apply(promisesResponse.bizDeletions, self.processDeletedRecords(currentGridData, idPageCache));\n      $.extend(promisesResponse.bizImages, self.processImages(currentGridData));\n      $.extend(promisesResponse.bizFiles, self.processFiles(currentGridData));\n\n    });\n\n    return promisesResponse;\n  },\n\n  processNewRecords: function processNewRecords(currentGridData, idPageCache) {\n    var self = this;\n\n    //Addition promises\n    var newRecords = [];\n    var gridNewRecords = currentGridData.value[\"new-records\"];\n\n    if (gridNewRecords) {\n      var keys = Object.keys(gridNewRecords);\n\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = gridNewRecords[keys[i]];\n        rowData['idPageCache'] = idPageCache;\n\n        var actionParams = self.renderDataService.addGridRecordData(rowData);\n        actionParams[\"offline-entityId\"] = keys[i];\n\n        newRecords.push({\n          actionParams: actionParams,\n          creationTimestamp: rowData.creationTimestamp });\n\n      }\n    }\n\n    // Sort additions\n    return newRecords.sort(function (a, b) {\n      return a.creationTimestamp - b.creationTimestamp;\n    }).map(function (newRecord) {\n      return newRecord.actionParams;\n    });\n  },\n\n  processImages: function processImages(currentGridData) {\n    var result = {};\n\n    if (currentGridData.value[\"edited-images\"]) {\n      var keys = Object.keys(currentGridData.value[\"edited-images\"]);\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = currentGridData.value[\"edited-images\"][keys[i]];\n        result[keys[i]] = rowData;\n      }\n    }\n\n    return result;\n  },\n\n  processFiles: function processFiles(currentGridData) {\n    var result = {};\n    var offlineFiles = currentGridData.value[\"offline-files\"];\n\n    if (offlineFiles) {\n      var keys = Object.keys(offlineFiles);\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = offlineFiles[keys[i]];\n        result[keys[i]] = rowData;\n      }\n    }\n\n    return result;\n  },\n\n  processDeletedRecords: function processDeletedRecords(currentGridData, idPageCache) {\n    var self = this;\n    var result = [];\n    var deletedRecords = currentGridData.value[\"deleted-records\"];\n\n    if (deletedRecords) {\n      var keys = Object.keys(deletedRecords);\n      for (var i = 0; i < keys.length; i++) {\n        var rowData = deletedRecords[keys[i]];\n        rowData['idPageCache'] = idPageCache;\n        result.push(self.renderDataService.deleteGridRecord(rowData));\n      }\n    }\n    return result;\n  } });","/*\r\n*   Name: Bizagi Rendering Services\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\nbizagi.form = bizagi.form || {};\nbizagi.form.services = bizagi.form.services || {};\nbizagi.form.services.service = bizagi.form.services.service || {};\n$.Class.extend(\"bizagi.form.services.service\", {\n  // STATIC METHODS\n},\n\n{\n  // INSTANCE METHODS\n  init: function init(params) {\n    var self = this;\n    self.renderDataService = params.renderDataService;\n    self.database = params.database;\n    self.fileService = self.renderDataService.getFileService();\n  },\n\n  getServerTaskForm: function getServerTaskForm(params) {\n    var self = this;\n    var form;\n    var hasEntryPipeline;\n    var wasPipelineExecuted;\n    params.downloadOfflineForm = true;\n    var service = params.bulkDownload ? self.renderDataService.multiactionWithLimit() : self.renderDataService;\n    return service.getFormData(params).\n    then(function (response) {\n      return self.executeOfflineEntryPipelineAndReloadForm(response, params);\n    }).\n    then(function (pipelineExecutionResponse) {\n      form = pipelineExecutionResponse.form;\n      hasEntryPipeline = pipelineExecutionResponse.hasEntryPipeline === true;\n      wasPipelineExecuted = pipelineExecutionResponse.wasPipelineExecuted === true;\n      return self.getFileAttachmentsFromLocalTaskForm(params);\n    }).\n    then(function (localFiles) {\n      if (form.errorType) return $.Deferred().reject(form).promise();\n      if (params.deleteNextButton) form = self.database.deleteNextButton(form);\n\n      form.dataChangeset = params.dataChangeset;\n      params.localFiles = localFiles;\n\n      var result = self.fileService.downloadFormFiles(form, params);\n\n      var filePromises = result.promises;\n      var imagePromises = self.fileService.downloadFormImages(form, params);\n      var downloadAttachmentsPromises = Array.prototype.push.apply(filePromises, imagePromises);\n\n      if (params.bulkDownload && downloadAttachmentsPromises.length > 0) {\n\n        // When downloading offline forms in bulk, wait for data promises\n        return $.when.apply($, downloadAttachmentsPromises).\n        then(function () {\n          return self.mergeForm(form, result.data);\n        });\n\n      }\n\n      // Single offline form, don't wait for files\n      return self.mergeForm(form, result.data);\n    }).\n    then(function (resolvedForm) {\n      return {\n        form: resolvedForm,\n        hasEntryPipeline: hasEntryPipeline,\n        wasPipelineExecuted: wasPipelineExecuted };\n\n    }).\n    fail(function () {\n      bizagi.util.console.error(\"Error downloading task form\", params);\n    });\n  },\n\n  executeOfflineEntryPipeline: function executeOfflineEntryPipeline(formData) {\n    var self = this;\n    var formProperties = formData.form ? formData.form.properties : {};\n    var shouldExecutePipeline = self.hasFormEntryPipeline(formData);\n\n    if (!shouldExecutePipeline) {\n      return $.Deferred().resolve({ hasEntryPipeline: false, wasPipelineExecuted: false }).promise();\n    }\n\n    return $.when(self.renderDataService.executePipeline({\n      pipeline: formProperties.loadExecution,\n      idPageCache: formData.form.pageCacheId })).\n\n    then(function () {\n      return { hasEntryPipeline: true, wasPipelineExecuted: true };\n    }, function () {\n      return $.Deferred().resolve({ hasEntryPipeline: true, wasPipelineExecuted: false }).promise();\n    });\n  },\n\n  executeOfflineEntryPipelineAndReloadForm: function executeOfflineEntryPipelineAndReloadForm(data, params) {\n    var self = this;\n\n    if (!params.executeOfflineEntryPipeline) return { form: data, wasPipelineExecuted: false };\n\n    // Execute pipeline, then reload form\n    return self.executeOfflineEntryPipeline(data).\n    then(function (response) {\n      hasEntryPipeline = response.hasEntryPipeline;\n      wasPipelineExecuted = response.wasPipelineExecuted;\n\n      if (hasEntryPipeline && wasPipelineExecuted) {\n        return self.renderDataService.getFormData(params).\n        then(function (getFormDataResponse) {\n          return {\n            form: getFormDataResponse,\n            hasEntryPipeline: hasEntryPipeline,\n            wasPipelineExecuted: wasPipelineExecuted };\n\n        });\n      }\n      return {\n        form: data,\n        hasEntryPipeline: hasEntryPipeline,\n        wasPipelineExecuted: wasPipelineExecuted };\n\n    });\n  },\n\n  getFileAttachmentsFromLocalTaskForm: function getFileAttachmentsFromLocalTaskForm(params) {\n    var self = this;\n    return self.database.getFileAttachmentsFromLocalTaskForm(params).\n    then(function (localAttachments) {\n      return localAttachments;\n    }, function () {\n      return {};\n    });\n  },\n\n  mergeForm: function mergeForm(form, data) {\n    var self = this;\n    return self.database.mergeDataDocument(data, form).\n    then(function (complexData) {\n      var object = { data: data };\n      object.data = complexData;\n      object.isOpen = true;\n\n      return self.database.mergeForm(object, form, { online: true });\n    });\n  },\n\n  downloadOfflineStartForm: function downloadOfflineStartForm(params) {\n    var self = this;\n    params.action = \"LOADSTARTFORM\";\n    params.downloadOfflineForm = true;\n\n    return self.renderDataService.multiactionWithLimit().getFormData(params).\n    then(function (serverResponse) {\n      if (serverResponse.errorType) return $.Deferred().reject(serverResponse).promise();\n      if (!serverResponse.form) return $.Deferred().reject(serverResponse).promise();\n\n      serverResponse.form.properties.isTaskForm = false;\n      if (serverResponse.form.buttons === undefined || Array.isArray(serverResponse.form.buttons) && serverResponse.form.buttons.length < 2)\n      serverResponse.form.buttons = self.addFormDefaultButtons();;\n      serverResponse.lastSynchronization = Date.now();\n\n      return self.database.saveStartForm(params, serverResponse);\n    });\n  },\n\n  downloadOfflineTaskForm: function downloadOfflineTaskForm(params) {\n    var self = this;\n    var hasEntryPipeline;\n    var wasPipelineExecuted;\n    params.deleteNextButton = false;\n\n    return self.getServerTaskForm({\n      idCase: params.idCase,\n      idWorkitem: params.idWorkitem,\n      executeOfflineEntryPipeline: params.executeOfflineEntryPipeline === true,\n      bulkDownload: params.bulkDownload }).\n\n    then(function (response) {\n\n      var form = response.form;\n      hasEntryPipeline = response.hasEntryPipeline;\n      wasPipelineExecuted = response.wasPipelineExecuted;\n      form.form.properties.isTaskForm = true;\n\n      if (form.form.buttons === undefined || Array.isArray(form.form.buttons) && form.form.buttons.length == 0)\n      form.form.buttons = self.addFormDefaultButtons();\n\n      return self.database.saveTaskForm(params, form);\n    }).\n    then(function () {\n\n      if (!params.isSingleSync) {\n        var formNotificationParams = $.extend({}, params);\n        formNotificationParams.type = \"download-form-success\";\n        $(document).trigger(\"offline-notify-form-sync-event\", formNotificationParams);\n      }\n\n      return {\n        wasFormDownloaded: true,\n        hasEntryPipeline: hasEntryPipeline,\n        wasPipelineExecuted: wasPipelineExecuted };\n\n    });\n  },\n\n  /*************************************************************************************************\r\n      *          UTIL METHODS\r\n      *************************************************************************************************/\n\n  addFormDefaultButtons: function addFormDefaultButtons() {\n    return [\n    {\n      button: {\n        properties: {\n          actions: [\n          \"submitData\",\n          \"refresh\"],\n\n          caption: \"render-form-button-save\",\n          id: \"ec0a5a02-0f81-44a7-8d64-ac090a01d61b\" } } },\n\n\n\n    {\n      button: {\n        properties: {\n          actions: [\n          \"validate\",\n          \"submitData\",\n          \"next\",\n          \"routing\"],\n\n          caption: \"render-form-button-next\",\n          id: \"ba81c7af-0d83-4139-879d-b040f0f81bd7\" } } }];\n\n\n\n\n  },\n\n  // TODO: Check if there is another way to check this without invoking 'renderDataService.getFormData'\n  verifyFormEntryPipeline: function verifyFormEntryPipeline(params) {\n    var self = this;\n    return self.renderDataService.getFormData(params).\n    then(function (formData) {\n      return self.hasFormEntryPipeline(formData);\n    }).\n    fail(function (err) {\n      bizagi.util.console.error(\"verifyFormEntryPipeline => getFormData error\", err);\n      return false;\n    });\n  },\n\n  hasFormEntryPipeline: function hasFormEntryPipeline(formData) {\n    var formProperties = formData.form ? formData.form.properties : {};\n    var hasEntryPipeline = bizagi.util.parseBoolean(formProperties.hasEntryPipeline) === true &&\n    !bizagi.util.isEmpty(formProperties.loadExecution);\n    return hasEntryPipeline;\n  } });","/*\r\n *   Name: BizAgi Rendering Services\r\n *   Author: Einer Perez\r\n *   Comments:\r\n *   -   This class will provide a facade to access to multiaction rendering REST services\r\n */\nbizagi.render.services.multiactionservice.extend(\"bizagi.render.services.metadatamultiactionservice\", {\n  // Statics\n  BA_ACTION_PARAMETER_PREFIX: \"p_\",\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  BA_PAGE_CACHE: \"h_pageCacheId\" },\n{\n\n  /*\r\n  *   Sends a multiaction to the server\r\n  */\n  execute: function execute(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    var rejectDeferreds = params.rejectDeferreds !== undefined ? params.rejectDeferreds : true;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"action\"] = \"multiaction\";\n\n    // Check action tag\n    $.each(params.actions, function (i, action) {\n      action[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"tag\"] = action.tag || i;\n      if (action[self.Class.BA_PAGE_CACHE]) {\n        data[self.Class.BA_PAGE_CACHE] = action[self.Class.BA_PAGE_CACHE];\n      }\n      delete action[self.Class.BA_PAGE_CACHE];\n      delete action.tag;\n    });\n\n    // Fill optional parameters\n    params = params || {};\n    if (params.actions) {\n      data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"actions\"] = JSON.encode(params.actions);\n    }\n\n    // Log submit data\n    bizagi.debug(\"Performing multi-action metadata\", data);\n\n    // Call ajax and returns promise\n    var deferred = new $.Deferred();\n    $.ajax({\n      url: self.serviceLocator.getUrl(\"render-multiaction-metadata\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      serviceType: \"MULTIACTION\",\n      beforeSend: function beforeSend(xhr, status) {\n        bizagi.multiactionConnection = bizagi.multiactionConnection || [];\n        bizagi.multiactionConnection.push(xhr);\n      } }).\n\n    done(function (responses) {\n      for (i in responses) {\n        if (typeof responses[i] !== \"function\") {\n          var response = responses[i];\n          if (response.error) {\n            if (rejectDeferreds) {\n              deferred.reject(this, \"servererror\", response);\n              return;\n            }\n\n          }\n        }\n      }\n      deferred.resolve(responses);\n\n    }).fail(function (xhr) {\n      var response = xhr.responseText || xhr;\n      var finalResponse;\n      // Try to parse the response\n      try {\n        finalResponse = JSON.parse(response);\n      } catch (e) {}\n      deferred.reject(xhr, \"servererror\", finalResponse);\n    });\n\n    return deferred.promise();\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\nvar STOREOBJECTNAME = \"offlineTasks\";\nbizagi.workportal.services.db.extend(\"bizagi.workportal.services.db\", {}, {\n\n  /**\r\n                                                                             * This method create a new case in the db to offline status\r\n                                                                             * @param {} params \r\n                                                                             * @returns {} promise\r\n                                                                             */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    var idWfClass = params.idWfClass,\n    id = new Date().toISOString();\n\n    var offlineCase = {\n      _id: id,\n      idWfClass: idWfClass.toString(),\n      idWorkFlow: idWfClass.toString(),\n      idCase: id,\n      isFavorite: false,\n      globalId: self.globalId,\n      createdBy: {\n        Name: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n        userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n      creationDate: new Date(),\n      process: params.displayName || \"Offline\",\n      categoryName: params.process || params.categoryName || \"Offline\",\n      displayName: params.displayName || \"Offline\",\n      radNumber: id,\n      // closed: false,\n      isOfflineForm: true,\n      formsRenderVersion: 2,\n      isOpen: true,\n      workItems: [\n      {\n        idWorkItem: bizagi.util.uniqueID(),\n        idTask: bizagi.util.uniqueID(),\n        idCase: id,\n        colorState: \"Green\",\n        State: \"Green\",\n        TaskName: params.displayName || \"Offline\" }] };\n\n\n\n\n    return this.saveStartCase(id, offlineCase).\n    then(function () {\n      return offlineCase;\n    });\n  },\n\n  /**\r\n      * Delete case\r\n      * @param {} params \r\n      * @returns {} promise \r\n      */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbStartData.get(params.idCase, function (err, doc) {\n      if (!err) {\n        self.dbStartData.remove(doc, function (error, response) {\n          if (!error) {\n            def.resolve(response);\n          } else {\n            bizagi.log(\"Error erasing case\");\n            def.reject(err);\n          }\n        });\n\n      } else {\n        bizagi.log(\"Error, the case do not exist\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * Delete tasks in dbActivities\r\n      */\n  deleteTask: function deleteTask(params) {\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var db = this.dbActivities;\n    return bizagi.util.db.deleteDocument(db, documentId);\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this,\n    def = new $.Deferred();\n\n    if (params.fromWorkItemId) {\n      var doc = {\n        workItems: [params.fromWorkItemId] };\n      def.resolve(doc);\n    } else\n    {\n      self.dbStartData.get(params.idCase, function (err, doc) {\n        if (!err) {\n          def.resolve(doc);\n        } else {\n\n          def.reject(err);\n        }\n      });\n    }\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the categories as the services if exists in the database\r\n      * @param {} data \r\n      * @returns {} promise\r\n      */\n  getCategories: function getCategories(data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (!data.enableOfflineForm) {\n      def.resolve({});\n    } else\n    {\n      var db = self.dbProcessesHierarchy;\n      $.when(bizagi.util.db.getDocument(db, self.globalId)).\n      then(function (processesHierarchyDoc) {\n        self.categories = processesHierarchyDoc.doc;\n        if (data.idApp || data.idCategory) {\n          var groupCategory = getGroup(self.categories, data);\n          def.resolve({\n            category: groupCategory,\n            totalApps: data.idApp ? groupCategory.length : 0 });\n\n        } else {\n          var tempCategories = self.categories;\n          while (tempCategories.length == 1 && (\n          tempCategories[0].categories || tempCategories[0].subCategories)) {\n            tempCategories = getGroup(\n            tempCategories,\n            tempCategories[0].appId ? { idApp: tempCategories[0].appId } :\n            { idCategory: tempCategories[0].idCategory });\n\n          }\n\n          def.resolve({\n            category: tempCategories,\n            totalApps: tempCategories[0] && tempCategories[0].appId ? tempCategories.length : 0 });\n\n        }\n      }).\n      fail(function () {//Document not found\n        def.resolve({\n          category: [],\n          totalApps: 0 });\n\n      });\n    }\n    return def.promise();\n\n    /**\r\n                           * Get the group for new cases similar to service \r\n                           * @param {} categories \r\n                           * @param {} data \r\n                           * @returns {} \r\n                           */\n    function getGroup(categories, data) {\n      for (var i = 0, len = categories.length; i < len; i++) {\n        if (categories[i].appId && categories[i].appId == data.idApp) {\n          return categories[i].categories;\n        }\n        if (categories[i].idCategory && categories[i].idCategory == data.idCategory) {\n          return categories[i].subCategories;\n        } else {\n          if (categories[i].categories) {\n            var cat = getGroup(categories[i].categories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n\n          if (categories[i].subCategories) {\n            var cat = getGroup(categories[i].subCategories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n        }\n      }\n    }\n  },\n\n  /**\r\n      * This method return all the open cases for the user authenticated from de DB\r\n      * @returns {} promise\r\n      */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbStartData.query({\n      map: map },\n    {\n      reduce: false },\n    function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get case by id\r\n      * @param {} idCase \r\n      * @returns {} \r\n      */\n  getCase: function getCase(idCase) {\n    var self = this;\n    var db = self.dbStartData;\n    return bizagi.util.db.getDocument(db, idCase);\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    if (params.radnumber || params.radNumber) {\n      params[\"radNumber\"] = params.radnumber ? params.radnumber : params.radNumber;\n    }\n\n    if (params.idcase || params.idCase) {\n      params[\"radNumber\"] = params.idcase ? params.idcase : params.idCase;\n    }\n\n    self.dbStartData.allDocs({\n      include_docs: true },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber)) {\n            var localCase = {\n              id: resp.rows[i].id,\n              idWFClass: resp.rows[i].idWFClass,\n              idWorkFlow: resp.rows[i].id,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isOfflineForm: true,\n              syncStatus: resp.rows[i].syncStatus,\n              fields: [\n              {\n                Value: resp.rows[i].value.process,\n                DisplayName: resp.rows[i].value.process,\n                DataType: \"VarChar\",\n                isRadNumber: false },\n              {\n                Value: resp.rows[i].value.creationDate,\n                DisplayName: \"Process creation date\",\n                DataType: \"DateTime\",\n                isRadNumber: false }] };\n\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local data base\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n\n  getAllProcesses: function getAllProcesses(params) {\n    var def = new $.Deferred();\n    var self = this;\n\n    var response = {\n      \"workflows\": {\n        \"taskstate\": \"\",\n        \"workflow\": [] } };\n\n\n\n    var activeProcessesQueryFun = {\n      map: function map(doc) {\n        if (doc.idWfClass && doc.isOpen) {\n          emit({\n            idWfClass: doc.idWfClass,\n            process: doc.process,\n            category: doc.categoryName },\n          1);\n        }\n      },\n      reduce: \"_count\" };\n\n\n    var queryArgs = {\n      include_docs: false,\n      group: true };\n\n\n    var executeQueryPromise = bizagi.util.db.executeQuery(self.dbActivities, activeProcessesQueryFun, queryArgs);\n\n    $.when(executeQueryPromise).\n    then(function (queryResponse) {\n      var responseRows = queryResponse.rows;\n      if (responseRows != undefined && responseRows.length > 0) {\n        responseRows.forEach(function (row) {\n          var casesCount = row.value;\n          response.workflows.workflow.push({\n            idworkflow: row.key[\"idWfClass\"],\n            name: row.key[\"process\"],\n            count: casesCount,\n            isFavorite: false,\n            category: row.key[\"category\"] });\n\n        });\n      }\n      def.resolve(JSON.stringify(response));\n    }).\n    fail(function (queryErr) {\n      def.reject(queryErr);\n    });\n    return def.promise();\n  },\n\n  getOutboxCases: function getOutboxCases() {\n    var self = this;\n\n    return self.dbStartData.allDocs({\n      include_docs: true,\n      attachments: true }).\n    toJqueryPromise().\n    then(function (response) {\n      response.rows = $.grep(response.rows, function (item) {return !item.doc.isOpen;});\n      response.rows = $.map(response.rows, function (item) {\n        return {\n          id: item.id,\n          key: item.doc.isOpen,\n          value: item.doc };\n\n      });\n      return response;\n    }).\n    fail(function (err) {\n      bizagi.log(\"Error loading data before syncronization\");\n      return err;\n    });\n  },\n\n  getOutboxTaskCases: function getOutboxTaskCases() {\n    var self = this;\n    var def = new $.Deferred();\n    self.dbActivityData.allDocs({ include_docs: true }, function (err, resp) {\n      if (!err) {\n        def.resolve(resp);\n      } else\n\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n  getOutboxTaskCasesFilteredBySyncStatus: function getOutboxTaskCasesFilteredBySyncStatus(pSyncStatus, includeDocs) {\n    var self = this;\n    var def = new $.Deferred();\n    pSyncStatus = pSyncStatus || \"none\";\n    var queryMap = {\n      map: function filterCaseBySyncStatus(doc, emit) {\n        if (doc.data != undefined && !bizagi.util.isEmpty(doc.data.h_action)) {\n          var emitValue = doc.syncStatus;\n          if (pSyncStatus === \"any\" && emitValue != undefined || pSyncStatus === \"none\" && emitValue == undefined) {\n            emitValue = pSyncStatus;\n          }\n          emit(emitValue);\n        }\n      } };\n\n\n\n    var filterParameters = {\n      key: pSyncStatus,\n      include_docs: includeDocs == true };\n\n    self.dbActivityData.query(queryMap, filterParameters, function (error, result) {\n      if (error) {\n        def.reject(error);\n      } else\n      {\n        def.resolve(result.rows);\n      }\n    });\n\n    return def.promise();\n  },\n\n  existantCase: function existantCase(params, data) {\n    var self = this;\n    var idWfClass = params.idWfClass,\n    id = params.idCase + \"-\" + params.idWorkitem;\n\n    return offlineCase = {\n      _id: id,\n      idCase: id,\n      isFavorite: false,\n      globalId: self.globalId,\n      createdBy: {\n        Name: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n        userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n      creationDate: new Date(),\n      process: params.process || \"Offline\",\n      categoryName: params.process || params.categoryName || \"Offline\",\n      displayName: params.displayName || \"Offline\",\n      radNumber: id,\n      // closed: false,\n      isOfflineForm: true,\n      formsRenderVersion: 2,\n      isOpen: true,\n      workItems: [\n      {\n        idWorkItem: bizagi.util.uniqueID(),\n        idTask: bizagi.util.uniqueID(),\n        idCase: id,\n        colorState: \"Green\",\n        State: \"Green\",\n        TaskName: params.process || \"Offline\" }] };\n\n\n\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {}  Returns a promise\r\n      *  Struct: [\r\n      *   idCase, idWorkItem, idTask,\r\n      *   dueDate, processName, activityName,\r\n      *   customzedColumns: [key, value],\r\n      *   isOfflineForm, isOpen\r\n      * ]\r\n      */\n  getCasesList: function getCasesList(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"page\": 1,\n      \"totalPages\": 1,\n      \"elements\": [] };\n\n\n    var isOpen = params.inputtray === \"drafts\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.isOpen, doc);\n      } };\n\n\n    self.dbStartData.query(queryFun, {\n      reduce: false,\n      key: isOpen },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.rows.length; i < len; i++) {\n          if (typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          resp.rows[i].value.radNumber.toString().indexOf(params.radNumber.toString()) != -1) {\n\n            var localCase = [\n            resp.rows[i].value.idCase,\n            resp.rows[i].value.workItems[0][\"idWorkItem\"][0] || \"\",\n            resp.rows[i].value.workItems[0][\"idTask\"][0] || \"\",\n            resp.rows[i].value.creationDate,\n            resp.rows[i].value.categoryName,\n            resp.rows[i].value.displayName,\n            [\n            [\"Case No\", resp.rows[i].value.idCase],\n            [\"Process\", resp.rows[i].value.process],\n            [\"Process creation date\", bizagi.util.formatDateTime(resp.rows[i].value.creationDate)]],\n\n            resp.rows[i].value.isOfflineForm,\n            resp.rows[i].value.isOpen];\n\n            localCase.offlineType = \"start\";\n            localCase.syncStatus = resp.rows[i].value.syncStatus;\n            localCase.taskstate = resp.rows[i].value.workItems[0].State.toLowerCase() || \"\";\n            if (!bizagi.util.isEmpty(localCase.syncStatus)) {\n              localCase.hasSyncError = true;\n              localCase.syncError = resp.rows[i].value.syncDetails;\n            }\n            cases.elements.push(localCase);\n          }\n        }\n        def.resolve(cases);\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n  /*\r\n     *   This method return the cases created offline by idWorkflow\r\n     *   Returns a promise\r\n     */\n  getCustomizedColumnsNewData: function getCustomizedColumnsNewData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.isOpen, doc);\n      } };\n\n\n    self.dbStartData.query(queryFun, {\n      reduce: false,\n      key: isOpen },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.rows.length; i < len; i++) {\n          if (typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber) {\n            var localCase = {\n              id: resp.rows[i].value.idCase,\n              idWFClass: resp.rows[i].value.idWfClass,\n              idWorkFlow: resp.rows[i].value.idWorkFlow,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isAborted: false,\n              isOfflineForm: true,\n              fields: [\n              resp.rows[i].value.idCase,\n              resp.rows[i].value.process,\n              {\n                \"workitems\": resp.rows[i].value.workItems },\n\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate),\n              \"\",\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate)] };\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get recent processes\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    var deferred = new $.Deferred();\n    var db = self.dbRecentProcesses;\n    $.when(bizagi.util.db.getDocument(db, self.globalId)).\n    then(function (recentProcesses) {\n      deferred.resolve(recentProcesses);\n    }).\n    fail(function (error) {\n      var emptyRecents = { \"processes\": [] };\n      deferred.resolve(emptyRecents);\n    });\n    return deferred.promise();\n  },\n  /**\r\n      * Save all the work items as a single object\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  saveOfflineTasks: function saveOfflineTasks(tasksMap) {\n    var self = this;\n    var saveQueue = new bizagiQueue();\n    for (i in tasksMap) {\n      var currentTask = tasksMap[i];\n      var idWfClass = currentTask[10],\n      id = currentTask[0] + '-' + currentTask[1];\n\n      var offlineCase = {\n        _id: id,\n        endDate: currentTask.endDate,\n        group: currentTask.group,\n        icon: currentTask.icon,\n        state: currentTask.state,\n        taskState: currentTask.taskState,\n        shortEndDate: currentTask.shortEndDate,\n        atRiskTime: currentTask[11],\n        type: currentTask.type,\n        idWfClass: idWfClass.toString(),\n        idWorkFlow: idWfClass.toString(),\n        idCase: currentTask[0],\n        isFavorite: currentTask[9],\n        isEdited: false,\n        createdBy: {\n          Name: typeof currentTask.creatorFullName !== \"undefined\" ? currentTask.creatorFullName : typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n          userName: typeof currentTask.creatorFullName !== \"undefined\" ? currentTask.creatorFullName : typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n        creationDate: currentTask[12],\n        process: currentTask[4],\n        categoryName: tasksMap.process || tasksMap.categoryName || \"Offline\",\n        displayName: tasksMap.displayName || \"Offline\",\n        radNumber: currentTask.systemColumns && currentTask.systemColumns.radnumber ? currentTask.systemColumns.radnumber : currentTask[0],\n        wfClassDisplayName: \"\",\n        // closed: false,\n        isOfflineForm: true,\n        formsRenderVersion: 2,\n        isOpen: true,\n        workItems: [\n        {\n          idWorkItem: currentTask[1],\n          idTask: currentTask[2],\n          idCase: currentTask[0],\n          colorState: currentTask.taskstate,\n          State: currentTask.taskstate,\n          TaskName: currentTask[5] }],\n\n\n        systemColumns: currentTask.systemColumns };\n\n      saveQueue.add(self.saveOrUpdateTask(id, offlineCase));\n    }\n    return saveQueue.execute();\n  },\n\n  saveStartCase: function saveStartCase(caseId, offlineCase) {\n    return bizagi.util.db.saveDocument(this.dbStartData, offlineCase);\n  },\n\n  saveTask: function saveTask(offlineId, offlineCase) {\n    return bizagi.util.db.saveDocument(this.dbActivities, offlineCase);\n  },\n\n  saveOrUpdateTask: function saveOrUpdateTask(internalTaskId, offlineCase) {\n    var def = new $.Deferred();\n    var self = this;\n    $.when(bizagi.util.db.getDocument(self.dbActivities, internalTaskId)).\n    then(function (currentDocument) {\n      $.extend(true, currentDocument, offlineCase);\n      return bizagi.util.db.saveDocument(self.dbActivities, currentDocument);\n    }).\n    then(function () {\n      def.resolve();\n    }).\n    fail(function (err) {\n      $.when(bizagi.util.db.saveDocument(self.dbActivities, offlineCase)).\n      then(function () {\n        def.resolve();\n      }).\n      fail(function (saveError) {\n        def.reject(saveError);\n      });\n    });\n\n    return def.promise();\n  },\n\n  cleanTaskDataActions: function cleanTaskDataActions(internalTaskId) {\n    var def = new $.Deferred();\n    var self = this;\n    $.when(bizagi.util.db.getDocument(self.dbActivityData, internalTaskId)).\n    then(function (currentDocument) {\n      if (currentDocument != undefined && currentDocument.data != undefined && currentDocument.data.h_actions != undefined) {\n        currentDocument.data.retry_h_actions = currentDocument.data.h_actions;\n        currentDocument.data.h_actions = [];\n      }\n      return bizagi.util.db.saveDocument(self.dbActivityData, currentDocument);\n    }).\n    always(function () {\n      def.resolve();\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Returns a task\r\n      * @param {} internalTaskId (idCase-idWorkitem)\r\n      */\n  getTask: function getTask(internalTaskId) {\n    return bizagi.util.db.getDocument(this.dbActivities, internalTaskId);\n  },\n\n  /**\r\n      * Save or update the headers and their metadata for the workflow specified\r\n      * @param {*} workflowId \r\n      * @param {*} headers \r\n      */\n  saveProcessCustomColumnsHeaders: function saveProcessCustomColumnsHeaders(workflowId, headers) {\n    var db = this.dbProcessColumns;\n    var doc = {\n      _id: workflowId,\n      headers: headers };\n\n    return bizagi.util.db.saveDocument(db, doc);\n  },\n\n  /**\r\n     * Save or update the headers and their metadata for the workflow specified\r\n     * @param {*} workflowId \r\n     * @param {*} headers \r\n     */\n  saveSmartInboxCustomColumnsHeaders: function saveSmartInboxCustomColumnsHeaders(smartInboxId, headers) {\n    var db = this.dbProcessColumns;\n    var doc = {\n      _id: smartInboxId,\n      headers: headers };\n\n    return bizagi.util.db.saveDocument(db, doc);\n  },\n\n  /**\r\n      * Returns an Array with the Custom Columns\r\n      * @param {*} workflowId \r\n      */\n  getProcessCustomColumnsHeaders: function getProcessCustomColumnsHeaders(workflowId) {\n    var self = this;\n    var db = this.dbProcessColumns;\n    var deferred = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(db, workflowId.toString())).\n    then(function (doc) {\n      deferred.resolve({ headers: doc.headers, type: workflowId != -1 ? \"process\" : \"system\" });\n    }).\n    fail(function (processErr) {\n      $.when(bizagi.util.db.getDocument(db, \"-1\")).\n      then(function (doc) {\n        deferred.resolve({ headers: doc.headers, type: \"system\" });\n      }).\n      fail(function (systemErr) {\n        deferred.reject(systemErr);\n      });\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Returns an Array with the Custom Columns\r\n      * @param {*} smartInboxId \r\n      */\n  getSmartInboxCustomColumnsHeaders: function getSmartInboxCustomColumnsHeaders(smartInboxId) {\n    var db = this.dbProcessColumns;\n    var deferred = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(db, smartInboxId.toString())).\n    then(function (doc) {\n      deferred.resolve({ headers: doc.headers, type: \"smartinbox\" });\n    }).\n    fail(function () {\n      $.when(bizagi.util.db.getDocument(db, \"-1\")).\n      then(function (doc) {\n        deferred.resolve({ headers: doc.headers, type: \"system\" });\n      }).\n      fail(function (systemErr) {\n        deferred.reject(systemErr);\n      });\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Generates the executable query based in the parameters.\r\n      * The query allows filtering by idWfClass and isOpen (inbox or outbox) properties\r\n      * The query allows ordering the rows based in the process or application custom columns.\r\n      */\n  generateSortedCasesQuery: function generateSortedCasesQuery(params) {\n    var idWfClass = params.idWfClass || -1;\n    var smartInboxId = params.smartInboxId;\n    var openStatus = params.isOpen;\n    var queryAcrossCustomColums = params.queryAcrossCustomColums || false;\n    var customColumnsType = params.customColumnsType || \"system\";\n\n    //Default statements\n    var filterStatement = \"doc != undefined\";\n    var emitStatement = \"doc._id\";\n    var argumentsObject = {\n      include_docs: true };\n\n\n    //Supported filters\n    if (idWfClass > 0) {\n      filterStatement = appendStatement(filterStatement, \"(doc.idWfClass != undefined && doc.idWfClass == \" + idWfClass + \")\", \"&&\");\n    } else\n    if (!bizagi.util.isEmpty(smartInboxId)) {\n      filterStatement = appendStatement(filterStatement, \"(doc.smartInboxColumns != undefined && doc.smartInboxColumns['\" + smartInboxId + \"'] !== undefined)\", \"&&\");\n    }\n    if (openStatus != undefined) {\n      filterStatement = appendStatement(filterStatement, \"doc.isOpen == \" + openStatus, \"&&\");\n    }\n\n    //RadNumber OR idCase\n    var idCase = params.idCase;\n    var radNumber = params.radNumber;\n    var caseIdFilterStatement = \"\";\n    if (idCase != undefined) {\n      caseIdFilterStatement = appendStatement(caseIdFilterStatement, \"doc.idCase != undefined && doc.idCase == \" + idCase, \"&&\");\n    }\n    if (radNumber != undefined) {\n      caseIdFilterStatement = appendStatement(caseIdFilterStatement, \"doc.radNumber != undefined \" +\n      \"&& doc.radNumber.toString().trim() == \\\"\" + (\"\" + radNumber).trim() + \"\\\"\", \"||\");\n    }\n    if (caseIdFilterStatement.trim().length > 0) {\n      filterStatement = appendStatement(filterStatement, \"(\" + caseIdFilterStatement + \")\", \"&&\");\n    }\n\n    //Sorting\n    var sortData = params.sortData;\n    if (sortData && sortData.sortFieldName) {\n      //var customColumnsType = idWfClass > 0 ? \"process\" : \"application\";\n      if (smartInboxId != null) {\n        emitStatement = \"doc.\" + (queryAcrossCustomColums ? \"smartInboxColumns['\" + smartInboxId + \"'].\" : \"\") + sortData.sortFieldName;\n      } else\n      {\n        emitStatement = \"doc.\" + (queryAcrossCustomColums ? customColumnsType + \"Columns.\" : \"\") + sortData.sortFieldName;\n      }\n      var orderType = sortData.sortDirection == 'asc' ? 0 : 1;\n      if (orderType == 0) {\n        argumentsObject[\"descending\"] = true;\n      }\n    }\n\n    var queryString = \"if(\" + filterStatement + \"){\" +\n    \"   emit(\" + emitStatement + \");\" +\n    \"}\";\n    var queryFunction = new Function(\"doc\", \"emit\", queryString);\n\n    return {\n      query: queryFunction,\n      args: argumentsObject };\n\n\n    function appendStatement(currentStatement, newStatement, operator) {\n      if (currentStatement.trim().length != 0) {\n        currentStatement += \" \" + operator + \" \";\n      }\n      currentStatement += \" \" + newStatement + \" \";\n      return currentStatement;\n    }\n  },\n\n  getCustomColumnsData: function getCustomColumnsData(params) {\n    var db = this.dbActivities;\n    var offlineType = \"task\";\n\n    if (params.inputtray == \"drafts\" || params.inputtray == \"outbox-new\") {\n      db = this.dbStartData;\n      offlineType = \"start\";\n    }\n\n    var deferred = new $.Deferred();\n    params.idWfClass = params.idWfClass || -1;\n\n    if (params.sortData) {\n      params.queryAcrossCustomColums = true;\n      //TODO Support for applicationCustomColumns\n      params.customColumnsType = params.customColumnsType || \"system\";\n    }\n\n    var generatedQuery = this.generateSortedCasesQuery(params);\n    var queryExecutionPromise = bizagi.util.db.executeQuery(db, generatedQuery.query, generatedQuery.args);\n\n    $.when(queryExecutionPromise).\n    then(function (queryResponse) {\n      var queryRows = queryResponse.rows;\n      deferred.resolve(queryRows.map(function (row) {\n        var item = row.doc;\n        var headers = params.headers || [];\n        var responseItem = {};\n        headers.forEach(function (headerObject) {\n          if (headerObject && headerObject.eval) {\n            try {\n              headerObject.eval = headerObject.eval.replaceAll(headerObject.varSymbol, \"item\");\n              responseItem[headerObject.fieldName] = eval(headerObject.eval);\n            }\n            catch (evalError) {\n              bizagi.util.console.error(\"ERROR in getProcessCustomColumnsData\", headerObject.eval + \" could not be evaluated in \", item);\n            }\n          } else\n          if (headerObject && headerObject.fieldName) {\n            var fieldName = headerObject.fieldName.toLowerCase();\n            var objetKeyForFieldName = Object.keys(item).find(function (key) {\n              return key.toLowerCase() == fieldName;\n            });\n            if (objetKeyForFieldName) {\n              responseItem[headerObject.fieldName] = item[objetKeyForFieldName];\n            }\n          }\n        });\n        //Columns retrieved from server\n        var customColumns = {};\n        switch (params.customColumnsType) {\n          case \"system\":\n            customColumns = item.systemColumns || {};\n            break;\n          case \"process\":\n            customColumns = item.processColumns || {};\n            break;\n          case \"smartinbox\":\n            customColumns = item.smartInboxColumns[params.smartInboxId] || {};\n            break;\n          case \"app\":\n            customColumns = item.applicationColumns || {};\n            break;\n          default:\n            customColumns = {};}\n\n        //Override with server columns\n        $.extend(responseItem, customColumns);\n        //OfflineDefaultValues\n        responseItem.isOfflineForm = true;\n        responseItem.offlineType = offlineType;\n        responseItem.isDraft = offlineType == \"start\" && responseItem.isOpen;\n        return responseItem;\n      }));\n    }).\n    fail(function (queryError) {\n      deferred.reject(queryError);\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Update the custom columns property based in the specified type and values\r\n      * @param {String in format \"caseId-WorkItemId\"} internalTaskId \r\n      * @param {\"app\"||\"process\"} customColumnsType \r\n      * @param {Array with values} customColumnsValues \r\n      */\n  updateTaskWorkItemCustomColumnsByType: function updateTaskWorkItemCustomColumnsByType(internalTaskId, customColumnsType, customColumnsValues, smartInboxId) {\n    var def = new $.Deferred();\n    var self = this;\n\n    var customColumnProperty;\n    switch (customColumnsType) {\n      case \"process\":\n        customColumnProperty = \"processColumns\";\n        break;\n      case \"smartinbox\":\n        customColumnProperty = \"smartInboxColumns\";\n        break;\n      case \"application\":\n        customColumnProperty = \"applicationColumns\";\n        break;\n      default:\n        def.reject(customColumnsType + \"is not a valid type for customColumnsType\");\n        return def.promise();}\n    ;\n\n    $.when(bizagi.util.db.getDocument(self.dbActivities, internalTaskId)).\n    then(function (currentDocument) {\n      if (customColumnsType != \"smartinbox\") {\n        currentDocument[customColumnProperty] = customColumnsValues;\n      } else {\n        if (bizagi.util.isEmpty(currentDocument[customColumnProperty])) currentDocument[customColumnProperty] = {};\n        currentDocument[customColumnProperty][smartInboxId] = customColumnsValues;\n      }\n      return bizagi.util.db.saveDocument(self.dbActivities, currentDocument);\n    }).\n    then(function () {\n      def.resolve(true);\n    }).\n    fail(function (err) {\n      def.resolve(false);\n    });\n    return def.promise();\n  },\n\n\n  /**\r\n      * Clean all tasks\r\n      * @returns {} promise \r\n      */\n  cleanOfflineTasks: function cleanOfflineTasks() {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbActivities.get(STOREOBJECTNAME, function (err, doc) {\n      if (!err) {\n        self.dbStartData.remove(doc, function (error, response) {\n          if (!error) {\n            def.resolve(response);\n          } else {\n            bizagi.log(\"Error erasing tasks\");\n            def.reject(err);\n          }\n        });\n\n      } else {\n        bizagi.log(\"Error, no offline tasks\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n  /**\r\n      * Get all offline tasks\r\n      * @returns {} promise \r\n      */\n  getOfflineCases: function getOfflineCases(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (params.sortData) {\n      params.queryAcrossCustomColums = true;\n      params.customColumnsType = \"system\";\n    }\n\n    var generatedQuery = self.generateSortedCasesQuery(params);\n    var queryExecutionPromise = bizagi.util.db.executeQuery(self.dbActivities, generatedQuery.query, generatedQuery.args);\n    $.when(queryExecutionPromise).\n    then(function (queryResponse) {\n      var cases = {\n        \"page\": 1,\n        \"totalPages\": 1,\n        \"elements\": [] };\n\n      var queryRows = queryResponse.rows;\n      var totalRows = queryRows != undefined ? queryRows.length : 0;\n      if (totalRows > 0) {\n        queryRows.forEach(function (row) {\n          var localCase = [\n          row.doc.idCase,\n          row.doc.workItems[0][\"idWorkItem\"] || \"\",\n          row.doc.workItems[0][\"idTask\"] || \"\",\n          row.doc.creationDate,\n          row.doc.process,\n          row.doc.workItems[0][\"TaskName\"],\n          [\n          [\"Case No\", row.doc.idCase],\n          [\"Process\", row.doc.process],\n          [\"Process creation date\", bizagi.util.formatDateTime(row.doc.creationDate)]],\n\n          row.doc.isOfflineForm,\n          row.doc.isOpen,\n          row.doc.isFavorite,\n          row.doc.idWfClass,\n          row.doc.atRiskTime,\n          row.doc.creationDate];\n\n          localCase.isEdited = row.doc.isEdited;\n          localCase.offlineType = 'task';\n          localCase.endDate = row.doc.endDate;\n          localCase.group = row.doc.group;\n          localCase.icon = row.doc.icon;\n          localCase.shortEndDate = row.doc.shortEndDate;\n          localCase.state = row.doc.state;\n          localCase.taskState = row.doc.taskState;\n          localCase.type = row.doc.type;\n          localCase.wfClassDisplayName = row.doc.wfClassDisplayName;\n          localCase.syncStatus = row.doc.syncStatus;\n          localCase.radNumber = row.doc.radNumber;\n          if (row.doc.systemColumns) {\n            localCase.systemColumns = row.doc.systemColumns;\n          }\n          if (row.doc.processColumns) {\n            localCase.processColumns = row.doc.processColumns;\n          }\n          if (!bizagi.util.isEmpty(row.doc.syncStatus)) {\n            localCase.hasSyncError = true;\n            localCase.syncError = row.doc.syncDetails;\n          }\n\n          cases.elements.push(localCase);\n        });\n      }\n      def.resolve(cases);\n    }).\n    fail(function (err) {\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * Returns a map with the local activities in the db\r\n      */\n  getLocalActivities: function getLocalActivities() {\n    var def = new $.Deferred();\n    var self = this;\n    self.dbActivities.allDocs({ include_docs: true }, function (err, resp) {\n      if (err) {\n        def.reject();\n      } else\n      {\n        var len = resp.total_rows;\n        var activities = {};\n        for (var i = 0; i < len; i++) {\n          var currentRow = resp.rows[i].doc;\n          activities[currentRow._id] = currentRow;\n        }\n        def.resolve(activities);\n      }\n    });\n    return def.promise();\n  },\n\n  updateCaseSyncStatus: function updateCaseSyncStatus(params) {\n\n    var self = this;\n    var docId = params.id;\n    if (params.type === \"start\") {\n      return updateSyncAttribute(self.dbStartData, docId);\n    } else\n    {\n      return updateSyncAttribute(self.dbActivityData, docId).\n      then(function () {\n        return updateSyncAttribute(self.dbActivities, docId);\n      });\n    }\n\n    function updateSyncAttribute(db, docId) {\n      return $.when(bizagi.util.db.getDocument(db, docId)).\n      then(function (doc) {\n        doc.syncStatus = params.syncStatus;\n        doc.syncDetails = params.syncDetails;\n        return $.when(bizagi.util.db.saveDocument(db, doc));\n\n      }).\n      then(function (saveResp) {\n        return saveResp;\n      });\n\n    }\n  },\n\n  validateLocalDataForTaskExists: function validateLocalDataForTaskExists(offlineTaskId) {\n    var deferred = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(this.dbActivityData, offlineTaskId)).\n    then(function (localActivityData) {\n      deferred.resolve(localActivityData.data != undefined);\n    }).\n    fail(function (getLocalActivityError) {\n      deferred.resolve(false);\n    });\n    return deferred.promise();\n  },\n\n  openOfflineTask: function openOfflineTask(offlineTaskId) {\n    var isOpenOverride = {\n      isOpen: true,\n      isEdited: true };\n\n    return this.saveOrUpdateTask(offlineTaskId, isOpenOverride);\n  },\n\n  closeOfflineTask: function closeOfflineTask(params) {\n    var offlineTaskId = params.idCase + '-' + params.idWorkitem;\n    var isOpenOverride = {\n      isOpen: false,\n      isEdited: true };\n\n    return this.saveOrUpdateTask(offlineTaskId, isOpenOverride);\n  },\n\n  updateTaskDatachangeset: function updateTaskDatachangeset(documentId, dataChangeset) {\n    var dataChangesetOverride = {\n      dataChangeset: dataChangeset };\n\n    return this.saveOrUpdateTask(documentId, dataChangesetOverride);\n  },\n\n  updateTaskIsEdited: function updateTaskIsEdited(documentId, isEdited) {\n    var isEditedOverride = {\n      isEdited: isEdited };\n\n    return this.saveOrUpdateTask(documentId, isEditedOverride);\n  },\n\n  saveAvailableSmartInboxes: function saveAvailableSmartInboxes(data) {\n    var self = this;\n\n    var docHierarchy = {\n      _id: self.globalId + \"-smartinboxes\",\n      doc: data };\n\n\n    return bizagi.util.db.saveDocument(self.dbProcessesHierarchy, docHierarchy).\n    fail(function (err) {\n      return $.Deferred.fail(\"Could not save available smartinboxes:\" + err).promise();\n    });\n  },\n\n  saveAvailableOfflineSmartInboxes: function saveAvailableOfflineSmartInboxes(data) {\n    var self = this;\n\n    var docHierarchy = {\n      _id: self.globalId + \"-smartinboxes-offline\",\n      doc: data };\n\n\n    return bizagi.util.db.saveDocument(self.dbProcessesHierarchy, docHierarchy).\n    fail(function (err) {\n      return $.Deferred.fail(\"Could not save available offline smartinboxes:\" + err).promise();\n    });\n  },\n\n  markSmartInboxAsAvailableOffline: function markSmartInboxAsAvailableOffline(id) {\n    var self = this;\n\n    self.getAvailableOfflineSmartInboxes().\n    then(function (data) {\n      if (data.indexOf(id) == -1) {\n        data.push(id);\n        self.saveAvailableOfflineSmartInboxes(data);\n      }\n    });\n  },\n\n  getAvailableSmartInboxes: function getAvailableSmartInboxes() {\n    var self = this;\n    var id = self.globalId + \"-smartinboxes\";\n\n    return bizagi.util.db.getDocument(self.dbProcessesHierarchy, id).\n    then(function (res) {return res.doc;},\n    function () {return $.Deferred().resolve([]).promise();});\n  },\n\n  getAvailableOfflineSmartInboxes: function getAvailableOfflineSmartInboxes() {\n    var self = this;\n    var id = self.globalId + \"-smartinboxes-offline\";\n\n    return bizagi.util.db.getDocument(self.dbProcessesHierarchy, id).\n    then(function (res) {return res.doc;},\n    function () {return $.Deferred().resolve([]).promise();});\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: oscaro\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler oll db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\nbizagi.workportal.services.db.extend(\"bizagi.workportal.services.db\", {}, {\n\n  /**\r\n                                                                             * This method return the form for a new case to offline status\r\n                                                                             * @param {} idWFClass\r\n                                                                             * @returns {} Returns a promise\r\n                                                                             */\n  getFormData: function getFormData(idWFClass) {\n    var self = this;\n    var def = new $.Deferred();\n\n    setTimeout(\n    function () {\n      self.dbStartForms.get(idWFClass, function (err, doc) {\n        if (!err) {\n          if (typeof doc.form !== \"undefined\") {\n            def.resolve({ form: doc.form, type: \"form\" });\n          } else {\n            var responseText = {\n              errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n              message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n            def.reject(JSON.stringify(responseText));\n          }\n        } else {\n          def.reject(err);\n        }\n      });\n\n    }, 300);\n    return def.promise();\n  },\n\n  /**\r\n      * This method merge the form and the data to result form\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  mergeForm: function mergeForm(doc, form, options) {\n\n    var self = this;\n    var def = new $.Deferred();\n\n    $.when(form).done(function (form) {\n      if (!doc.data) {\n        def.resolve(form);\n      } else {var\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        fillForm = function fillForm(element, data) {\n          if (Array.isArray(element)) {\n            for (var i = 0, len = element.length; i < len; i++) {\n              fillForm(element[i], data);\n            }\n          } else {\n            if (element.container) {\n              fillForm(element.container.elements, data);\n            } else {\n              // If it case is in outbox or closed, make all renders in the form not editable\n              if (!doc.isOpen) {\n                element.render.properties.editable = false;\n              }\n\n              if (element.render.properties.xpath == data.key) {\n                if (element.render.properties.type === \"grid\") {\n                  self.setRenderGridValues(element.render);\n                }\n                self.setRenderValues(element.render.properties, data.value, options);\n              }\n\n            }\n          }\n        }; // If it case is in outbox or closed, hide buttons in the form\n        if (!doc.isOpen) {form.form.buttons = [];if (Object.keys(doc.data).length === 0) {fillForm(form.form.elements, { key: \"read-only-form\", value: \"\" });}}options.formProperties = form.form.properties;for (prop in doc.data) {fillForm(form.form.elements, { key: prop, value: doc.data[prop] });}\n        def.resolve(form);\n      }\n    }).fail(function (cause) {\n      if (!cause.responseText)\n      var responseText = {\n        errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n        message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n      cause.responseText = JSON.stringify(responseText);\n\n      def.reject(cause);\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Set render Grid values\r\n      * @param {} render\r\n      * @returns {}\r\n      */\n  setRenderGridValues: function setRenderGridValues(render) {\n    render.properties.data.columns = [];\n    for (var i = 0, length = render.elements.length; i < length; i++) {\n      render.properties.data.columns.push(render.elements[i].render.properties.xpath);\n    }\n  },\n\n  /**\r\n      * This function sets the type of each xpath\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  setDataType: function setDataType(doc, form) {\n\n  },\n\n  /**\r\n      *  This method return the categories like the services if exists in the database\r\n      * @param {} params\r\n      * @param {} data\r\n      * @returns {} Returns a promise\r\n      */\n  setRenderValues: function setRenderValues(params, data, options) {\n    var type = params.type;\n\n    if (!type) type = \"label\";\n\n    var typeGroupBasic = [\"text\", \"label\", \"number\", \"money\", \"date\", \"boolean\", \"geolocation\", \"hidden\", \"upload\"];\n    var typeGroupCombo = [\"combo\", \"cascadingCombo\", \"radio\", \"list\"];\n\n    if (typeGroupBasic.indexOf(type) !== -1) {\n      params.value = data.value;\n      return;\n    }\n\n    if (typeGroupCombo.indexOf(type) !== -1) {\n      for (var i = 0, len = params.data.length; i < len; i++) {\n        if (params.data[i].id == data.value) {\n          params.value = [{ id: data.value, value: params.data[i].value }];\n        }\n      }\n\n      return;\n    }\n\n    if (type === \"search\") {\n      for (var j = 0, lengthData = params.data.length; j < lengthData; j++) {\n        if (params.data[j].id == data.value.id) {\n          params.value = data.value;\n        }\n      }\n      return;\n    }\n\n    if ([\"image\", \"signature\"].includes(type)) {\n      params.value = [[0, data.value.name]];\n      params.binaryValue = data.value;\n      return;\n    }\n\n    if (type === \"grid\") {\n      //New complex object for grids\n      params[\"offline-files\"] = data.value[\"offline-files\"] ? data.value[\"offline-files\"] : {};\n      params[\"deleted-records\"] = data.value[\"deleted-records\"] ? data.value[\"deleted-records\"] : {};\n      params[\"edited-images\"] = data.value[\"edited-images\"] ? data.value[\"edited-images\"] : {};\n\n\n      var isTaskForm = options.formProperties ? options.formProperties.isTaskForm : undefined;\n      var hasSyncErrors = options.hasSyncError === true;\n      if (isTaskForm === true && options.online === true && !hasSyncErrors) {\n        // This means that a sync was performed, therefore we must trust the server\n        return;\n      }\n      var storedDataRows = data.value.rows || [];\n\n      params.data.records = storedDataRows.length;\n      params.data.total = 1;\n      params.data.page = 1;\n\n      var lengthColumns = params.data.columns.length;\n      var tmpEditAndVisible = [];\n      var lengthRows = storedDataRows.length;\n      params.data.rows = [];\n      for (var row = 0; row < lengthRows; row++) {\n        // Add random value\n        var details = storedDataRows[row][storedDataRows[row].length - 1] && storedDataRows[row][storedDataRows[row].length - 1].idRow ? storedDataRows[row][storedDataRows[row].length - 1] : undefined;\n        var idRow = details ? details.idRow : bizagi.util.randomNumber();\n\n        var tmpElement = [];\n        var tempRow = [];\n        tmpElement[0] = idRow;\n\n        for (var col = 0; col < lengthColumns; col++) {\n          var index = -1;\n          if (storedDataRows[row][col]) {\n            if (storedDataRows[row][col].xpath) {\n              index = params.data.columns.indexOf(storedDataRows[row][col].xpath);\n              tempRow[index] = storedDataRows[row][col];\n            } else\n            if (!storedDataRows[row][col].changes) {\n              tempRow[col] = storedDataRows[row][col];\n            }\n          }\n          tempRow[col] = tempRow[col] != undefined ? tempRow[col] : null;\n          tmpElement[tmpElement.length] = \"true\";\n        }\n        var mergedRow = $.merge([idRow], tempRow);\n        params.data.rows.push(mergedRow);\n        tmpEditAndVisible[tmpEditAndVisible.length] = tmpElement;\n      }\n\n      params.data.editable = tmpEditAndVisible;\n      params.data.visible = tmpEditAndVisible;\n      return;\n    }\n\n    // No type supported\n    try {\n      params.value = data.value;\n    } catch (e) {\n    }\n\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  },\n\n  /**\r\n      * This method simulate a summary response\r\n      * @param {} params\r\n      * @returns {} Returns a promise\r\n      */\n  getSummary: function getSummary(params) {\n    var self = this;\n    var def = new $.Deferred();\n    if (params.offlineType && params.offlineType === \"task\") {\n      var activityCaseId = params.idCase + \"-\" + params.idWorkitem;\n      self.dbActivities.get(activityCaseId, function (err, doc) {\n        if (!err)\n        def.resolve($.extend(doc, {\n          processPath: \"/\",\n          currentState: doc.workItems,\n          countAssigness: 0,\n          countEvents: 0,\n          isOpen: doc.isOpen.toString(),\n          countSubProcesses: 0 }));else\n\n\n        def.reject(err);\n      });\n    } else\n    {\n      self.dbStartData.get(params.idCase, function (err, doc) {\n        if (!err)\n        def.resolve($.extend(doc, {\n          processPath: \"/\",\n          currentState: doc.workItems,\n          countAssigness: 0,\n          countEvents: 0,\n          isOpen: doc.isOpen.toString(),\n          countSubProcesses: 0 }));else\n\n\n        def.reject(err);\n      });\n    }\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save the image as an attachment to the form.\r\n      * This function only is called for store locally images in tasks \r\n      * that already exists in the server. For save new images use the saveActivityDataImage function.\r\n      * @param {*} params \r\n      * @param {*} image The blob corresponding to the image\r\n      */\n  saveActivityFormImage: function saveActivityFormImage(params, image) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var mimeType = \"image/png\";\n    return bizagi.util.db.saveAttachment(self.dbActivityForms, documentId, attachmentId, mimeType, image, true);\n  },\n\n  /**\r\n      * Save the image as an attachment to the Activity Data.\r\n      * This function only is called for store images uploaded in offline mode. \r\n      * @param {*} params \r\n      * @param {*} image The blob corresponding to the image\r\n      */\n  saveActivityDataImage: function saveActivityDataImage(params, image, type) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var mimeType = type || \"image/png\";\n    return bizagi.util.db.saveAttachment(self.dbActivityData, documentId,\n    attachmentId, mimeType, image, true);\n  },\n\n  getActivityDataImage: function getActivityDataImage(params, fileType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, \"image/png\");\n  },\n\n  getActivityImage: function getActivityImage(params, fileType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var mimeType = \"image/png\";\n\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, mimeType).\n    then(function (dataResult) {\n      if (dataResult !== undefined && dataResult != null) {\n        return dataResult;\n      }\n      return bizagi.util.db.getAttachment(self.dbActivityForms, documentId, attachmentId, fileType, mimeType);\n    });\n  },\n\n  /**\r\n      * Save the image as an attachment to the Start Form Data.\r\n      * This function only is called for store images uploaded in offline mode. \r\n      * @param {*} params \r\n      * @param {*} image The blob corresponding to the image\r\n      */\n  saveStartDataImage: function saveStartDataImage(params, image) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    var mimeType = \"image/png\";\n    return bizagi.util.db.saveAttachment(self.dbStartData, documentId, attachmentId, mimeType, image, true);\n  },\n\n  getStartDataImage: function getStartDataImage(params, fileType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    return bizagi.util.db.getAttachment(self.dbStartData, documentId, attachmentId, fileType, \"image/png\");\n  },\n\n  saveActivityFormFile: function saveActivityFormFile(params, file, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.saveAttachment(self.dbActivityForms, documentId, attachmentId, mimeType, file, true);\n  },\n\n  saveActivityDataFile: function saveActivityDataFile(params, file, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.saveAttachment(self.dbActivityData, documentId, attachmentId, mimeType, file, true);\n  },\n\n  getActivityDataFile: function getActivityDataFile(params, fileType, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, mimeType);\n  },\n\n  getActivityFile: function getActivityFile(params, fileType, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n\n    return bizagi.util.db.getAttachment(self.dbActivityData, documentId, attachmentId, fileType, mimeType).\n    then(function (dataResult) {\n      if (dataResult !== undefined && dataResult != null) {\n        return dataResult;\n      }\n      return bizagi.util.db.getAttachment(self.dbActivityForms, documentId, attachmentId, fileType, mimeType);\n    });\n  },\n\n  /**\r\n      * Save the file as an attachment to the Start Form Data.\r\n      * This function only is called for store files uploaded in offline mode. \r\n      * @param {*} params \r\n      * @param {*} file The blob corresponding to the file\r\n      */\n  saveStartDataFile: function saveStartDataFile(params, file, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    return bizagi.util.db.saveAttachment(self.dbStartData, documentId,\n    attachmentId, mimeType, file, true);\n  },\n\n  getStartDataFile: function getStartDataFile(params, fileType, mimeType) {\n    var self = this;\n    var attachmentId = params.id;\n    var documentId = params.idCase;\n    return bizagi.util.db.getAttachment(self.dbStartData, documentId, attachmentId, fileType, mimeType);\n  },\n\n  /**\r\n      * Prepare data for upload control\r\n      */\n  convertUploadOnlineValueInOfflineValue: function convertUploadOnlineValueInOfflineValue(uploadControlValue) {\n    var offlineValue = [];\n    if (uploadControlValue && Array.isArray(uploadControlValue)) {\n      uploadControlValue.forEach(function (singleFileValue) {\n        var fileName = singleFileValue[1];\n        var fileExtension = bizagi.util.media.getFileExtension(fileName).toLowerCase();\n        offlineValue.push(\n        {\n          id: singleFileValue[0],\n          fileName: fileName,\n          mimeType: bizagi.util.media.getMIMETypeByExtension(fileExtension),\n          status: \"existent\" });\n\n\n      });\n    }\n    return offlineValue;\n  },\n\n\n  /**\r\n      * Save the form with all xpaths resolved\r\n      * @param {R} params, workitem id, case id\r\n      * @param {*} data: form data\r\n      */\n  saveTaskForm: function saveTaskForm(params, formData) {\n    var db = this.dbActivityForms;\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var dataChangeset = formData && formData.form && formData.form.DataChangesetVersion != undefined ?\n    formData.form.DataChangesetVersion : params.dataChangeset;\n    formData._id = documentId;\n    var deferred = new $.Deferred();\n    var updatePromise = undefined;\n    if (dataChangeset != undefined) {\n      params.dataChangeset = dataChangeset;\n      formData.dataChangeset = dataChangeset;\n      updatePromise = this.updateTaskDatachangeset(documentId, dataChangeset);\n    }\n    $.when(updatePromise).always(function () {\n      $.when(bizagi.util.db.saveDocument(db, formData)).\n      then(function (resultSave) {\n        deferred.resolve(resultSave);\n      }).fail(function (errorSave) {\n        deferred.reject(errorSave);\n      });\n    });\n    return deferred.promise();\n  },\n\n  getTaskForm: function getTaskForm(params) {\n    var db = this.dbActivityForms;\n    var docId = params.idCase + '-' + params.idWorkitem;\n    var def = new $.Deferred();\n    $.when(bizagi.util.db.getDocument(db, docId)).\n    then(function (data) {\n      if (data && data.form) {\n        def.resolve(data);\n      } else\n      {\n        var responseText = {\n          errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n          message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n        def.reject({ responseText: JSON.stringify(responseText) });\n      }\n    }).\n    fail(function (err) {\n      var responseText = {\n        errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n        message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n      def.reject({ responseText: JSON.stringify(responseText) });\n    });\n\n    return def.promise();\n  },\n\n  deleteTaskForm: function deleteTaskForm(params) {\n    var documentId = params.idCase + '-' + params.idWorkitem;\n    var db = this.dbActivityForms;\n    return bizagi.util.db.deleteDocument(db, documentId);\n  },\n\n  updateTaskForm: function updateTaskForm(params, formData) {\n    this.saveTaskForm(params, formData);\n  },\n\n  getFileAttachmentsFromLocalTaskForm: function getFileAttachmentsFromLocalTaskForm(params) {\n    var def = new $.Deferred();\n    this.getTaskForm(params).\n    then(function (localForm) {\n      def.resolve(localForm._attachments || {});\n    }, function () {\n      def.resolve({});\n    });\n    return def.promise();\n  },\n\n\n  getStartForm: function getStartForm(params) {\n    var db = this.dbStartForms;\n    var docId = params.idProcess.toString();\n    return bizagi.util.db.getDocument(db, docId);\n  },\n\n  saveStartForm: function saveStartForm(params, form) {\n    var db = this.dbStartForms;\n    form._id = params.idProcess;\n    return bizagi.util.db.saveDocument(db, form);\n  },\n\n  mergeTaskAction: function mergeTaskAction(oldAction, newAction) {\n\n    var self = this;\n    var result = self.mergeObject(oldAction, newAction, { depth: 3 });\n    result = self.reduceLocalGridDeletions(result);\n    return result;\n  },\n\n  mergeObject: function mergeObject(a, b, options) {\n    var self = this;\n    if (_typeof(b) !== \"object\" || bizagi.util.isArray(b)) {\n      a = b;\n      return a;\n    }\n    if (b === null || b === undefined) return a;\n\n    Object.keys(b).forEach(function (key) {\n      if (_typeof(b[key]) == \"object\" && !bizagi.util.isArray(b[key])) {\n        a[key] = a[key] || {};\n        if (options.depth === undefined || options.depth <= 0)\n        bizagi.util.extend(a[key], b[key]);else\n\n        self.mergeObject(a[key], b[key], { depth: options.depth - 1 });\n      } else\n\n      a[key] = b[key];\n    });\n    return a;\n  },\n\n  reduceLocalGridDeletions: function reduceLocalGridDeletions(data) {\n    Object.keys(data).forEach(function (key) {\n      var item = data[key] && data[key].value ? data[key].value : data[key];\n      if (item !== undefined && item[\"deleted-records\"] && item[\"new-records\"]) {\n        Object.keys(item[\"new-records\"]).forEach(function (i) {\n          if (item[\"deleted-records\"][i]) {\n            delete item[\"new-records\"][i];\n            delete item[\"deleted-records\"][i];\n          }\n        });\n      }\n    });\n    return data;\n\n  },\n\n  /*\r\n     *   This method save the form data of the created case\r\n     *   Returns a promise\r\n     */\n  saveTaskData: function saveTaskData(params, data) {\n    var self = this;\n    var def = new $.Deferred();\n    var docId = params.idCase + '-' + params.idWorkitem;\n    var db = self.dbActivityData;\n    $.when(bizagi.util.db.getDocument(db, docId)).\n    then(function (document) {\n      // only add new actions\n      if (document.data) {\n\n        var unifiedActions = document.data.h_actions || [];\n        if (params.actions) {\n          Object.keys(params.actions).forEach(function (actionKey) {\n            var currentAction = params.actions[actionKey];\n            if (currentAction != undefined) {\n              if (self.canAddActionInList(currentAction, unifiedActions)) {\n                unifiedActions.push(currentAction);\n              }\n            }\n          });\n        }\n        document.data.h_actions = unifiedActions;\n      } else {\n        data.h_actions = params.actions;\n      }\n\n      var dataUpdated = document.data ?\n      self.mergeTaskAction(document.data, data) :\n      data;\n\n      self.performSaveTaskData(def, dataUpdated, docId, params, db);\n    })\n    //First save => and the actions are saved\n    .fail(function () {\n      data.h_actions = params.actions;\n      self.performSaveTaskData(def, data, docId, params, db);\n    });\n\n    return def.promise();\n  },\n\n  performSaveTaskData: function performSaveTaskData(def, dataToSave, docId, params, db) {\n    var self = this;\n    var doc = {\n      _id: docId,\n      data: dataToSave,\n      idForm: params.idForm };\n\n    $.when(bizagi.util.db.saveDocument(db, doc)).\n    then(function (saveResult) {\n      var markTaskPromise;\n\n      if (params.action === \"next\" || params.action === \"nextWithoutValidations\")\n      {\n        markTaskPromise = self.closeOfflineTask(params);\n      } else\n\n      {\n        markTaskPromise = self.markTaskEdited(params);\n      }\n\n      $.when(markTaskPromise).\n      then(function (markResponse) {\n        def.resolve(markResponse);\n      }).\n      fail(function (markError) {\n        def.reject(markError);\n      });\n    }).\n    fail(function (saveError) {\n      def.reject(saveError);\n    });\n  },\n\n  canAddActionInList: function canAddActionInList(action, actionList) {\n    var result = true;\n\n    // validate if action added before\n    actionList.forEach(function (actionStored) {\n      if (actionStored.h_action && action.h_action) {\n        if (actionStored.h_idRender && action.h_idRender) {\n          if (actionStored.h_action == action.h_action && actionStored.h_idRender == action.h_idRender) {\n            result = false;\n          }\n        } else\n        {\n          if (actionStored.h_action == action.h_action) {\n            result = false;\n          }\n        }\n      }\n    });\n\n    return result;\n  },\n\n  separateComplexControls: function separateComplexControls(params, data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var mergePromise;\n    if (params.offlineType && params.offlineType !== \"task\") {\n      mergePromise = new $.Deferred(),\n      mergePromise.resolve(data);\n    } else\n    {\n      mergePromise = self.mergeDataDocument(data, self.getTaskForm(params));\n    }\n    $.when(mergePromise).\n    done(function (mergeRes) {\n      var images = [];\n      var uploads = [];\n      var grids = [];\n      Object.keys(mergeRes).forEach(function (key) {\n        var value = mergeRes[key];\n        if (value && value.renderId && value.type && [\"image\", \"signature\"].includes(value.type)) {\n          value.xpath = key;\n          images.push(value);\n          delete data[key];\n        } else\n        if (value && value.renderId && value.type && value.type === \"upload\") {\n          value.xpath = key;\n          uploads.push(value);\n          delete data[key];\n        } else\n        if (value && value.renderId && value.type && value.type === \"grid\") {\n          value.xpath = key;\n          grids.push(value);\n          delete data[key];\n        }\n      });\n      def.resolve({\n        data: data,\n        images: images,\n        uploads: uploads,\n        grids: grids });\n    }).\n    fail(function (mergeError) {\n      def.reject(mergeError);\n    });\n\n    return def.promise();\n  },\n\n  markTaskEdited: function markTaskEdited(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var db = self.dbActivities;\n    var docId = params.idCase + '-' + params.idWorkitem;\n\n    $.when(bizagi.util.db.getDocument(db, docId)).\n    then(function (document) {\n      document.isEdited = true;\n      $.when(bizagi.util.db.saveDocument(db, document)).\n      then(function (updateResponse) {\n        def.resolve(updateResponse);\n      }).\n      fail(function (updateErr) {\n        def.reject(updateErr);\n      });\n    }).\n    fail(function (getErr) {\n      def.reject(getErr);\n    });\n\n    return def.promise();\n  },\n\n  getTaskData: function getTaskData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var id = params.idCase + '-' + params.idWorkitem;\n    self.dbActivityData.get(id, function (err, resp) {\n      if (!err)\n      def.resolve(resp);else\n\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n  deleteTaskData: function deleteTaskData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var id = params.idCase + '-' + params.idWorkitem;\n    var deleteAttachments = params.deleteAttachments === true;\n    $.when(bizagi.util.db.getDocument(self.dbActivityData, id)).\n    then(function (currentTaskData) {\n      var deletePromise;\n      if (deleteAttachments) {\n        deletePromise = bizagi.util.db.deleteDocument(self.dbActivityData, id);\n      } else\n      {\n        var emptyTaskData = {\n          _id: id };\n\n        deletePromise = bizagi.util.db.saveDocument(self.dbActivityData, emptyTaskData);\n      }\n      $.when(deletePromise).\n      then(function (deleteResponse) {\n        def.resolve();\n      }).\n      fail(function (deleteError) {\n        def.reject(deleteError);\n      });\n    }).\n    fail(function (getDocError) {\n      //Local document doesn't exist so delete is unnecessary\n      def.resolve();\n    });\n    return def.promise();\n  },\n\n  /*\r\n     *   This method saves the form info in the db\r\n     *   Returns a promise\r\n     */\n  saveStartData: function saveStartData(params, data) {\n    var self = this;\n\n    return $.when(bizagi.util.db.getDocument(self.dbStartData, params.idCase)).\n    then(function (doc) {\n      return self.mergeDataDocument(data, bizagi.util.db.getDocument(self.dbStartForms, doc.idWfClass.toString())).\n      then(function (resp) {\n        doc = self.mergeData(data, doc, resp);\n        if (params.idForm) {\n          doc.idForm = params.idForm;\n        }\n        return bizagi.util.db.saveDocument(self.dbStartData, doc);\n      });\n    });\n  },\n\n  filterXpathsByType: function filterXpathsByType(form, type) {\n    var xpaths = [];\n    var elements = form.form.elements;\n    extractRenderElements(elements, xpaths);\n\n    function extractRenderElements(elements, xpaths) {\n      if (elements) {\n        for (var i = 0; i < elements.length; i++) {\n          var isContainer = elements[i].container;\n          if (isContainer) {\n            extractRenderElements(elements[i].container.elements, xpaths);\n          } else\n          {\n            extractXpathFromRenderProperties(elements[i].render.properties, xpaths);\n          }\n        }\n      }\n    }\n\n    function extractXpathFromRenderProperties(renderProperties, xpaths) {\n      if (renderProperties.xpath && renderProperties.type === type) {\n        xpaths.push({\n          xpath: renderProperties.xpath,\n          renderId: renderProperties.id,\n          value: renderProperties.value });\n\n      }\n    }\n\n    return xpaths;\n\n  },\n\n  filterXpathsByTypeMap: function filterXpathsByTypeMap(form, typeMap) {\n    var self = this;\n    var xpaths = [];\n    var elements = form.form.elements;\n    extractRenderElements(elements, xpaths);\n\n    function extractRenderElements(elements, xpaths) {\n      if (elements) {\n        for (var i = 0; i < elements.length; i++) {\n          var isContainer = elements[i].container;\n          if (isContainer) {\n            extractRenderElements(elements[i].container.elements, xpaths);\n          } else\n          {\n            var renderProperties = elements[i].render.properties;\n            if (renderProperties.type === \"grid\") {\n              if (renderProperties.data && renderProperties.data.records > 0) {\n                var filteredColumns = [];\n                //filterCols\n                for (var k = 0; k < elements[i].render.elements.length; k++) {\n                  var renderColumn = elements[i].render.elements[k];\n                  renderColumn.position = k + 1;\n                  if (typeMap[renderColumn.render.properties.type]) {\n                    filteredColumns.push(renderColumn);\n                  }\n                }\n                if (filteredColumns.length > 0) {\n                  var rows = renderProperties.data.rows;\n                  for (var j = 0; j < rows.length; j++) {\n                    var currentRow = rows[j];\n                    filteredColumns.forEach(function (column) {\n                      xpaths.push({\n                        xpath: column.render.properties.xpath,\n                        renderId: column.render.properties.id,\n                        value: currentRow[column.position],\n                        xpathContext: renderProperties.xpath + self.buildCellXpathFilter(currentRow[0]),\n                        gridXpath: renderProperties.xpath,\n                        columnXpath: column.render.properties.xpath,\n                        idRow: currentRow[0],\n                        type: column.render.properties.type });\n\n                    });\n                  }\n                }\n              }\n            } else {\n              extractXpathFromRenderProperties(renderProperties, xpaths);\n            }\n          }\n        }\n      }\n    }\n\n    function extractXpathFromRenderProperties(renderProperties, xpaths) {\n      if (renderProperties.xpath && typeMap[renderProperties.type]) {\n        xpaths.push({\n          xpath: renderProperties.xpath,\n          renderId: renderProperties.id,\n          value: renderProperties.value,\n          type: renderProperties.type });\n\n      }\n    }\n\n    return xpaths;\n\n  },\n\n  buildCellXpathFilter: function buildCellXpathFilter(key) {\n    if (bizagi.util.isNumeric(key)) return \"[id=\" + key + \"]\";\n    return \"[id='\" + key + \"']\";\n  },\n\n  mergeDataDocument: function mergeDataDocument(data, form) {\n    var defer = new $.Deferred();\n    var response = {};\n\n    $.when(form).done(function (resp) {\n\n      for (prop in data) {\n        if (prop != \"h_action\" && prop != \"h_actions\") {\n          response[prop] = {};\n          response[prop].value = data[prop];\n          fillForm(resp.form.elements, {\n            key: prop,\n            value: data[prop] });\n\n        }\n      }\n\n      function fillForm(element, datafill) {\n        if (Array.isArray(element)) {\n          for (var i = 0, len = element.length; i < len; i++) {\n            fillForm(element[i], datafill);\n          }\n        } else {\n          if (element.container) {\n            fillForm(element.container.elements, datafill);\n          } else {\n            if (element.render.properties.xpath == datafill.key) {\n              response[datafill.key].DataType = element.render.properties.dataType || \"\";\n              response[datafill.key].type = element.render.properties.type || \"\";\n              response[datafill.key].renderId = element.render.properties.id;\n            }\n          }\n        }\n      }\n\n      defer.resolve(response);\n    });\n\n    return defer.promise();\n  },\n\n  mergeData: function mergeData(data, doc, resp) {\n    var self = this;\n    if (data.h_action == \"next\" || data.h_action == \"nextWithoutValidations\") {\n      doc.isOpen = false;\n    }\n\n    doc.data = doc.data || {};\n    var dataUpdated = self.mergeTaskAction(doc.data, resp);\n    doc.data = dataUpdated;\n    return doc;\n\n  },\n\n  nativeSaveFormInfo: function nativeSaveFormInfo(data, doc, form) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.mergeDataDocument(data, form).\n    done(function (resp) {\n      doc = self.mergeData(data, doc, resp);\n      def.resolve(doc);\n    });\n\n    return def.promise();\n  },\n\n  deleteNextButton: function deleteNextButton(data) {\n    if (data.form && data.form.buttons) {\n\n      data.form.buttons = data.form.buttons.filter(function (value) {\n        var properties = value.button.properties;\n        if (properties) {\n          return !(properties.caption && properties.caption === \"render-form-button-next\");\n        }\n        return true;\n      });\n    }\n    return data;\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author:Bizagi Mobile Team\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n$.Class.extend(\"bizagi.workportal.services.fetchWorker\", {}, {\n  init: function init(params) {\n    var self = this;\n    self.services = params;\n    self.db = params.database;\n    self.maxOfflineCases = 100;\n    self.secondsBeforeAllowFetchAgain = 2;\n    self.tasksSyncDelta = 8;\n    self.startSyncDelta = 8;\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n\n    self.fetchInProgress = false;\n\n  },\n\n  triggerOfflineSyncEvent: function triggerOfflineSyncEvent(params) {\n    if (bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice()) {\n      bizagiapp.synchronizeDownloadOfflineState(params);\n    } else {\n      bizagi.webpart.publish(\"offline.sync\", params);\n    }\n  },\n\n  fetch: function fetch(argument) {\n    var self = this;\n\n    var timeBeforeFetch = self.secondsBeforeAllowFetchAgain * 1000;\n    if (self.lastFetch) {\n      if (self.lastFetch + timeBeforeFetch < Date.now() && !self.fetchInProgress) {\n        executeFetch();\n      }\n    } else\n    if (!self.fetchInProgress) {\n      executeFetch();\n    }\n\n    function executeFetch() {\n      self.triggerOfflineSyncEvent({ type: \"download-started\" });\n      self.fetchInProgress = true;\n      self.fetchInProgressPromise = new $.Deferred();\n\n      var getOfflineTasksProm = self.services.callServiceWithNetworkRetries(self.services, self.services.getOfflineTasks, [], 5, 2000);\n      var getOfflineProcessesProm = self.services.callServiceWithNetworkRetries(self.services, self.services.getOfflineProcessesHierarchy, [], 5, 2000);;\n      var formsToDownloadCountPromise = new $.Deferred();\n\n      var downloadStartFormsPromise;\n      var downloadTaskFormsPromise;\n\n      var offlineWorkAvailable = 0;\n\n      $.when(getOfflineProcessesProm, getOfflineTasksProm).\n      then(function (offlineProcessesHierarchy, offlineTasksResponse) {\n\n        var offlineProcessesList = self.getProcessesListFromHierarchy(offlineProcessesHierarchy);\n\n        var serializedOfflineActivities = self.serializeActivities(offlineTasksResponse);\n\n        offlineWorkAvailable = offlineProcessesList.length + Object.keys(serializedOfflineActivities).length;\n\n        $.when(self.getTasksToDownload(serializedOfflineActivities), self.getStartFormsToDownload(offlineProcessesList)).\n        then(function (tasksToDownloadResponse, startFormsToDownload) {\n          downloadTaskFormsPromise = self.processTasksToFetchForms(serializedOfflineActivities, tasksToDownloadResponse.items);\n          downloadStartFormsPromise = self.fetchStartForms(offlineProcessesHierarchy, startFormsToDownload);\n          formsToDownloadCountPromise.resolve(startFormsToDownload.length + tasksToDownloadResponse.count);\n        }).\n        fail(function (getTasksToDownloadErr, getStartFormsToDownloadErr) {\n          formsToDownloadCountPromise.reject({ tasks: getTasksToDownloadErr, start: getStartFormsToDownloadErr });\n        });\n      }).\n      fail(function (startFormsSyncNeededError, offlineTasksError) {\n        console.log(\"Forms download fails\", startFormsSyncNeededError, offlineTasksError);\n        formsToDownloadCountPromise.reject();\n      });\n\n      $.when(formsToDownloadCountPromise).\n      then(function (count) {\n        if (count > 0) {\n          self.triggerOfflineSyncEvent({ type: \"update-total-downloads\", argument: count });\n        } else\n        {\n          if (offlineWorkAvailable > 0) {\n            self.triggerOfflineSyncEvent({ type: \"up-to-date\", argument: offlineWorkAvailable });\n          }\n        }\n        return $.when.apply($, [downloadStartFormsPromise, downloadTaskFormsPromise]);\n      }).\n      then(function () {\n        self.lastFetch = Date.now();\n        self.fetchInProgressPromise.resolve(true);\n        self.fetchInProgress = false;\n        self.triggerOfflineSyncEvent({ type: \"download-finished\" });\n        $(document).trigger(\"offline-notify-form-sync-event\", { type: \"download-finished\" });\n      }).\n      fail(function () {\n        //Wait for all downloads ends, because can fail only downloading start forms but not tasks or vice\n        $.when(downloadStartFormsPromise).\n        always(function (startResult) {\n          $.when(downloadTaskFormsPromise).\n          always(function (tasksResult) {\n            self.fetchInProgressPromise.reject(\"Error executing fetch v2\");\n            self.fetchInProgress = false;\n            self.triggerOfflineSyncEvent({ type: \"download-error\" });\n            $(document).trigger(\"offline-notify-form-sync-event\", { type: \"download-error\" });\n          });\n        });\n      });\n\n      $.when(self.services.getRecentOfflineProcesses()).\n      then(function (recentProcceses) {\n        self.saveRecentProcesses(recentProcceses);\n      });\n    }\n\n    return self.fetchInProgressPromise.promise();\n  },\n\n  fetchStartForms: function fetchStartForms(offlineProcessTree, processesList) {\n    var def = new $.Deferred();\n    var self = this;\n    var offlineProcessTree;\n    $.when(self.saveProcessesHierarchy(offlineProcessTree)).\n    then(function () {\n      return self.downloadStartForms(processesList);\n    }).\n    then(function () {\n      def.resolve();\n    }).\n    fail(function (err) {\n      console.log(\"Sv2: Problem downloading any offline start form\", err);\n      def.reject();\n    });\n    return def.promise();\n  },\n\n  getProcessesListFromHierarchy: function getProcessesListFromHierarchy(offlineProcessTree) {\n    var processes = [];\n\n    for (var i = 0; i < offlineProcessTree.length; i++) {\n      var currentApplication = offlineProcessTree[i];\n      var categories = currentApplication.categories;\n      for (var j = 0; j < categories.length; j++) {\n        getProcessesFromCategory(categories[j]);\n      }\n    }\n\n    function getProcessesFromCategory(category) {\n      if (category.isProcess === \"true\" && category.hasOfflineForm) {\n        processes.push(category.idCategory);\n      } else\n      if (category.subCategories) {\n        for (var k = 0; k < category.subCategories.length; k++) {\n          var subCategory = category.subCategories[k];\n          getProcessesFromCategory(subCategory);\n        }\n      }\n    }\n    return processes;\n  },\n\n  getStartFormsToDownload: function getStartFormsToDownload(processes) {\n    var self = this;\n    var def = new $.Deferred();\n    var checksQueue = new bizagiQueue();\n    var processesToDownload = [];\n    processes.forEach(function (idProcess) {\n      var checkProm = self.checkIfStartFormNeedsSync(idProcess);\n      $.when(checkProm).\n      then(function (isSyncNeeded) {\n        if (isSyncNeeded) {\n          processesToDownload.push(idProcess);\n        }\n      });\n      checksQueue.add(checkProm);\n    });\n\n    $.when(checksQueue.execute()).\n    always(function () {\n      def.resolve(processesToDownload);\n    });\n    return def.promise();\n  },\n\n  checkIfStartFormNeedsSync: function checkIfStartFormNeedsSync(idProcess) {\n    var def = new $.Deferred();\n    var self = this;\n    $.when(self.services.database.getStartForm({ idProcess: idProcess })).\n    then(function (localForm) {\n      var isHardRefreshNeeded = false;\n      var isFirstDayDownload = false;\n\n      var lastSync = localForm.lastSynchronization;\n      if (lastSync != undefined) {\n        var currentTime = Date.now();\n        isHardRefreshNeeded = lastSync + self.startSyncDelta * 60 * 60 * 1000 < currentTime;\n      } else\n      {\n        isHardRefreshNeeded = true;\n      }\n      if (new Date().getDate() != (bizagi.util.getSyncTimeStamp() || new Date()).getDate()) {\n        isFirstDayDownload = true;\n      }\n      def.resolve(isFirstDayDownload || isHardRefreshNeeded);\n    }).\n    fail(function () {\n      def.resolve(true);\n    });\n    return def.promise();\n  },\n\n  downloadStartForms: function downloadStartForms(processes) {\n    var self = this;\n    var def = new $.Deferred();\n    var downloadFormsQueue = new bizagiQueue();\n\n    var formsSuccessCount = 0;\n    var formsFailedCount = 0;\n\n    for (var i = 0; i < processes.length; i++) {\n      var downloadProm = self.services.downloadOfflineStartForm({\n        idProcess: processes[i] });\n\n      $.when(downloadProm).\n      then(function () {\n        self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"success\" });\n        formsSuccessCount++;\n        checkIfDownloadStartFormsEnds();\n      }).\n      fail(function () {\n        self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"error\" });\n        formsFailedCount++;\n        checkIfDownloadStartFormsEnds();\n      });\n      downloadFormsQueue.add(downloadProm);\n    }\n    $.when(downloadFormsQueue.execute()).\n    always(function () {\n      checkIfDownloadStartFormsEnds();\n    });\n\n    function checkIfDownloadStartFormsEnds() {\n      if (formsFailedCount + formsSuccessCount == processes.length) {\n        if (formsFailedCount > 0) {\n          def.reject();\n        } else\n        {\n          def.resolve();\n        }\n      }\n    }\n\n    return def.promise();\n  },\n\n  serializeActivities: function serializeActivities(offlineTasksResponse) {\n    var self = this;\n    var elementsMap = {};\n\n    var row,i = -1;\n    var actualDate = new Date();\n    var statusFunction = offlineTasksResponse.advanceSearch ? self.services.defineActivityStateByTaskState : self.services.defineActivityStateByDate;\n\n    while (row = offlineTasksResponse.rows[++i]) {\n      var tempElementOriginalValues = {},el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\", \"\", \"\"];\n      var systemColumns = {};\n      var field,j = -1;\n      while (field = offlineTasksResponse.headers[++j]) {\n        tempElementOriginalValues[field.fieldName.toLowerCase()] = {\n          \"displayName\": field.displayName.trim(),\n          \"value\": row[j] };\n\n        if (self.services.isInboxHeaderASystemColumn(field.fieldName)) {\n          systemColumns[field.fieldName] = row[j];\n        }\n        self.services.serializeActivity(el, field.fieldName.toLowerCase(), tempElementOriginalValues[field.fieldName.toLowerCase()]);\n      }\n\n      var tmpElement = el;\n      var status = {};\n\n      status = statusFunction(tmpElement[3], tmpElement.taskstate);\n\n      // Time to atRiskTimeDelta\n      if (tmpElement.length >= 10 && parseInt(tmpElement[11], 10) > 0) {\n        var tmpEndDate = new Date(tmpElement[3]);\n\n        if (actualDate.getTime() > tmpEndDate.getTime()) {\n          status.state = \"red\";\n        } else {\n          if (actualDate.getTime() > tmpEndDate.getTime() - parseInt(tmpElement[11], 10) * 60000) {\n            status.state = \"yellow\";\n          } else {\n            status.state = \"green\";\n          }\n        }\n      }\n\n      //Tasks are offline\n      // When the activity has the property isOffline it should be mapped\n      tmpElement[7] = !bizagi.util.isEmpty(tempElementOriginalValues.isoffline) ? tempElementOriginalValues.isoffline.value : true;\n      tmpElement = $.extend({}, tmpElement, status, {\n        \"endDate\": tmpElement[3],\n        \"idworkitem\": tmpElement[1],\n        \"idwfclass\": !bizagi.util.validateFeatureSupport(\"advancedSearch\") ? tmpElement[7] : tmpElement[10],\n        \"systemColumns\": systemColumns });\n\n\n      var idCase = tmpElement[0];\n      var idWorkitem = tmpElement[1];\n      var internalId = idCase + \"-\" + idWorkitem;\n\n      //Only the offline activities should be included in the response\n      if (tmpElement[7] === true) {\n        elementsMap[internalId] = tmpElement;\n      }\n    }\n\n    return elementsMap;\n  },\n\n  getTasksToDownload: function getTasksToDownload(serverActivities) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.services.database.getLocalActivities()).\n    then(function (localCases) {\n      var itemsToDownload = {};\n      var itemsCount = 0;\n\n      Object.keys(serverActivities).forEach(function (servTaskId) {\n        var servTask = serverActivities[servTaskId];\n        var matchingLocalTask = localCases[servTaskId];\n        if (self.taskFormNeedsRefresh(servTask, matchingLocalTask)) {\n          itemsToDownload[servTaskId] = {\n            idCase: servTask[0],\n            idWorkitem: servTask[1],\n            syncDelda: self.tasksSyncDelta,\n            dataChangeset: servTask.dataChangeset };\n\n          itemsCount++;\n        }\n      });\n      def.resolve({\n        items: itemsToDownload,\n        count: itemsCount });\n\n      if (itemsCount > 0) {\n        var formNotificationParams = {\n          type: \"fetch-tasks-started\",\n          tasks: itemsToDownload };\n\n        $(document).trigger(\"offline-notify-form-sync-event\", formNotificationParams);\n      }\n    }).\n    fail(function () {\n      def.reject();\n    });\n    return def.promise();\n  },\n\n  taskFormNeedsRefresh: function taskFormNeedsRefresh(serverTask, localTask) {\n    var timeBeforeNextHardRefresh = 1000 * 60 * 60 * this.tasksSyncDelta;\n    var updateIsRequired = false;\n    var hardRefreshIsRequired = false;\n    var isFirstDayDownload = false;\n    if (localTask == undefined || localTask.dataChangeset == undefined || serverTask.dataChangeset !== localTask.dataChangeset) {\n      updateIsRequired = true;\n    } else\n    if (localTask.lastFullSync == undefined || localTask.lastFullSync + timeBeforeNextHardRefresh < Date.now()) {\n      hardRefreshIsRequired = true;\n    }\n    if (new Date().getDate() != (bizagi.util.getSyncTimeStamp() || new Date()).getDate()) {\n      isFirstDayDownload = true;\n    }\n    return updateIsRequired || hardRefreshIsRequired || isFirstDayDownload;\n  },\n\n  processTasksToFetchForms: function processTasksToFetchForms(serverTasks, tasksToDownload) {\n    var self = this;\n    var def = new $.Deferred();\n    var queueReadyToProcess = new $.Deferred();\n    var processOfflineFormsQueue = new bizagiQueue();\n\n    var tasksSuccessfulCount = 0;\n    var tasksFailedCount = 0;\n    var tasksToDownloadCount = 0;\n\n    //Si el task fue trabajado y tiene error de sincronizacin no se actualiza.\n    $.when(self.db.getOutboxTaskCasesFilteredBySyncStatus(\"any\", false)).\n    then(function (result) {\n      for (var i = 0; i < result.length; i++) {\n        delete tasksToDownload[result[i].id];\n        delete serverTasks[result[i].id];\n      }\n      return true;\n    })\n    //Buscar las actividades que estn en el inbox offline\n    .then(function () {\n      var localActivitiesProm = new $.Deferred();\n      self.db.dbActivities.allDocs({ include_docs: false }, function (err, response) {\n        if (err)\n        localActivitiesProm.reject();else\n\n        localActivitiesProm.resolve(response.rows);\n      });\n      return localActivitiesProm.promise();\n    })\n    //Si una actividad ya no est disponible (est local pero no en la lista del server) se debe eliminar la actividad, la forma y el caso\n    .then(function (localActivities) {\n      for (var i = 0; i < localActivities.length; i++) {\n        localActivityInternalId = localActivities[i].id;\n        var isActivityAvailable = serverTasks[localActivityInternalId] ? true : false;\n        if (!isActivityAvailable) {\n          processOfflineFormsQueue.add(self.deleteLocalDataIfActivityWasNotWorked(localActivityInternalId));\n        }\n      }\n      queueReadyToProcess.resolve();\n    }).\n    fail(function (error) {\n      console.log(\"Diff algorithm error\", error);\n      queueReadyToProcess.resolve();\n    });\n\n    $.when(queueReadyToProcess).\n    then(function () {\n      return self.services.database.saveOfflineTasks(serverTasks);\n    }).\n    then(function (saveResponse) {\n      self.services.downloadOfflineCustomizedColumns();\n      Object.keys(tasksToDownload).forEach(function (key) {\n        var internalId = key;\n        var downloadTaskParams = tasksToDownload[internalId];\n        tasksToDownloadCount++;\n        $.extend(downloadTaskParams, { bulkDownload: true });\n        var processFormProm = self.services.downloadOfflineTaskForm(downloadTaskParams);\n        $.when(processFormProm).\n        then(function () {\n          return self.updateActivityDatachangesetAndSyncTimestamp(internalId, downloadTaskParams.dataChangeset);\n        }).\n        then(function () {\n          self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"success\" });\n          tasksSuccessfulCount++;\n          checkIfDownloadTaskFormsEnds();\n        }).\n        fail(function () {\n          self.triggerOfflineSyncEvent({ type: \"form-finished\", argument: \"error\" });\n          tasksFailedCount++;\n          checkIfDownloadTaskFormsEnds();\n        });\n        processOfflineFormsQueue.add(processFormProm);\n      });\n      return processOfflineFormsQueue.execute();\n    }).\n    then(function () {\n      checkIfDownloadTaskFormsEnds();\n    }).\n    fail(function (err) {\n      if (tasksToDownloadCount == 0) {\n        def.reject(err);\n        console.log(\"Error in tasks download's differential algorithm:\", err);\n      } else\n      {\n        checkIfDownloadTaskFormsEnds();\n      }\n    });\n\n\n    function checkIfDownloadTaskFormsEnds() {\n      if (tasksFailedCount + tasksSuccessfulCount == tasksToDownloadCount) {\n        if (tasksFailedCount > 0) {\n          console.log(\"Download of tasks forms finished with ERRORS\");\n          def.reject();\n        } else\n        {\n          def.resolve();\n        }\n      }\n    }\n\n    return def.promise();\n  },\n\n  deleteLocalDataIfActivityWasNotWorked: function deleteLocalDataIfActivityWasNotWorked(internalId) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.db.validateLocalDataForTaskExists(internalId)).\n    then(function (localDataExists) {\n      if (!localDataExists) {\n        var deleteTaskDataParams = {\n          idCase: internalId.split(\"-\")[0],\n          idWorkitem: internalId.split(\"-\")[1],\n          deleteAttachments: true };\n\n        var deleteFullActivityData = self.db.deleteTaskData(deleteTaskDataParams);\n        var deleteActivity = self.db.deleteTask(deleteTaskDataParams);\n        var deleteActivityForm = self.db.deleteTaskForm(deleteTaskDataParams);\n        $.when(deleteActivity, deleteActivityForm, deleteFullActivityData).\n        then(function () {\n          def.resolve();\n        }).\n        fail(function (deleteActivityError, deleteFormError, deleteFullActivityDataError) {\n          // If those items are already deleted, it doesn't matter\n          if (deleteActivityError && deleteActivityError.status == 404) deleteActivityError = undefined;\n          if (deleteFormError && deleteFormError.status == 404) deleteActivityError = undefined;\n          if (deleteFullActivityDataError && deleteFullActivityDataError.status == 404) deleteActivityError = undefined;\n\n          if (bizagi.util.isEmpty(deleteActivityError) &&\n          bizagi.util.isEmpty(deleteFormError) &&\n          bizagi.util.isEmpty(deleteFullActivityDataError)) {\n\n            def.resolve();\n            return;\n          }\n\n          var error = {\n            type: \"error\",\n            errorType: \"offlineDiffAlgorithmError\",\n            message: \"Problem removing local case and data\",\n            technicalNote: \"Problem in deleteLocalDataIfActivityWasNotWorked\",\n            deleteActivityError: deleteActivityError,\n            deleteFormError: deleteFormError,\n            deleteFullActivityDataError: deleteFullActivityDataError };\n\n          def.reject(error);\n        });\n      } else\n      {\n        def.resolve();\n      }\n    }).\n    fail(function (validateLocalDataError) {\n      def.reject(validateLocalDataError);\n    });\n    return def.promise();\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // Only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n\n    return objects;\n  },\n\n\n  /**\r\n      * Save in the db the user permitions to create cases\r\n      * @param {} hierarchy \r\n      * @returns {} \r\n      */\n  saveProcessesHierarchy: function saveProcessesHierarchy(hierarchy) {\n    var self = this;\n    var db = self.db.dbProcessesHierarchy;\n    var docHierarchy = {\n      _id: self.globalId,\n      doc: hierarchy,\n      lastSynchronization: Date.now() };\n\n    return bizagi.util.db.saveDocument(db, docHierarchy);\n  },\n\n  /**\r\n      * Save in the db the user recent processes to create cases\r\n      * @param {} processes \r\n      * @returns {} \r\n      */\n  saveRecentProcesses: function saveRecentProcesses(processes) {\n    var self = this;\n    var db = self.db.dbRecentProcesses;\n    processes._id = self.globalId;\n    return bizagi.util.db.saveDocument(db, processes);\n  },\n\n\n  /**\r\n      * \r\n      */\n  updateActivityDatachangesetAndSyncTimestamp: function updateActivityDatachangesetAndSyncTimestamp(caseId, dataChangeset) {\n    var self = this;\n    var def = new $.Deferred();\n    var db = self.db.dbActivities;\n    $.when(bizagi.util.db.getDocument(db, caseId)).\n    then(function (activity) {\n      if (activity.dataChangeset == undefined || dataChangeset > activity.dataChangeset) {\n        activity.dataChangeset = dataChangeset;\n      }\n      activity.lastFullSync = Date.now();\n      return bizagi.util.db.saveDocument(db, activity);\n    }).\n    then(function (saveResult) {\n      def.resolve();\n    }).\n    fail(function (error) {\n      def.reject(error);\n    });\n    return def.promise();\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: BizAgi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author: Ricardo Perez\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n//$.Class.extend\n$.Class(\"bizagi.workportal.services.db.old\", {}, {\n  /* \r\n                                                   *   Constructor\r\n                                                   */\n  init: function init() {\n    var self = this;\n\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    if (!self.disabledb) {\n      self.dbProcessRecent = new PouchDB(\"DataProcessesRecent\"); // Recent process\n      self.dbProcessHierarchy = new PouchDB(\"DataProcessesHierarchy\"); // Process hierarchy to new cases creation\n      self.dbForms = new PouchDB(\"DataRenderForms\"); // To save all forms for server\n      self.dbCases = new PouchDB(\"DataRenderCases\"); // Save the data from forms            \n    }\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    BIZAGI_USER.toLowerCase() + \"-\" + BIZAGI_PROXY_PREFIX.toLowerCase() + \"-\" + BIZAGI_DOMAIN.toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  /*\r\n     * Delete all Documents (databases)\r\n     * Example for callback : function (err, info) { }\r\n     * \r\n     */\n  _destroy: function _destroy(callback) {\n    var self = this;\n    if (typeof callback === \"undefined\") {\n      callback = function callback(err, info) {\n      };\n    }\n\n    PouchDB.destroy(\"DataRenderForms\", callback);\n    PouchDB.destroy(\"DataRenderCases\", callback);\n    PouchDB.destroy(\"DataProcessesHierarchy\", callback);\n    PouchDB.destroy(\"DataProcessesRecent\", callback);\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n    return objects;\n  },\n\n  /*\r\n     *   This method return all the open cases for the user authenticated from de DB\r\n     *   Returns a promise\r\n     */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbCases.query({ map: map }, { reduce: false }, function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Name: Bizagi Database Plugin\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Author:Bizagi Mobile Team\r\n                                                                                                                                                                                                                                                                                                                                                                               *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   This script creates a plugin to handler all db functionalities\r\n                                                                                                                                                                                                                                                                                                                                                                               *   -   Pre-requisite pouchDB\r\n                                                                                                                                                                                                                                                                                                                                                                               */\n\n$.Class.extend(\"bizagi.workportal.services.fetchWorker.old\", {}, {\n  init: function init(params) {\n    var self = this;\n    self.services = params;\n\n    var queryString = bizagi.readQueryString();\n    self.disabledb = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n\n    if (!self.disabledb) {\n      self.dbForms = new PouchDB(\"DataRenderForms\");\n      self.dbCases = new PouchDB(\"DataRenderCases\");\n      self.dbProcessHierarchy = new PouchDB(\"DataProcessesHierarchy\");\n      self.dbProcessRecent = new PouchDB(\"DataProcessesRecent\");\n    }\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    BIZAGI_USER.toLowerCase() + \"-\" + BIZAGI_PROXY_PREFIX.toLowerCase() + \"-\" + BIZAGI_DOMAIN.toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  fetch: function fetch(argument) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (self.disabledb) {\n      def.reject(\"Disable Sync\");\n      return def.promise();\n    }\n\n    $.when(self.services.processesHierarchy()).\n    done(function (dataCategory, dataRecents) {\n      $.when(self.saveProcessesHierarchy(dataCategory),\n      self.processesHierarchyTofetchForms(),\n      self.services.getRecentOfflineProcesses()).\n      done(function (data1, data2, dataRecents) {\n        self.saveRecentProcesses(dataRecents);\n        def.resolve(\"All data fetched\");\n      }).fail(function (data1, data2, data3) {\n        if (data1 === \"nothing\") {\n          def.reject(0);\n        } else {\n          def.reject(\"Error fetching data\");\n        }\n      });\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save in the db the user permitions to create cases\r\n      * @returns {} \r\n      */\n  processesHierarchyTofetchForms: function processesHierarchyTofetchForms() {\n    var self = this;\n    var def = new $.Deferred();\n\n    var changeset = bizagi.util.getItemLocalStorage(\"formChangeset\" + self.globalId);\n    if (changeset === null || typeof changeset === \"undefined\") {\n      changeset = 0;\n    }\n\n    self.callSyncForms({\n      changeSet: changeset }).\n    done(function (data) {\n      console.log(data, \"Sync forms\");\n      def.resolve(data);\n    }).fail(function (error) {\n      if (error === \"nothing\") {\n        console.log(\"Nothing to sync\");\n      } else {\n        console.log(error, \"Error sync forms\");\n      }\n      def.reject(error);\n    });\n\n    return def.promise();\n  },\n\n  callSyncForms: function callSyncForms(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var changeSet = params.changeSet;\n\n    self.services.processesHierarchyTofetchForms(params).\n    done(function (data) {\n      if (data.changeSet > changeSet) {\n        // Add code to validate if form and save\n        var prom = null;\n        if (data.changeSetType === 1) // Form \n          prom = self.saveProcessesHierarchyTofetchForms(data.result);\n        if (data.changeSetType === 4) {// Grant acess\n          prom = self.saveProcessInHierarchy(data.result);\n        }\n\n        $.when(prom).done(function () {\n          self.callSyncForms({\n            changeSet: data.changeSet }).\n          done(function (resp) {\n            def.resolve(resp);\n          }).fail(function (error) {\n            def.reject(error);\n          });\n        }).fail(function (err) {\n          def.reject(err);\n        });\n      } else {\n        // Set the variable changeset in localStorage\n        bizagi.util.setItemLocalStorage(\"formChangeset\" + self.globalId, data.changeSet);\n        changeSet = parseInt(changeSet);\n        if (data.changeSet === 0 && changeSet === 0) {\n          // Nothing to sync                    \n          def.reject(\"nothing\");\n        } else {\n          def.resolve(\"succesfully\");\n        }\n      }\n    }).fail(function (error) {\n      def.reject(error);\n    });\n\n    return def.promise();\n  },\n\n  saveProcessInHierarchy: function saveProcessInHierarchy(data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    def.resolve(\"\");\n\n    return def.promise();\n  },\n\n  getHierarchyObjects: function getHierarchyObjects(obj, key, val) {\n    var self = this;\n    var objects = [];\n\n    for (var i in obj) {\n      if (!obj.hasOwnProperty(i)) continue;\n      if (_typeof(obj[i]) == \"object\") {\n        objects = objects.concat(self.getHierarchyObjects(obj[i], key, val));\n      } else if (i == key && obj[i] == val || i == key && val == '') {\n        objects.push(obj);\n      } else if (obj[i] == val && key == '') {\n        // Only add if the object is not already in the array\n        if (objects.lastIndexOf(obj) == -1) {\n          objects.push(obj);\n        }\n      }\n    }\n\n    return objects;\n  },\n\n  /**\r\n      * Save in the db the user Forms\r\n      * @param {} result \r\n      * @returns {} \r\n      */\n  saveProcessesHierarchyTofetchForms: function saveProcessesHierarchyTofetchForms(result) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var docHierarchy = {\n      _id: result.wfClass.toString() + \"-\" + result.wfClass.toString() + \"-\" + self.globalId,\n      globalid: self.globalId,\n      idWfClass: result.wfClass,\n      idWorkFlow: result.workFlow,\n      form: result.data.form };\n\n\n    self.dbForms.get(docHierarchy._id, function (err, doc) {\n      // If error, then the doc doesn't exists and it's added\n      if (err) {\n        // If it does not exist then add\n        self.dbForms.put(docHierarchy, function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not add the document\");\n          }\n        });\n      } else {\n        // If no error, then the doc exists and must be replaced if is outdated\n        self.dbForms.put({\n          _rev: doc._rev,\n          _id: doc._id,\n          form: docHierarchy.form },\n        function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not update the document\");\n          }\n        });\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save in the db the user permitions to create cases\r\n      * @param {} hierarchy \r\n      * @returns {} \r\n      */\n  saveProcessesHierarchy: function saveProcessesHierarchy(hierarchy) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var docHierarchy = {\n      _id: self.globalId,\n      doc: hierarchy };\n\n\n    // Try to search de doc\n    self.dbProcessHierarchy.get(docHierarchy._id, function (err, doc) {\n      // If error, then the doc doesn't exists and it's add\n      if (err) {\n        // If it does not exist then add\n        self.dbProcessHierarchy.put(docHierarchy, function callback(err, result) {\n          if (!err) {\n\n            def.resolve(result);\n          } else {\n\n            def.reject(\"Could not add the document\");\n          }\n        });\n      } else {\n        // If not error, then the doc exists and must be replaced if is outdated\n        self.dbProcessHierarchy.put({\n          _id: doc._id,\n          _rev: doc._rev,\n          doc: hierarchy },\n        function callback(err, result) {\n\n          if (!err) {\n\n            def.resolve(result);\n          } else {\n\n            def.reject(\"Could not update the document\");\n          }\n        });\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Save in the db the user recent processes to create cases\r\n      * @param {} processes \r\n      * @returns {} \r\n      */\n  saveRecentProcesses: function saveRecentProcesses(processes) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var docRecent = {\n      _id: self.globalId,\n      doc: processes };\n\n\n    self.dbProcessRecent.get(docRecent._id, function (err, doc) {\n      // If error, then the doc does not exists and it's added\n      if (err) {\n        // If it does not exist then add\n        self.dbProcessRecent.put(docRecent, function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not add the document\");\n          }\n        });\n      } else {\n        // If no error, then the doc exists and must be replaced if is outdated\n        self.dbProcessRecent.put({\n          _rev: doc._rev,\n          _id: doc._id,\n          doc: processes },\n        function callback(err, result) {\n          if (!err) {\n            def.resolve(result);\n          } else {\n            def.reject(\"Could not update the document\");\n          }\n        });\n      }\n    });\n\n    return def.promise();\n  } });","function _defineProperty(obj, key, value) {if (key in obj) {Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });} else {obj[key] = value;}return obj;} /*\r\n                                                                                                                                                                                                           *   Name: BizAgi Services WorkPortal End Points\r\n                                                                                                                                                                                                           *   Author: Diego Parra (based on Edward Morales version)\r\n                                                                                                                                                                                                           *   Comments:\r\n                                                                                                                                                                                                           *   -   This script defines all the end-points used to retrieve ajax stuff\r\n                                                                                                                                                                                                           *   -   All urls must be relative to the base application\r\n                                                                                                                                                                                                           */\n\n// Create or define namespace\nbizagi.workportal = typeof bizagi.workportal !== \"undefined\" ? bizagi.workportal : {};\nbizagi.workportal.services = typeof bizagi.workportal.services !== \"undefined\" ? bizagi.workportal.services : {};\nbizagi.workportal.services.endPoints = [];\n\n// Creates a endpoint hash factory to resolve custom requirements\nbizagi.workportal.services.getEndPoints = function (params) {\n  // Default workportal end-points\n  if (params.context == \"workportal\") {var _endPoints;\n    var endPoints = (_endPoints = {\n      \"user-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx\",\n      \"process-handler\": params.proxyPrefix + \"RestServices/ProcessHandler.ashx\",\n      \"query-handler\": params.proxyPrefix + \"Rest/Handlers/Query\",\n      \"case-handler\": params.proxyPrefix + \"RestServices/CaseHandler.ashx\",\n      \"query-form\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\n      \"query-form-edit\": params.proxyPrefix + \"App/ListaDetalle/SaveQuery.aspx\",\n      \"query-form-delete\": params.proxyPrefix + \"App/ListaDetalle/QueryForm.aspx\",\n      \"query-form-delete-cube\": params.proxyPrefix + \"Rest/Queries/Cubes/{idCube}\",\n      \"favorites-handler\": params.proxyPrefix + \"RestServices/FavoritesHandler.ashx\",\n      \"file-handler\": params.proxyPrefix + \"RestServices/EntityHandler.ashx\",\n      \"login-handler\": params.proxyPrefix + \"Rest/Users/UserAuthentication\",\n      \"login-handlerv10\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}\",\n      \"logoff-handler\": params.proxyPrefix + \"RestServices/UserHandler.ashx?action=logOff\",\n      \"logoff-handlerv1\": params.proxyPrefix + \"Rest/Users/LogOff\",\n\n      // Rest Services\n      \"authorization-handler-getMenuAuthorization\": params.proxyPrefix + \"Rest/Authorization/MenuAuthorization\",\n      \"authorization-handler-isCaseCreationAuthorized\": params.proxyPrefix + \"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized\",\n      \"case-handler-getCaseSummary\": params.proxyPrefix + \"Rest/Cases/{idCase}/Summary\",\n\n      //ReleaseActivityResponse\n      \"case-handler-releaseActivity\": params.proxyPrefix + \"Rest/Cases/{idCase}/ReleaseActivity\",\n\n      //mobile beta services\n      \"case-handler-getCasesList\": params.proxyPrefix + \"Rest/Processes/SearchCases\",\n      \"case-handler-getActivityList\": params.proxyPrefix + \"Api/Cases/Activities\",\n\n      // Services to Offline capability\n      \"offline-getProcessTree\": params.proxyPrefix + \"Rest/Processes/OfflineProcessTree\",\n\n      //\"offline-getForms\": params.proxyPrefix + \"Rest/Handlers/Render\",\n      \"offline-tasks\": params.proxyPrefix + \"Api/Cases/GetOfflineTasks\",\n      \"offline-getForms\": params.proxyPrefix + \"Rest/RenderForm/offlineForms\",\n      \"offline-sendForm\": params.proxyPrefix + \"Rest/Cases/SaveAsynchWorkItemOffLine\",\n\n      // StartProcess\n      \"case-handler-getCaseTasks\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks\",\n      \"case-handler-getCaseEvents\": params.proxyPrefix + \"Rest/Cases/{idCase}/Events\",\n      \"case-handler-getCaseSubprocesses\": params.proxyPrefix + \"Rest/Cases/{idCase}/Subprocesses\",\n      \"case-handler-getTaskAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees\",\n      \"case-handler-getCaseAssignees\": params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\",\n      \"case-handler-getWorkItems\": params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItems\",\n      \"case-handler-getAsynchExecutionState\": params.proxyPrefix + \"Rest/Cases/{idCase}/AsynchExecutionState\",\n      \"case-handler-addNewCase\": params.proxyPrefix + \"Rest/Cases\",\n      \"case-handler-startProcess\": params.proxyPrefix + \"Rest/Processes/StartProcess/{idProcess}\",\n      \"handler-execute-action-start\": params.proxyPrefix + \"Api/Cases/{processId}/Start\",\n      \"case-handler-supportedLogTypes\": params.proxyPrefix + \"Rest/Cases/SupportedLogsTypes\",\n      \"case-handler-getActivityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/ActivityLog\",\n      \"case-handler-getActivityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idWorkItemFrom}/ActivityDetailLog\",\n      \"case-handler-getEntityLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityLog\",\n      \"case-handler-getEntityDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/EntityDetailLog\",\n      \"case-handler-getUserLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/UserLog\",\n      \"case-handler-getUserDetailLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/{idUser}/UserDetailLog\",\n      \"case-handler-getAdminLog\": params.proxyPrefix + \"Rest/Cases/{idCase}/AdminLog\",\n      \"case-handler-getCaseFormsRenderVersion\": params.proxyPrefix + \"Rest/Cases/{idCase}/FormsRenderVersion\",\n      \"case-handler-validateHasStartForm\": params.proxyPrefix + \"Api/Processes/{processId}/StartContext\",\n\n      //Favorites Restful\n      \"favorites-handler-saveFavorite\": params.proxyPrefix + \"Rest/Favorites\",\n      \"favorites-handler-deleteFavorite\": params.proxyPrefix + \"Rest/Favorites/{guidFavorite}\",\n\n      //ICONS && IMAGES\n      \"process-getIcon\": params.proxyPrefix + \"Api/Processes/{processId}/Icon\",\n      \"collections-getIcon\": params.proxyPrefix + \"Api/CurrentUser/Collections/{collectionId}/Icon\",\n\n      //BAMAnalytics Restful\n      \"bamAnalytics-handler-getAnalisysQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/AnalisysQueries\",\n      \"bamAnalytics-handler-updateQuery\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/Ids/{idQuery}\",\n\n      //Inbox Restful\n      \"inbox-handler-getInboxSummary\": params.proxyPrefix + \"Rest/Inbox/Summary\",\n      \"inbox-handler-getFullInboxSummary\": params.proxyPrefix + \"Rest/Inbox/FullSummary\",\n\n      //Messages Restful\n      \"MessageHandler-NewComment\": params.proxyPrefix + \"Rest/Cases/Comments\",\n      \"MessageHandler-GetComments\": params.proxyPrefix + \"Rest/Cases/Comments\",\n      \"MessageHandler-SetCategoryToComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\n      \"MessageHandler-RemoveComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}\",\n      \"MessageHandler-ReplyComment\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies\",\n      \"MessageHandler-RemoveReply\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/Replies/{idReply}\",\n      \"MessageHandler-GetCategoryColors\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors\",\n      \"MessageHandler-RenameCategoryColor\": params.proxyPrefix + \"Rest/Cases/Comments/CategoryColors/{idColorCategory}\",\n      \"MessageHandler-CountNewComments\": params.proxyPrefix + \"Rest/Cases/Comments/{idComment}/NewComments/Count\",\n\n      //Processes Restful\n      \"process-handler-getAllProcesses\": params.proxyPrefix + \"Rest/Processes\",\n      \"process-handler-getFavourites\": params.proxyPrefix + \"Rest/Home/MyFavorites/Count\",\n      \"process-handler-getFavouriteCases\": params.proxyPrefix + \"Rest/Home/MyFavorites\",\n      \"process-handler-getCustomizedColumnsData\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsData\",\n      \"process-handler-getCategory\": params.proxyPrefix + \"Rest/Processes/Categories\",\n      \"process-handler-getRecentProcesses\": params.proxyPrefix + \"Rest/Processes/RecentProcesses\",\n      \"process-handler-getCustomizedColumnsDataInfo\": params.proxyPrefix + \"Rest/Processes/CustomizedColumnsDataInfo\",\n      \"process-handler-getOrganizations\": params.proxyPrefix + \"Rest/Profile/Organizations\",\n      \"process-handler-getOrganizationsByUser\": params.proxyPrefix + \"Rest/Profile/OrganizationsByUser\",\n\n      //SmartInbox\n      \"smartinbox-entity-values\": params.proxyPrefix + \"api/SmartInbox/Detail/EntityValues/{entityGuid}\",\n      \"smartinbox-getAllInbox\": params.proxyPrefix + \"api/SmartInbox/All\",\n      \"smartinbox-user-tasks\": params.proxyPrefix + \"api/SmartInbox/Detail/UserTasks/{smartInboxId}\",\n      \"smartinbox-user-tasks-process\": params.proxyPrefix + \"api/SmartInbox/Detail/UserTasks/ByProcess/{workflowId}\",\n\n      //workportal\n      \"process-handler-getMyStuff\": params.proxyPrefix + \"Api/CurrentUser/Collections\",\n      \"process-handler-getIdCasesOfProcessEntities\": params.proxyPrefix + \"Api/Entities/Cases\",\n      \"templates-handler-getCollectionData\": params.proxyPrefix + \"Api/Collection/{idFact}/Data\",\n      //\"data-navigation-handler\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Data/{surrogateKeyLeftEntity}\",\n      \"data-navigation-handler-collection\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}\",\n      \"data-navigation-handler-entity\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}\",\n      \"data-navigation-handler-entity-filters\": params.proxyPrefix + \"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}\",\n\n      //\"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/Entities/{guidLeftEntity}/Collection/{guidFact}/Actions\",\n      \"action-handler-getProcessAddAction\": params.proxyPrefix + \"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions\",\n\n      //My Searches\n      'my-search-getSearchLists': params.proxyPrefix + \"Api/CurrentUser/Searches\",\n      'my-search-getFilters': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Filters\",\n      'my-search-getFiltersData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/FilterData\",\n      'my-search-getData': params.proxyPrefix + \"Api/CurrentUser/Searches/{guidSearch}/Data\",\n\n      \"templates-handler-getVirtualCollectionData\": params.proxyPrefix + \"Api/Collection/{guidVirtualCollection}/VirtualData\",\n      \"templates-handler-getMultipleActions\": params.proxyPrefix + \"Rest/Entities/multipleInstancesActions\",\n\n      \"process-handler-getMapping\": params.proxyPrefix + \"Rest/Entities/Mapping\",\n      \"process-handler-getForm\": params.proxyPrefix + \"Rest/Handlers/Render\",\n      \"process-handler-startform\": params.proxyPrefix + \"Rest/Processes/HasStartForm\",\n      //\"process-handler-rule\": params.proxyPrefix + \"Rest/Action/Rule\",\n      \"process-handler-rule\": params.proxyPrefix + \"Api/Rules/{ruleId}/Execute\",\n      //\"process-action-execute\" : params.proxyPrefix + \"Api/Action/Execute\",\n      \"process-action-execute\": params.proxyPrefix + \"Api/Rules/{ruleId}/ExecuteMultiple\",\n      \"process-handler-getActivitiesData\": params.proxyPrefix + \"Api/Processes/CasesData/MyActivities\",\n      \"process-handler-getPendingsData\": params.proxyPrefix + \"Api/Processes/CasesData/MyPendings\",\n\n      //\"entities-handler-getActions\" : params.proxyPrefix + \"Rest/Entities/Actions\",\n      \"entities-handler-getActions\": params.proxyPrefix + \"Api/Entities/{guidEntity}/{surrogateKey}/actions\",\n      \"entities-handler-getUsersAndEvents\": params.proxyPrefix + \"Rest/Processes/CasesData/UsersAndEvents\",\n      \"entities-handler-getUsers\": params.proxyPrefix + \"Api/Cases/{caseId}/Users\",\n      \"entities-handler-getEvents\": params.proxyPrefix + \"Api/Cases/{caseId}/CurrentEvents\",\n      \"entities-handler-getUsersImages\": params.proxyPrefix + \"Rest/Users/UserPictures\",\n      \"entities-handler-getShotCuts\": params.proxyPrefix + \"Api/CurrentUser/Shortcuts\",\n\n      //Queries Restful\n      \"query-handler-getqueries\": params.proxyPrefix + \"Rest/Queries\",\n      \"query-handler-getQueryForm\": params.proxyPrefix + \"Rest/Handlers/Render\",\n\n      //Users Restful\n      \"user-handler-getCurrentUser\": params.proxyPrefix + \"Rest/Users/CurrentUser\",\n\n      // Old render integration, readonly\n      \"old-render\": params.proxyPrefix + \"App/ListaDetalle/Detalle.aspx\",\n\n      //Service locator for reports\n      \"Reports\": params.proxyPrefix + \"RestServices/BAMAnalyticsHandler.ashx\",\n      \"reports-handler-deleteQueries\": params.proxyPrefix + \"Rest/BAMAnalytics/Reports/{QueryId}\",\n\n      //Service locator for bizagi folders\n      \"folders-handler-getUserQueries\": params.proxyPrefix + \"Rest/SmartFolders\",\n      \"folders-associate-deleteSmartFolder\": params.proxyPrefix + \"Rest/SmartFolders/{idSmartFolder}\",\n      \"folders-handler\": params.proxyPrefix + \"RestServices/SmartFoldersHandler.ashx\",\n      \"folders-associate\": params.proxyPrefix + \"App/Ajax/AJAXGateway.aspx\",\n      \"smartfolders-integration\": params.proxyPrefix + \"App/WorkPortal/ConfigureFilteredFolder.aspx\",\n\n      //Service locator for menu\n      \"AlarmAdmin\": params.proxyPrefix + \"App/Admin/AlarmsAdmin.aspx\",\n      \"AnalyticsProcess\": params.proxyPrefix + \"App/Cockpit/AnalyticsProcess.aspx\",\n      \"AnalyticsSensor\": params.proxyPrefix + \"App/Cockpit/AnalyticsSensor.aspx\",\n      \"AnalyticsTask\": params.proxyPrefix + \"App/Cockpit/AnalyticsTask.aspx\",\n      \"AsynchronousWorkitemRetries\": params.proxyPrefix + \"App/Admin/AsynchDisabledWorkitems.aspx\",\n      \"AuthenticationLogQuery\": params.proxyPrefix + \"App/Admin/AuthLogQuery.aspx\",\n      \"BAMProcess\": params.proxyPrefix + \"App/Cockpit/BAMProcess.aspx\",\n      \"BAMTask\": params.proxyPrefix + \"App/Cockpit/BAMTask.aspx\",\n      \"BusinessPolicies\": params.proxyPrefix + \"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx\",\n      \"CaseAdmin\": params.proxyPrefix + \"App/Admin/CaseSearch.aspx\",\n      \"adminReassignCases\": \"CaseAdmin\", // Open workportal module called 'adminCases'\n      \"asyncECMUpload\": \"asyncECMUpload\", // Open workportal module called 'asyncECMUpload'\n      \"CasesMonitor\": params.proxyPrefix + \"App/Admin/CasesMonitor.aspx\",\n      \"Closed\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed\",\n      \"CurrentUser\": params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\n      \"EncryptionAdmin\": params.proxyPrefix + \"App/Admin/Encrypt.aspx\",\n      \"MobileUpdatesAdmin\": params.proxyPrefix + \"App/MobileUpdates/default.aspx\",\n      \"EntityAdmin\": params.proxyPrefix + \"App/Admin/Entity.aspx\",\n      \"LocationResources\": params.proxyPrefix + \"App/Admin/AdminLocResources.aspx\",\n      \"NewCase\": params.proxyPrefix + \"App/Radicar/application.aspx\",\n      \"Pending\": params.proxyPrefix + \"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running\",\n      \"Profiles\": params.proxyPrefix + \"App/Admin/ProfilesAdminSearch.aspx\",\n      \"Search\": params.proxyPrefix + \"App/ListaDetalle/Search.aspx\",\n      \"UserAdmin\": params.proxyPrefix + \"App/Admin/ListUsers.aspx\",\n      \"UserDefaultAssignation\": params.proxyPrefix + \"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1\",\n      \"UserPendingRequests\": params.proxyPrefix + \"App/Admin/UserPendingRequests.aspx\",\n      \"ListPreferences\": bizagi.UserPreferencesUrl !== \"\" ? params.proxyPrefix + bizagi.UserPreferencesUrl : params.proxyPrefix + \"App/Admin/CurrentUser.aspx\",\n      \"GRDimensionAdmin\": params.proxyPrefix + \"App/Cockpit/DimensionEdit.aspx\",\n      \"Licenses\": params.proxyPrefix + \"App/Admin/Licenses.aspx\",\n      \"AnalysisQueries\": params.proxyPrefix + \"App/Inicio/WPAnalysisQuery.aspx\",\n      \"DocumentTemplates\": params.proxyPrefix + \"App/Admin/AdminDocumentTemplates.aspx\",\n      \"ProcessAdmin\": params.proxyPrefix + \"App/Admin/AdminProcess.aspx\",\n      \"ResourceBAM\": params.proxyPrefix + \"App/Cockpit/BAMResourceMonitor.aspx\",\n      \"WorkPortalVersion\": params.proxyPrefix + \"Rest/Util/Version\",\n\n      // entities administration\n      \"entities-administration\": \"RestServices/EntityHandler.ashx\",\n\n      //Theme Rest Service Handler\n      \"theme-handler-getLogoImagePath\": params.proxyPrefix + \"Rest/Theme/LogoImage\",\n\n      // Logout Service, already implemented on java environment\n      \"logout\": params.proxyPrefix + \"Rest/Authentication/logout\",\n      \"logoutDotNet\": params.proxyPrefix + \"App/Inicio/LogOff.aspx\",\n      \"authenticationConfig\": params.proxyPrefix + \"Api/Authentication/BizagiConfig\",\n      \"logout-oauth2\": params.proxyPrefix + \"Api/Authentication/OAuth2/IdentityProvider/Server/Logout\",\n      \"FederateLogoffUrl\": params.proxyPrefix + \"Api/Authentication/FederateLogoffUrl\",\n      \"oauth2AuthenticationConfig\": params.proxyPrefix + \"Api/Authentication/OAuth2/OAuth2AuthenticationConfig\",\n\n      //Massive Activity Asigments\n      \"massive-activity-assignments-getOrganizationInfo\": params.proxyPrefix + \"Rest/Users/OrganizationInfo\",\n      \"massive-activity-assignments-getCasesByOrganization\": params.proxyPrefix + \"Rest/Queries/GetCasesByOrganization\",\n      \"massive-activity-assignments-reassignCases\": params.proxyPrefix + \"Rest/Cases/ReassignCases\",\n      \"massive-activity-assignments-searchUsers\": params.proxyPrefix + \"Rest/Users/\",\n\n      //Asynchronous ECM Upload\n      \"async-ecm-upload-baseService\": params.proxyPrefix + \"Rest/Handlers/Metadata\",\n\n      // Workportal\n      \"domains\": params.proxyPrefix + \"Rest/Authentication/Domains\",\n\n      // Theme Builder\n      //\"ThemeBuilder\": params.proxyPrefix + \"ThemeBuilder/index.html?language=\" + bizagi.localization.language,\n      \"getCurrentTheme\": params.proxyPrefix + \"Api/Theme/Current\",\n\n      //Frankenstein\n      \"admin-getAuthenticationLog\": params.proxyPrefix + \"Rest/Users/AuthLog\",\n      \"admin-getAuthenticationDomains\": params.proxyPrefix + \"Rest/Users/Domains\",\n      \"admin-getAuthenticationEventsTypes\": params.proxyPrefix + \"Rest/Users/EventTypes\",\n      \"admin-getAuthenticationEventSubTypes\": params.proxyPrefix + \"Rest/Users/EventSubTypes\",\n      \"admin-EncryptString\": params.proxyPrefix + \"Rest/Util/EncryptString\",\n      \"admin-UserPendingRequests\": params.proxyPrefix + \"Rest/Users/UserPendingRequests\",\n      \"admin-UserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UserAuthenticationInfo\",\n      \"admin-updateUserAuthenticationInfo\": params.proxyPrefix + \"Rest/Users/UpdateUserAuthenticationInfo\",\n      \"admin-generateRandomPassword\": params.proxyPrefix + \"Rest/Util/GenerateRandomPassword\",\n      \"admin-GenerateDataToSendByEmail\": params.proxyPrefix + \"Rest/Users/GenerateDataToSendByEmail\",\n      \"admin-sendEmail\": params.proxyPrefix + \"Rest/Util/SendEmail/\",\n      \"admin-getApplicationList\": params.proxyPrefix + \"Rest/Application\",\n      \"admin-getApplicationProcesses\": params.proxyPrefix + \"Rest/Application/{idApp}/Process\",\n      \"admin-getProcessVersion\": params.proxyPrefix + \"Rest/Processes/Version\",\n      \"admin-getProcessTasks\": params.proxyPrefix + \"Rest/Processes/Version/{version}/Tasks\",\n\n      //servicios alarmas\n      \"admin-getTaskAlarms\": params.proxyPrefix + \"Rest/Alarm/TaskAlarms\",\n      \"admin-getLapseMode\": params.proxyPrefix + \"Rest/Alarm/LapseMode\",\n      \"admin-getRecurrMode\": params.proxyPrefix + \"Rest/Alarm/RecurrMode\",\n      \"admin-getScheduleType\": params.proxyPrefix + \"Rest/Alarm/ScheduleType\",\n      \"admin-getBossList\": params.proxyPrefix + \"Rest/Alarm/Boss\",\n      \"admin-addAlarm\": params.proxyPrefix + \"Rest/Alarm\",\n      \"admin-editAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}\",\n      \"admin-deleteAlarm\": params.proxyPrefix + \"Rest/Alarm\",\n      \"admin-alarmRecipients\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient\",\n      \"admin-deleteAlarmRecipients\": params.proxyPrefix + \"Rest/Alarm/Recipient\",\n      \"admin-recipientToAlarm\": params.proxyPrefix + \"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}\",\n      \"admin-enableAlarm\": params.proxyPrefix + \"Rest/Alarm/Task/{idTask}/ToggleAlarm\",\n      \"admin-getCategoriesList\": params.proxyPrefix + \"Rest/Application/Category\",\n      \"admin-getCasesList\": params.proxyPrefix + \"Rest/Queries/SearchCases\",\n      \"admin-abortItems\": params.proxyPrefix + \"Rest/Cases/Abort\",\n      \"admin-reassignItems\": params.proxyPrefix + \"Rest/Cases/Reassign\",\n      \"admin-getDefaultAssignationUserToAllProcess\": params.proxyPrefix + \"Rest/Users/{serviceAction}/\",\n      \"admin-getDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\n      \"admin-setDefaultAssignationUserToProcess\": params.proxyPrefix + \"Rest/Users/Process/{process}/AssignationUser\",\n      \"admin-getProfilesTypes\": params.proxyPrefix + \"Rest/Profile/Types\",\n      \"admin-searchProfiles\": params.proxyPrefix + \"Rest/Profile\",\n      \"admin-getUsersByProfile\": params.proxyPrefix + \"Rest/Users/Profile/{type}/{id}\",\n      \"admin-removeUserFromProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\n      \"admin-addUserToProfile\": params.proxyPrefix + \"Rest/Profile/{type}/{id}/User/{idUser}/\",\n      \"admin-async-activities-get-activities\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities\",\n      \"admin-async-activities-get-retry-now\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/RetryNow\",\n      \"admin-async-activities-get-activities-by-task\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Activities/Task\",\n      \"admin-async-activities-enable-execution\": params.proxyPrefix + \"Rest/Cases/Asynchronous/Enable\",\n      \"admin-async-activities-enable-multiple\": params.proxyPrefix + \"Rest/Cases/Asynchronous/EnableMultiple\",\n      \"admin-async-activities-async-execution\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution\",\n      \"admin-async-activities-async-execution-log\": params.proxyPrefix + \"Rest/Cases/{idCase}/Workitem/{idworkItem}/AsynchExecutionLog\",\n      \"admin-Licenses\": params.proxyPrefix + \"Rest/Licenses\",\n      \"admin-GetDimensions\": params.proxyPrefix + \"Rest/Dimensions\",\n      \"admin-EditDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}\",\n      \"admin-CreateAdministrableDimension\": params.proxyPrefix + \"Rest/Dimensions/Administrable\",\n      \"admin-DeleteDimension\": params.proxyPrefix + \"Rest/Dimensions/{id}?isAdministrable={administrable}\",\n      \"admin-EntityPathChildNodesAction\": params.proxyPrefix + \"Rest/Dimensions/EntityChildNodes\",\n      \"admin-GetActiveWFClasses\": params.proxyPrefix + \"Rest/Dimensions/ActiveProcess\",\n      \"admin-document-templates-storeDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/StoreDocumentTemplates\",\n      \"admin-document-templates-restoreDocumentTemplates\": params.proxyPrefix + \"Rest/DocumentTemplates/RestoreDocumentTemplate\",\n      \"admin-document-templates-uploadDocumentTemplate\": params.proxyPrefix + \"Rest/DocumentTemplates/UploadDocumentTemplate\",\n      \"admin-processes-workflowClasses\": params.proxyPrefix + \"Rest/Processes/WorkflowClasses\",\n      \"admin-processes-tasksByWorkflow\": params.proxyPrefix + \"Rest/Processes/TasksByWorkflow\",\n      \"admin-processes-modifyProcessDuration\": params.proxyPrefix + \"Rest/Processes/{idWorkflow}/Duration/\",\n      \"admin-processes-modifyTaskDuration\": params.proxyPrefix + \"Rest/Processes/Task/{idTask}/Duration/\",\n      \"admin-language-resource\": params.proxyPrefix + \"Rest/Multilanguage/Resource\",\n      \"admin-language-languages\": params.proxyPrefix + \"Rest/Multilanguage/Languages\",\n      \"bam-resourcemonitor-myteam\": params.proxyPrefix + \"Rest/Reports/BAM/Resources/MyTeam\",\n      \"reports-analysisquery\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\n      \"reports-analysisquery-update\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\n      \"reports-analysisquery-delete\": params.proxyPrefix + \"Rest/Reports/AnalysisQueries\",\n      \"processviewer-processdefinition\": params.proxyPrefix + \"Rest/Reports/Components/ProcessDefinition\",\n      \"processviewer-processgraphicinfo\": params.proxyPrefix + \"Rest/Reports/Components/ProcessGraphicInfo\",\n\n      // Mobile Updates\n      \"mobile-getLastUpdate\": params.proxyPrefix + \"Rest/Util/mobileUpdates\",\n\n      //discussionCase\n      \"discussion-case\": params.proxyPrefix + \"Api/CaseResource/Discussion?globalParent={globalParent}\",\n      \"discussion-case-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/Discussion\",\n      \"get-users\": params.proxyPrefix + \"Rest/Users/UserPictures\",\n      \"new-discussion\": params.proxyPrefix + \"Api/CaseResource/Discussion\",\n      \"count-comments\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment/Count\",\n      \"comment-case\": params.proxyPrefix + \"Api/CaseResource/{idParent}/Comment\",\n      \"new-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\n      \"new-comment-attach\": params.proxyPrefix + \"Api/CaseResource/Attachment\",\n      \"get-list-files\": params.proxyPrefix + \"Api/CaseResource/File?globalParent={globalParent}\",\n      \"get-list-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File\",\n      \"project-resource-action\": params.proxyPrefix + \"Api/CaseResource/{typeResource}\",\n      \"thumbnail-file\": params.proxyPrefix + \"Api/CaseResource/File/Thumbnails?globalParent={globalParent}\",\n      \"get-attachment\": params.proxyPrefix + \"Api/CaseResource/Attachment/{idAttachment}\",\n      \"get-mobile-attachment\": params.proxyPrefix + \"Api/CaseResource/Mobile/Attachment/{idAttachment}\",\n\n      //Files and Attachments\n      \"project-files-upload\": params.proxyPrefix + \"Api/CaseResource/File\",\n      \"count-files\": params.proxyPrefix + \"Api/CaseResource/File/Count?globalParent={globalParent}\",\n      \"count-files-v1\": params.proxyPrefix + \"Api/CaseResource/{globalParent}/File/Count\",\n      \"remove-comment\": params.proxyPrefix + \"Api/CaseResource/Comment\",\n\n      //Mobile CaseSummary\n      \"time-schemas-effectiveduration\": params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\" }, _defineProperty(_endPoints, \"case-handler-getCaseAssignees\",\n    params.proxyPrefix + \"Rest/Cases/{idCase}/Assignees\"), _defineProperty(_endPoints,\n    \"project-users-get\", params.proxyPrefix + \"Rest/Users/UserPictures\"), _defineProperty(_endPoints,\n    \"case-summary-task-options\", params.proxyPrefix + \"Rest/Cases/WorkItems/{idWorkitem}/TaskOptions?idCase={idCase}\"), _defineProperty(_endPoints,\n\n    \"project-plan-get\", params.proxyPrefix + \"Api/Plans/{idPlan}\"), _defineProperty(_endPoints,\n    \"project-plan-activities\", params.proxyPrefix + \"Api/Plans/{idPlan}/Activities\"), _defineProperty(_endPoints,\n    \"project-plan-workitems\", params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItems\"), _defineProperty(_endPoints,\n    \"project-plan-transitions-get\", params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/Transitions\"), _defineProperty(_endPoints,\n    \"project-plan-activity-edit\", params.proxyPrefix + \"Api/Plans/{idPlan}/Activities/{id}\"), _defineProperty(_endPoints,\n    \"project-plan-get-by-parent\", params.proxyPrefix + \"Api/Plans?parentWorkItem={parentWorkItem}\"), _defineProperty(_endPoints,\n    \"project-plan-parent\", params.proxyPrefix + \"Api/Plans/{idPlan}/ParentCase\"), _defineProperty(_endPoints,\n    \"project-plan-update\", params.proxyPrefix + \"Api/Plans/{idPlan}\"), _defineProperty(_endPoints,\n    \"project-plan-execute\", params.proxyPrefix + \"Api/Plans/Execute\"), _defineProperty(_endPoints,\n    \"project-plan-close\", params.proxyPrefix + \"Api/Plans/Close\"), _defineProperty(_endPoints,\n    \"project-plan-delete\", params.proxyPrefix + \"Api/Plans/{idPlan}\"), _defineProperty(_endPoints,\n    \"project-plan-first-parent-plan\", params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlan\"), _defineProperty(_endPoints,\n\n\n    \"PreferencesWorkportalCurrentUser\", params.proxyPrefix + \"Api/Users/Data/WindowPreferences\"), _defineProperty(_endPoints,\n\n\n    \"diagnostics-sync-system-error\", params.proxyPrefix + \"api/ErrorLogs/Import\"), _endPoints);\n\n\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n\n      endPoints[\"user-handler-getCurrentUser\"] = params.proxyPrefix + \"Rest/Users/CurrentUserGuid\";\n      endPoints[\"get-users\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\n      endPoints[\"entities-handler-getUsersImages\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\n      endPoints[\"project-users-get\"] = params.proxyPrefix + \"Rest/Users/UserPicturesGuid\";\n\n      endPoints[\"entities-handler-getUsers\"] = params.proxyPrefix + \"Api/Cases/{caseId}/UsersGuid\";\n      //endPoints[\"case-handler-getWorkItems\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/WorkItemsGuid\";\n      endPoints[\"case-handler-getCaseSummary\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/SummaryGuid\";\n      endPoints[\"case-handler-getCaseAssignees\"] = params.proxyPrefix + \"Rest/Cases/{idCase}/AssigneesGuid\";\n\n      endPoints[\"discussion-case\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid?globalParent={globalParent}\";\n      //endPoints[\"discussion-case-v1\"] = params.proxyPrefix + \"Api/CaseResource/{globalParent}/DiscussionGuid\";\n      endPoints[\"new-discussion\"] = params.proxyPrefix + \"Api/CaseResource/DiscussionGuid\";\n\n      endPoints[\"comment-case\"] = params.proxyPrefix + \"Api/CaseResource/{idParent}/CommentGuid\";\n      endPoints[\"new-comment\"] = params.proxyPrefix + \"Api/CaseResource/CommentGuid\";\n\n      endPoints[\"project-files-upload\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid\";\n      endPoints[\"get-list-files\"] = params.proxyPrefix + \"Api/CaseResource/FileGuid?globalParent={globalParent}\";\n\n      //Mobile case summary\n      endPoints[\"time-schemas-effectiveduration\"] = params.proxyPrefix + \"Api/WorkingTimeSchema/EffectiveDurationGuid?idUser={idUser}&fromDate={fromDate}&toDate={toDate}\";\n      //Mobile plans\n      endPoints[\"project-plan-get\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\n      endPoints[\"project-plan-update\"] = params.proxyPrefix + \"Api/Plans/Guid/{idPlan}\";\n      endPoints[\"project-plan-activities\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid\";\n      endPoints[\"project-plan-workitems\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/WorkItemsGuid\";\n      endPoints[\"project-plan-first-parent-plan\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/FirstParentPlanGuid\";\n      endPoints[\"project-plan-activity-edit\"] = params.proxyPrefix + \"Api/Plans/{idPlan}/ActivitiesGuid/{id}\";\n\n    }\n\n    return endPoints;\n  }\n  return {};\n};","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra (based on Edward Morales version)\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to workportal REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\n$.Class.extend(\"bizagi.workportal.services.service\", {\n  // Statics\n  BA_CONTEXT_PARAMETER_PREFIX: \"h_\",\n  ENTITIES_QUERY_PAGE_SIZE: 10 },\n{\n  /*\r\n   *   Constructor\r\n   */\n  init: function init(params) {\n    var self = this;\n    params = _typeof(params) == \"object\" ? params : {};\n    params.context = !bizagi.util.isEmpty(params.context) ? params.context : \"workportal\";\n\n    params.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    params.proxyPrefix = this.normalizeUrl(params.proxyPrefix);\n    bizagi.RPproxyPrefix = params.proxyPrefix;\n\n\n    params.sharepointProxyPrefix = !bizagi.util.isEmpty(params.sharepointProxyPrefix) ? params.sharepointProxyPrefix : \"\";\n    params.sharepointProxyPrefix = this.normalizeUrl(params.sharepointProxyPrefix);\n\n    this.serviceLocator = new bizagi.workportal.services.context(params);\n\n    // Define default value of number of records to show\n    this.pageSize = 10;\n\n    this.deviceType = params.deviceType || (bizagi.util.isSmartphoneDevice() ? bizagi.deviceEnum.smartphone : bizagi.util.isTabletDevice() ? bizagi.deviceEnum.tablet : bizagi.deviceEnum.desktop);\n    this.deviceCode = bizagi.util.getDeviceCode();\n\n    // Get override for pageSize, use BIZAGI_INBOX_ROWS_PER_PAGE constant within config file\n    if (typeof BIZAGI_INBOX_ROWS_PER_PAGE !== \"undefined\") {\n      this.pageSize = $.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE) ? BIZAGI_INBOX_ROWS_PER_PAGE : this.pageSize;\n    }\n    this.activeForm = undefined;\n\n    this.configureGlobalHandlers();\n  },\n\n  /**\r\n      * This method will return the url defined as endPoint using the parameter 'endPoint' name\r\n      */\n  getUrl: function getUrl(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(params.endPoint);\n    return url;\n  },\n  /**\r\n      * This method will return the url normalized\r\n      */\n  normalizeUrl: function normalizeUrl(url) {\n    if (url !== \"\") {\n      if (url[url.length - 1] != \"/\") {\n        url = url.concat(\"/\");\n      }\n\n      if (url.indexOf(\"http://\") == -1 && url.indexOf(\"https://\") == -1) {\n        url = \"http://\" + url;\n      }\n    }\n    return url;\n  },\n\n  /**\r\n      * This service get all overrides keys within configuration project\r\n      *\r\n      * @return {json}\r\n      */\n  getOverrides: function getOverrides() {\n    var self = this;\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"overrides\") }).\n    pipe(function (overrides) {\n      overrides = overrides || {};\n\n      $.each(overrides, function (key, value) {\n        var valueUppercase = value.toUpperCase();\n        if (valueUppercase == \"TRUE\" || valueUppercase == \"FALSE\") {\n          overrides[key] = bizagi.util.parseBoolean(value);\n        }\n      });\n\n      return overrides;\n    });\n  },\n\n  /**\r\n      * This service get json of theme definition\r\n      *@return {json} theme definition\r\n      */\n  getCurrentTheme: function getCurrentTheme() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('getCurrentTheme');\n\n    return $.read(url);\n  },\n\n  /**\r\n      * This method will return the response of the user information login is correct\r\n      * this method is use for native smartphone\r\n      **/\n  authenticatedUser: function authenticatedUser(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl(\"login-handler\");\n\n    return $.read({\n      url: urlSend,\n      data: {\n        \"userName\": BIZAGI_USER,\n        \"password\": BIZAGI_PASSWORD,\n        \"domain\": BIZAGI_DOMAIN } }).\n\n    pipe(\n    function (response) {\n      return response;\n    },\n    function (data) {\n      urlSend = self.serviceLocator.getUrl('login-handlerv10');\n      urlSend = urlSend.replace('{0}', BIZAGI_USER || '');\n      urlSend = urlSend.replace('{1}', BIZAGI_PASSWORD || '');\n      urlSend = urlSend.replace('{2}', BIZAGI_DOMAIN || '');\n      return $.ajax({\n        url: urlSend,\n        type: 'GET',\n        dataType: 'json' });\n\n    });\n\n  },\n\n  /**\r\n      *\r\n      * this method is use for native smartphone\r\n      **/\n  logoutUser: function logoutUser(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl('logoff-handlerv1');\n    return $.read({\n      url: urlSend });\n\n  },\n  /*\r\n      *   Logoff the current user\r\n      */\n  logOffUser: function logOffUser(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl(\"logoff-handler\");\n    return $.read({\n      url: urlSend });\n\n  },\n  /*\r\n      *   Gets the current working user\r\n      */\n  getCurrentUser: function getCurrentUser(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"user-handler-getCurrentUser\"));\n  },\n  /*\r\n      *   Gets the inbox summary for the current logged user\r\n      *   Returns a promise of the data being retrieved\r\n      */\n  getInboxSummary: function getInboxSummary(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"inbox-handler-getInboxSummary\")).\n    pipe(function (response) {\n      // Extract inboxSummary property\n      return response[\"inboxSummary\"];\n    });\n  },\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getAllProcesses: function getAllProcesses(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl('process-handler-getAllProcesses');\n\n    if (params.taskState != undefined) {\n      data['taskState'] = params.taskState;\n    }\n\n    if (params.onlyFavorites != undefined && params.onlyFavorites != '') {\n      data['onlyFavorites'] = params.onlyFavorites;\n    }\n\n    if (params.myActivities != undefined && params.myActivities != \"\") {\n      data[\"myActivities\"] = params.myActivities;\n    }\n\n    if (params.myPendings != undefined && params.myPendings != \"\") {\n      data[\"myPendings\"] = params.myPendings;\n    }\n\n    if (params.smartfoldersParameters) {\n      url = url + '?' + params.smartfoldersParameters;\n    }\n\n    if (bizagi.isMobile()) {\n      data['mobileDevice'] = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      // !! (double Not) (bang bang) <-- For Boolean Type Casting http://jibbering.com/faq/notes/type-conversion/#tcBool\n      if (!!params.skipAggrupate) {\n        self.includeAllProcessesItem(response);\n        return response;\n      }\n\n      // Aggrupate workflows by categories\n      var responseData = {};\n      var categories = {};\n      var allProcesses = bizagi.localization.getResource('workportal-widget-inbox-all-processes');\n      var allCases = {\n        name: bizagi.localization.getResource('workportal-widget-inbox-all-cases'),\n        path: '',\n        category: allProcesses,\n        isFavorite: params.onlyFavorites || false,\n        guidFavorite: '',\n        idworkflow: '',\n        guidWFClass: '',\n        count: 0 };\n\n\n      // Create a default category\n      categories[allProcesses] = [];\n      categories[allProcesses].workflows = [];\n      categories[allProcesses].workflows.push(allCases);\n      if (response.workflows) {\n        $.each(response.workflows.workflow, function (i, workflow) {\n          // Creates the category if it doesn't exist\n          if (!categories[workflow.category]) {\n            categories[workflow.category] = [];\n            categories[workflow.category].workflows = [];\n          }\n\n          // Push the workflow\n          categories[workflow.category].workflows.push(workflow);\n\n          // Sum the cases count\n          //  if (bizagi.util.isEmpty(params.onlyFavorites) || params.onlyFavorites == false) {\n          allCases.count += Number(workflow.count);\n          // }\n        });\n      }\n\n      // Build result array once grouped\n      responseData.categories = [];\n      for (key in categories) {\n        responseData.categories.push({\n          name: key,\n          workflows: categories[key].workflows });\n\n      }\n\n      return responseData;\n    });\n  },\n\n  /**\r\n      * do request if the preferences have not been load, else resolve with preferences\r\n      */\n  getUserWorkportalPreferences: function getUserWorkportalPreferences() {\n    var self = this,\n    _defer = new $.Deferred(),\n    _thePreferencesAreSaved = self._userPreferences !== undefined,\n    _doRequest = function _doRequest() {\n      self.getPreferencesWorkportalCurrentUser().done(function (response) {\n        self._userPreferences = bizagi.util.tryCatch(\n        function () {return response.workportal;},\n        {});\n\n\n        // ::ALERT:: This code is from workportal user preferences page settings\n        bizagi.util.storeMobileFeatures({ userPreferences: self._userPreferences });\n\n        _defer.resolve(self._userPreferences);\n      }).fail(function (params) {\n        console.error(params);\n        _defer.resolve({});\n      });\n    };\n\n    _thePreferencesAreSaved ? _defer.resolve(self._userPreferences) : _doRequest();\n    return _defer;\n  },\n\n  /**\r\n      * return all preferences or the specific preference if is set\r\n      */\n  getUserPreferences: function getUserPreferences(preference) {\n    var self = this;\n\n    // Get mobile features from workportal\n    var mobFeatures = bizagi.util.getMobileFeatures();\n\n    // for read local information\n    var localStorage = mobFeatures ? mobFeatures : {};\n    var localStoragePreferences = localStorage.userPreferences ? localStorage.userPreferences : {};\n\n    // Set user preference for result\n    var userPreferences = self._userPreferences || localStoragePreferences;\n\n    // return object or property\n    return preference === undefined ? userPreferences : userPreferences[preference];\n  },\n\n  /**\r\n      * get last process inbox workflow\r\n      * @return {workflow} \r\n      */\n  getLastProcessInboxWorkflow: function getLastProcessInboxWorkflow() {\n    var self = this;\n    var defer = new $.Deferred();\n\n    // localstorage\n    var lastProcessInbox = bizagi.util.getLastProcessInboxProcessInfo();\n\n    if (bizagi.util.validateFeatureSupport(\"defaultInboxEnabled\") == false || bizagi.util.isMobileInboxByProcessSupported() == false) {\n      if (lastProcessInbox.idWorkflow != -1)\n      bizagi.util.setLastProcessInbox(lastProcessInbox.processInfoName, lastProcessInbox.idWorkflow);\n      defer.resolve(lastProcessInbox);\n    } else\n    {\n      // Last Open Inbox -> Default Open Inbox -> All processes\n      $.when(\n      self.getUserWorkportalPreferences(),\n      self.getAllProcesses({\n        taskState: \"all\",\n        onlyFavorites: false,\n        inputtray: \"inbox\",\n        skipAggrupate: true,\n        mobileDevice: true }),\n\n      self.getAllSmartInbox()).\n      then(function (userPreferences, processesData, smartinboxes) {\n        // Preferences result\n        var idWorkFlowResult = lastProcessInbox.idWorkflow,\n        smartInboxId = lastProcessInbox.smartInboxId,\n        _preferDefaultOpenInbox = parseInt(userPreferences.defaultOpenInboxWorkflowId),\n        _preferDefaultOpenSmartInbox = userPreferences.defaultOpenInboxSmartInboxId,\n        _hasPreferDefaultOpenInbox = _preferDefaultOpenInbox > 0,\n        _hasPreferDefaultOpenSmartInbox = !bizagi.util.isEmpty(_preferDefaultOpenSmartInbox);\n\n        // First way ask by last Open Inbox\n        if (idWorkFlowResult == -1 && _hasPreferDefaultOpenInbox && bizagi.util.isEmpty(smartInboxId)) {\n          idWorkFlowResult = _preferDefaultOpenInbox;\n          smartInboxId = null;\n        } else if (bizagi.util.isEmpty(smartInboxId) && _hasPreferDefaultOpenSmartInbox && idWorkFlowResult == -1) {\n          smartInboxId = _preferDefaultOpenSmartInbox;\n          idWorkFlowResult = -1;\n        }\n\n        if (processesData && processesData.workflows && idWorkFlowResult != -1)\n        {\n          // search processName by workflowId\n          var workflowFound = $.first(processesData.workflows.workflow, function (workflow) {return workflow.idworkflow == idWorkFlowResult;});\n          if (workflowFound) {\n            bizagi.util.setLastProcessInbox(workflowFound.name, idWorkFlowResult);\n          } else {\n            bizagi.util.setLastProcessInbox(null, -1);\n          }\n\n        } else if (smartinboxes && smartinboxes.length > 0 && !bizagi.util.isEmpty(smartInboxId)) {\n          // search smartinbox by id\n          var smartinboxFound = $.first(smartinboxes, function (smartinbox) {return smartinbox.id == smartInboxId;});\n          if (smartinboxFound) {\n            bizagi.util.setLastProcessInbox(smartinboxFound.name, -1, smartInboxId);\n          } else {\n            bizagi.util.setLastProcessInbox(null, -1);\n          }\n        }\n\n        // get info from local storage\n        defer.resolve(bizagi.util.getLastProcessInboxProcessInfo());\n\n      }).fail(function () {\n        defer.reject('Error in bizagi.workportal.services.service.getLastProcessInboxWorkflow');\n      });\n\n    }\n\n    return defer.promise();\n  },\n\n  /*\r\n      *   Return my favourites count\r\n      */\n  getFavourites: function getFavourites() {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getFavourites\");\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Return my favourites count\r\n      */\n  getMyStuff: function getMyStuff(params) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getMyStuff\");\n\n    if (typeof params.icon !== \"undefined\" && params.icon) {\n      data.icon = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data);\n  },\n  /*\r\n      *   Return my favourites cases\r\n      */\n  getFavouriteCases: function getFavouriteCases(params) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getFavouriteCases\");\n\n    data[\"pageSize\"] = params.pageSize || self.pageSize;\n    data[\"page\"] = params.page || 1;\n\n    if (bizagi.isMobile()) {\n      data[\"mobileDevice\"] = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Return all the available cases in bizagi and thinking for mobile response\r\n      */\n  getCasesList: function getCasesList(params) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\n\n    params = params || {};\n\n    data[\"pageSize\"] = params.pageSize || 10;\n    data[\"page\"] = params.page || 1;\n    data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\n    data[\"idWfClass\"] = params.idWfClass || \"-1\";\n\n    return $.read(url, data).\n    pipe(function (response) {\n      var elementToHtml = {\n        overdue: [],\n        today: [],\n        tomorrow: [],\n        upcoming: [],\n        page: response.page,\n        totalPages: response.totalPages };\n\n      var actualDate = new Date();\n      var actualMonth = actualDate.getMonth();\n      var actualDay = actualDate.getDate();\n      var actualYear = actualDate.getYear();\n      var lengthData = typeof response.elements !== \"undefined\" ? response.elements.length : 0;\n\n      for (var counter = 0; lengthData > counter; counter++) {\n        var tmpElement = response.elements[counter];\n        var tmpdate = new Date(tmpElement[3]);\n        var tmpDay = tmpdate.getDate();\n        var tmpMonth = tmpdate.getMonth();\n        var tmpYear = tmpdate.getYear();\n\n        if (actualDay > tmpDay || actualMonth > tmpMonth || actualYear > tmpYear) {\n          tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\n          elementToHtml.overdue.push(tmpElement);\n        } else {\n          if (actualDay == tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\n            elementToHtml.today.push(tmpElement);\n\n          } else if (actualDay + 1 == tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm\");\n            elementToHtml.tomorrow.push(tmpElement);\n\n          } else {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"dd MMM yyyy\");\n            elementToHtml.upcoming.push(tmpElement);\n          }\n        }\n      }\n      return elementToHtml;\n    });\n\n  },\n\n  /*\r\n      *   Return all the available cases in bizagi and thinking for mobile response\r\n      */\n  getCasesListBeta: function getCasesListBeta(params) {\n    var self = this;\n    return self.getMobileCasesList(params).then(function (response) {\n      return self.adapterDataOfActivitiesToTemplate(response);\n    });\n  },\n\n  getMobileCasesList: function getMobileCasesList(params) {\n    var self = this;\n    var data = {};\n\n    params = params || {};\n\n    //if server version is less than server version where the new service was implemented, then call last version of service\n    if (!bizagi.util.validateFeatureSupport(\"advancedSearch\")) {\n      var urlMobile = self.serviceLocator.getUrl(\"case-handler-getCasesList\");\n      if (typeof params.radNumber !== \"undefined\") {\n        data[\"radNumber\"] = params.radNumber;\n      }\n      data[\"pageSize\"] = params.pageSize || 10;\n      data[\"page\"] = params.page || 1;\n      data[\"numberOfFields\"] = params.numberOfFields || \"-1\"; //1;\n      data[\"idWfClass\"] = params.idWfClass || \"-1\";\n      return $.read(urlMobile, data);\n    } else\n    {\n      return $.when(self.getMobileActivities(params)).then(function (resp) {\n        var response = { elements: [], rows: [] };\n        var row,i = -1;\n        while (row = resp.rows[++i]) {\n          var tempElement = {},el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\", \"\", \"\"];\n          var field,j = -1;\n          while (field = resp.headers[++j]) {\n            tempElement[field.fieldName.toLowerCase()] = {\n              \"displayName\": field.displayName,\n              \"value\": row[j] };\n\n            self.serializeActivity(el, field.fieldName.toLowerCase(), tempElement[field.fieldName.toLowerCase()]);\n          }\n\n          if (resp.syncErrors) {\n            self.appendActivityElementSyncError(el, resp.syncErrors);\n            self.appendActivityRowsSyncError(tempElement, resp.syncErrors);\n          }\n\n          response.elements.push(el);\n          response.rows.push(tempElement);\n        }\n        return {\n          \"page\": resp.page || resp.currentPage,\n          \"totalPages\": resp.totalPages,\n          \"elements\": response.elements,\n          \"rows\": response.rows,\n          \"advanceSearch\": true };\n\n      });;\n    }\n  },\n\n  /**\r\n      * Calc some activity properties to map easier on template \r\n      * @param {Any} serverResponse \r\n      */\n  adapterDataOfActivitiesToTemplate: function adapterDataOfActivitiesToTemplate(response) {\n    var self = this;\n    var groupedData = {\n      elements: [],\n      page: response.page,\n      totalPages: response.totalPages,\n      advanceSearch: response.advanceSearch || false,\n      headers: response.headers,\n      rows: response.rows };\n\n\n    var actualDate = new Date();\n    var statusFunction = response.advanceSearch ? self.defineActivityStateByTaskState : self.defineActivityStateByDate;\n\n    for (var counter = 0; response.elements.length > counter; counter++) {\n      var tmpElement = response.elements[counter];\n      var status = {};\n\n      status = statusFunction(tmpElement[3], tmpElement.taskstate);\n\n      // Time to atRiskTimeDelta\n      if (tmpElement.length >= 10 && parseInt(tmpElement[11], 10) > 0) {\n        var tmpEndDate = new Date(tmpElement[3]);\n\n        if (actualDate.getTime() > tmpEndDate.getTime()) {\n          status.state = \"red\";\n        } else {\n          if (actualDate.getTime() > tmpEndDate.getTime() - parseInt(tmpElement[11], 10) * 60000) {\n            status.state = \"yellow\";\n          } else {\n            status.state = \"green\";\n          }\n        }\n      }\n\n      groupedData.elements.push($.extend({}, tmpElement, status, {\n        \"endDate\": tmpElement[3],\n        \"idworkitem\": tmpElement[1],\n        \"idwfclass\": !bizagi.util.validateFeatureSupport(\"advancedSearch\") ? tmpElement[7] : tmpElement[10] }));\n\n    }\n    return groupedData;\n  },\n\n  /**\r\n      * Return compatible object for Template binding \r\n      * @param {Any} serverResponse \r\n      */\n  adapterServerResponseTemplateBindingObject: function adapterServerResponseTemplateBindingObject(serverResponse) {\n    var self = this;\n    var response = { elements: [], rows: [] };\n    var row,i = -1;\n    while (row = serverResponse.rows[++i]) {\n      var tempElement = {},el = [\"\", \"\", \"\", \"\", \"\", \"\", [], \"\", \"\", \"\", \"\", \"\", \"\"];\n      var field,j = -1;\n\n      while (field = serverResponse.headers[++j]) {\n\n        tempElement[field.fieldName.toLowerCase()] = {\n          \"displayName\": field.displayName,\n          \"value\": row[j] };\n\n        self.serializeActivity(el, field.fieldName.toLowerCase(), tempElement[field.fieldName.toLowerCase()]);\n      }\n\n      if (serverResponse.syncErrors) {\n        self.appendActivityElementSyncError(el, serverResponse.syncErrors);\n        self.appendActivityRowsSyncError(tempElement, serverResponse.syncErrors);\n      }\n\n      response.elements.push(el);\n      response.rows.push(tempElement);\n    }\n    return {\n      \"page\": serverResponse.page || serverResponse.currentPage,\n      \"totalPages\": serverResponse.totalPages,\n      \"elements\": response.elements,\n      \"rows\": response.rows,\n      \"advanceSearch\": true,\n      \"headers\": serverResponse.headers };\n\n  },\n\n  /**\r\n      * Returns the activity status based on the end date and the risk\r\n      * @param {String} endDate ISO representation of a date\r\n      * @returns {{}}\r\n      */\n  defineActivityStateByDate: function defineActivityStateByDate(endDate) {\n    var status = {};\n\n    if (endDate) {\n      var activityDate = new Date(endDate);\n      var now = new Date();\n      var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      var second = 1000;\n      var minute = 60 * second;\n      var day = 24 * 60 * minute;\n\n      // Before today\n      if (activityDate.getTime() < today.getTime()) {\n        status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\", type: \"overdue\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n      }\n      // Today but before now\n      else if (activityDate.getTime() < now.getTime() + minute) {\n          status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"red\", type: \"today\", icon: \"overdue\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n        }\n        // Today but after now\n        else if (activityDate.getTime() < today.getTime() + day) {\n            status = { group: \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\"), state: \"yellow\", type: \"today\", icon: \"ontime\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n          }\n          // Tomorrow\n          else if (activityDate.getTime() < today.getTime() + 2 * day) {\n              status = { group: \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\"), state: \"green\", type: \"tomorrow\", icon: \"upcoming\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n            }\n            // After tomorrow\n            else {\n                status = { group: \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\"), state: \"green\", type: \"upcoming\", icon: \"upcoming\", shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n              }\n    } else {\n      status = { group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"), state: \"red\", type: \"overdue\", shortEndDate: \"--\", icon: \"overdue\" };\n    }\n\n    return status;\n  },\n\n  /**\r\n      * Returns the activity status based on the taskstate property\r\n      * @param {String} endDate ISO representation of a date\r\n      * @param {String} taskstate Color name\r\n      * @returns {{}}\r\n      */\n  defineActivityStateByTaskState: function defineActivityStateByTaskState(endDate, taskstate) {\n    var status = {\n      group: \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\"),\n      state: taskstate,\n      type: \"overdue\",\n      shortEndDate: \"--\",\n      icon: \"overdue\" };\n\n\n    if (endDate && taskstate) {\n      var activityDate = new Date(endDate);\n      var now = new Date();\n      var today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      var second = 1000;\n      var minute = 60 * second;\n      var day = 24 * 60 * minute;\n\n      status = {\n        group: \"\",\n        state: taskstate,\n        type: \"\",\n        icon: \"\",\n        shortEndDate: bizagi.util.dateFormatter.formatDate(new Date(endDate), bizagi.localization.getResource(\"dateFormat\") + ' | ' + bizagi.localization.getResource(\"timeFormat\")) };\n\n      // Before today\n      if (activityDate.getTime() < today.getTime()) {\n        status.group = \"1|\" + bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n        status.type = \"overdue\";\n      }\n      // Today\n      else if (activityDate.getTime() < today.getTime() + day) {\n          status.group = \"2|\" + bizagi.localization.getResource(\"workportal-taskfeed-today\");\n          status.type = \"today\";\n        }\n        // Tomorrow\n        else if (activityDate.getTime() < today.getTime() + 2 * day) {\n            status.group = \"3|\" + bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n            status.type = \"tomorrow\";\n          }\n          // After tomorrow\n          else {\n              status.group = \"4|\" + bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n              status.type = \"upcoming\";\n            }\n\n      switch (taskstate) {\n        case \"green\":\n          status.icon = \"upcoming\";\n          break;\n        case \"yellow\":\n          status.icon = \"ontime\";\n          break;\n        case \"red\":\n        default:\n          status.icon = \"overdue\";\n          break;}\n\n    }\n    return status;\n  },\n\n  serializeActivity: function serializeActivity(el, fieldName, element) {\n    switch (fieldName) {\n      case \"radnumber\":\n        el[6].push([element.displayName, element.value]);\n        el.radNumber = element.value;\n        break;\n      //Proceso\n      case \"wfclsdisplayname\":\n        el[4] = element.value != null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-activity-plan\");\n        break;\n      //Actividad\n      case \"currenttask\":\n        el[5] = element.value != null ? element.value.toString() : bizagi.localization.getResource(\"workportal-project-casedashboard-activity\");\n        break;\n      //Fecha creacin caso\n      case \"cascreationdate\":\n        el[12] = element.value;\n        break;\n      // Actividad vence en\n      case \"wiestimatedsolutiondate\":\n        el[3] = element.value;\n        break;\n      //Fecha Solucin caso\n      case \"cassolutiondate\":\n        //el[6] = [\"\"];\n        break;\n      // Id de caso\n      case \"idcase\":\n        el[0] = element.value;\n        break;\n      // idWorkItem\n      case \"idworkitem\":\n        el[1] = element.value.toString();\n        break;\n      //Fecha de entrada al estado\n      case \"wientrydate\":\n        //el[6] = [\"\"];\n        break;\n      case \"taskid\":\n        el[2] = element.value;\n        break;\n      case \"taskstate\":\n        el.taskstate = element.value ? (\"\" + element.value).toLowerCase() : \"\";\n        break;\n      //idWorkflow\"\n      case \"idwfclass\":\n        el[10] = el.idwfclass = element.value;\n        break;\n      //Is Favorite\n      case \"isfavorite\":\n        el[9] = element.value;\n        break;\n      case \"atrisktime\":\n        el[11] = element.value;\n        break;\n      case \"guidfavorite\":\n        el[8] = element.value;\n        break;\n      case \"isevent\":\n        el.isEvent = element.value;\n        break;\n      case \"datachangesetversion\":\n        el.dataChangeset = element.value;\n        break;\n      case \"creatorfullname\":\n        el.creatorFullName = element.value;\n        break;}\n\n  },\n\n  /**\r\n      * Assign the sync error to element passed by parameter\r\n      * @param {} element The array element that represent an activity\r\n      * @param {*} syncErrors The sync errors map\r\n      */\n  appendActivityElementSyncError: function appendActivityElementSyncError(element, syncErrors) {\n    var offlineId = element[0] + \"-\" + element[1];\n    var caseSyncError = syncErrors[offlineId];\n    if (caseSyncError) {\n      element.syncError = caseSyncError;\n      element.hasSyncError = true;\n    }\n  },\n\n  /**\r\n      * Assign the sync error to element passed by parameter\r\n      * @param {*} row The object that represent an activity\r\n      * @param {*} syncErrors The sync errors map\r\n      */\n  appendActivityRowsSyncError: function appendActivityRowsSyncError(row, syncErrors) {\n    var offlineId = row.idcase.value + \"-\" + row.idworkitem.value;\n    var caseSyncError = syncErrors[offlineId];\n    if (caseSyncError) {\n      row.syncerror = {\n        displayName: \"syncError\",\n        value: caseSyncError };\n\n      row.hassyncerror = {\n        displayName: \"hasSyncError\",\n        value: true };\n\n    }\n  },\n\n  /**\r\n      * Obtiene la lista de actividades para el usuario actual con filtros\r\n      * Version: 2, Llamado al servicio con todas las prestaciones de filtrado\r\n      */\n  getCurrentActivities: function getCurrentActivities(params) {\n    var self = this;\n    var data = {};\n    params = params || {};\n\n    data[\"page\"] = params.page || 1;\n    data[\"pageSize\"] = params.pageSize || 10;\n\n    if (typeof params.radNumber !== \"undefined\") {\n      data[\"radNumber\"] = params.radNumber;\n    }\n\n    var url = self.serviceLocator.getUrl('case-handler-getActivityList');\n    return $.read(url, data).then(function (resp) {\n      return self.processActivitiesResponse(resp);\n    });\n  },\n\n  processActivitiesResponse: function processActivitiesResponse(resp, highlight, process_filter) {\n    var self = this;\n    var row;\n    var i = -1;\n\n    resp.elements = [];\n    resp.processes = [];\n\n    while (row = resp.rows[++i]) {\n      var tempElement = {};\n      var field,j = -1;\n      while (field = resp.headers[++j]) {\n        tempElement[\"o_\" + field.fieldName.toLowerCase()] = { \"displayName\": field.displayName, \"value\": row[j] };\n        tempElement[field.fieldName.toLowerCase()] = row[j];\n      }\n      $.extend(tempElement, self.defineActivityStateByDate(tempElement[\"wiestimatedsolutiondate\"]), { highlightedNumber: self.highlightsString(tempElement[\"radnumber\"], highlight) });\n      resp.elements.push(tempElement);\n\n      var process = resp.processes.find(function (el) {\n        return el.processname == tempElement[\"wfclsdisplayname\"];\n      });\n\n      if (typeof process === \"undefined\") {\n        resp.processes.push({\n          processname: tempElement[\"wfclsdisplayname\"],\n          idwfclass: tempElement[\"idwfclass\"],\n          active: process_filter || false ? \"active\" : \"\" });\n\n      }\n    }\n    return resp;\n  },\n\n  highlightsString: function highlightsString(string, highlight) {\n    if (typeof string !== \"string\" || typeof highlight !== \"string\") {\n      return string;\n    }\n\n    var expresion = new RegExp(highlight, \"gi\");\n    return string.replace(expresion, function (match, offset) {\n      return \"<strong>\" + match + \"</strong>\";\n    });\n  },\n\n  getDiscussionCase: function getDiscussionCase(params) {\n    var self = this;\n    var data = data || {};\n    data['globalParent'] = params.globalParent;\n    var url = bizagi.util.validateFeatureSupport(\"discussionCase\") ? self.serviceLocator.getUrl('discussion-case') : self.serviceLocator.getUrl('discussion-case-v1');\n\n    return $.read({\n      url: url,\n      data: data,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  editDiscussion: function editDiscussion(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"new-discussion\");\n    return $.update({\n      url: url,\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getUsersDiscussion: function getUsersDiscussion(params) {\n    var self = this;\n    var data = data || {};\n    data[\"userIds\"] = params;\n    data[\"width\"] = 50;\n    data[\"height\"] = 50;\n    var url = self.serviceLocator.getUrl(\"get-users\");\n\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n      return $.ajax({\n        url: url,\n        data: data,\n        type: \"POST\",\n        dataType: \"json\" });\n\n    } else {\n      return $.read(url, data).\n      pipe(function (response) {\n        return response;\n      });\n    }\n  },\n\n  getEffectiveDuration: function getEffectiveDuration(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"time-schemas-effectiveduration\");\n\n    return $.read({\n      url: url,\n      data: data,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getUsersData: function getUsersData(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-users-get\");\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n      return $.ajax({\n        url: url,\n        data: data,\n        type: \"POST\",\n        dataType: \"json\" });\n\n    } else {\n      return $.read({\n        url: url,\n        data: data,\n        dataType: \"json\" });\n\n    }\n\n\n  },\n\n  getSummaryCaseTaskOptions: function getSummaryCaseTaskOptions(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"case-summary-task-options\");\n\n    params = params || {};\n\n    // Required params: idWorkitem\n    return $.read(url, {\n      idWorkitem: params.idWorkitem,\n      idCase: params.idCase });\n\n  },\n\n  createNewDiscussion: function createNewDiscussion(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"new-discussion\");\n\n    params = params || {};\n\n    return $.create({\n      url: url,\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  createNewComment: function createNewComment(params) {\n    var self = this;\n    params = params || {};\n    var data = params.data || {};\n    var url = self.serviceLocator.getUrl(\"new-comment\");\n\n    return $.create({\n      url: url.replace(\"{typeResource}\", \"Comment\"),\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * Update Project File\r\n      */\n  updateProjectFile: function updateProjectFile(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-files-upload\");\n\n    return $.update({\n      url: url,\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * Update Project File\r\n      */\n  createProjectFile: function createProjectFile(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-files-upload\");\n\n    return $.create({\n      url: url,\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * Count the files number\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getFilesCount: function getFilesCount(params) {\n    var self = this;\n    params = params || {};\n    var url = bizagi.util.validateFeatureSupport(\"filesCount\") ? self.serviceLocator.getUrl(\"count-files\") : self.serviceLocator.getUrl(\"count-files-v1\");\n\n    return $.read({\n      url: url,\n      data: params,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getCommentCase: function getCommentCase(data) {\n    var self = this;\n    data = data || {};\n\n    var url = self.serviceLocator.getUrl(\"comment-case\");\n\n    return $.read({\n      url: url,\n      data: data,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getCommentsByParent: function getCommentsByParent(params) {\n    var self = this;\n    params = params || {};\n    var url = self.serviceLocator.getUrl(\"count-comments\");\n\n    return $.read({\n      url: url,\n      data: params,\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getFilesList: function getFilesList(params) {\n    var self = this;\n    var url = bizagi.util.validateFeatureSupport(\"filesList\") ? self.serviceLocator.getUrl(\"get-list-files\") : self.serviceLocator.getUrl(\"get-list-files-v1\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  deleteFile: function deleteFile(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-resource-action\");\n    return $.destroy({\n      url: url.replace(\"{typeResource}\", \"Attachment\"),\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getFilesThumbnail: function getFilesThumbnail(data) {\n    var self = this;\n    data = data || {};\n    var url = self.serviceLocator.getUrl(\"thumbnail-file\");\n\n    return $.read({\n      url: url,\n      data: data,\n      dataType: \"json\",\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  getAttachment: function getAttachment(guidAttachment) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"get-attachment\");\n    url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\n    return url;\n  },\n\n  getMobileAttachment: function getMobileAttachment(guidAttachment) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"get-mobile-attachment\");\n    url = url.replace(\"{idAttachment}\", guidAttachment.idAttachment);\n    return url + \"?sessionId=\";\n  },\n\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getAllAdministrableEntities: function getAllAdministrableEntities(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data[\"action\"] = \"entitiesList\";\n    data[\"kind\"] = \"administrable\";\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"entities-administration\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" }).\n    pipe(function (data) {\n      var result = {\n        entities: [] };\n\n      $.each(data, function (i, item) {\n        result.entities.push(item);\n      });\n      return result;\n    });\n  },\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getEntitiesList: function getEntitiesList(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    params[\"action\"] = \"entitiesList\";\n    params[\"kind\"] = \"entitiesData\";\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"entities-administration\"),\n      data: params,\n      type: \"POST\",\n      dataType: \"json\" });\n\n  },\n  /*\r\n      *   Returns all the cases for the current user filtered by a workflow\r\n      */\n  getCasesByWorkflow: function getCasesByWorkflow(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsDataInfo');\n\n\n    // Required params\n    if (!bizagi.util.isEmpty(params.taskState))\n    data['taskState'] = params.taskState;\n    if (!bizagi.util.isEmpty(params.smartInboxId))\n    data['smartInboxGuid'] = params.smartInboxId;else\n    if (!bizagi.util.isEmpty(params.idWorkflow))\n    data['idWorkflow'] = params.idWorkflow;\n\n    // Special case to search all favorite cases for all processes\n    if (params.onlyFavorites == true) {\n      data['onlyFavorites'] = true;\n      data['taskState'] = 'all';\n    }\n\n    // Optional params\n    data['pageSize'] = params.pageSize || self.pageSize;\n    data['page'] = params.page || 1;\n\n    if (bizagi.isMobile()) {\n      data['mobileDevice'] = true;\n    }\n\n    if (params.smartfoldersParameters) {\n      var param = params.smartfoldersParameters.split('&');\n      $.each(param, function (k, v) {\n        var keyvalue = v.split('=');\n        data[keyvalue[0]] = keyvalue[1];\n      });\n    }\n\n    if (params.radnumber || params.radNumber) {\n      data['radNumber'] = params.radNumber ? params.radNumber : params.radnumber;\n    }\n\n    if ((params.idcase || params.idCase) && bizagi.util.isNumeric(params.idcase || params.idCase)) {\n      data['idCase'] = params.idCase ? params.idCase : params.idcase;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      $.each(response.cases.rows, function (key, value) {\n        var newFieldsValue = [];\n\n        //  Set id of case to radnumber\n        response.cases.rows[key]['radnumber'] = value.id;\n        $.each(value.fields, function (fieldsKey, fieldsValue) {\n          // when delete element from fields array, each function lose key value\n          if (fieldsValue != undefined) {\n            // Radnumber\n            try {\n              if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == 'true') {\n                response.cases.rows[key]['radnumber'] = fieldsValue.Value;\n                response.cases.rows[key]['casenumberdisplayname'] = fieldsValue.DisplayName;\n              } else if (fieldsValue.workitems != undefined) {\n                response.cases.rows[key]['workitems'] = fieldsValue.workitems;\n              } else {\n                newFieldsValue.push(fieldsValue);\n              }\n            } catch (e) {}\n          }\n        });\n\n        // Update Fields\n        response.cases.rows[key]['fields'] = newFieldsValue;\n      });\n      return response.cases;\n    });\n  },\n  /*\r\n      *   Returns the Organization List\r\n      */\n  getOrganizationsList: function getOrganizationsList() {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('process-handler-getOrganizations');\n    var data = {};\n    data['type'] = 12;\n    data['name'] = '';\n\n    return $.read(url, data);\n  },\n  getOrganizationsByUserList: function getOrganizationsByUserList() {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"process-handler-getOrganizationsByUser\");\n\n    return $.read(url, {});\n  },\n  /*\r\n      *   Returns the data for the inbox grid view\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"process-handler-getCustomizedColumnsData\");\n    data[\"pageSize\"] = params.pageSize || self.pageSize;\n    data[\"page\"] = params.page || 1;\n\n    // data for sort columns\n    data[\"orderFieldName\"] = params.orderFieldName || \"\";\n    data[\"orderType\"] = params.orderType || \"0\";\n    data[\"order\"] = params.order || \"\";\n\n    if (bizagi.isMobile()) {\n      data[\"mobileDevice\"] = true;\n    }\n\n    // Fixes stuff\n    // TODO: this must be fixed in the server\n    params.taskState = params.taskState || 'all';\n    if (params.taskState.toString().toLowerCase() === '')\n    params.taskState = 'all';\n    if (params.taskState.toString().toLowerCase() === 'red')\n    params.taskState = 'Red';\n    if (params.taskState.toString().toLowerCase() === 'yellow')\n    params.taskState = 'Yellow';\n    if (params.taskState.toString().toLowerCase() === 'green')\n    params.taskState = 'Green';\n\n    data.taskState = params.taskState;\n    // Required params\n    if (!bizagi.util.isEmpty(params.idWorkflow)) {\n      data['idWorkflow'] = params.idWorkflow;\n    }\n    if (!bizagi.util.isEmpty(params.idTask)) {\n      data['idTask'] = params.idTask;\n    }\n\n    if (!bizagi.util.isEmpty(params.radNumber)) {\n      data['radNumber'] = params.radNumber;\n    }\n\n    // Special case to search all favorite cases for all processes\n    if (params.onlyFavorites == true) {\n      data['onlyFavorites'] = true;\n      data['taskState'] = 'all';\n    }\n\n    if (params.smartfoldersParameters) {\n      var param = params.smartfoldersParameters.split('&');\n      $.each(param, function (k, v) {\n        var keyvalue = v.split('=');\n        data[keyvalue[0]] = keyvalue[1];\n      });\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data);\n  },\n\n  /*\r\n      *   Returns the data for the inbox grid view\r\n      */\n  getCustomizedColumnsDataBeta: function getCustomizedColumnsDataBeta(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    var url = self.serviceLocator.getUrl('process-handler-getCustomizedColumnsData');\n\n    data['pageSize'] = params.pageSize || self.pageSize;\n    data['page'] = params.page || 1;\n\n    // data for sort columns\n    data['orderFieldName'] = params.orderFieldName || '';\n    data['orderType'] = params.orderType || '0';\n    data['order'] = params.order || '';\n    data['mobileDevice'] = bizagi.isMobile() ? true : false;\n\n    // Fixes stuff\n    // TODO: this must be fixed in the server\n    params.taskState = params.taskState || 'all';\n    if (params.taskState.toString().toLowerCase() === '')\n    params.taskState = 'all';\n    if (params.taskState.toString().toLowerCase() === 'red')\n    params.taskState = 'Red';\n    if (params.taskState.toString().toLowerCase() === 'yellow')\n    params.taskState = 'Yellow';\n    if (params.taskState.toString().toLowerCase() === 'green')\n    params.taskState = 'Green';\n\n    data.taskState = params.taskState;\n    // Required params\n    if (!bizagi.util.isEmpty(params.idWorkflow)) {\n      data['idWorkflow'] = params.idWorkflow;\n    }\n    if (!bizagi.util.isEmpty(params.idTask)) {\n      data['idTask'] = params.idTask;\n    }\n\n    if (!bizagi.util.isEmpty(params.radNumber)) {\n      data['radNumber'] = params.radNumber;\n    }\n\n    // Special case to search all favorite cases for all processes\n    if (params.onlyFavorites == true) {\n      data['onlyFavorites'] = true;\n      data['taskState'] = 'all';\n    }\n\n    if (params.smartfoldersParameters) {\n      var param = params.smartfoldersParameters.split('&');\n      $.each(param, function (k, v) {\n        var keyvalue = v.split('=');\n        data[keyvalue[0]] = keyvalue[1];\n      });\n    }\n\n    // Call ajax and returns promise\n    //return $.read(url, data);\n    return $.read(url, data).\n    pipe(function (response) {\n\n      var groupedData = {\n        columnTitle: [],\n        lstIdCases: [],\n        elements: [],\n        page: response.page,\n        totalPages: response.totalPages };\n\n\n      var actualDate = new Date();\n      var actualMonth = actualDate.getMonth();\n      var actualDay = actualDate.getDate();\n      var actualYear = actualDate.getYear();\n\n      groupedData.columnTitle = response.cases.columnTitle;\n      groupedData.lstIdCases = response.cases.lstIdCases;\n      groupedData.page = response.cases.page;\n      groupedData.totalPages = response.cases.totalPages;\n\n      for (var counter = 0, length = response.cases.rows.length; counter < length; counter++) {\n        var tmpElement = response.cases.rows[counter];\n\n        var tmpdate = new Date(tmpElement.fields[3]);\n        var tmpDay = tmpdate.getDate();\n        var tmpMonth = tmpdate.getMonth();\n        var tmpYear = tmpdate.getYear();\n\n        if (actualDay > tmpDay || actualMonth > tmpMonth || actualYear > tmpYear) {\n          tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM'); // 'dd MMM hh:mm'\n          groupedData.elements.push($.extend({}, tmpElement, { 'group': 'overdue' }));\n\n        } else {\n          if (actualDay == tmpDay) {\n            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\n            groupedData.elements.push($.extend({}, tmpElement, { 'group': 'today' }));\n\n          } else if (actualDay + 1 == tmpDay) {\n            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'hh:mm');\n            groupedData.elements.push($.extend({}, tmpElement, { 'group': 'tomorrow' }));\n\n          } else {\n            tmpElement.fields[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement.fields[3]), 'dd MMM');\n            groupedData.elements.push($.extend({}, tmpElement, { 'group': 'upcoming' }));\n          }\n        }\n      }\n\n      // No data items\n      if (typeof groupedData.elements === 'undefined' || typeof groupedData.elements !== 'undefined' && groupedData.elements.length === 0) {\n        groupedData.elements.push({ noResults: true, message: bizagi.localization.getResource('workportal-menu-search-found-no-cases') });\n      }\n\n      return groupedData;\n    });\n  },\n  /*\r\n      *   Returns the available categories filtered by a parent category\r\n      *   If not parent category is sent, it will return the base categories\r\n      */\n  getCategories: function getCategories(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    // Required params\n    if (params.idCategory)\n    data['idCategory'] = params.idCategory;\n    if (params.idApp)\n    data['idApp'] = params.idApp;\n\n    if (bizagi.isMobile()) {\n      data['mobileDevice'] = true;\n    }\n\n\n    data['groupByApp'] = params.groupByApp || false;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('process-handler-getCategory'), data);\n  },\n  /*\r\n      *   Returns the recent process\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    params = params || {};\n    params.mobileDevice = bizagi.isMobile() || \"false\";\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('process-handler-getRecentProcesses'), params);\n  },\n\n  /*\r\n      *   Returns the summary for a case\r\n      */\n  getCaseSummary: function getCaseSummary(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getCaseSummary'),\n      data: {\n        idCase: params.idCase,\n        eventAsTasks: params.eventAsTasks || \"false\",\n        onlyUserWorkItems: params.onlyUserWorkItems || \"true\",\n        mobileDevice: bizagi.isMobile() || \"false\" },\n\n      serviceType: \"GETSUMMARY\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /*\r\n      *   Returns the assigness for a case (all users assigned to any task of this case)\r\n      */\n  getCaseAssignees: function getCaseAssignees(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(self.serviceLocator.getUrl('case-handler-getCaseAssignees'), {\n      idCase: params.idCase }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /*\r\n      *   Returns all the tasks belonging to a process, aditionally return if it has an active workitem or not\r\n      */\n  getCaseTasks: function getCaseTasks(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getCaseTasks'), {\n      idCase: params.idCase });\n\n\n  },\n  /*\r\n      *   Returns all the events available for a case\r\n      */\n  getCaseEvents: function getCaseEvents(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getCaseEvents'),\n      data: {\n        idCase: params.idCase },\n\n      serviceType: 'GETEVENTS' }).\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns all the available subprocesses for a case\r\n      */\n  getCaseSubprocesses: function getCaseSubprocesses(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getCaseSubprocesses'),\n      data: {\n        idCase: params.idCase },\n\n      serviceType: 'GETSUBPROCESSES' }).\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns forms render version for a case\r\n      */\n  getCaseFormsRenderVersion: function getCaseFormsRenderVersion(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getCaseFormsRenderVersion'), {\n      idCase: params.idCase });\n\n\n  },\n  /**\r\n      *  Get json from forms render version service\r\n      */\n  getCaseFormsRenderVersionDataContent: function getCaseFormsRenderVersionDataContent(options) {\n    var self = this;\n    var defer = new $.Deferred();\n\n    $.when(self.getCaseFormsRenderVersion(options)).\n    done(function (data) {\n      // return json content\n      defer.resolve(data);\n    });\n    return defer.promise();\n  },\n  /*\r\n      *   Returns all the assignees belonging to a workitem (case - task combination)\r\n      */\n  getTaskAssignees: function getTaskAssignees(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase, idTask\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getTaskAssignees'), {\n      idCase: params.idCase,\n      idTask: params.idTask });\n\n\n  },\n  /*\r\n      *   Returns the available workitems for a case (Routing service)\r\n      */\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    var data = {};\n\n    params = params || {};\n\n    data.idCase = params.idCase;\n    data.fromTask = params.fromTask;\n    data.fromWorkItemId = params.fromWorkItemId;\n    data.mobileDevice = bizagi.isMobile();\n\n    params.eventAsTasks ? data.eventAsTasks = params.eventAsTasks : \"\";\n\n    if (typeof params.onlyUserWorkItems !== \"undefined\") {\n      data.onlyUserWorkItems = params.onlyUserWorkItems;\n    }\n\n    // Required params: idCase\n    return $.read({\n      url: self.serviceLocator.getUrl('case-handler-getWorkItems'),\n      data: data,\n      serviceType: 'GETWORKITEMS' });\n\n  },\n  /*\r\n      *   Returns the available workitems for a case (Routing service)\r\n      */\n  getQueries: function getQueries(params) {\n    var self = this;\n\n    if (self.hashQueries && params.idElement) {\n      return self.hashQueries[params.idElement];\n    } else {\n      var defer = new $.Deferred();\n\n      // Call ajax and returns promise\n      $.read(self.serviceLocator.getUrl('query-handler-getqueries')).\n      done(function (response) {\n        self.hashQueries = {};\n        self.hashQueries[0] = {};\n\n        // Process the full response converting it into small entries inside a hashtable\n        self.processQueries(response.query);\n        defer.resolve(self.hashQueries['-1']);\n      });\n      return defer.promise();\n    }\n  },\n  /*\r\n      *   Creates a hash of queries to simulate each category request\r\n      */\n  processQueries: function processQueries(queries) {\n    var self = this;\n    $.each(queries, function (i, query) {\n      if (!self.hashQueries[query.idParent]) {\n        self.hashQueries[query.idParent] = [];\n      }\n      self.hashQueries[query.idParent].push(query);\n      if (query.nodes) {\n        self.processQueries(query.nodes);\n      } else {\n        query.nodes = {};\n      }\n    });\n  },\n  /*\r\n      *   Creates a new case in BizAgi\r\n      */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.create({\n      url: self.serviceLocator.getUrl('case-handler-addNewCase'),\n      data: {\n        idWfClass: params.idWfClass,\n        caseData: params.caseData ? JSON.stringify(params.caseData) : null,\n        idOrganization: params.idOrganization ? params.idOrganization : null },\n\n      serviceType: 'NEWCASE' });\n\n  },\n\n  /*\r\n      * La idea con este servicio es por ahora quitar el hatStartForm del servicio de Shortcuts y de acciones\r\n      * retorna si tiene forma de inicio y el guid de la entidad de proceso\r\n      */\n  validateHasStartForm: function validateHasStartForm(params) {\n    var self = this;\n    var data = {\n      processId: params.processId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"case-handler-validateHasStartForm\"),\n      data: data,\n      batchRequest: true });\n\n  },\n\n\n  /*\r\n      *   Start process in Bizagi\r\n      */\n  startProcess: function startProcess(params) {\n    var self = this;\n    params = params || {};\n\n    var data = {\n      idProcess: params.idProcess,\n      entityMapping: params.mapping ? JSON.stringify(params.mapping) : {} };\n\n\n    if (typeof params.idParentCase !== \"undefined\") {\n      data.idParentCase = params.idParentCase;\n    }\n\n    var defer = $.Deferred();\n\n    $.create({\n      url: self.serviceLocator.getUrl(\"case-handler-startProcess\"),\n      data: data,\n      serviceType: \"STARTPROCESS\" }).\n    fail(function (error) {\n      var response = $.parseJSON(error.responseText);\n      if (response.status === \"error\" && !bizagi.util.isVersionSupported()) {\n        var oldParams = {\n          idWfClass: params.idProcess || params.idWfClass,\n          idOrganization: params.idOrganization || null };\n\n\n        self.createNewCase(oldParams).\n        then(function (result) {\n          result.oldVersion = true;\n\n          defer.resolve(result);\n        }).fail(function (error) {\n          defer.reject(error);\n        });\n      } else {\n        defer.reject(error);\n      }\n    }).done(function (data) {\n      defer.resolve(data);\n    });\n\n    return defer.promise();\n  },\n\n  /*\r\n      *   Start process in BizAgi\r\n      */\n  actionCreateCase: function actionCreateCase(params) {\n    var self = this;\n    var data = {\n      processId: typeof params.idProcess !== \"undefined\" ? params.idProcess : params.guidProcess };\n\n    // When the proccess is a shortcut it does not have mapping and parentCaseId,\n    // but when the process is not a shortcut, it has a context, so it comes with mapping and parentCaseId\n    if (typeof params.parentCaseId !== \"undefined\") {\n      data.parentCaseId = params.parentCaseId;\n    }\n    if (typeof params.mapping !== \"undefined\") {\n      data.entityMapping = params.mapping ? JSON.stringify(params.mapping) : {};\n    }\n\n    return $.create({\n      url: self.serviceLocator.getUrl(\"handler-execute-action-start\"),\n      data: data,\n      serviceType: \"STARTPROCESS\" });\n\n  },\n\n  /**\r\n      * Get the first parent plan on not contextualizeds plans\r\n      * */\n  getFirstParentPlan: function getFirstParentPlan(data) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"project-plan-first-parent-plan\");\n    var defer = $.Deferred();\n    $.when($.read({\n      url: url,\n      data: data,\n      dataType: \"json\" })).\n    done(function (response) {\n      defer.resolve(response);\n    }).fail(function () {\n      defer.resolve(null);\n    });\n    return defer.promise();\n  },\n  /*\r\n      *   Search cases with radNumber\r\n      */\n  searchCases: function searchCases(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    data['h_action'] = 'SEARCHCASES';\n    data['onlyUserCases'] = false;\n    data['active'] = false;\n    data['page'] = params.page || 1;\n    if (params.radNumber)\n    data['radNumber'] = $.trim(params.radNumber);\n    data['pageSize'] = params.pageSize || self.pageSize;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('query-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Search cases with radNumber\r\n      */\n  queryCases: function queryCases(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    data.h_action = 'QUERYCASES';\n    data.onlyUserCases = params.onlyUserCases || false;\n    data.active = params.active && true;\n    data.page = params.page || 1;\n    if (params.radNumber)\n    data.radNumber = $.trim(params.radNumber);\n    data.pageSize = params.pageSize || self.pageSize;\n\n    data.filter = params.filter;\n    data.outputxpath = params.outputxpath;\n\n    // data for sort columns\n    data.orderFieldName = params.orderFieldName || '';\n    data.orderType = params.orderType == 'asc' || params.orderType == 1 ? 1 : 0;\n    data.order = params.order || '';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('query-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Search entities service\r\n      */\n  queryEntities: function queryEntities(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    data.h_action = 'QUERYENTITIES';\n    data.page = params.page || 1;\n    data.pageSize = self.Class.ENTITIES_QUERY_PAGE_SIZE;\n\n    // Query parameters\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + 'idEnt'] = params.idEntity;\n    data.filter = params.filter;\n    data.outputxpath = params.outputxpath;\n\n    // Data to sort columns\n    data.orderFieldName = params.orderFieldName || '';\n    data.orderType = params.orderType || '';\n    data.order = params.order || '';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('query-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *  Get Menu Authorization\r\n      */\n  getMenuAuthorization: function getMenuAuthorization() {\n    var self = this;\n\n    return $.read(\n    self.serviceLocator.getUrl('authorization-handler-getMenuAuthorization'));\n\n  },\n  /*\r\n      *  The user have permissions to excecute this Case\r\n      */\n  isCaseCreationAuthorized: function isCaseCreationAuthorized(params) {\n    var self = this;\n    var urlSend = self.serviceLocator.getUrl('authorization-handler-isCaseCreationAuthorized');\n    urlSend = urlSend.replace('{0}', params.idWfClass || '');\n\n    return $.read({\n      url: urlSend //,\n      //data: { 'idWfClass': params.idWfClass }\n      //data: { 'userName': BIZAGI_USER, 'password': BIZAGI_PASSWORD, 'domain': BIZAGI_DOMAIN }\n    });\n  },\n  /*\r\n      *   Returns the execution state of an async workitem\r\n      */\n  getAsynchExecutionState: function getAsynchExecutionState(params) {\n    var self = this;\n    var idAsynchWorkitem;\n    params = params || {};\n\n    if (params.idCase != -1) {\n      return $.read({\n        url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\n        data: {\n          idCase: params.idCase,\n          idAsynchWorkitem: params.idAsynchWorkitem },\n\n        serviceType: \"ASYNCHEXECUTION\" });\n\n    } else {\n      return $.read({\n        url: self.serviceLocator.getUrl(\"case-handler-getAsynchExecutionState\"),\n        data: {\n          idCase: params.idCase,\n          idAsynchWorkitem: params.idAsynchWorkitem },\n\n        serviceType: \"ASYNCHEXECUTION\" });\n\n    }\n  },\n\n  /*\r\n      *  Returns the supported log types\r\n      */\n  supportedLogTypes: function supportedLogTypes() {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('case-handler-supportedLogTypes'));\n  },\n  /*\r\n      *   Returns the Activity Log for a case\r\n      */\n  getActivityLog: function getActivityLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getActivityLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Activity Detail Log for a case\r\n      */\n  getActivityDetailLog: function getActivityDetailLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idWorkItemFrom\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getActivityDetailLog'), {\n      idCase: params.idCase,\n      idWorkItemFrom: params.idWorkItemFrom,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Entity Log for a case\r\n      */\n  getEntityLog: function getEntityLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getEntityLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Entity Detail Log for a case\r\n      */\n  getEntityDetailLog: function getEntityDetailLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getEntityDetailLog'), {\n      idCase: params.idCase,\n      idEntity: params.idEntity || -1,\n      userFullName: params.userFullName || '',\n      attribDisplayName: params.attribDisplayName || '',\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the User Log for a case\r\n      */\n  getUserLog: function getUserLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getUserLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the User Detail Log for a case\r\n      */\n  getUserDetailLog: function getUserDetailLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase , idUser\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getUserDetailLog'), {\n      idCase: params.idCase,\n      idUser: params.idUser,\n      entDisplayName: params.entDisplayName || '',\n      attribDisplayName: params.attribDisplayName || '',\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Returns the Admin Log for a case\r\n      */\n  getAdminLog: function getAdminLog(params) {\n    var self = this;\n\n    params = params || {};\n\n    // Required params: idCase\n    return $.read(\n    self.serviceLocator.getUrl('case-handler-getAdminLog'), {\n      idCase: params.idCase,\n      orden: params.sort || 0,\n      idActualPage: params.idActualPage || 1,\n      pageSize: params.pageSize || 10 }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Adds a New Favorite\r\n      */\n  addFavorite: function addFavorite(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n\n    return $.create(\n    self.serviceLocator.getUrl('favorites-handler-saveFavorite'), {\n      idObject: params.idObject,\n      favoriteType: params.favoriteType }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  /*\r\n      *   Favorites service\r\n      */\n  delFavorite: function delFavorite(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n\n    // Required params: guidFavorite\n    return $.destroy(\n    self.serviceLocator.getUrl('favorites-handler-deleteFavorite'), {\n      guidFavorite: params.idObject }).\n\n\n    pipe(function (response) {\n      return response;\n    });\n  },\n  // Data Transformations for Summary Widget\n  /*\r\n   * Render Assigness\r\n   */\n  summaryAssigness: function summaryAssigness(options) {\n    var self = this;\n    var def = new $.Deferred();\n    var idCase = options.idCase || \"\";\n\n    $.when(\n    self.getCaseAssignees({\n      idCase: idCase })).\n\n    done(function (baseAssignees) {\n\n      var assignees = baseAssignees.assignees || [];\n      var assigneesLength = assignees.length;\n      var assigneesFix = {\n        showAssignees: bizagi.override.showAssignees && assignees.length > 0 ? true : false,\n        assignees: {},\n        events: \"\",\n        activities: \"\" };\n\n\n      var assigneesEvents = \"\";\n      var assigneesActivities = \"\";\n      var assigneesEventsList = [];\n      var assigneesActivitiesList = [];\n\n      for (var i = 0; i < assigneesLength; i++) {\n        if (bizagi.util.parseBoolean(assignees[i].isEvent)) {\n          if (assigneesEventsList.indexOf(assignees[i].idUser) == -1) {\n            assigneesEventsList.push(assignees[i].idUser);\n            assigneesEvents += assignees[i].Name + \", \";\n          }\n        } else {\n          if (assigneesActivitiesList.indexOf(assignees[i].idUser) == -1) {\n            assigneesActivitiesList.push(assignees[i].idUser);\n            assigneesActivities += assignees[i].Name + \", \";\n          }\n        }\n      }\n      //join assignees to event and activities\n      assigneesFix.events = assigneesEvents.substring(0, assigneesEvents.length - 2);\n      assigneesFix.activities = assigneesActivities.substring(0, assigneesActivities.length - 2);\n\n\n      def.resolve(assigneesFix);\n    });\n\n    return def.promise();\n  },\n  /*\r\n      * Render Assigness\r\n      */\n  summarySubProcess: function summarySubProcess(options) {\n    var self = this;\n    var def = $.Deferred();\n    var idCase = options.idCase || '';\n\n    $.when(\n    self.getCaseSubprocesses({\n      idCase: idCase })).\n\n    done(function (subprocess) {\n      subprocess['showSubProcess'] = subprocess['subProcesses'].length >= 1 ? true : false;\n      subprocess['showSubProcesColumns'] = subprocess['CustFields'][0] !== undefined && subprocess['CustFields'][0][0].length >= 1 ? true : false;\n\n      // Prepare json for subprocess\n      if (subprocess['showSubProcesColumns']) {\n        subprocess['subProcPersonalized'] = {};\n        var len;\n        for (var n = 0; n < subprocess['CustFields'].length; n++) {\n          len = 0;\n          for (var i = 0; i < subprocess['subProcesses'].length; i++) {\n            if (subprocess['subProcesses'][i]['idCustData'] == n) {\n              subprocess['subProcPersonalized'][n] = subprocess['subProcPersonalized'][n] || {};\n              subprocess['subProcPersonalized'][n]['subProcesses'] = subprocess['subProcPersonalized'][n]['subProcesses'] || {};\n              subprocess['subProcPersonalized'][n]['subProcesses'][len++] = subprocess['subProcesses'][i];\n            }\n          }\n\n          if (subprocess[\"subProcesses\"][n][\"idCustData\"] != -1 && subprocess[\"subProcPersonalized\"][n] != undefined) {\n            subprocess[\"subProcPersonalized\"][n][\"CustFields\"] = subprocess[\"CustFields\"][n];\n            subprocess[\"subProcPersonalized\"][n][\"idCase\"] = subprocess[\"idCase\"];\n          }\n        }\n      }\n\n      def.resolve(subprocess);\n    });\n\n    return def.promise();\n  },\n  /*\r\n      * Render Case Events\r\n      */\n  summaryCaseEvents: function summaryCaseEvents(options) {\n    var self = this;\n    var def = $.Deferred();\n    var idCase = options.idCase || '';\n\n    $.when(\n    self.getCaseEvents({\n      idCase: idCase })).\n\n    done(function (events) {\n      events['showEvents'] = events['events'].length >= 1 ? true : false;\n      def.resolve(events);\n    }).fail(function (error) {\n      def.reject();\n    });\n\n    return def.promise();\n  },\n  /*\r\n      * Render Details\r\n      * @param idWorkitem\r\n      */\n  summaryCaseDetails: function summaryCaseDetails(options) {\n    var self = this;\n    var def = new $.Deferred();\n    var idWorkitem = options.idWorkitem || 0;\n\n    $.when(\n    self.getCaseSummaryDataContent(options)).\n    done(function (data) {\n      data.currentState = data.currentState || [];\n      var dataCurrentStateLength = data.currentState.length;\n      // Show or hide tabs\n      data.showEvents = data.countEvents >= 1 ? true : false;\n      data.showParentProcess = data.idParentCase >= 1 ? true : false;\n      data.parentProcess = {\n        \"displayName\": data.parentDisplayName,\n        \"idCase\": data.idParentCase };\n\n\n      //data.isOpen: if request have onlyUserWorkItems = true, so verify workitems of current user\n      //data.isClosed: if request have onlyUserWorkItems = false, not verify workitems of current user\n      data.isClosedForAllUsers = bizagi.util.parseBoolean(data.isClosed);\n      data.isClosed = bizagi.util.parseBoolean(data.isOpen) ? false : true;\n      data.showAssignees = bizagi.override.showAssignees && data.countAssigness > 0 ? true : false;\n      data.showSubProcess = data.countSubProcesses > 0 ? true : false;\n      data.showForm = bizagi.util.parseBoolean(data.hasGlobalForm) ? true : false;\n      data.allowsReassign = \"false\";\n\n      for (i = 0; i < dataCurrentStateLength; i++) {\n        if (data.currentState[i].idWorkItem == idWorkitem) {\n          data.allowsReassign = data.currentState[i].allowsReassign;\n        }\n      }\n\n      // edit original data, no show events in activities tab\n      var currentStateTypes = [];\n      var m = 0; // counter for new activities array\n      for (i = 0; i < dataCurrentStateLength; i++) {\n        if (!bizagi.util.parseBoolean(data.currentState[i].isEvent) && bizagi.util.parseBoolean(data.\n        currentState[i].assignToCurrentUser) && data.currentState[i].idWorkItem != idWorkitem) {\n          currentStateTypes[m++] = data.currentState[i];\n        }\n      }\n\n      data.currentStateTypes = currentStateTypes;\n      data.showActivities = currentStateTypes.length > 0 ? true : false;\n\n      def.resolve(data);\n    });\n\n    return def.promise();\n  },\n\n  releaseActivity: function releaseActivity(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"case-handler-releaseActivity\");\n    url = url.replace(\"{idCase}\", params.idCase);\n    var data = {};\n    // Define data\n    if (params) {\n      data[\"idCase\"] = params.idCase;\n      data[\"idWorkItem\"] = params.idWorkItem;\n    }\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      data: data,\n      type: \"POST\",\n      dataType: \"json\" });\n\n\n  },\n  /**\r\n      *\r\n      * Segment Activities for summary in render module\r\n      * @param options {data,idWorkItem}\r\n      */\n  summaryActivities: function summaryActivities(options) {\n    var activities = {};\n    var data = options['data'] || {};\n    var idWorkItem = idWorkItem || options['idWorkitem'] || 0;\n\n    try {\n      activities['showActivities'] = data['currentStateTypes'].length >= 1 ? true : false;\n      activities['currentState'] = data['currentStateTypes'];\n      activities['globalIdWorkitem'] = idWorkItem;\n      activities['creationDate'] = data['creationDate'];\n    } catch (e) {}\n\n    return activities;\n  },\n  /**\r\n      *  Get json from cases service\r\n      */\n  getCaseSummaryDataContent: function getCaseSummaryDataContent(options) {\n    var self = this;\n    var promise = new $.Deferred();\n\n    $.when(self.getCaseSummary(options)).\n    done(function (data) {\n      // Completes data\n      data.taskState = self.icoTaskState;\n      data.process = data.process ? data.process : \"\";\n\n      if (data.createdBy) {\n        data.createdByName = data.createdBy.Name;\n        data.createdByUserName = data.createdBy.userName;\n        data.caseDescription = data.caseDescription == \"\" ? \"\" : data.caseDescription;\n        data.processPath = data.processPath.replace(/\\//g, \" > \") + data.process;\n        data.showWorkOnIt = true;\n      }\n\n      // return json content\n      promise.resolve(data);\n    });\n\n    return promise.promise();\n  },\n  /**\r\n      * Definition service for bizagi smart folders\r\n      *\r\n      * @param id optional with filter purpose\r\n      */\n  getSmartFolders: function getSmartFolders(id) {\n    var self = this;\n    var data = {};\n\n    data.idFolder = id || '';\n    // Call read and returns promise\n    return $.read(self.serviceLocator.getUrl('folders-handler-getUserQueries'), data).pipe(function (response) {\n      if (id == -1 || id == '') {\n        return response;\n      } else {\n        return self.searchFolders(id, response) || [];\n      }\n    });\n  },\n  /**\r\n      * Delete smart folder\r\n      * @param options {idSmartFolder,idUser}\r\n      */\n  deleteSmartFolder: function deleteSmartFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = '6';\n    options = options || {};\n\n    data.idSmartFolder = options.idSmartFolder || '';\n    data.idUser = options.idUser || '';\n\n    return $.destroy(self.serviceLocator.getUrl('folders-associate-deleteSmartFolder'), data);\n  },\n  /**\r\n      * Definition service for bizagi folders\r\n      *\r\n      * @param id optional with filter purpose\r\n      */\n  getFolders: function getFolders(id) {\n    var self = this;\n    var data = {};\n\n    data.action = 'getUserFolder';\n    data.idFolder = id || '';\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      type: 'POST',\n      data: data,\n      dataType: 'json' }).\n    pipe(function (response) {\n      if (id == '') {\n        var folders = {\n          folders: [{\n            name: bizagi.localization.getResource('workportal-widget-folders'),\n            id: '-1',\n            idParent: 0,\n            childs: response }] };\n\n\n        return folders;\n      } else if (id == -1) {\n        return response;\n      } else {\n        return self.searchFolders(id, response) || [];\n      }\n    });\n  },\n  searchFolders: function searchFolders(idFolder, data) {\n    for (var i = 0; i < data.folders.length; i++) {\n      var value = data.folders[i];\n      if (value.id == idFolder) {\n        return data.folders[i]['childs'];\n        break;\n      }\n    }\n    return undefined;\n  },\n  getCasesByFolder: function getCasesByFolder(query) {\n    query = query || '';\n\n    return $.ajax({\n      cache: true,\n      url: 'RestServices/' + query,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  makeFolder: function makeFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = 'CreateUpdateFolder';\n    data.folderName = options.folderName || 'No Name';\n\n    // Make folder under subcategory\n    if (options.idParentFolder != undefined && options.idParentFolder > 1) {\n      data.idParentFolder = options.idParentFolder;\n    }\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  updateFolder: function updateFolder(options) {\n    var self = this;\n    var data = {};\n    options = options || {};\n\n    data.action = 'CreateUpdateFolder';\n    // Define idFolder\n    data.idFolder = options.idFolder || '';\n\n    // Update name\n    if (options.folderName) {\n      data.folderName = options.folderName;\n    }\n\n    // Update path\n    if (options.idParentFolder) {\n      data.idParentFolder = options.idParentFolder;\n    }\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Associate cases to folders\r\n      *\r\n      * @param options {idcase,idCustomFolder}\r\n      */\n  associateCaseToFolder: function associateCaseToFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = '4';\n    options = options || {};\n\n    data.idCase = options.idCase || '';\n    data.idCustomFolder = options.idCustomFolder;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-associate'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      * Dissasociate cases to folder\r\n      *\r\n      * @param options {idFolder, idCase}\r\n      */\n  dissasociateCaseFromFolder: function dissasociateCaseFromFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = 'DeleteCaseFromFolder';\n    options = options || {};\n\n    data.idFolder = options.idFolder;\n    data.idCase = options.idCase;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-handler'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Delete folder\r\n      * @param options {idCustomFolder}\r\n      */\n  deleteFolder: function deleteFolder(options) {\n    var self = this;\n    var data = {};\n\n    data.action = '5';\n    options = options || {};\n\n    data.idCustomFolder = options.idCustomFolder || '';\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('folders-associate'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Gets a file binary from the server\r\n      * @param options {fileId}\r\n      */\n  getFile: function getFile(options) {\n    var self = this;\n    var data = {};\n    var url = this.serviceLocator.getUrl('file-handler');\n    options = options || {};\n\n    data.action = 'getFileContent';\n    data.uploadId = options.uploadId || '';\n    data.entityId = options.entityId || '';\n    data.entityKey = options.entityKey || '';\n\n    return bizagi.services.ajax.pathToBase + url + '?' + jQuery.param(data);\n  },\n  /**\r\n      * Get Comments per case\r\n      * @param params {idCase=int&idColorCategory=int&pag=int&pagSize=int}\r\n      * @return json\r\n      */\n  getComments: function getComments(params) {\n    //params.idCase = params.idCase || 0;\n    var self = this;\n\n    params = params || {};\n\n    return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-GetComments')), {\n      idCase: params.idCase || '',\n      idColorCategory: typeof params.idColorCategory == 'number' ? params.idColorCategory : '',\n      pag: params.pag || 1,\n      pagSize: params.pagSize || 10 }).\n\n    pipe(function (result) {\n      var def = new $.Deferred();\n      var picture = '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';\n      if (!result.comments) {\n        result.comments = [];\n      } else {\n        // Add CategoryColor for each comment\n        $.each(result.comments, function (key, value) {\n          if (!result.comments[key].hasOwnProperty('CategoryColor')) {\n            result.comments[key]['CategoryColor'] = '';\n          }\n        });\n      }\n      if (!result.users) {\n        $.when(self.getCurrentUser()).\n        done(function (user) {\n          result.users = [];\n          result.users.push({\n            Id: user.idUser,\n            Name: user.user,\n            DisplayName: user.userName,\n            Picture: picture });\n\n        });\n      } else {\n        $.each(result.users, function (key, value) {\n          // Add picture to all users\n          result.users[key]['Picture'] = result.users[key]['Picture'] === '' ? picture : result.users[key]['Picture'];\n        });\n      }\n      def.resolve(result);\n      return def.promise();\n    });\n  },\n  /**\r\n      * This function allow create new comment into the activity\r\n      *\r\n      * @param options {idCase,comment}\r\n      * @return json\r\n      */\n  makeNewComment: function makeNewComment(options) {\n    var self = this;\n    var picture = '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';\n    return $.create(self.serviceLocator.getUrl('MessageHandler-NewComment'), {\n      idCase: options.idCase || '',\n      comment: options.comment.replace(/\\n/g, '<br>') || '' }).\n\n    pipe(function (result) {\n      if (result.comments) {\n        var comments = [result.comments];\n        $.each(comments, function (key, value) {\n          // Add CategoryColor for each comment\n          comments[key]['CategoryColor'] = '';\n        });\n        result.comments = comments;\n      }\n\n      if (result.users) {\n        var users = [result.users];\n        $.each(users, function (key, value) {\n          // Add picture to all users\n          users[key]['Picture'] = users[key]['Picture'] == '' ? picture : users[key]['Picture'];\n        });\n        result.users = users;\n      }\n\n      return result;\n    });\n  },\n  /**\r\n      * This function allow create new replies into the comment\r\n      *\r\n      * @param options {idCase=int&idComment=int&comment=string}\r\n      * @return json\r\n      */\n  makeNewReply: function makeNewReply(options) {\n    var self = this;\n    var picture = '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';\n\n    options = options || {};\n\n    return $.create(self.serviceLocator.getUrl('MessageHandler-ReplyComment'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '',\n      comment: options.comment.replace(/\\n/g, '<br>') || '' }).\n\n    pipe(function (result) {\n      if (result.comments) {\n        result.Replies = [result.comments];\n      }\n\n      if (result.users) {\n        var users = [result.users];\n        $.each(users, function (key, value) {\n          // Add picture to all users\n          users[key]['Picture'] = users[key]['Picture'] == '' ? picture : users[key]['Picture'];\n        });\n        result.users = users;\n      }\n\n      return result;\n    });\n  },\n  /**\r\n      * Remove one comment from the list in mobiles\r\n      *\r\n      * @param options {content:{guid:\"...\"},attachmentsToDelete:[\"...\", \"...\", ...]};\r\n      * @return json {action:true|false, message:'if error, explain why'}\r\n      */\n  removeMobileComment: function removeMobileComment(options) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('remove-comment');\n\n    options = options || {};\n\n    return $.destroy({\n      url: url,\n      data: JSON.stringify(options),\n      dataType: \"json\",\n      contentType: \"application/json\" }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      * Remove one comment from the list\r\n      *\r\n      * @param options {idCase=int&idComment=int}\r\n      * @return json {action:true|false, message:'if error, explain why'}\r\n      */\n  removeComment: function removeComment(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveComment'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '' });\n\n  },\n  /**\r\n      * Remove one replies from the list\r\n      *\r\n      * @param options {idCase=int&idComment=int&idReply=int}\r\n      * @return json {action:true|false, message:'if error, explain why'}\r\n      */\n  removeReply: function removeReply(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.destroy(self.serviceLocator.getUrl('MessageHandler-RemoveReply'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '',\n      idReply: options.idReply || '' });\n\n\n  },\n  /**\r\n      * Rename category\r\n      *\r\n      * @param options {idColorCategory=int&colorName=string}\r\n      * @return json\r\n      */\n  renameCommentCategory: function renameCommentCategory(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.update(self.serviceLocator.getUrl('MessageHandler-RenameCategoryColor'), {\n      idColorCategory: options.idColorCategory >= 0 ? options.idColorCategory : '',\n      colorName: options.colorName || '' });\n\n  },\n  /**\r\n      * @param options {idCase=int&idComment=int&idColorCategory={0-5}}\r\n      * return json\r\n      */\n  setCommentCategory: function setCommentCategory(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.update(self.serviceLocator.getUrl('MessageHandler-SetCategoryToComment'), {\n      idCase: options.idCase || '',\n      idComment: options.idComment || '',\n      idColorCategory: typeof options.idColorCategory == 'number' ? options.idColorCategory : '' });\n\n  },\n  /**\r\n      * @return json Definition of all categories of message\r\n      */\n  getCommentsCategories: function getCommentsCategories() {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('MessageHandler-GetCategoryColors')).\n    pipe(function (result) {\n      if (result.length > 1 && result[0]['categories']) {\n        return result[0];\n      } else {\n        return result;\n      }\n    });\n  },\n  /**\r\n      * This service can be define number of new comments based on idComment\r\n      * @param json  options {idCase=int, idLastComment=int}\r\n      * @return int\r\n      */\n  getNewComments: function getNewComments(options) {\n    var self = this;\n\n    options = options || {};\n\n    return $.read(encodeURI(self.serviceLocator.getUrl('MessageHandler-CountNewComments')), {\n      idCase: options.idCase || 0,\n      idComment: options.idComment || 0 });\n\n  },\n  /**\r\n      * Get all analisys queries\r\n      * @return json\r\n      */\n  getAnalisysQueries: function getAnalisysQueries() {\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('bamAnalytics-handler-getAnalisysQueries'));\n  },\n  /**\r\n      * Update name and comment\r\n      *\r\n      * @param options json {queryName,queryDescription,idQuery }\r\n      * @return json  {response:true}\r\n      */\n  updateQueries: function updateQueries(options) {\n    var self = this;\n\n    return $.update(self.serviceLocator.getUrl('bamAnalytics-handler-updateQuery'), {\n      idQuery: options.idQuery >= 0 ? options.idQuery : '',\n      queryName: options.queryName || '',\n      queryDescription: options.queryDescription || '' });\n\n  },\n  /**\r\n      * Delete query\r\n      *\r\n      * @param queryId integer\r\n      * @return json  {response:true}\r\n      */\n  deleteQueries: function deleteQueries(queryId) {\n    var self = this;\n    var data = {};\n\n    data.action = '1612';\n    data.QueryId = queryId || '';\n\n    return $.destroy(self.serviceLocator.getUrl('reports-handler-deleteQueries'), data);\n  },\n\n  /**\r\n      * Get bizagi configuration\r\n      * @param {Function}   type    callback function when the file load is succed\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getConfiguration: function getConfiguration() {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"authenticationConfig\");\n\n    return $.read(url);\n  },\n\n  /**\r\n      * Logout Service\r\n      */\n  logout: function logout() {\n    var self = this;\n    // Remove session storage of authentication data\n    sessionStorage.removeItem('bizagiAuthentication');\n\n    //Call to the restfull service for domain list\n    try {\n      var javaLogout = $.create(self.serviceLocator.getUrl('logout'));\n\n      $.when(javaLogout).done(function () {\n        location.reload();\n      }).fail(function () {\n        bizagi.log('Error logging out');\n      });\n    } catch (e) {}\n  },\n\n  /**\r\n      * Logout from different types of services\r\n      * This method can reload the page after calling the logout service required\r\n      */\n  logoutMobile: function logoutMobile() {\n    var self = this;\n    var logoutData = { sourceLogout: \"user\" };\n\n    // Remove session storage of authentication data\n    sessionStorage.removeItem(\"bizagiAuthentication\");\n\n    // Remove last process inbox\n    bizagi.util.removeLastProcessInbox();\n\n    // Hybrid will use normal system\n    if (bizagi.util.isCordovaSupported()) {\n      var url = self.serviceLocator.getUrl(\"logout\");\n      return $.create(url);\n    } else {\n      // Call to the restfull service for domain list\n      try {\n\n        $.when(self.getConfiguration()).done(function (data) {\n          if (data.redirectErrorPage) {\n            window.location.href = data.redirectErrorPage;\n            return;\n          }\n\n          var authenticationType = data.authenticationType;\n          switch (authenticationType) {\n            case \"Federate\":\n              var logOffURL = data.logOffURL;\n              var federationLogoutBindingProtocol = data.federationLogoutBindingProtocol;\n              var authenticationSubType = data.authenticationSubType;\n              if (authenticationSubType === 'WSFederated') {\n                $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\n                  location.href = logOffURL;\n                }).fail(function () {\n                  bizagi.log(\"Error logging out\");\n                }).always(function () {\n                  location.href = data.logOffURL;\n                });\n              } else\n              if (authenticationSubType === 'Saml') {\n                var param = {};\n                $.when($.read(self.serviceLocator.getUrl(\"FederateLogoffUrl\"), param)).done(function (res) {\n                  if (res.federateLogoffUrl) {\n                    logOffURL = res.federateLogoffUrl;\n                  }\n\n                  $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\n                    if (federationLogoutBindingProtocol === 'POST') {\n                      window.document.open('text/html');\n                      window.document.write(logOffURL);\n                      window.document.close();\n                    } else\n                    {\n                      window.location.href = logOffURL;\n                    }\n                  }).fail(function () {\n                    bizagi.log(\"Error logging out\");\n                  }).always(function () {\n                  });\n\n                }).fail(function () {\n                  bizagi.log(\"Error logging out\");\n                }).always(function () {\n                });\n              }\n              break;\n            case \"SAML\":\n              loader.nativeAjax(loader.getPathUrl(self.serviceLocator.getUrl(\"logout\"), logoutData),\n              function (response) {\n                var jsonResponse = JSON.parse(response.responseText);\n\n                if (jsonResponse.logout === true) {\n                  if (typeof jsonResponse.samlUrlRedirect != \"undefined\") {\n                    var url = decodeURI(jsonResponse.samlUrlRedirect);\n                    var iframe = document.createElement(\"iframe\");\n\n                    document.getElementsByTagName(\"body\")[0].appendChild(iframe);\n\n                    $(iframe).on(\"load\", function () {\n                      var iframeContent = bizagi.util.isIE8() ?\n                      $(this.contentWindow.document.body) :\n                      $(this.contentWindow.eval(\"document.body\"));\n                      var rawResponse = iframeContent.text();\n\n                      location.reload();\n                    });\n\n                    iframe.src = url;\n\n                  } else {\n                    location.reload();\n                  }\n                } else {\n                  bizagi.log(\"Error logging out\");\n                }\n              });\n              break;\n            case \"OAuth2\":\n              $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).done(function () {\n                $.when($.read(self.serviceLocator.getUrl(\"oauth2AuthenticationConfig\"))).\n                done(function (response) {\n                  if (response.logoutUrl && response.logoutUrl != \"\") {\n                    var logoutUrl = response.logoutUrl;\n                    var callbackUrl = response.homeUrl;\n\n                    logoutUrl = logoutUrl.replace(/post_logout_redirect_uri=[^&]*/,\n                    \"post_logout_redirect_uri=\" + callbackUrl);\n                    location.href = logoutUrl;\n                  } else {\n                    location.reload();\n                  }\n\n                }).fail(function () {\n                  bizagi.log(\"Error logging out\");\n                });\n              }).fail(function () {\n                bizagi.log(\"Error logging out\");\n              });\n              break;\n            default:\n              //Normal\n              $.when($.create(self.serviceLocator.getUrl(\"logout\"), logoutData)).\n              done(function () {\n                window.location = bizagi.services.ajax.loginPage;\n              }).fail(function () {\n                bizagi.log(\"Error logging out\");\n              });\n              break;}\n\n        }).fail(function (message) {\n          bizagi.log(message);\n        });\n      } catch (e) {\n        bizagi.log(e);\n      }\n    }\n  },\n\n  /**\r\n      * Services for Massive Activity Assignment\r\n      */\n\n  /*\r\n          * Obtain the organization info, such as roles, skills or locations. One of this options\r\n          * must be specified as a parameter\r\n          * @param object  {objectType=Roles|Skills|Locations}\r\n          * @return json\r\n          */\n  getOrganizationInfo: function getOrganizationInfo(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['objectType'] = params;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-getOrganizationInfo'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n      * @param object  {roles=(string),roles=(skills), locations=(string)}\r\n      * @return json\r\n      */\n  getCasesByOrganization: function getCasesByOrganization(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n\n    data['roles'] = params.roles ? '[' + params.roles.toString() + ']' : '[]';\n\n    data['skills'] = params.skills ? '[' + params.skills.toString() + ']' : '[]';\n\n    data['locations'] = params.locations ? '[' + params.locations.toString() + ']' : '[]';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-getCasesByOrganization'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Get Cases By Organization, using parameters suchs as roles, skills and locations\r\n      * @param object  {user=[array], roles=(string),roles=(skills), locations=(string)}\r\n      */\n  reassignCases: function reassignCases(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['users'] = params.user ? '[' + params.user.toString() + ']' : '[]';\n    data['roles'] = params.roles ? '[' + params.roles.toString() + ']' : '[]';\n    data['skills'] = params.skills ? '[' + params.skills.toString() + ']' : '[]';\n    data['locations'] = params.locations ? '[' + params.locations.toString() + ']' : '[]';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-reassignCases'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      * Search the users inside the Organization, using parameters suchs as userName, full name, domain, roles, skills and locations\r\n      * All parameters are optional\r\n      * @param object  {userName=(string), fullName=(string), domain=(string), roles=(string),roles=(skills), locations=(string)}\r\n      * @return json\r\n      */\n  searchUsers: function searchUsers(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['userName'] = params.userName || '';\n\n    data['fullName'] = params.fullName || '';\n\n    data['domain'] = params.domain || '';\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('massive-activity-assignments-searchUsers'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /**\r\n      * Get json with bizagi domains list\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  getDomainList: function getDomainList() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('domains');\n\n    return $.read(url);\n  },\n  /**\r\n      * Services for Asynchronous ECM Upload\r\n      */\n\n  /* Get the ECM Pending Scheduled Jobs\r\n          * @return {deferred} ajax object with JSON content\r\n          */\n  getEcmAllScheduledJobs: function getEcmAllScheduledJobs() {\n    var self = this;\n\n    // Define data\n    var data = {};\n    data['action'] = 'getEcmAllScheduledJobs';\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\n  },\n  /* Retries an especific ECM Pending Scheduled Job\r\n      * @param object  {jobId=(string)} //The id of the job wich is going to be retried\r\n      * @return {deferred} ajax object with JSON content\r\n      */\n  retryECMPendingScheduledJob: function retryECMPendingScheduledJob(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    data['action'] = 'retryECMPendingScheduledJob';\n    data['idJob'] = params;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('async-ecm-upload-baseService'), data);\n  },\n  /*\r\n      *   Returns the current workportal version\r\n      */\n  getWorkPortalVersion: function getWorkPortalVersion() {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('WorkPortalVersion'),\n      type: 'GET',\n      dataType: 'json' }).\n    always(function (data) {\n      // Compatibility with java version\n      data = data || {};\n\n      if (data.version == '') {\n        // Take the build version\n        data.version = bizagi.loader.productBuild || '';\n      }\n      return data;\n    });\n  },\n  /*\r\n      *   Returns the combo's data to authentication log depending of the params\r\n      */\n  getAuthenticationLogData: function getAuthenticationLogData(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n    var url = '';\n\n    if (params['dataType'] == 'domains') {\n      url = 'admin-getAuthenticationDomains';\n    } else if (params['dataType'] == 'events') {\n      url = 'admin-getAuthenticationEventsTypes';\n    } else {\n      url = 'admin-getAuthenticationEventSubTypes';\n    }\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(url),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Get the search result of authentication log\r\n      */\n  getAuthenticationLogResult: function getAuthenticationLogResult(params) {\n    var self = this;\n\n    // Define data\n    var data = {};\n\n    data['action'] = params.action;\n    data['domain'] = params.domain;\n    data['userName'] = params.userName;\n    data['dtFrom'] = params.dtFrom;\n    data['dtTo'] = params.dtTo;\n    data['eventSubType'] = params.eventSubType;\n    data['eventType'] = params.eventType;\n    data['pag'] = params.pag;\n    data['pagSize'] = params.pagSize;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-getAuthenticationLog'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n  /*\r\n      *   Return the password encrypted\r\n      */\n  encryptString: function encryptString(params) {\n    var self = this;\n\n    var data = {};\n\n    // Define data\n    params = params || {};\n\n    data.entry = params.entry;\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-EncryptString'),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return the users requests\r\n      */\n  userPendingRequests: function userPendingRequests(params) {\n    var self = this;\n    var data = {\n      pag: params.pag,\n      pagSize: params.pagSize };\n\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl(\"admin-UserPendingRequests\"), data);\n  },\n\n  /*\r\n      *   Return the User Authentication Info\r\n      */\n  userAuthenticationInfo: function userAuthenticationInfo(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('admin-UserAuthenticationInfo'), {\n      idUser: params.idUser });\n\n  },\n\n  /*\r\n      *   Return Update User Authentication Info\r\n      */\n  updateUserAuthenticationInfo: function updateUserAuthenticationInfo(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.create(self.serviceLocator.getUrl('admin-updateUserAuthenticationInfo'), {\n      idUser: params.idUser,\n      password: params.password,\n      enable: params.enable,\n      expired: params.expired,\n      locked: params.locked });\n\n  },\n\n  /*\r\n      *   Return generate Data To Send By Email\r\n      */\n  generateRandomPassword: function generateRandomPassword(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    params['action'] = 'generateRandomPassword';\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-generateRandomPassword'),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return generate Data To Send By Email\r\n      */\n  generateDataToSendByEmail: function generateDataToSendByEmail(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['action'] = 'GenerateDataToSendByEmail';\n    data['idUser'] = params.idUser;\n    data['password'] = params.password;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-GenerateDataToSendByEmail'),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n\n  },\n\n  /*\r\n      *   Return generate Send Mail\r\n      */\n  sendEmail: function sendEmail(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['action'] = 'sendEmail';\n    data['emailTo'] = params.emailTo;\n    data['subject'] = params.subject;\n    data['body'] = params.body;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-sendEmail'),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return Applications, Categories or processes list\r\n      */\n  getApplicationCategoriesList: function getApplicationCategoriesList(params) {\n    var self = this;\n    var data = {};\n    var url = '';\n\n    if (params.action == 'Applications') {\n      url = 'admin-getApplicationList';\n\n      // Call ajax and returns promise\n      return $.ajax({\n        url: self.serviceLocator.getUrl(url),\n        type: 'GET',\n        dataType: 'json' });\n\n    } else {\n      url = 'admin-getCategoriesList';\n      data.idApp = params.idApp;\n      data.idCategory = params.idCategory;\n      if (data.idCategory == '') {\n        data.idCategory = -1;\n      }\n\n      if (typeof params.filterStartEvent !== 'undefined') {\n        data.filterStartEvent = params.filterStartEvent;\n      }\n\n      // Call ajax and returns promise\n      return $.ajax({\n        url: self.serviceLocator.getUrl(url),\n        data: data,\n        type: 'GET',\n        dataType: 'json' });\n\n    }\n  },\n\n  /*\r\n      *   Return the list of all cases that matched the filters\r\n      */\n  getAdminCasesList: function getAdminCasesList(params) {\n    var self = this;\n    var data = params || {};\n\n    // Call ajax and returns promise\n    return $.ajax({\n      //eliminar esto con el servicio restfull\n      cache: true,\n      url: self.serviceLocator.getUrl('admin-getCasesList'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n\n  },\n\n  /*\r\n      *   Return the application's processes\r\n      */\n  getApplicationProcesses: function getApplicationProcesses(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getApplicationProcesses');\n\n    var data = {};\n\n    data['idApp'] = params['idApp'] ? params['idApp'] : -1;\n\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *   Return the application's processes\r\n      */\n  getProcessVersion: function getProcessVersion(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getProcessVersion');\n\n    var data = {};\n\n    data['idWfClass'] = params['idWFClass'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *   Return the the workflow's versions task\r\n      */\n  getProcessTasks: function getProcessTasks(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getProcessTasks');\n\n    var data = {};\n\n    data['idWfClass'] = params['idWFClass'];\n    data['version'] = params['version'] ? params['version'] : undefined;\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Retrieves the alarms from an specific task\r\n      */\n  getTaskAlarms: function getTaskAlarms(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getTaskAlarms');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Retrieves each kind of alarm lapse\r\n      */\n  getLapseMode: function getLapseMode() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getLapseMode');\n\n    return $.read(url);\n  },\n\n  /*\r\n      * Retrieves each kind of alarm recurrence\r\n      */\n  getRecurrMode: function getRecurrMode() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getRecurrMode');\n\n    return $.read(url);\n  },\n\n\n  /*\r\n      * Retrieves each kind of alarm recurrence\r\n      */\n  getScheduleType: function getScheduleType() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getScheduleType');\n\n    return $.read(url);\n  },\n\n  /*\r\n      *   Retrieves the boss list\r\n      */\n  getBossList: function getBossList(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-getBossList');\n    return $.read(url);\n  },\n\n  /**\r\n      *   Add a new alarm\r\n      */\n  addAlarm: function addAlarm(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-addAlarm');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n    data['idRecurrMode'] = params['idRecurrMode'];\n    data['idLapseMode'] = params['idLapseMode'];\n    data['scheduleType'] = params['scheduleType'];\n    data['alarmTime'] = params['alarmTime'];\n    data['alarmRecurrTime'] = params['alarmRecurrTime'];\n    data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\n\n    return $.update(url, data);\n    /*\r\n                                 return $.ajax({\r\n                                 url: self.serviceLocator.getUrl('admin-addAlarm'),\r\n                                 data: data,\r\n                                 type: 'PUT',\r\n                                 dataType: 'json'\r\n                                 });\r\n                                 */\n  },\n\n  /*\r\n      *   Edits an existin alarm\r\n      */\n  editAlarm: function editAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-editAlarm');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n    data['idAlarm'] = params['idAlarm'];\n    data['idRecurrMode'] = params['idRecurrMode'];\n    data['idLapseMode'] = params['idLapseMode'];\n    data['scheduleType'] = params['scheduleType'];\n    data['alarmTime'] = params['alarmTime'];\n    data['alarmRecurrTime'] = params['alarmRecurrTime'];\n    data['sendToCurrentAssignee'] = params['sendToCurrentAssignee'];\n\n\n    return $.update(url, data);\n\n\n  },\n\n  /*\r\n      *   Delete an alarm\r\n      */\n  deleteAlarm: function deleteAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-deleteAlarm');\n\n    var data = {};\n\n    data['idAlarm'] = params['idAlarm'];\n\n    return $.destroy(url, params);\n\n  },\n\n  /*\r\n      * Returns the Alarm Recipients\r\n      * @param param: idAlarm : the alarm id to get the related recipients\r\n      */\n  getAlarmRecipients: function getAlarmRecipients(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-alarmRecipients');\n\n    var data = {};\n\n    data['idAlarm'] = params['idAlarm'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Adds a new Alarm Recipient to the current alam\r\n      * @param param: idAlarm : the alarm id to get the related recipients\r\n      * @param param: idRecipient : the recipient id\r\n      */\n  addRecipientToAlarm: function addRecipientToAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-recipientToAlarm');\n\n    var data = {};\n\n    data['idAlarm'] = params['idAlarm'];\n    data['idRecipient'] = params['idRecipient'];\n\n    return $.update(url, data);\n\n\n  },\n\n  /*\r\n      * Delete/s the alarm recipient/s from the current task\r\n      * @param param: idRecipient : the recipient id/s who is going to be deleted\r\n      */\n  deleteRecipientsFromAlarm: function deleteRecipientsFromAlarm(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-deleteAlarmRecipients');\n\n    var data = {};\n\n    data['idRecipients'] = params['idRecipients'];\n\n    return $.destroy(url, data);\n  },\n\n  /*\r\n      * Send the action to toggle the alarms state: enable or disable\r\n      * @param param: idTask : the task id who is going to be actvidated/deactivaded his alarms\r\n      */\n  enableAlarm: function enableAlarm(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-enableAlarm');\n\n    var data = {};\n\n    data['idTask'] = params['idTask'];\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * Invalidate or Reassign a set of cases\r\n      */\n  abortReassignItems: function abortReassignItems(params) {\n    var self = this;\n    var data = params || {};\n    var url = params.action == 'abort' ? 'admin-abortItems' : 'admin-reassignItems';\n    // Call ajax and returns promise\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(url),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n  /*\r\n      * Services for Asynchronous Activities\r\n      */\n  asyncActivitiesServices: function asyncActivitiesServices(params) {\n    var self = this;\n    var data = params;\n    var url = '';\n    var type = 'GET';\n    if (params.action == 'getActivities') {\n      url = self.serviceLocator.getUrl('admin-async-activities-get-activities');\n    } else if (params.action == 'retryNow') {\n      type = 'POST';\n      url = self.serviceLocator.getUrl('admin-async-activities-get-retry-now');\n      url = url.replace('{idCase}', params.idCase);\n      url = url.replace('{idworkItem}', params.idWorkitem);\n      url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\n    } else if (params.action == 'getActivitiesByTask') {\n      url = self.serviceLocator.getUrl('admin-async-activities-get-activities-by-task');\n    } else if (params.action == 'enableExecution') {\n      type = 'POST';\n      url = self.serviceLocator.getUrl('admin-async-activities-enable-execution');\n    } else if (params.action == 'enableMultiple') {\n      url = self.serviceLocator.getUrl('admin-async-activities-enable-multiple');\n      type = 'POST';\n    } else if (params.action == 'asyncExecution') {\n      url = self.serviceLocator.getUrl('admin-async-activities-async-execution');\n    } else if (params.action == 'asyncExecutionLog') {\n      url = self.serviceLocator.getUrl('admin-async-activities-async-execution-log');\n      url = url.replace('{idCase}', params.idCase);\n      url = url.replace('{idworkItem}', params.idWorkItem);\n      url = url.replace(\"{idAsynchWorkitem}\", params.idAsynchWorkitem);\n    } else if (params.action == 'getAsyncExecution') {\n      url = self.serviceLocator.getUrl('admin-async-activities-async-get-current-execution-log');\n    }\n    // Call ajax and returns promise\n    var response = $.ajax({\n      url: url,\n      data: data,\n      type: type,\n      dataType: 'json' });\n\n\n    return response;\n  },\n\n  /*\r\n      *  Return generate Default Assignation To all Process\r\n      */\n  getDefaultAssignationUserToAllProcess: function getDefaultAssignationUserToAllProcess(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToAllProcess'), {\n      serviceAction: 'getDefaultAssignationUserToAllProcess' });\n\n  },\n\n  /*\r\n      *  Return generate Default Assignation To Process\r\n      */\n  getDefaultAssignationUserToProcess: function getDefaultAssignationUserToProcess(params) {\n    var self = this;\n    var process;\n    // Call ajax and returns promise\n    if (params.idWFClass == '') {\n      process = -1;\n    } else {\n      process = params.idWfClass;\n    }\n    return $.read(self.serviceLocator.getUrl('admin-getDefaultAssignationUserToProcess'), {\n      serviceAction: 'getDefaultAssignationUserToProcess',\n      process: process });\n\n\n  },\n\n  /*\r\n      * Return Assignation Process\r\n      */\n  setDefaultAssignationUserToProcess: function setDefaultAssignationUserToProcess(params) {\n    var self = this;\n    if (params.idWFClass == '') {\n      process = -1;\n    } else {\n      process = params.idWfClass;\n    }\n\n    // Call ajax and returns promise\n    return $.create(self.serviceLocator.getUrl('admin-setDefaultAssignationUserToProcess'), {\n      serviceAction: 'setDefaultAssignationUserToProcess',\n      process: process,\n      idUser: params.idUser });\n\n  },\n\n  /**\r\n      * Get the icon of a given process\r\n      * @param params\r\n      */\n  getProcessIcon: function getProcessIcon(params) {\n    var self = this;\n    var data = {\n      processId: params.processId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"process-getIcon\"),\n      data: data,\n      batchRequest: true });\n\n  },\n  /**\r\n      * Get the icon of a given collection\r\n      * @param params\r\n      */\n  getCollectionIcon: function getCollectionIcon(params) {\n    var self = this;\n    var data = {\n      collectionId: params.collectionId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"collections-getIcon\"),\n      data: data,\n      batchRequest: true });\n\n  },\n\n  /*\r\n      *   Returns the combo's data to Type Profiles depending of the params\r\n      */\n  getProfilesTypes: function getProfilesTypes(params) {\n    var self = this;\n\n    // Call ajax and returns promise\n    return $.read(self.serviceLocator.getUrl('admin-getProfilesTypes'));\n  },\n\n  /*\r\n      *  Return generate Search Profiles\r\n      */\n  searchProfiles: function searchProfiles(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-searchProfiles');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['name'] = params['profileName'];\n\n    data[\"orgId\"] = params[\"orgId\"] ? params[\"orgId\"] : null;\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *  Return Users By Profiles\r\n      */\n  getUsersByProfile: function getUsersByProfile(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-getUsersByProfile');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['id'] = params['idProfile'];\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      *  Remove User Profiles\r\n      */\n  removeUserFromProfile: function removeUserFromProfile(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-removeUserFromProfile');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['id'] = params['idProfile'];\n    data['idUser'] = params['idUser'];\n\n    return $.destroy(url, data);\n  },\n\n  /*\r\n      *  Add Users Profiles\r\n      */\n  addUserToProfile: function addUserToProfile(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl('admin-addUserToProfile');\n    var data = {};\n    data['type'] = params['profileType'];\n    data['id'] = params['idProfile'];\n    data['idUser'] = params['idUser'];\n\n    return $.update(url, data);\n  },\n  /*\r\n      *  Display Licenses\r\n      */\n  licenses: function licenses() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-Licenses');\n    return $.read(url);\n  },\n\n  /*\r\n      *   Return Dimensions List\r\n      */\n  getDimensions: function getDimensions() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-GetDimensions');\n    return $.read(url);\n  },\n\n  /*\r\n      *   Edit Dimensions\r\n      */\n  editDimension: function editDimension(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['id'] = params.id;\n    data['displayName'] = params.displayName;\n    data['name'] = params.name;\n    data['idWfClass'] = params.idWfClass;\n    data['entityPath'] = params.entityPath;\n    data['description'] = params.description;\n    var url = self.serviceLocator.getUrl('admin-EditDimension');\n    // Call ajax and returns promise\n    return $.create(url, data);\n    /*return $.ajax({\r\n                                 url: self.serviceLocator.getUrl('admin-EditDimension'),\r\n                                 data: params,\r\n                                 type: 'POST',\r\n                                 dataType: 'json'\r\n                                 });*/\n  },\n\n  /*\r\n      *   Create Dimensions\r\n      */\n  createAdministrableDimension: function createAdministrableDimension(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['displayName'] = params.displayName;\n    data['name'] = params.name;\n    data['idWfClass'] = params.idWfClass;\n    data['entityPath'] = params.entityPath;\n    data['Description'] = params.description;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-CreateAdministrableDimension'),\n      data: params,\n      type: 'PUT',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      * Delete manageable dimensions\r\n      */\n  deleteDimension: function deleteDimension(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-DeleteDimension');\n    // Define data\n    params = params || {};\n    var data = {};\n    data['id'] = params.id;\n    data['idDimension'] = params.id;\n    data['administrable'] = params.administrable;\n    // Call ajax and returns promise\n    return $.destroy(url, data);\n  },\n\n  /*\r\n      *   Dimensions Process Tree\r\n      */\n  entityPathChildNodesAction: function entityPathChildNodesAction(params) {\n    var self = this;\n\n    // Define data\n    params = params || {};\n    var data = {};\n    data['pathNodeType'] = params.nodeType;\n    data['idNode'] = params.idNode;\n    data['nodeDisplayPath'] = params.nodeDisplayPath;\n    data['nodePath'] = params.nodePath;\n    data['idWfClass'] = params.idWfClass;\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl('admin-EntityPathChildNodesAction'),\n      data: params,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Return list of available processes\r\n      */\n  getActiveWFClasses: function getActiveWFClasses(params) {\n    var self = this;\n    var data = params || {};\n\n    // Call ajax and returns promise\n\n    return $.ajax({\n      //eliminar esto con el servicio restfull\n      cache: true,\n      url: self.serviceLocator.getUrl('admin-GetActiveWFClasses'),\n      data: data,\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      *   Resturn the list of Stored Document Templates\r\n      */\n  storeDocumentTemplates: function storeDocumentTemplates() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-document-templates-storeDocumentTemplates');\n    return $.read(url);\n  },\n\n  /*\r\n      * Restore an selected document template using his Guid as parameter\r\n      * @param params {Object} Guid: the associated Guid from the desired document template\r\n      */\n  restoreDocumentTemplates: function restoreDocumentTemplates(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-document-templates-restoreDocumentTemplates');\n\n    url += '?Guid=' + params.Guid;\n\n    return $.read(url);\n  },\n\n  /*\r\n      * Retreieves the workflow from the actual processes\r\n      */\n  getWorkFlowClasses: function getWorkFlowClasses() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-workflowClasses');\n    return $.read(url);\n  },\n\n\n  /*\r\n      * Retreives the task from a desired workflow\r\n      * @param params {Object} idWorkFlow: the desired workflow id\r\n      */\n  getTaskByWorkFlow: function getTaskByWorkFlow(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-tasksByWorkflow');\n\n    var data = {};\n    data['idWorkflow'] = params.idWorkflow;\n\n\n    return $.read(url, data);\n  },\n\n  /*\r\n      * Modifies the process durationworkflow\r\n      * @param params {Object} idWorkflow: the desired process id to modify\r\n      * @param params {Object} duration: the duracion, converted in minutes\r\n      */\n  modifyProcessDuration: function modifyProcessDuration(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-modifyProcessDuration');\n\n    var data = {};\n    data['idWorkflow'] = params.idWorkflow;\n    data['duration'] = params.duration;\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * Modifies the task duration form a desired workflow\r\n      * @param params {Object} idTask: the desired task id to modifie\r\n      * @param params {Object} duration: the duracion, converted in minutes\r\n      */\n  modifyTaskDuration: function modifyTaskDuration(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-processes-modifyTaskDuration');\n\n    var data = {};\n    data['idTask'] = params.idTask;\n    data['duration'] = params.duration;\n\n    return $.create(url, data);\n  },\n\n  /*\r\n      * this retrive data for the report my team\r\n      */\n  getDataForMyTeam: function getDataForMyTeam() {\n\n    var self = this;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('bam-resourcemonitor-myteam'),\n      type: 'GET',\n      dataType: 'json' });\n\n  },\n\n  /*\r\n      * Retrive data for reports\r\n      */\n  getReporstAnalysisQuery: function getReporstAnalysisQuery() {\n\n    var self = this;\n\n    return $.read(self.serviceLocator.getUrl('reports-analysisquery'));\n  },\n\n  /*\r\n      * Update report data\r\n      */\n  updateReportData: function updateReportData(params) {\n\n    var self = this;\n\n    return $.update(self.serviceLocator.getUrl('reports-analysisquery-update'), params);\n  },\n\n  /*\r\n      * Delete report data\r\n      */\n  deleteReportData: function deleteReportData(params) {\n\n    var self = this;\n\n    return $.destroy(self.serviceLocator.getUrl('reports-analysisquery-delete') + '?' + params);\n  },\n  /*\r\n      *Entrega la lista de idiomas soportados\r\n      */\n  getStoreLanguageTemplates: function getStoreLanguageTemplates() {\n    var self = this;\n    var url = self.serviceLocator.getUrl('admin-language-languages');\n    var data = { justActives: false };\n    return $.read(url, data);\n  },\n\n  /*\r\n      *Download template language list\r\n      */\n  getLanguageTemplate: function getLanguageTemplate(params) {\n    var self = this;\n    var defer = $.Deferred();\n    var url = self.serviceLocator.getUrl('admin-language-resource') + '?cultureName=' + params.cultureName;\n    defer.resolve('OK');\n    window.location.href = url;\n    /*\r\n                                 var response=  $.ajax({\r\n                                 type: 'GET',\r\n                                 url: url\r\n                                 });\r\n                                 response.always(function(response, status, xhr) {\r\n                                 if(response.responseText.indexOf('error') >= 0){\r\n                                 defer.reject('Download error');\r\n                                 }else{\r\n                                 defer.resolve('OK');\r\n                                 window.location.href=url;\r\n                                 }\r\n                                 });*/\n    return defer.promise();\n  },\n  /*\r\n      * Process definition service for process viewer\r\n      */\n  processDefinition: function processDefinition(params) {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl('processviewer-processdefinition'), params);\n  },\n\n  /*\r\n      * Graphic info for process viewer\r\n      */\n  graphicInfo: function graphicInfo(params) {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl('processviewer-processgraphicinfo'), params);\n  },\n\n  /**\r\n      * This service get the last version of BizagiBPM\r\n      *\r\n      * @return {json}\r\n      */\n  getLastUpdateByMobile: function getLastUpdateByMobile() {\n    var self = this;\n    return $.read({\n      url: self.serviceLocator.getUrl(\"mobile-getLastUpdate\") });\n\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getCollectionData: function getCollectionData(params) {\n    var self = this,\n    data = {},\n    url = self.serviceLocator.getUrl('templates-handler-getCollectionData');\n\n    data.idFact = params.idFact;\n    data.pag = params.page || 1;\n    data.pagSize = params.pageSize || 10;\n    data.filters = params.filters ? !Array.isArray(params.filters) ? JSON.stringify(params.filters) : undefined : undefined;\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getVirtualCollectionData: function getVirtualCollectionData(params) {\n    var self = this,\n    data = {},\n    url = self.serviceLocator.getUrl('templates-handler-getVirtualCollectionData');\n\n    data.guidVirtualCollection = params.guidVirtualCollection;\n    data.pag = params.page || 1;\n    data.pagSize = params.pageSize || 10;\n    data.filters = params.filters ? !Array.isArray(params.filters) ? JSON.stringify(params.filters) : undefined : undefined;\n\n    // Call ajax and returns promise\n    return $.read(url, data).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getSearchData: function getSearchData(params) {\n    var self = this;\n    // Call ajax and returns promise\n    var urlSend = self.serviceLocator.getUrl(\"my-search-getData\");\n    urlSend = urlSend.replace(\"{guidSearch}\", params.guidSearch);\n    var filters = params.filters || [];\n\n    var data = {\n      filters: JSON.stringify(filters),\n      pag: params.page || 1,\n      calculateFilters: params.calculateFilters || false,\n      pagSize: params.pageSize || 10 };\n\n    return $.read(urlSend, data).then(function (data) {\n      return self.serializeEntityData(data);\n    });\n  },\n\n  /**\r\n      * Return an array with the collections or entity related to stakeholder entities\r\n      * @param params\r\n      */\n  getCollectionEntityData: function getCollectionEntityData(params) {\n    var self = this,url;\n    params = params || {};\n    var data = {\n      templateType: params.referenceType === \"VIRTUAL\" || params.referenceType === \"FACT\" ? \"List\" : \"Content\",\n      surrogateKey: params.surrogateKey,\n      pag: params.page || 1,\n      pagSize: params.pageSize || 10,\n      defaultFilterApplied: params.defaultFilterApplied,\n      filters: JSON.stringify(params.filters) };\n\n\n    // VIRTUAL\n    if (params.referenceType === \"VIRTUAL\") {\n      url = self.serviceLocator.getUrl('data-navigation-handler-collection');\n      data.reference = params.reference;\n    }\n    // ENTITY AND FACTS\n    else {\n        url = self.serviceLocator.getUrl('data-navigation-handler-entity');\n        data.reference = params.guidEntityCurrent;\n        data.xpath = params.xpath;\n        data.collectionId = params.reference;\n      }\n\n    // Call ajax and returns promise\n    return $.read(url, data).then(function (response) {\n      return self.serializeEntityData(response);\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      */\n  getFiltersEntityData: function getFiltersEntityData(params) {\n    var self = this;\n    params = params || {};\n    var data = {\n      reference: params.guidEntityCurrent,\n      collectionId: params.reference,\n      surrogateKey: params.surrogateKey,\n      xpath: params.xpath,\n      templateType: \"List\",\n      defaultFilterApplied: params.defaultFilterApplied,\n      filters: JSON.stringify(params.filters) };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"data-navigation-handler-entity-filters\"),\n      data: data });\n\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getProcessAddAction: function getProcessAddAction(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"action-handler-getProcessAddAction\");\n\n    // Call ajax and returns promise\n    return $.read(url, params).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getMultipleActions: function getMultipleActions(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"templates-handler-getMultipleActions\");\n\n    // Call ajax and returns promise\n    return $.read(url, params).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getMapping: function getMapping(params) {\n    var self = this;\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"process-handler-getMapping\"),\n      data: params,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /**\r\n      *\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  getForm: function getForm(data) {\n    var self = this;\n\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicetype\"] = self.deviceType;\n    data[self.Class.BA_CONTEXT_PARAMETER_PREFIX + \"devicecode\"] = self.deviceCode;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"process-handler-getForm\"),\n      data: data,\n      type: 'POST',\n      dataType: 'json' });\n\n  },\n\n  /**\r\n      * Chek if an entity has startform\r\n      * @param params\r\n      * @return {*}\r\n      */\n  hasStartForm: function hasStartForm(params) {\n    var self = this;\n    var data = {};\n\n    if (params.guid) {\n      data.guidWFClass = params.guid;\n    }\n\n    return $.read(self.serviceLocator.getUrl(\"process-handler-startform\"), data);\n  },\n\n  /**\r\n      * Executes the action\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  executeAction: function executeAction(params) {\n    var self = this;\n    var data = {\n      surrogateKey: JSON.stringify(params.surrogatedKey),\n      entityId: params.entityId,\n      ruleId: params.processId };\n\n\n    // Call ajax and returns promise\n    return $.create({\n      url: self.serviceLocator.getUrl(\"process-action-execute\"),\n      data: data });\n\n  },\n\n  /**\r\n      * executes a rule\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  actionRule: function actionRule(params) {\n    var self = this;\n    var data = {\n      surrogateKey: params.surrogateKey,\n      entityId: params.entityId,\n      ruleId: params.processId };\n\n\n    return $.create({\n      url: self.serviceLocator.getUrl(\"process-handler-rule\"),\n      data: data,\n      batchRequest: false });\n\n  },\n\n  /**\r\n      * Get following cases\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getActivitiesData: function getActivitiesData(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"process-handler-getActivitiesData\");\n    params = params || {};\n    var data = {\n      page: params.page || 1,\n      pagsize: params.pageSize || 10 };\n\n\n    if (typeof params.idworkflow !== \"undefined\" && params.idworkflow ||\n    typeof params.idWorkflow !== \"undefined\" && params.idWorkflow) {\n      data.idWorkflow = params.idworkflow || params.idWorkflow;\n    }\n    if (typeof params.idCase !== \"undefined\" && params.idCase) {\n      data.idCase = params.idCase;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).then(function (response) {\n      return self.serializeEntityData(response);\n    });\n  },\n\n  /**\r\n      * Return an array with the collections related to stakeholder entities\r\n      */\n  getPendingsData: function getPendingsData(params) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"process-handler-getPendingsData\");\n    params = params || {};\n    var data = {\n      page: params.page || 1,\n      pagsize: params.pageSize || 10 };\n\n\n    if (typeof params.idworkflow !== \"undefined\" && params.idworkflow ||\n    typeof params.idWorkflow !== \"undefined\" && params.idWorkflow) {\n      data.idWorkflow = params.idworkflow || params.idWorkflow;\n    }\n    if (typeof params.idCase !== \"undefined\" && params.idCase) {\n      data.idCase = params.idCase;\n    }\n    if (typeof params.taskState !== \"undefined\" && params.taskState) {\n      data.taskState = params.taskState;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data).then(function (response) {\n      return self.serializeEntityData(response);\n    });\n  },\n\n  /**\r\n      * Get actions\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getActionsData: function getActionsData(params) {\n    var self = this;\n    params = params || {};\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl('entities-handler-getActions'),\n      data: params,\n      batchRequest: true }).\n    pipe(function (response) {\n      return response;\n    });\n  },\n\n  /**\r\n      * Get Users, assignees and events from cases\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getUsersAndEvents: function getUsersAndEvents(params) {\n    var self = this;\n    var data = {};\n\n    if (params.idCases && params.idCases.length > 0) {\n      data.idCases = params.idCases.toString();\n    }\n\n    return $.read(self.serviceLocator.getUrl(\"entities-handler-getUsersAndEvents\"), data);\n  },\n\n  /**\r\n      * Get Users, assignees and events from cases\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getUsers: function getUsers(params) {\n    var self = this;\n    var data = {\n      caseId: params.caseId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"entities-handler-getUsers\"),\n      data: params,\n      batchRequest: true });\n\n  },\n\n  /**\r\n      * Get Users, assignees and events from cases\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getEvents: function getEvents(params) {\n    var self = this;\n    var data = {\n      caseId: params.caseId };\n\n\n    // Call ajax and returns promise\n    return $.read({\n      url: self.serviceLocator.getUrl(\"entities-handler-getEvents\"),\n      data: params,\n      batchRequest: true });\n\n  },\n\n  /**\r\n      * Get Users images\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getUsersImages: function getUsersImages(params, userIds) {\n    var self = this;\n    var data = {};\n    var url = self.serviceLocator.getUrl(\"entities-handler-getUsersImages\");\n\n    if (userIds && userIds.length > 0) {\n      data.userIds = userIds.toString();\n    }\n\n    data.width = params.width;\n    data.height = params.height;\n    data.square = params.square;\n\n    var newUserServices = bizagi.util.getFeatureObject(\"userService.v1.enabled\");\n    if (newUserServices) {\n      return $.ajax({\n        url: url,\n        data: data,\n        type: \"POST\",\n        dataType: \"json\" });\n\n    } else {\n      return $.read({\n        url: url,\n        data: data,\n        dataType: \"json\" });\n\n    }\n  },\n\n  getPreferencesCurrentUser: function getPreferencesCurrentUser() {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"currentUser\");\n    return $.ajax({\n      url: url,\n      type: \"GET\" });\n\n  },\n\n  getPreferencesWorkportalCurrentUser: function getPreferencesWorkportalCurrentUser() {\n    var self = this;\n    var resp = $.read(self.serviceLocator.getUrl(\"PreferencesWorkportalCurrentUser\"));\n    return resp;\n  },\n\n  /**\r\n      * Get stakeholder shortCurts\r\n      * @param params\r\n      * @return {*}\r\n      */\n  getShortCuts: function getShortCuts(params) {\n    var self = this,\n    data = {},\n    url = self.serviceLocator.getUrl(\"entities-handler-getShotCuts\");\n\n    if (typeof params.icon !== \"undefined\" && params.icon) {\n      data.icon = true;\n    }\n\n    // Call ajax and returns promise\n    return $.read(url, data);\n  },\n\n  /**\r\n      *   Returns the available list of searches\r\n      */\n  getSearchLists: function getSearchLists() {\n    var self = this;\n    return $.read(self.serviceLocator.getUrl(\"my-search-getSearchLists\"), {});\n  },\n\n  /**\r\n      *\r\n      * @param params\r\n      */\n  getIdCasesOfProcessEntities: function getIdCasesOfProcessEntities(params) {\n    params = params || {};\n    var self = this;\n    var ids = {\n      ids: JSON.stringify(params) };\n\n\n    // TODO: Validate compatibility\n    if (bizagi.version.server.lessThanOrEqualsTo(\"11.0.0.2608\")) {\n      // Call ajax and returns promise\n      return $.read({\n        url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\n        data: ids });\n\n\n    } else {\n      return $.ajax({\n        url: self.serviceLocator.getUrl(\"process-handler-getIdCasesOfProcessEntities\"),\n        data: ids,\n        type: \"POST\" });\n\n    }\n  },\n\n  /**\r\n      * Retuns query form to searches\r\n      * @param params\r\n      * @returns {*}\r\n      */\n  getQueryForm: function getQueryForm(params) {\n    var self = this;\n    params = params || {};\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"query-handler-getQueryForm\"),\n      data: params,\n      type: \"POST\",\n      dataType: params.dataType || \"json\" });\n\n  },\n\n  /**\r\n      * Returns an object with the filter to send to the server\r\n      * @param params\r\n      * @param filterObject\r\n      * @param callback is called when a filter is added to the array\r\n      */\n  defineFilterObject: function defineFilterObject(params, filterObject, callback) {\n    var properties = params.properties;\n    var xpath = properties.xpath.split('@')[0];\n\n    var filter = filterObject.find(function (el) {\n      return el.xpath == xpath;\n    });\n\n    //if the control exists is because it is a range\n    if (filter) {\n      if (properties.rangeQuery == \"from\") {\n        filter.value = filter.value || {};\n        filter.searchType = 'range';\n        filter.value.min = params.value;\n      } else\n      if (properties.rangeQuery == \"to\") {\n        filter.value = filter.value || {};\n        filter.searchType = 'range';\n        filter.value.max = params.value;\n      } else\n      {\n        params.properties.typeSearch = filter.searchType;\n        var values = setValues(params);\n        $.extend(filter, values);\n      }\n\n      if (properties.orderType) {\n        filter.orderType = properties.orderType;\n      }\n      if (callback) {\n        callback(bizagi.clone(filter));\n      }\n    } else\n    {\n      var isDefaultFilter = properties.defaultFilter || false;\n      filter = setValues(params);\n\n      if (properties.orderType) {\n        filter.orderType = properties.orderType;\n      }\n\n      if (typeof filter.value != 'undefined' || filter.orderType || isDefaultFilter) {\n        filterObject.push(filter);\n        if (callback) {\n          callback(bizagi.clone(filter));\n        }\n      }\n    }\n\n\n    function setValues(params) {\n      var properties = params.properties;\n      var searchType = properties.typeSearch;\n      var value = params.value;\n\n      //Identifing the type control in order to define search type\n      if (properties.type == \"boolean\") {\n        if (value.toLowerCase() === \"null\") {\n          value = null;\n          searchType = \"Nullable\";\n        } else\n        {\n          value = bizagi.util.parseBoolean(value);\n          searchType = \"exact\";\n        }\n      }\n\n      if (properties.type == \"number\" || properties.type == \"money\" || properties.type == \"date\") {\n        searchType = \"exact\";\n      }\n\n      if (_typeof(params.value) == 'object') {\n        value = [];\n        if (Array.isArray(params.value)) {\n          for (var i = 0, len = params.value.length; i < len; i++) {\n            var val = parseInt(params.value[i].id);\n            if (!isNaN(val)) {\n              value.push(val);\n            }\n          }\n        } else\n        {\n          var val = parseInt(params.value.id);\n          if (!isNaN(val)) {\n            value.push(val);\n          }\n        }\n        searchType = \"exact\";\n        value = value.length > 0 ? value : undefined;\n      }\n\n      if (properties.rangeQuery && properties.rangeQuery !== \"none\") {\n        value = {\n          min: params.value,\n          max: params.value };\n\n        searchType = \"range\";\n      }\n\n      searchType = searchType || \"approx\";\n\n      var filter = {\n        xpath: xpath,\n        searchType: searchType };\n\n\n      if (typeof value !== 'undefined') {\n        filter.value = value;\n      }\n\n      return filter;\n    }\n  },\n\n  /*PLAN*/\n  getPlan: function getPlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-get\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getActivities: function getActivities(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-activities\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  updatePlan: function updatePlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-update\");\n    return $.update({\n      url: url.replace(\"{idPlan}\", params.id),\n      data: JSON.stringify(params),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  putExecutePlan: function putExecutePlan(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-execute\");\n\n    return $.create({\n      url: url,\n      data: params,\n      contentType: \"application/x-www-form-urlencoded\" });\n\n  },\n\n  deletePlan: function deletePlan(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-delete\");\n\n    return $.destroy({\n      url: url.replace(\"{idPlan}\", params.id),\n      data: params,\n      contentType: \"application/x-www-form-urlencoded\" });\n\n  },\n\n  closePlan: function closePlan(params) {\n\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-close\");\n\n    return $.create({\n      url: url,\n      data: params,\n      contentType: \"application/x-www-form-urlencoded\" });\n\n  },\n\n  getWorkitemsPlan: function getWorkitemsPlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-workitems\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getTransitionsByPlan: function getTransitionsByPlan(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-transitions-get\");\n\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  editActivityPlan: function editActivityPlan(params) {\n    var self = this;\n    var data = {};\n\n    if (params.activity) {\n      data = params.activity;\n      data.items = params.items;\n    } else {\n      data = params;\n    }\n\n    var url = self.serviceLocator.getUrl(\"project-plan-activity-edit\").replace(\"{idPlan}\", data.idPlan).replace(\"{id}\", data.id);\n\n    return $.update({\n      url: url,\n      data: JSON.stringify(data),\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getPlanByParent: function getPlanByParent(data) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-get-by-parent\");\n    var def = $.Deferred();\n\n    $.when($.read({\n      url: url,\n      data: data,\n      dataType: \"json\",\n      contentType: \"application/json\" })).\n    done(function (response) {\n      def.resolve(response);\n    });\n\n    return def.promise();\n\n  },\n\n  getItemsByActivity: function getItemsByActivity(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"project-plan-activity-tasks-get\");\n    return $.read({\n      url: url,\n      data: params,\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getPlanParent: function getPlanParent(data) {\n    var self = this,\n    url = self.serviceLocator.getUrl(\"project-plan-parent\");\n    return $.read({\n      url: url,\n      data: data,\n      dataType: \"json\" });\n\n  },\n  /**\r\n      * Serializador de servicio de entitiData\r\n      * @param data\r\n      * @returns {*}\r\n      */\n  serializeEntityData: function serializeEntityData(data) {\n    var serializedData = data;\n    serializedData.entities = [];\n\n    /**\r\n                                   * build the return object.\r\n                                   * @param header\r\n                                   * @param row\r\n                                   * @returns {{data: {}, guid: *, surrogateKey: *, timestamp: *}}\r\n                                   * @private\r\n                                   */\n    function _buildNewObject(header, row) {\n      var newObject = {\n        data: {},\n        guid: row.guidEntity,\n        timestamp: header.timestamp },\n\n      columns = header.columns,\n      rowData = row.row;\n\n      for (name in row) {\n        if (row.hasOwnProperty(name) && name.toString() !== \"row\" && name.toString() !== \"id\") {\n          newObject[name] = row[name];\n        }\n      }\n\n      for (var i = 0, len = columns.length; i < len; i += 1) {\n        newObject.data[columns[i]] = rowData[i];\n      }\n\n      return newObject;\n    };\n\n    var k = -1,kRow;\n    while (kRow = data.rows[++k]) {\n      var i = -1,iCell;\n      while (iCell = data.cells[++i]) {\n        if (iCell.id === kRow.id) {\n          var kReturnObject = _buildNewObject(iCell, kRow);\n          serializedData.entities.push(kReturnObject);\n          break;\n        }\n      }\n    }\n\n    return serializedData;\n  },\n\n  getCardViewCustomizedColumns: function getCardViewCustomizedColumns(params) {\n    var self = this;\n    params = params || {};\n    params.sortData = bizagi.util.getLastProcessInboxSort();\n    return this.getMobileActivities(params);\n  },\n  /**\r\n      * Method that calls the activities endpoint and handles sorting and filtering\r\n      */\n  getMobileActivities: function getMobileActivities(params) {\n    var self = this;\n    var url = self.serviceLocator.getUrl(\"case-handler-getActivityList\");\n\n    var data = params || {};\n    // information for sort\n    var sortData = params.sortData;\n    if (sortData) {\n      if (bizagi.util.isMobileInboxByProcessSupported() && sortData.sortOrder && sortData.sortDirection && sortData.sortFieldName) {\n        data.orderFieldName = sortData.sortFieldName;\n        data.orderType = sortData.sortDirection == 'asc' ? 0 : 1;\n        data.order = sortData.sortOrder;\n      } else\n      {\n        delete data.sortData;\n      }\n    }\n    if (typeof params.radNumber !== \"undefined\") {\n      data.radNumber = params.radNumber;\n    }\n    if (params.idWfClass != -1) {\n      data.idWfClass = params.idWfClass;\n    }\n    data.mobileDevice = bizagi.util.isMobileDevice();\n    data.page = data.page || 1;\n    data.pageSize = data.pageSize || 10;\n    if (data.idWfClass != undefined && data.idWfClass < 0) {\n      delete data.idWfClass;\n    }\n\n    if (params.smartInboxId) {\n      data.smartInboxGuid = params.smartInboxId;\n    }\n\n    if (params.liveFilterData) {\n      data.smartInboxFilter = self.encodeLiveFilter(params.liveFilterData);\n      delete params.liveFilterData;\n    }\n\n    var ajaxParams = {\n      url: url,\n      data: data,\n      type: \"GET\",\n      dataType: \"json\" };\n\n    if (params.avoidLoader) {\n      ajaxParams.avoidLoader = true;\n      delete data.avoidLoader;\n    }\n\n\n    var serverResponse;\n    return $.ajax(ajaxParams).then(function (response) {\n      bizagi.util.setLastProcessInboxProcessColumns(response.headers);\n      serverResponse = response;\n      return params.includeSyncErrors && params.inputtray == \"inbox\" ? self.getInboxSyncErrors() : undefined;\n    }).\n    then(function (localSyncErrors) {\n      if (localSyncErrors != undefined) {\n        serverResponse.syncErrors = localSyncErrors;\n      }\n      return serverResponse;\n    });\n\n  },\n\n  /**\r\n      * Encode json filter to base64\r\n      * @param {json} filter \r\n      */\n  encodeLiveFilter: function encodeLiveFilter(filter) {\n    var serializeFilter = \"\";\n\n    var CryptoJS = CryptoJS || function (t, e) {var r = {},i = r.lib = {},n = function n() {},o = i.Base = { extend: function extend(t) {n.prototype = this;var e = new n();return t && e.mixIn(t), e.hasOwnProperty(\"init\") || (e.init = function () {e.$super.init.apply(this, arguments);}), e.init.prototype = e, e.$super = this, e;}, create: function create() {var t = this.extend();return t.init.apply(t, arguments), t;}, init: function init() {}, mixIn: function mixIn(t) {for (var e in t) {t.hasOwnProperty(e) && (this[e] = t[e]);}t.hasOwnProperty(\"toString\") && (this.toString = t.toString);}, clone: function clone() {return this.init.prototype.extend(this);} },s = i.WordArray = o.extend({ init: function init(t, e) {t = this.words = t || [], this.sigBytes = null != e ? e : 4 * t.length;}, toString: function toString(t) {return (t || a).stringify(this);}, concat: function concat(t) {var e = this.words,r = t.words,i = this.sigBytes;if (t = t.sigBytes, this.clamp(), i % 4) for (var n = 0; n < t; n++) {e[i + n >>> 2] |= (r[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 24 - (i + n) % 4 * 8;} else if (65535 < r.length) for (n = 0; n < t; n += 4) {e[i + n >>> 2] = r[n >>> 2];} else e.push.apply(e, r);return this.sigBytes += t, this;}, clamp: function clamp() {var e = this.words,r = this.sigBytes;e[r >>> 2] &= 4294967295 << 32 - r % 4 * 8, e.length = t.ceil(r / 4);}, clone: function clone() {var t = o.clone.call(this);return t.words = this.words.slice(0), t;}, random: function random(e) {for (var r = [], i = 0; i < e; i += 4) {r.push(4294967296 * t.random() | 0);}return new s.init(r, e);} }),c = r.enc = {},a = c.Hex = { stringify: function stringify(t) {var e = t.words;t = t.sigBytes;for (var r = [], i = 0; i < t; i++) {var n = e[i >>> 2] >>> 24 - i % 4 * 8 & 255;r.push((n >>> 4).toString(16)), r.push((15 & n).toString(16));}return r.join(\"\");}, parse: function parse(t) {for (var e = t.length, r = [], i = 0; i < e; i += 2) {r[i >>> 3] |= parseInt(t.substr(i, 2), 16) << 24 - i % 8 * 4;}return new s.init(r, e / 2);} },f = c.Latin1 = { stringify: function stringify(t) {var e = t.words;t = t.sigBytes;for (var r = [], i = 0; i < t; i++) {r.push(String.fromCharCode(e[i >>> 2] >>> 24 - i % 4 * 8 & 255));}return r.join(\"\");}, parse: function parse(t) {for (var e = t.length, r = [], i = 0; i < e; i++) {r[i >>> 2] |= (255 & t.charCodeAt(i)) << 24 - i % 4 * 8;}return new s.init(r, e);} },h = c.Utf8 = { stringify: function stringify(t) {try {return decodeURIComponent(escape(f.stringify(t)));} catch (t) {throw Error(\"Malformed UTF-8 data\");}}, parse: function parse(t) {return f.parse(unescape(encodeURIComponent(t)));} },u = i.BufferedBlockAlgorithm = o.extend({ reset: function reset() {this._data = new s.init(), this._nDataBytes = 0;}, _append: function _append(t) {\"string\" == typeof t && (t = h.parse(t)), this._data.concat(t), this._nDataBytes += t.sigBytes;}, _process: function _process(e) {var r = this._data,i = r.words,n = r.sigBytes,o = this.blockSize,c = n / (4 * o);if (e = (c = e ? t.ceil(c) : t.max((0 | c) - this._minBufferSize, 0)) * o, n = t.min(4 * e, n), e) {for (var a = 0; a < e; a += o) {this._doProcessBlock(i, a);}a = i.splice(0, e), r.sigBytes -= n;}return new s.init(a, n);}, clone: function clone() {var t = o.clone.call(this);return t._data = this._data.clone(), t;}, _minBufferSize: 0 });i.Hasher = u.extend({ cfg: o.extend(), init: function init(t) {this.cfg = this.cfg.extend(t), this.reset();}, reset: function reset() {u.reset.call(this), this._doReset();}, update: function update(t) {return this._append(t), this._process(), this;}, finalize: function finalize(t) {return t && this._append(t), this._doFinalize();}, blockSize: 16, _createHelper: function _createHelper(t) {return function (e, r) {return new t.init(r).finalize(e);};}, _createHmacHelper: function _createHmacHelper(t) {return function (e, r) {return new p.HMAC.init(t, r).finalize(e);};} });var p = r.algo = {};return r;}(Math);!function () {var t = CryptoJS,e = t.lib.WordArray;t.enc.Base64 = { stringify: function stringify(t) {var e = t.words,r = t.sigBytes,i = this._map;t.clamp(), t = [];for (var n = 0; n < r; n += 3) {for (var o = (e[n >>> 2] >>> 24 - n % 4 * 8 & 255) << 16 | (e[n + 1 >>> 2] >>> 24 - (n + 1) % 4 * 8 & 255) << 8 | e[n + 2 >>> 2] >>> 24 - (n + 2) % 4 * 8 & 255, s = 0; 4 > s && n + .75 * s < r; s++) {t.push(i.charAt(o >>> 6 * (3 - s) & 63));}}if (e = i.charAt(64)) for (; t.length % 4;) {t.push(e);}return t.join(\"\");}, parse: function parse(t) {var r = t.length,i = this._map;(n = i.charAt(64)) && -1 != (n = t.indexOf(n)) && (r = n);for (var n = [], o = 0, s = 0; s < r; s++) {if (s % 4) {var c = i.indexOf(t.charAt(s - 1)) << s % 4 * 2,a = i.indexOf(t.charAt(s)) >>> 6 - s % 4 * 2;n[o >>> 2] |= (c | a) << 24 - o % 4 * 8, o++;}}return e.create(n, o);}, _map: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\" };}(), function (t) {function e(t, e, r, i, n, o, s) {return ((t = t + (e & r | ~e & i) + n + s) << o | t >>> 32 - o) + e;}function r(t, e, r, i, n, o, s) {return ((t = t + (e & i | r & ~i) + n + s) << o | t >>> 32 - o) + e;}function i(t, e, r, i, n, o, s) {return ((t = t + (e ^ r ^ i) + n + s) << o | t >>> 32 - o) + e;}function n(t, e, r, i, n, o, s) {return ((t = t + (r ^ (e | ~i)) + n + s) << o | t >>> 32 - o) + e;}for (var o = CryptoJS, s = (a = o.lib).WordArray, c = a.Hasher, a = o.algo, f = [], h = 0; 64 > h; h++) {f[h] = 4294967296 * t.abs(t.sin(h + 1)) | 0;}a = a.MD5 = c.extend({ _doReset: function _doReset() {this._hash = new s.init([1732584193, 4023233417, 2562383102, 271733878]);}, _doProcessBlock: function _doProcessBlock(t, o) {for (var s = 0; 16 > s; s++) {var c = t[a = o + s];t[a] = 16711935 & (c << 8 | c >>> 24) | 4278255360 & (c << 24 | c >>> 8);}s = this._hash.words;var a = t[o + 0],h = (c = t[o + 1], t[o + 2]),u = t[o + 3],p = t[o + 4],d = t[o + 5],l = t[o + 6],y = t[o + 7],_ = t[o + 8],v = t[o + 9],g = t[o + 10],B = t[o + 11],x = t[o + 12],S = t[o + 13],k = t[o + 14],m = t[o + 15],z = e(z = s[0], D = s[1], w = s[2], C = s[3], a, 7, f[0]),C = e(C, z, D, w, c, 12, f[1]),w = e(w, C, z, D, h, 17, f[2]),D = e(D, w, C, z, u, 22, f[3]);z = e(z, D, w, C, p, 7, f[4]), C = e(C, z, D, w, d, 12, f[5]), w = e(w, C, z, D, l, 17, f[6]), D = e(D, w, C, z, y, 22, f[7]), z = e(z, D, w, C, _, 7, f[8]), C = e(C, z, D, w, v, 12, f[9]), w = e(w, C, z, D, g, 17, f[10]), D = e(D, w, C, z, B, 22, f[11]), z = e(z, D, w, C, x, 7, f[12]), C = e(C, z, D, w, S, 12, f[13]), w = e(w, C, z, D, k, 17, f[14]), z = r(z, D = e(D, w, C, z, m, 22, f[15]), w, C, c, 5, f[16]), C = r(C, z, D, w, l, 9, f[17]), w = r(w, C, z, D, B, 14, f[18]), D = r(D, w, C, z, a, 20, f[19]), z = r(z, D, w, C, d, 5, f[20]), C = r(C, z, D, w, g, 9, f[21]), w = r(w, C, z, D, m, 14, f[22]), D = r(D, w, C, z, p, 20, f[23]), z = r(z, D, w, C, v, 5, f[24]), C = r(C, z, D, w, k, 9, f[25]), w = r(w, C, z, D, u, 14, f[26]), D = r(D, w, C, z, _, 20, f[27]), z = r(z, D, w, C, S, 5, f[28]), C = r(C, z, D, w, h, 9, f[29]), w = r(w, C, z, D, y, 14, f[30]), z = i(z, D = r(D, w, C, z, x, 20, f[31]), w, C, d, 4, f[32]), C = i(C, z, D, w, _, 11, f[33]), w = i(w, C, z, D, B, 16, f[34]), D = i(D, w, C, z, k, 23, f[35]), z = i(z, D, w, C, c, 4, f[36]), C = i(C, z, D, w, p, 11, f[37]), w = i(w, C, z, D, y, 16, f[38]), D = i(D, w, C, z, g, 23, f[39]), z = i(z, D, w, C, S, 4, f[40]), C = i(C, z, D, w, a, 11, f[41]), w = i(w, C, z, D, u, 16, f[42]), D = i(D, w, C, z, l, 23, f[43]), z = i(z, D, w, C, v, 4, f[44]), C = i(C, z, D, w, x, 11, f[45]), w = i(w, C, z, D, m, 16, f[46]), z = n(z, D = i(D, w, C, z, h, 23, f[47]), w, C, a, 6, f[48]), C = n(C, z, D, w, y, 10, f[49]), w = n(w, C, z, D, k, 15, f[50]), D = n(D, w, C, z, d, 21, f[51]), z = n(z, D, w, C, x, 6, f[52]), C = n(C, z, D, w, u, 10, f[53]), w = n(w, C, z, D, g, 15, f[54]), D = n(D, w, C, z, c, 21, f[55]), z = n(z, D, w, C, _, 6, f[56]), C = n(C, z, D, w, m, 10, f[57]), w = n(w, C, z, D, l, 15, f[58]), D = n(D, w, C, z, S, 21, f[59]), z = n(z, D, w, C, p, 6, f[60]), C = n(C, z, D, w, B, 10, f[61]), w = n(w, C, z, D, h, 15, f[62]), D = n(D, w, C, z, v, 21, f[63]);s[0] = s[0] + z | 0, s[1] = s[1] + D | 0, s[2] = s[2] + w | 0, s[3] = s[3] + C | 0;}, _doFinalize: function _doFinalize() {var e = this._data,r = e.words,i = 8 * this._nDataBytes,n = 8 * e.sigBytes;r[n >>> 5] |= 128 << 24 - n % 32;var o = t.floor(i / 4294967296);for (r[15 + (n + 64 >>> 9 << 4)] = 16711935 & (o << 8 | o >>> 24) | 4278255360 & (o << 24 | o >>> 8), r[14 + (n + 64 >>> 9 << 4)] = 16711935 & (i << 8 | i >>> 24) | 4278255360 & (i << 24 | i >>> 8), e.sigBytes = 4 * (r.length + 1), this._process(), r = (e = this._hash).words, i = 0; 4 > i; i++) {n = r[i], r[i] = 16711935 & (n << 8 | n >>> 24) | 4278255360 & (n << 24 | n >>> 8);}return e;}, clone: function clone() {var t = c.clone.call(this);return t._hash = this._hash.clone(), t;} }), o.MD5 = c._createHelper(a), o.HmacMD5 = c._createHmacHelper(a);}(Math), function () {var t,e = CryptoJS,r = (t = e.lib).Base,i = t.WordArray,n = (t = e.algo).EvpKDF = r.extend({ cfg: r.extend({ keySize: 4, hasher: t.MD5, iterations: 1 }), init: function init(t) {this.cfg = this.cfg.extend(t);}, compute: function compute(t, e) {for (var r = (c = this.cfg).hasher.create(), n = i.create(), o = n.words, s = c.keySize, c = c.iterations; o.length < s;) {a && r.update(a);var a = r.update(t).finalize(e);r.reset();for (var f = 1; f < c; f++) {a = r.finalize(a), r.reset();}n.concat(a);}return n.sigBytes = 4 * s, n;} });e.EvpKDF = function (t, e, r) {return n.create(r).compute(t, e);};}(), CryptoJS.lib.Cipher || function (t) {var e = (d = CryptoJS).lib,r = e.Base,i = e.WordArray,n = e.BufferedBlockAlgorithm,o = d.enc.Base64,s = d.algo.EvpKDF,c = e.Cipher = n.extend({ cfg: r.extend(), createEncryptor: function createEncryptor(t, e) {return this.create(this._ENC_XFORM_MODE, t, e);}, createDecryptor: function createDecryptor(t, e) {return this.create(this._DEC_XFORM_MODE, t, e);}, init: function init(t, e, r) {this.cfg = this.cfg.extend(r), this._xformMode = t, this._key = e, this.reset();}, reset: function reset() {n.reset.call(this), this._doReset();}, process: function process(t) {return this._append(t), this._process();}, finalize: function finalize(t) {return t && this._append(t), this._doFinalize();}, keySize: 4, ivSize: 4, _ENC_XFORM_MODE: 1, _DEC_XFORM_MODE: 2, _createHelper: function _createHelper(t) {return { encrypt: function encrypt(e, r, i) {return (\"string\" == typeof r ? l : p).encrypt(t, e, r, i);}, decrypt: function decrypt(e, r, i) {return (\"string\" == typeof r ? l : p).decrypt(t, e, r, i);} };} });e.StreamCipher = c.extend({ _doFinalize: function _doFinalize() {return this._process(!0);}, blockSize: 1 });var a = d.mode = {},f = function f(t, e, r) {var i = this._iv;i ? this._iv = void 0 : i = this._prevBlock;for (var n = 0; n < r; n++) {t[e + n] ^= i[n];}},h = (e.BlockCipherMode = r.extend({ createEncryptor: function createEncryptor(t, e) {return this.Encryptor.create(t, e);}, createDecryptor: function createDecryptor(t, e) {return this.Decryptor.create(t, e);}, init: function init(t, e) {this._cipher = t, this._iv = e;} })).extend();h.Encryptor = h.extend({ processBlock: function processBlock(t, e) {var r = this._cipher,i = r.blockSize;f.call(this, t, e, i), r.encryptBlock(t, e), this._prevBlock = t.slice(e, e + i);} }), h.Decryptor = h.extend({ processBlock: function processBlock(t, e) {var r = this._cipher,i = r.blockSize,n = t.slice(e, e + i);r.decryptBlock(t, e), f.call(this, t, e, i), this._prevBlock = n;} }), a = a.CBC = h, h = (d.pad = {}).Pkcs7 = { pad: function pad(t, e) {for (var r, n = (r = (r = 4 * e) - t.sigBytes % r) << 24 | r << 16 | r << 8 | r, o = [], s = 0; s < r; s += 4) {o.push(n);}r = i.create(o, r), t.concat(r);}, unpad: function unpad(t) {t.sigBytes -= 255 & t.words[t.sigBytes - 1 >>> 2];} }, e.BlockCipher = c.extend({ cfg: c.cfg.extend({ mode: a, padding: h }), reset: function reset() {c.reset.call(this);var t = (e = this.cfg).iv,e = e.mode;if (this._xformMode == this._ENC_XFORM_MODE) var r = e.createEncryptor;else r = e.createDecryptor, this._minBufferSize = 1;this._mode = r.call(e, this, t && t.words);}, _doProcessBlock: function _doProcessBlock(t, e) {this._mode.processBlock(t, e);}, _doFinalize: function _doFinalize() {var t = this.cfg.padding;if (this._xformMode == this._ENC_XFORM_MODE) {t.pad(this._data, this.blockSize);var e = this._process(!0);} else e = this._process(!0), t.unpad(e);return e;}, blockSize: 4 });var u = e.CipherParams = r.extend({ init: function init(t) {this.mixIn(t);}, toString: function toString(t) {return (t || this.formatter).stringify(this);} }),p = (a = (d.format = {}).OpenSSL = { stringify: function stringify(t) {var e = t.ciphertext;return ((t = t.salt) ? i.create([1398893684, 1701076831]).concat(t).concat(e) : e).toString(o);}, parse: function parse(t) {var e = (t = o.parse(t)).words;if (1398893684 == e[0] && 1701076831 == e[1]) {var r = i.create(e.slice(2, 4));e.splice(0, 4), t.sigBytes -= 16;}return u.create({ ciphertext: t, salt: r });} }, e.SerializableCipher = r.extend({ cfg: r.extend({ format: a }), encrypt: function encrypt(t, e, r, i) {i = this.cfg.extend(i);var n = t.createEncryptor(r, i);return e = n.finalize(e), n = n.cfg, u.create({ ciphertext: e, key: r, iv: n.iv, algorithm: t, mode: n.mode, padding: n.padding, blockSize: t.blockSize, formatter: i.format });}, decrypt: function decrypt(t, e, r, i) {return i = this.cfg.extend(i), e = this._parse(e, i.format), t.createDecryptor(r, i).finalize(e.ciphertext);}, _parse: function _parse(t, e) {return \"string\" == typeof t ? e.parse(t, this) : t;} })),d = (d.kdf = {}).OpenSSL = { execute: function execute(t, e, r, n) {return n || (n = i.random(8)), t = s.create({ keySize: e + r }).compute(t, n), r = i.create(t.words.slice(e), 4 * r), t.sigBytes = 4 * e, u.create({ key: t, iv: r, salt: n });} },l = e.PasswordBasedCipher = p.extend({ cfg: p.cfg.extend({ kdf: d }), encrypt: function encrypt(t, e, r, i) {return r = (i = this.cfg.extend(i)).kdf.execute(r, t.keySize, t.ivSize), i.iv = r.iv, (t = p.encrypt.call(this, t, e, r.key, i)).mixIn(r), t;}, decrypt: function decrypt(t, e, r, i) {return i = this.cfg.extend(i), e = this._parse(e, i.format), r = i.kdf.execute(r, t.keySize, t.ivSize, e.salt), i.iv = r.iv, p.decrypt.call(this, t, e, r.key, i);} });}(), function () {for (var t = CryptoJS, e = t.lib.BlockCipher, r = t.algo, i = [], n = [], o = [], s = [], c = [], a = [], f = [], h = [], u = [], p = [], d = [], l = 0; 256 > l; l++) {d[l] = 128 > l ? l << 1 : l << 1 ^ 283;}var y = 0,_ = 0;for (l = 0; 256 > l; l++) {var v = (v = _ ^ _ << 1 ^ _ << 2 ^ _ << 3 ^ _ << 4) >>> 8 ^ 255 & v ^ 99;i[y] = v, n[v] = y;var g = d[y],B = d[g],x = d[B],S = 257 * d[v] ^ 16843008 * v;o[y] = S << 24 | S >>> 8, s[y] = S << 16 | S >>> 16, c[y] = S << 8 | S >>> 24, a[y] = S, S = 16843009 * x ^ 65537 * B ^ 257 * g ^ 16843008 * y, f[v] = S << 24 | S >>> 8, h[v] = S << 16 | S >>> 16, u[v] = S << 8 | S >>> 24, p[v] = S, y ? (y = g ^ d[d[d[x ^ g]]], _ ^= d[d[_]]) : y = _ = 1;}var k = [0, 1, 2, 4, 8, 16, 32, 64, 128, 27, 54];r = r.AES = e.extend({ _doReset: function _doReset() {for (var t = (r = this._key).words, e = r.sigBytes / 4, r = 4 * ((this._nRounds = e + 6) + 1), n = this._keySchedule = [], o = 0; o < r; o++) {if (o < e) n[o] = t[o];else {var s = n[o - 1];o % e ? 6 < e && 4 == o % e && (s = i[s >>> 24] << 24 | i[s >>> 16 & 255] << 16 | i[s >>> 8 & 255] << 8 | i[255 & s]) : (s = i[(s = s << 8 | s >>> 24) >>> 24] << 24 | i[s >>> 16 & 255] << 16 | i[s >>> 8 & 255] << 8 | i[255 & s], s ^= k[o / e | 0] << 24), n[o] = n[o - e] ^ s;}}for (t = this._invKeySchedule = [], e = 0; e < r; e++) {o = r - e, s = e % 4 ? n[o] : n[o - 4], t[e] = 4 > e || 4 >= o ? s : f[i[s >>> 24]] ^ h[i[s >>> 16 & 255]] ^ u[i[s >>> 8 & 255]] ^ p[i[255 & s]];}}, encryptBlock: function encryptBlock(t, e) {this._doCryptBlock(t, e, this._keySchedule, o, s, c, a, i);}, decryptBlock: function decryptBlock(t, e) {var r = t[e + 1];t[e + 1] = t[e + 3], t[e + 3] = r, this._doCryptBlock(t, e, this._invKeySchedule, f, h, u, p, n), r = t[e + 1], t[e + 1] = t[e + 3], t[e + 3] = r;}, _doCryptBlock: function _doCryptBlock(t, e, r, i, n, o, s, c) {for (var a = this._nRounds, f = t[e] ^ r[0], h = t[e + 1] ^ r[1], u = t[e + 2] ^ r[2], p = t[e + 3] ^ r[3], d = 4, l = 1; l < a; l++) {var y = i[f >>> 24] ^ n[h >>> 16 & 255] ^ o[u >>> 8 & 255] ^ s[255 & p] ^ r[d++],_ = i[h >>> 24] ^ n[u >>> 16 & 255] ^ o[p >>> 8 & 255] ^ s[255 & f] ^ r[d++],v = i[u >>> 24] ^ n[p >>> 16 & 255] ^ o[f >>> 8 & 255] ^ s[255 & h] ^ r[d++];p = i[p >>> 24] ^ n[f >>> 16 & 255] ^ o[h >>> 8 & 255] ^ s[255 & u] ^ r[d++], f = y, h = _, u = v;}y = (c[f >>> 24] << 24 | c[h >>> 16 & 255] << 16 | c[u >>> 8 & 255] << 8 | c[255 & p]) ^ r[d++], _ = (c[h >>> 24] << 24 | c[u >>> 16 & 255] << 16 | c[p >>> 8 & 255] << 8 | c[255 & f]) ^ r[d++], v = (c[u >>> 24] << 24 | c[p >>> 16 & 255] << 16 | c[f >>> 8 & 255] << 8 | c[255 & h]) ^ r[d++], p = (c[p >>> 24] << 24 | c[f >>> 16 & 255] << 16 | c[h >>> 8 & 255] << 8 | c[255 & u]) ^ r[d++], t[e] = y, t[e + 1] = _, t[e + 2] = v, t[e + 3] = p;}, keySize: 8 });t.AES = e._createHelper(r);}();\n\n    try {\n      serializeFilter = JSON.encode(filter);\n    } catch (e) {\n      serializeFilter = JSON.encode(\"[]\");\n    }\n\n    var encoded = CryptoJS.enc.Utf8.parse(serializeFilter);\n\n    return CryptoJS.enc.Base64.stringify(encoded);;\n  },\n\n  /**\r\n      * Include default all processes item in server resposne\r\n      */\n  includeAllProcessesItem: function includeAllProcessesItem(response) {\n    // all Process - no filter\n    var allProcessItem = {\n      idworkflow: \"-1\",\n      guidWFClass: \"-1\",\n      name: bizagi.localization.getResource(\"workportal-widget-inbox-all-processes\"),\n      path: \"App/\",\n      count: 0,\n      isFavorite: \"false\",\n      icon: \"\",\n      category: \"Processes\",\n      guidFavorite: \"\",\n      orderValue: String.fromCharCode(0) };\n\n\n    if (response.workflows) {\n      // each for count all cases or activities\n      $.each(response.workflows.workflow, function (i, workflow) {\n        response.workflows.workflow[i].orderValue = response.workflows.workflow[i].name;\n        allProcessItem.count += Number(workflow.count);\n      });\n      // Set first element in the list\n      response.workflows.workflow.unshift(allProcessItem);\n    };\n  },\n\n  /**\r\n      * validate column enabled / currentInboxView\r\n      * @returns {bool} header enabled\r\n      */\n  isInboxSystemHeaderSortable: function isInboxSystemHeaderSortable(field, lastProcessInbox, viewType) {\n    var result = false;\n    var headersEnabled = {};\n\n    if (viewType === 'detailView') {\n      headersEnabled = {\n        \"radnumber\": true,\n        \"wiestimatedsolutiondate\": true,\n        \"isfavorite\": true,\n        \"currenttask\": true,\n        \"wfclsdisplayname\": true };\n\n    } else\n    if (viewType === 'cardView') {\n      headersEnabled = {\n        \"radnumber\": true,\n        \"wiestimatedsolutiondate\": true,\n        \"isfavorite\": true,\n        \"currenttask\": true,\n        \"wfclsdisplayname\": true,\n        \"taskstate\": true };\n\n    }\n\n    // Only if wfclsdisplayname is enabled\n    if (headersEnabled.wfclsdisplayname) {\n      // specific process list \n      var isSmartInbox = lastProcessInbox.smartInboxId != undefined && lastProcessInbox.smartInboxId != null;\n      var disableProcessColumn = isSmartInbox && field.fieldName == \"wfclsdisplayname\" && !field.isSmartInbox;\n      if (lastProcessInbox.idWorkflow != -1 || disableProcessColumn) {\n        headersEnabled.wfclsdisplayname = false;\n      }\n    }\n\n    if (field && field.fieldName) {\n      // columns enabled\n      var columnEnabled = headersEnabled[field.fieldName.toLowerCase()];\n      // validate\n      if (columnEnabled && (field.order || field.fieldFilterName)) {\n        result = true;\n      }\n    }\n\n    return result;\n  },\n\n  isInboxHeaderASystemColumn: function isInboxHeaderASystemColumn(field) {\n    var systemHeaders = {\n      \"taskstate\": true,\n      \"taskstateColor\": true,\n      \"radnumber\": true,\n      \"wfclsdisplayname\": true,\n      \"currenttask\": true,\n      \"cascreationdate\": true,\n      \"wiestimatedsolutiondate\": true,\n      \"cassolutiondate\": true,\n      \"idcase\": true,\n      \"idworkitem\": true,\n      \"taskid\": true,\n      \"atrisktime\": true,\n      \"currentuser\": true,\n      \"currentfullname\": true,\n      \"fieldName\": true,\n      \"idwfclass\": true,\n      \"isfavorite\": true,\n      \"guidfavorite\": true,\n      \"creatorfullname\": true };\n\n    return systemHeaders[field.toLowerCase()] || false;\n  },\n\n  /**\r\n      * Verify if custom column is enabled\r\n      * @returns {boolean} customcolumn enabled\r\n      */\n  validateCustomColumn: function validateCustomColumn(field, maxColumnsAllowedOnView, columnsAddedCount) {\n    var result = { isValid: false, selectedColumnsCount: columnsAddedCount };\n\n    // validate if countColumnsAdded < maxColumnsAllowedOnView\n    if (columnsAddedCount < maxColumnsAllowedOnView) {\n      // is customColumn\n      if (field.isSmartInbox || field.isCustomColumn) {\n        result.isValid = true;\n        result.selectedColumnsCount = columnsAddedCount + 1;\n      }\n    }\n\n    return result;\n  },\n  /**\r\n      * Configure for usage in online and offline services\r\n      */\n  configureGlobalHandlers: function configureGlobalHandlers() {\n    var self = this;\n    $(document).off(\"openForm.services\");\n    $(document).on(\"openForm.services\", function (_, params) {\n      self.activeForm = params.form;\n    });\n    $(document).off(\"disposeForm.services\");\n    $(document).on(\"disposeForm.services\", function (_, params) {\n      self.activeForm = undefined;\n    });\n  },\n\n\n\n  /**\r\n      * <SMART_INBOX>\r\n      */\n  getAllSmartInbox: function getAllSmartInbox() {\n    var self = this;\n    var data = {};\n\n    // Call ajax and returns promise\n    return $.read({ url: self.serviceLocator.getUrl(\"smartinbox-getAllInbox\"), data: data });\n  },\n\n  getSpecificSmartInbox: function getSpecificSmartInbox(params) {\n    var self = this;\n    var data = {};\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-specific-inbox\");\n    var url = endPoint.replace(\"{settingName}\", params.settingName);\n    url = url.replace(\"{owner}\", params.owner);\n    url = url.replace(\"{smartInboxId}\", params.smartInboxId);\n\n\n    // Call ajax and returns promise\n    return $.read({ url: url, data: data });\n  },\n\n\n  /*\r\n      *   Return all the available processes to SmartInbox\r\n      */\n  getAllProcessesSmartInbox: function getAllProcessesSmartInbox(params) {\n    var self = this;\n    var data = {};\n\n    // Call ajax and returns promise\n    return $.read({ url: self.serviceLocator.getUrl(\"smartinbox-processes\"), data: data });\n  },\n\n  /*\r\n      *   Return all the available processes to SmartInbox\r\n      */\n  getAllCustomizedColumnsSmartInbox: function getAllCustomizedColumnsSmartInbox(params) {\n    var self = this;\n    var data = JSON.stringify(params);\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"smartinbox-customized-columns\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  createSmartInbox: function createSmartInbox(params) {\n    var self = this;\n    var data = JSON.stringify(params);\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"smartinbox-createinbox\"),\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  updateSmartInbox: function updateSmartInbox(params, model) {\n    var self = this;\n    var data = JSON.stringify(model);\n\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-specific-inbox\");\n    var url = endPoint.replace(\"{settingName}\", params.settingName);\n    url = url.replace(\"{owner}\", params.owner);\n    url = url.replace(\"{smartInboxId}\", params.smartInboxId);\n\n    return $.ajax({\n      url: url,\n      data: data,\n      type: \"PUT\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  deleteSmartInbox: function deleteSmartInbox(params) {\n    var self = this;\n    var data = {};\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-specific-inbox\");\n    var url = endPoint.replace(\"{settingName}\", params.settingName);\n    url = url.replace(\"{owner}\", params.owner);\n    url = url.replace(\"{smartInboxId}\", params.smartInboxId);\n\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      //data: data,\n      type: \"DELETE\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n\n  },\n\n  shareSmartInbox: function shareSmartInbox(params, model) {\n    var self = this;\n    var data = JSON.stringify(model);\n    var endPoint = self.serviceLocator.getUrl(\"smartinbox-share\");\n    var url = endPoint.replace(\"{smartInboxId}\", params.smartInboxId);\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      data: data,\n      type: \"POST\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n\n  },\n\n  getEntityValuesForInboxFilter: function getEntityValuesForInboxFilter(params) {\n    var self = this;\n\n    var url = self.serviceLocator.getUrl(\"smartinbox-entity-values\");\n    url = url.replace(\"{entityGuid}\", params.entityGuid);\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      type: \"GET\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  getUserTasksForInboxFilter: function getUserTasksForInboxFilter(params) {\n    var self = this;\n    var url = \"\";\n\n    if (params.isSmartInbox) {\n      url = self.serviceLocator.getUrl(\"smartinbox-user-tasks\");\n      url = url.replace(\"{smartInboxId}\", params.id);\n    } else {\n      url = self.serviceLocator.getUrl(\"smartinbox-user-tasks-process\");\n      url = url.replace(\"{workflowId}\", params.id);\n    }\n\n    // Call ajax and returns promise\n    return $.ajax({\n      url: url,\n      type: \"GET\",\n      dataType: \"json\",\n      contentType: \"application/json\" });\n\n  },\n\n  /**\r\n      * END OF CODE SECTION FOR : </SMART_INBOX>\r\n      */\n\n  /**\r\n          * callServiceWithNetworkRetries\r\n          */\n  callServiceWithNetworkRetries: function callServiceWithNetworkRetries(context, serviceInvocation, pArguments, maxRetries, delayBetweenRetry, currentRetry, currentDeferred) {\n    var self = this;\n    var currentDeferred = currentDeferred || $.Deferred();\n    currentRetry = isNaN(currentRetry) ? 0 : currentRetry;\n    maxRetries = isNaN(maxRetries) ? 1 : maxRetries;\n    delayBetweenRetry = isNaN(delayBetweenRetry) ? 100 : delayBetweenRetry;\n    if (currentRetry >= maxRetries) {\n      console.error(\"Max retries reached\");\n      currentDeferred.reject(\"Max retries reached\");\n      return;\n    }\n\n    $.when(serviceInvocation.apply(context, pArguments)).\n    then(function (response) {\n      currentDeferred.resolve(response);\n    }).\n    fail(function (params) {\n      if (params.status === 0) {\n        setTimeout(function () {\n          self.callServiceWithNetworkRetries(context, serviceInvocation, pArguments, maxRetries, delayBetweenRetry, currentRetry + 1, currentDeferred);\n        }, delayBetweenRetry);\n      } else\n      {\n        currentDeferred.reject(params);\n      }\n    });\n\n    return currentDeferred.promise();\n  },\n\n  getAndSaveMobileFeaturesFromBizagiConfig: function getAndSaveMobileFeaturesFromBizagiConfig() {\n    var self = this;\n\n    if (bizagi.util.validateIfSaveMobileFeaturesIsEnabled()) {\n      $.when(self.getConfiguration()).then(function (configuration) {\n        if (configuration && configuration.features) {\n          bizagi.util.storeMobileFeatures(configuration.features);\n        }\n      });\n    }\n  } });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /*\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name: BizAgi Rendering Services\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Diego Parra (based on Edward Morales version)\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   -   This class will provide a facade to access to workportal REST services\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {}, {\n  /*\r\n                                                                                       *   Constructor\r\n                                                                                       */\n  init: function init(params) {\n    // Call base\n    var self = this;\n    self.shouldSynchronize = !(bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice() && params.module !== \"offlineServices\");\n    self.isOfflineFormsV2Supported = bizagi.util.isOfflineFormsV2Supported();\n    self._super(params);\n\n    // Create instance of database services\n    if (!params.oldOfflineServicesAlreadyEnabled) {\n      self.database = typeof bizagi.workportal.services.db !== \"undefined\" && !bizagi.util.isMashupContext() ? new bizagi.workportal.services.db() : null;\n      self.configureOfflineEvents();\n    }\n\n    if (self.isOfflineFormsV2Supported) {\n      //Workflow context let us access to rendering services to retrieve offline forms\n      params.context = \"workflow\";\n      params.database = self.database;\n      self.multiactionService = new bizagi.render.services.multiactionservice(this);\n      self.renderDataService = typeof bizagi.render.services.service !== \"undefined\" ? new bizagi.render.services.service(params) : bizagi.render.services.service;\n      self.formService = self.renderDataService.getFormService();\n      self.syncService = self.renderDataService.getSyncService();\n\n      self.fetchWorker = new bizagi.workportal.services.fetchWorker(this);\n      self.pullWorker = new bizagi.workportal.services.pullWorker(this);\n\n      if (self.shouldSynchronize) {\n        self.configureOfflineHandlers();\n      }\n      self.configurePushCaseHandler();\n    }\n\n    if (bizagi.util.isNativePluginSupported() && bizagi.util.isiOSSmartphoneDevice() && bizagi.getNativeComponent() === \"offline\") {\n      bizagiapp.offlineModuleReady();\n    }\n  },\n\n  /*\r\n     *   Return the multiaction-service\r\n     */\n  multiaction: function multiaction() {\n    return this.multiactionService;\n  },\n\n  /*************************************************************************************************\r\n      *          MAIN HANDLERS\r\n      *************************************************************************************************/\n\n  /**\r\n                                                                                                          * Configure events handler specifically for native devices\r\n                                                                                                          * @returns {}\r\n                                                                                                          */\n  configureOfflineHandlers: function configureOfflineHandlers() {\n    var self = this;\n\n    $(document).on(\"fetch-offline-processes\", $.proxy(self.fetchOfflineData, self));\n    $(document).on(\"get-offline-categories\", $.proxy(self.getOfflineCategoriesHandler, self));\n    $(document).on(\"get-offline-recent-processes\", $.proxy(self.getRecentProcessesHandler, self));\n    $(document).on(\"create-startform-case\", $.proxy(self.createStartFormHandler, self));\n    $(document).on(\"get-offline-cases\", $.proxy(self.getOfflineCasesHandler, self));\n    $(document).on(\"get-offline-case-workitems\", $.proxy(self.getOfflineWorkitemsHandler, self));\n    $(document).on(\"delete-offline-case\", $.proxy(self.getOfflineWorkitemsHandler, self));\n\n    // Execute this trigger in render on next event\n    $(document).off(\"tryPushData.offline\");\n    $(document).on(\"tryPushData.offline\", $.proxy(self.pushOfflineDataHandler, self));\n\n    //Clean databases\n    $(document).off(\"cleanDatabases.offline\");\n    $(document).on(\"cleanDatabases.offline\", $.proxy(self.cleanDatabasesHandler, self));\n\n    // Retry download\n    $(document).off(\"retry-download-offline-forms\");\n    $(document).on(\"retry-download-offline-forms\", $.proxy(self.fetchOfflineData, self));\n    // Get Sync Error\n    $(document).off(\"routing-get-offline-task-sync-error\");\n    $(document).on(\"routing-get-offline-task-sync-error\", function (_, params) {\n      self.getTaskSyncError(params);\n    });\n\n    // Sync errors\n    $(document).on(\"get-sync-errors-list\", $.proxy(self.getSyncErrorsListHandler, self));\n    $(document).off(\"get-inbox-sync-errors\");\n    $(document).on(\"get-inbox-sync-errors\", $.proxy(self.getInboxSyncErrorsHandler, self));\n    $(document).off(\"retry-sync-single-offline-case\");\n    $(document).on(\"retry-sync-single-offline-case\", function (_, params) {\n      self.retrySyncSingleOfflineCaseNative(params);\n    });\n  },\n\n  //Manage sync case if user has connection\n  configurePushCaseHandler: function configurePushCaseHandler() {\n    var self = this;\n    $(document).off(\"tryPushCase.offline\");\n    $(document).on(\"tryPushCase.offline\", function (_, params) {\n      var deferred = params.deferred || new $.Deferred();\n      self.tryPushOfflineCaseHandler(params).\n      then(function (response) {\n        deferred.resolve(response);\n      }, function (error) {\n        deferred.reject(error);\n      });\n    });\n    $(document).off(\"retrySyncCase.offline\");\n    $(document).on(\"retrySyncCase.offline\", function (_, params) {\n      var deferred = params.deferred || new $.Deferred();\n      params.isRetry = true;\n      self.tryPushOfflineCaseHandler(params).\n      then(function (response) {\n        deferred.resolve(response);\n      }, function (error) {\n        deferred.reject(error);\n      });\n    });\n  },\n\n  configureOfflineEvents: function configureOfflineEvents() {\n    var self = this;\n\n    if (bizagi.isMobileDevice()) {\n      if (typeof navigator.connection != \"undefined\") {\n        if (typeof Connection !== \"undefined\" && (\n        navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")) {\n          self.online = false;\n        } else {\n          self.online = true;\n        }\n      } else {\n        var queryString = bizagi.readQueryString();\n        var queryoffline = queryString && queryString[\"online\"] ? eval(queryString[\"online\"]) : true;\n        self.online = queryoffline;\n      }\n\n      $(document).off(\"online.services\");\n      $(document).on(\"online.services\", $.proxy(self.onlineServicesHandler, self));\n      $(document).off(\"offline.services\");\n      $(document).on(\"offline.services\", $.proxy(self.offlineServicesHandler, self));\n\n      window.addEventListener('online', function () {\n        self.online = true;\n      });\n\n      window.addEventListener('offline', function () {\n        self.online = false;\n      });\n    }\n  },\n\n  getOfflineCategoriesHandler: function getOfflineCategoriesHandler(_, params) {\n    var self = this;\n\n    params = params || {};\n    params.enableOfflineForm = true;\n    self.getCategories(params).\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineCategories(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting offline categories\");\n    });\n  },\n\n  getRecentProcessesHandler: function getRecentProcessesHandler() {\n    var self = this;\n\n    self.getRecentProcesses().\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineRecentProcesses(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting recent processes\");\n    });\n  },\n\n  createStartFormHandler: function createStartFormHandler(e, params) {\n    var self = this;\n    params = params || {};\n    params.categoryName = \"\";\n    params.isOfflineForm = true;\n\n    self.createNewCase(params).\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.openCreatedStartForm(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error creating a new case with start form\");\n    });\n  },\n\n  getOfflineCasesHandler: function getOfflineCasesHandler(_, param) {\n    var self = this;\n    var params = {};\n    params.enableOfflineForm = true;\n    params.inputtray = param;\n\n    self.getCasesListBeta(params).\n    then(function (resp) {\n      resp.inboxType = param;\n      bizagiapp.setOfflineInboxCases(resp);\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting offline cases\");\n    });\n  },\n\n  getOfflineWorkitemsHandler: function getOfflineWorkitemsHandler(_, params) {\n    var self = this;\n    var params = params || {};\n    params.isOfflineForm = params.isOfflineForm || true;\n    params.idCase = params.idCase || \"\";\n\n    self.getWorkitems(params).\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.openCreatedStartForm(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"error getting offline workitems\");\n    });\n  },\n\n  deleteOfflineCaseHandler: function deleteOfflineCaseHandler(_, params) {\n    var self = this;\n    var params = params || {};\n    params.idCase = params.idCase || \"\";\n\n    self.deleteCase(params).\n    then(function () {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.offlineCaseDeleted(\"success\");\n      }\n    }).fail(function (e) {\n      bizagiapp.offlineCaseDeleted(\"error\");\n      self.defaultErrorHandler(e, \"error deleting an offline case\");\n    });\n  },\n\n  pushOfflineDataHandler: function pushOfflineDataHandler(_) {\n    var self = this;\n    if (self.online) {\n      self.pushOfflineData();\n    }\n  },\n\n  cleanDatabasesHandler: function cleanDatabasesHandler() {\n    var self = this;\n    self.database.restartDatabases().\n    then(function () {\n      var isIphoneNative = bizagi.util.isiOSSmartphoneDevice() && bizagi.util.isNativePluginSupported();\n      if (!isIphoneNative) {\n        bizagi.webpart.publish(\"bz-summary-item-clear\");\n        self.showTaskFeed();\n        if (!self.online) {\n          $(document).trigger(\"offline.inbox\");\n        }\n        bizagi.webpart.publish(\"bz-update-list-sync-errors-cases\");\n      }\n    }).\n    fail(function (e) {\n      self.defaultErrorHandler(e, \"error cleaning database\");\n    });\n  },\n\n  tryPushOfflineCaseHandler: function tryPushOfflineCaseHandler(params) {\n    var self = this;\n\n    if (self.online && params) {\n      return self.syncSingleOfflineCase(params).\n      then(function (syncResponse) {\n        if (params.offlineType === \"task\") {\n          syncResponse.IdCase = params.idCase;\n        }\n        return syncResponse;\n      }).\n      fail(function (e) {\n        self.defaultErrorHandler(e, \"error trying to push offline case\");\n      });;\n    }\n\n    // No connection\n    var networkErrorMsg = bizagi.localization.getResource(\"workportal-login-network-error\", \"The internet connection appears to be offline. Please verify and try again\");\n    var error = JSON.stringify({\n      error: { errorType: \"NetworkError\", message: networkErrorMsg },\n      message: networkErrorMsg,\n      type: \"error\" });\n\n    return $.Deferred().reject(error).promise();\n  },\n\n  syncSingleOfflineCase: function syncSingleOfflineCase(params) {\n    var self = this;\n\n    return params.offlineType === \"task\" ?\n    self.pullWorker.syncSingleOfflineTaskCase(params) :\n    self.pullWorker.syncSingleOfflineStartCase(params);\n  },\n\n  onlineServicesHandler: function onlineServicesHandler() {\n    var self = this;\n    if (self.lastOnlineTimestamp !== undefined && Date.now() - self.lastOnlineTimestamp < 100) {\n      return;\n    }\n\n    self.online = true;\n    if (self.isOfflineFormsV2Supported && self.shouldSynchronize) {\n      self.returnOnlineStatus();\n      self.lastOnlineTimestamp = Date.now();\n    }\n  },\n\n  offlineServicesHandler: function offlineServicesHandler() {\n    var self = this;\n    self.online = false;\n  },\n\n  getSyncErrorsListHandler: function getSyncErrorsListHandler() {\n    var self = this;\n    self.getSyncErrorsList().\n    then(function (resp) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineSyncErrorList(resp);\n      }\n    }).fail(function (e) {\n      self.defaultErrorHandler(e, \"Error getting sync error list\");\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineSyncErrorList([]);\n      }\n    });\n  },\n\n  getInboxSyncErrorsHandler: function getInboxSyncErrorsHandler() {\n    $.when(this.getInboxSyncErrors()).\n    then(function (syncErrors) {\n      if (bizagi.util.isNativePluginSupported()) {\n        bizagiapp.setOfflineInboxSyncErrors(syncErrors);\n      }\n    }).\n    fail(function (e) {\n      bizagiapp.setOfflineInboxSyncErrors({});\n      this.defaultErrorHandler(e, \"Error getting inbox sync errors\");\n    });\n\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n\n  showTaskFeed: function showTaskFeed() {\n    var params = { updateDataList: true, page: 1 };\n    var lastConfiguration = bizagi.util.getLastProcessInbox();\n    if (!bizagi.util.isEmpty(lastConfiguration) && !bizagi.util.isEmpty(lastConfiguration.processInfo)) {\n      if (lastConfiguration.processInfo.idWorkflow != -1) params.idWorkflow = lastConfiguration.processInfo.idWorkflow;else\n      if (!bizagi.util.isEmpty(lastConfiguration.processInfo.smartInboxId)) params.smartInboxId = lastConfiguration.processInfo.smartInboxId;\n    }\n    // Update TaskFeed \n    bizagi.webpart.publish(\"bz-update-list-cases\", params);\n  },\n  getOutboxCasesCount: function getOutboxCasesCount() {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = 0;\n    $.when(self.database.getOutboxCases()).\n    then(function (response) {\n      cases += response.rows ? response.rows.length : 0;\n    }).\n    always(function () {\n      var syncStatusCriteria = \"none\";\n      $.when(self.database.getOutboxTaskCasesFilteredBySyncStatus(syncStatusCriteria, true)).\n      done(function (responses) {\n        cases += responses.length;\n      }).\n      always(function () {\n        def.resolve(cases);\n      });\n    });\n    return def.promise();\n  },\n\n  returnOnlineStatus: function returnOnlineStatus() {\n    var self = this;\n\n    return self.saveWorkInProgress().always(function () {\n      return self.getOutboxCasesCount().\n      then(function (outboxCasesCount) {\n        if (outboxCasesCount > 0) {\n          if (bizagi.util.isNativePluginSupported()) {\n            bizagiapp.openSyncDialog();\n          }\n          return self.pushOfflineData();\n        }\n        return;\n      }).\n      always(function () {\n        var lastProcessInbox = bizagi.util.getLastProcessInbox();\n        var smartInboxId = lastProcessInbox.processInfo.smartInboxId;\n\n        if (!bizagi.util.isiOSSmartphoneDevice()) {\n          bizagi.webpart.publish(\"bz-update-list-cases\", { updateDataList: true, smartInboxId: smartInboxId || undefined });\n          if (bizagi.util.isOfflineErrorsViewSupported()) {\n            bizagi.webpart.publish(\"bz-update-list-sync-errors-cases\");\n          }\n        } else\n        {\n          self.fetchOfflineData();\n        }\n      });\n    });\n  },\n\n  /*\r\n      * Get all data from server : new case structure, forms data\r\n      */\n  fetchOfflineData: function fetchOfflineData() {\n    var self = this;\n    if (!self.isOfflineFormsV2Supported) {\n      return;\n    }\n    self.fetchWorker.fetch();\n  },\n\n  /*\r\n      * Push all data to server : new case structure, forms data\r\n      */\n  pushOfflineData: function pushOfflineData() {\n    var self = this;\n    if (!self.isOfflineFormsV2Supported) return;\n    return self.pullWorker.pull().\n    then(function (success) {\n      self.showSyncMessage(success);\n      return success;\n    }).\n    fail(function (error) {\n      //It is necessary to not show error windows on native when is a business error\n      var notAnError = error && error.type ? true : false;\n      self.showSyncMessage(false, notAnError);\n      return error;\n    });\n  },\n\n  /*\r\n      *   Gets the current working user\r\n      */\n  getCurrentUser: function getCurrentUser(params) {\n    var self = this;\n\n    if (self.online) return self._super(params);\n\n    return $.when({\n      idUser: 1,\n      user: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n      userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n      domain: typeof BIZAGI_DOMAIN !== \"undefined\" ? BIZAGI_DOMAIN : \"domain\",\n      delegateUserName: \"\",\n      idDelegateUser: -1,\n      groupSeparator: \",\",\n      language: \"en-US\",\n      decimalSeparator: \".\",\n      decimalDigits: \"2\",\n      symbol: \"$\",\n      ShortDateFormat: \"M/d/yyyy\",\n      TimeFormat: \"h:mm tt\",\n      LongDateFormat: \"dddd, MMMM d, yyyy\",\n      twoDigitYearMax: 2029,\n      twoDigitYearMaxDelta: 13,\n      uploadMaxFileSize: \"1048576\",\n      isMultiOrganization: \"false\",\n      associatedStakeholders: [],\n      sUserProperties: [] });\n\n  },\n\n  /*\r\n      *   Return all the available processes in bizagi\r\n      */\n  getAllProcesses: function getAllProcesses(params) {\n    var self = this;\n    params.inputtray = params.inputtray || \"inbox\";\n    if (self.online && params.inputtray == \"inbox\") return self._super(params);\n\n    return self.database.getAllProcesses(params).\n    then(function (response) {\n      response = JSON.parse(response);\n\n      // Aggrupate workflows by categories \n      if (!!params.skipAggrupate) {\n        self.includeAllProcessesItem(response);\n        return response;\n      }\n\n      var responseData = {};\n\n      // Create a default category\n      var categories = self.createDefaultCategories(params, response);\n\n      // Build result array once grouped\n      responseData.categories = [];\n      for (key in categories) {\n        responseData.categories.push({\n          name: key,\n          workflows: categories[key].workflows });\n\n      }\n      return responseData;\n    });\n  },\n\n  getAllSmartInbox: function getAllSmartInbox() {\n    var self = this;\n    if (!bizagi.util.isMobileSmartInboxEnabled()) return $.Deferred().resolve([]).promise();\n    if (self.online) {\n      return self._super().then(function (data) {\n        self.database.saveAvailableSmartInboxes(data);\n        return data;\n      });\n    }\n    return self.database.getAvailableSmartInboxes().\n    then(function (data) {\n      self.availableSmartInboxes = data;\n      return self.database.getAvailableOfflineSmartInboxes();\n    }).then(function (offline) {\n      return $.map(self.availableSmartInboxes, function (item) {return $.extend(item, { offline: offline.indexOf(item.id) != -1 });});\n    });\n  },\n  markSmartInboxAsAvailableOffline: function markSmartInboxAsAvailableOffline(id) {\n    var self = this;\n    return self.database.markSmartInboxAsAvailableOffline(id);\n  },\n  /**\r\n      * get last process inbox workflow\r\n      * @return {workflow} \r\n      */\n  getLastProcessInboxWorkflow: function getLastProcessInboxWorkflow() {\n    var self = this;\n    if (self.online) return self._super();\n    return bizagi.util.getLastProcessInboxProcessInfo();\n  },\n\n  /*\r\n      *   Returns all the cases for the current user filtered by a workflow\r\n      */\n  getCasesByWorkflow: function getCasesByWorkflow(params) {\n    var self = this;\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (params.inputtray === \"inbox\") {\n      if (self.online) return self._super(params);\n      return self.getCasesByWorkflowForInboxOffline(params);\n    }\n    return self.getCasesByWorkflowForOtherTrays(params);\n  },\n\n  getCasesByWorkflowForInboxOffline: function getCasesByWorkflowForInboxOffline(params) {\n    var self = this;\n\n    return self.getCustomizedColumnsDataTasks(params).\n    then(function (response) {\n      response = JSON.parse(response);\n      $.each(response.cases.rows, function (key, value) {\n        var newFieldsValue = [];\n\n        //  Set id of case to radnumber\n        response.cases.rows[key][\"radnumber\"] = value.radNumber;\n        $.each(value.fields, function (fieldsKey, fieldsValue) {\n          // when delete element from fields array, each function lose key value\n          if (fieldsValue != undefined) {\n            // Radnumber\n            try {\n              if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == \"true\") {\n                response.cases.rows[key][\"radnumber\"] = fieldsValue.Value;\n              } else if (fieldsValue.workitems != undefined) {\n                response.cases.rows[key][\"workitems\"] = fieldsValue.workitems;\n              } else {\n                newFieldsValue.push(fieldsValue);\n              }\n            } catch (e) {}\n          }\n        });\n\n        // Update Fields\n        response.cases.rows[key]['fields'] = newFieldsValue;\n      });\n\n      return response.cases;\n    });\n  },\n\n  getCasesByWorkflowForOtherTrays: function getCasesByWorkflowForOtherTrays(params) {\n    var self = this;\n    return self.database.getCustomizedColumnsData(params).\n    then(function (response) {\n      response = JSON.parse(response);\n      $.each(response.cases.rows, function (key, value) {\n        var newFieldsValue = [];\n\n        //  Set id of case to radnumber\n        response.cases.rows[key][\"radnumber\"] = value.id;\n        $.each(value.fields, function (fieldsKey, fieldsValue) {\n          // when delete element from fields array, each function lose key value\n          if (fieldsValue != undefined) {\n            // Radnumber\n            try {\n              if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == \"true\") {\n                response.cases.rows[key][\"radnumber\"] = fieldsValue.Value;\n              } else if (fieldsValue.workitems != undefined) {\n                response.cases.rows[key][\"workitems\"] = fieldsValue.workitems;\n              } else {\n                newFieldsValue.push(fieldsValue);\n              }\n            } catch (e) {\n            }\n          }\n        });\n\n        // Update Fields\n        response.cases.rows[key]['fields'] = newFieldsValue;\n      });\n      return response.cases;\n    });\n  },\n\n  /*\r\n      * Get columns data from offline tasks\r\n      */\n  getCustomizedColumnsDataTasks: function getCustomizedColumnsDataTasks(params) {\n    var self = this;\n    var headers, headersType;\n    var idWfClass = -1;\n    params.idWorkflow = params.idWorkflow || params.idWfClass;\n\n    if (params.radnumber || params.radNumber) params[\"radNumber\"] = params.radnumber ? params.radnumber : params.radNumber;\n    if (params.idcase || params.idCase) params[\"radNumber\"] = params.idcase ? params.idcase : params.idCase;\n    if (params.idWorkflow != undefined && bizagi.util.validateFeatureSupport(\"offlineCustomizedColumns\")) idWfClass = params.idWorkflow;\n\n    // Get custom column headers\n    return self.database.getProcessCustomColumnsHeaders(idWfClass).\n    then(function (headersResponse) {\n      headers = headersResponse.headers;\n      headersType = headersResponse.type;\n      var getOfflineCasesParams = $.extend({ isOpen: true }, params);\n      return self.database.getOfflineCases(getOfflineCasesParams);\n    }).\n    then(function (resp) {\n      return self.parseCustomizedColumnDataTaskResponse(params, resp, headers, headersType);\n    });\n  },\n\n  parseCustomizedColumnDataTaskResponse: function parseCustomizedColumnDataTaskResponse(params, response, headers, headersType) {\n    var self = this;\n    var tasks = response.elements;\n    var cases = { cases: { rows: [], totalPages: 1, page: 1, lstIdCases: [] } };\n\n    for (var i = 0, len = tasks.length; i < len; i++) {\n      var currTask = tasks[i];\n\n      if (self.isValidRadNumber(params.radNumber, currTask)) {\n        var localCase = self.buildCaseData(currTask);\n        var dataFields = currTask.systemColumns;\n        var defaultSystemHeaders = self.buildDefaultSystemHeaders();\n        if (headersType == \"process\") dataFields = currTask.processColumns;\n\n        if (dataFields != undefined) {\n          localCase.fields = [];\n          headers.forEach(function (header) {\n            if (header.fieldName == \"radnumber\") {\n              localCase.casenumberdisplayname = header.displayName;\n            } else\n            {\n              var includeHeader = headersType == \"process\" ? header.isCustomColumn == true :\n              defaultSystemHeaders[header.fieldName] == true;\n              if (includeHeader) {\n                localCase.fields.push({\n                  Value: dataFields[header.fieldName] || \"\",\n                  DisplayName: header.displayName,\n                  DataType: header.type,\n                  isRadNumber: header.fieldName == \"radnumber\" });\n\n              }\n            }\n          });\n        }\n        cases.cases.rows.push(localCase);\n        cases.cases.lstIdCases.push(currTask[0]);\n      }\n    }\n\n    // Update counter\n    cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n    return JSON.stringify(cases);\n  },\n\n  buildCaseData: function buildCaseData(task) {\n    return {\n      id: task[0],\n      radNumber: task.radNumber,\n      idWFClass: task[10],\n      idWorkFlow: task[10],\n      taskState: task.taskState,\n      isFavorite: task[9],\n      isEdited: task.isEdited,\n      offlineType: 'task',\n      isOpen: true,\n      isOfflineForm: true,\n      fields: [\n      {\n        Value: task.wfclsdisplayname,\n        DisplayName: task.wfclsdisplayname,\n        DataType: \"VarChar\",\n        isRadNumber: false },\n      {\n        Value: task[12],\n        DisplayName: \"Process creation date\",\n        DataType: \"DateTime\",\n        isRadNumber: false }] };\n\n\n\n  },\n\n  /*\r\n      *  Get Menu Authorization\r\n      */\n  getMenuAuthorization: function getMenuAuthorization() {\n    var self = this;\n\n    if (self.online) return self._super();\n    return $.when({\n      \"permissions\": [\n      { \"Cases\": [\"NewCase\", \"Pending\", \"Closed\", \"Search\"] },\n      {\n        \"AnalysisReports\": [\n        \"BAMProcess\", \"BAMTask\", \"AnalyticsProcess\", \"AnalyticsTask\", \"AnalyticsSensor\",\n        \"AnalysisQueries\", \"BAMResourceMonitor\"] },\n\n      {\n        \"Admin\": [\n        \"UserAdmin\", \"Licenses\", \"EntityAdmin\", \"CaseAdmin\", \"AlarmAdmin\", \"EncryptionAdmin\",\n        \"MobileUpdatesAdmin\", \"AsynchronousWorkitemRetries\", \"UserPendingRequests\",\n        \"AuthenticationLogQuery\", \"BusinessPolicies\", \"Profiles\", \"UserDefaultAssignation\",\n        \"GRDimensionAdmin\", \"ThemeBuilder\"] },\n\n      { \"CurrentUserAdministration\": [\"CurrentUser\"] }, { \"LogOut\": [] }, { \"Search\": [] },\n      { \"SmartFolders\": [] }, { \"CustomFolders\": [] }, { \"BizagiQueries\": [] }, { \"AnalysisQueries\": [] },\n      { \"StateLog\": [] }, { \"PrintableVersion\": [] }] });\n\n\n  },\n\n  /*\r\n      *   Gets the inbox summary for the current logged user\r\n      *   Returns a promise of the data being retrieved\r\n      */\n  getInboxSummary: function getInboxSummary(params) {\n    var self = this;\n    var enableDefaultMethod = self.online;\n    if (params && (params.inputtray == \"false\" || params.inputtray == \"true\")) {\n      enableDefaultMethod = false;\n    }\n    if (enableDefaultMethod) return self._super(params);\n    return $.when({ inboxSummary: { Red: 7, Yellow: 0, Green: 0, Black: 0, All: 7 } });\n  },\n\n  /*\r\n      *   Returns the available categories filtered by a parent category\r\n      *   If not parent category is sent, it will return the base categories\r\n      */\n  getCategories: function getCategories(params) {\n    var self = this;\n    if (self.online) return self._super(params);\n\n    // Define data\n    params = params || {};\n    var data = {};\n\n    // Required params\n    if (params.idCategory)\n    data[\"idCategory\"] = params.idCategory;\n    if (params.idApp)\n    data[\"idApp\"] = params.idApp;\n\n    data[\"enableOfflineForm\"] = params.enableOfflineForm || false;\n    data[\"groupByApp\"] = params.groupByApp || false;\n\n    // Call ajax and returns promise\n    return self.database.getCategories(data);\n  },\n\n  /*\r\n      * Create new case\r\n      */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n    return self.database.createNewCase(params);\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n\n    if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getCase !== \"undefined\")\n    return self.getNativeWorkItems(params);\n\n    return self.database.getWorkitems(params);\n  },\n\n  getNativeWorkItems: function getNativeWorkItems(params) {\n    var defer = new $.Deferred();\n    bizagiapp.getCase(params.idCase, function (response) {\n      var workItems = JSON.parse(response);\n      defer.resolve(workItems);\n    }, function (response) {\n      defer.reject(response);\n    });\n\n    return defer.promise();\n  },\n\n  getCaseSummary: function getCaseSummary(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n    return self.database.getSummary(params);\n  },\n\n  /*\r\n      *   Delete offline cases created localy\r\n      *   return a promise\r\n      */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    params = params || {};\n\n    return self.database.deleteCase(params);\n  },\n\n  /*\r\n      *   Get subprocesses\r\n      *   return a promise\r\n      */\n  getCaseSubprocesses: function getCaseSubprocesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (!params.isOfflineForm) return self._super(params);\n    return $.when({ subProcesses: [] });\n  },\n\n  /**\r\n      * This service get all overrides keys within configuration project\r\n      *\r\n      * @return {json}\r\n      */\n  getOverrides: function getOverrides() {\n    return {};\n  },\n\n  /**\r\n      * Return all the available cases in bizagi and thinking for mobile response\r\n      * @param {} params: inputtray:  inbox | outbox-new | outbox-finished | drafts \r\n      * @returns {}\r\n      */\n  getCasesListBeta: function getCasesListBeta(params) {\n    var self = this;\n    params = params || {};\n    params.inputtray = params.inputtray || \"inbox\";\n    if (params.inputtray === \"inbox\") {\n      if (self.online) {\n\n        $.when(self.saveWorkInProgress()).then(function () {\n          self.fetchOfflineData();\n        }).fail(function () {\n          console.log('getCasesListBeta => Error in saveWorkInProgress promise');\n        });\n\n        return self._super(params);\n      }\n      return self.getCasesListBetaForInbox(params);\n    } else if (params.inputtray === \"drafts\" || params.inputtray === \"outbox-new\") {\n      return self.getCasesListBetaForDraftsOrOutBox(params);\n    }\n    return self.getCasesListBetaForOtherTrays(params);\n  },\n\n  getCasesListBetaForInbox: function getCasesListBetaForInbox(params) {\n    var self = this;\n\n    //Bring work items from db that contain offlineform\n    params.isOpen = true;\n    params.idWfClass = params.idWfClass != undefined ? params.idWfClass : -1;\n    return $.when(self.getProcessCustomColumnsHeaders(params), self.database.getOfflineCases(params)).\n    then(function (headersResponse, tasks) {\n      var taskFeedData = self.getTaskFeedData(tasks);\n      if (headersResponse && headersResponse.headers)\n      taskFeedData.headers = headersResponse.headers;\n      return taskFeedData;\n    });\n    ;\n  },\n\n  getCasesListBetaForDraftsOrOutBox: function getCasesListBetaForDraftsOrOutBox(params) {\n    var self = this;\n\n    return self.database.getCasesList(params).\n    then(function (response) {\n      var taskFeedData = self.getTaskFeedData(response);\n      return taskFeedData;\n    });\n  },\n\n  getCasesListBetaForOtherTrays: function getCasesListBetaForOtherTrays(params) {\n    var self = this;\n    params.isOpen = false;\n\n    return self.database.getOfflineCases(params).\n    then(function (tasks) {\n      var taskFeedData = self.getTaskFeedData(tasks);\n      return taskFeedData;\n    });\n  },\n\n  getLastSelectionCustomColumns: function getLastSelectionCustomColumns() {\n    var self = this;\n    var lastProcessInbox = bizagi.util.getLastProcessInbox();\n    var workflowId = lastProcessInbox.processInfo.idWorkflow;\n    var smartInboxId = lastProcessInbox.processInfo.smartInboxId;\n    if (!bizagi.util.isEmpty(lastProcessInbox.processColumnsInfo) && !bizagi.util.isEmpty(lastProcessInbox.processColumnsInfo.processColumns))\n    return $.Deferred().resolve(lastProcessInbox.processColumnsInfo.processColumns).promise();\n    var service = $.Deferred().resolve(undefined).promise();\n    if (smartInboxId != null) service = self.getSmartInboxCustomColumnsHeaders({ smartInboxId: smartInboxId });else\n    service = self.getProcessCustomColumnsHeaders({ idWfClass: workflowId });\n    return service.then(function (data) {\n      bizagi.util.setLastProcessInboxProcessColumns(data.headers);\n      return data.headers;\n    });\n  },\n  getProcessCustomColumnsHeaders: function getProcessCustomColumnsHeaders(params) {\n    var self = this;\n    return self.database.getProcessCustomColumnsHeaders(params.idWfClass);\n  },\n\n  getSmartInboxCustomColumnsHeaders: function getSmartInboxCustomColumnsHeaders(params) {\n    var self = this;\n    return params.smartInboxId != null ?\n    self.database.getSmartInboxCustomColumnsHeaders(params.smartInboxId) :\n    undefined;\n  },\n\n  getMobileCasesList: function getMobileCasesList(params) {\n    var self = this;\n\n    if (params.inputtray === \"inbox\") return self._super(params);\n    return getCasesListBeta(params);\n  },\n\n  /*\r\n      * Customize Columns\r\n      */\n  getTaskFeedData: function getTaskFeedData(response) {\n    var self = this;\n    var overdue = bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n    var today = bizagi.localization.getResource(\"workportal-taskfeed-today\");\n    var tomorrow = bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n    var upcoming = bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n    var groupedData = { elements: [], page: response.page, totalPages: response.totalPages, advanceSearch: false };\n    var actualDate = new Date();\n    var actualMonth = actualDate.getMonth();\n    var actualDay = actualDate.getDate();\n    var actualYear = actualDate.getFullYear();\n\n    for (var counter = 0; response.elements.length > counter; counter++) {\n      var tmpElement = response.elements[counter];\n      if (tmpElement.offlineType !== undefined && tmpElement.offlineType === \"task\") tmpElement[3] = tmpElement.endDate;\n      var status = {};\n      var originalEndDate = tmpElement[3];\n\n      if (tmpElement[3] !== \"\") {\n        var tmpdate = new Date(tmpElement[3]);\n        var tmpDay = tmpdate.getDate();\n        var tmpMonth = tmpdate.getMonth();\n        var tmpYear = tmpdate.getFullYear();\n        var dateDiff = new Date(tmpYear, tmpMonth, tmpDay, 0, 0, 0) - new Date(actualYear, actualMonth, actualDay, 0, 0, 0);\n\n        if (dateDiff < 0) {\n          tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd | hh:mm tt\");\n          status = self.getTaskFeedStatus(\"1|\" + overdue, \"red\", \"overdue\", \"overdue\");\n\n        } else {\n          if (actualMonth === tmpMonth && actualDay === tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n\n            // Define if the case is overdue\n            if (tmpdate.getTime() < actualDate.getTime()) {\n              status = self.getTaskFeedStatus(\"2|\" + today + \", \" + bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"), \"red\", \"today\", \"overdue\");\n            } else {\n              status = self.getTaskFeedStatus(\"2|\" + today + \", \" + bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"), \"yellow\", \"today\", \"ontime\");\n            }\n          } else if (actualMonth === tmpMonth && actualDay + 1 === tmpDay) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n            status = self.getTaskFeedStatus(\"3|\" + tomorrow, \"yellow\", \"tomorrow\", \"ontime\");\n          } else {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd | hh:mm tt\");\n            status = self.getTaskFeedStatus(\"4|\" + upcoming, \"green\", \"upcoming\", \"upcoming\");\n          }\n\n          if (status && tmpElement.taskstate) {\n            status.state = tmpElement.taskstate;\n          }\n        }\n      } else {\n        tmpElement[3] = \"--\";\n        status = self.getTaskFeedStatus(\"1|\" + overdue, \"red\", \"overdue\", \"overdue\");\n      }\n\n      groupedData.elements.push($.extend({}, tmpElement, status, { \"endDate\": originalEndDate, \"idworkitem\": tmpElement[1] }));\n    }\n    return groupedData;\n  },\n\n  getTaskFeedStatus: function getTaskFeedStatus(group, state, type, icon) {\n    return status = {\n      group: group,\n      state: state,\n      type: type,\n      icon: icon };\n\n  },\n\n  /*\r\n      * Render Details\r\n      * @param idWorkitem\r\n      */\n  summaryCaseDetails: function summaryCaseDetails(options) {\n    var self = this;\n    var params = options || {};\n    var idWorkitem = options[\"idWorkitem\"] || 0;\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (!params.isOfflineForm) return self._super(params);\n    return self.getCaseSummaryDataContent(options).\n    done(function (data) {\n\n      data.currentState = data.currentState || [];\n      var dataCurrentStateLength = data.currentState.length;\n\n      // Show or hide tabs\n      data[\"showEvents\"] = data[\"countEvents\"] >= 1 ? true : false;\n      data[\"showParentProcess\"] = data[\"idParentCase\"] >= 1 ? true : false;\n      data[\"parentProcess\"] = { 'displayName': data[\"parentDisplayName\"], 'idCase': data[\"idParentCase\"] };\n      data[\"isClosed\"] = data[\"isOpen\"] == \"true\" ? false : true;\n      data[\"showAssignees\"] = data[\"countAssigness\"] >= 1 ? true : false;\n      data[\"showSubProcess\"] = data[\"countSubProcesses\"] >= 1 ? true : false;\n      data[\"showForm\"] = data[\"hasGlobalForm\"] == \"true\" ? true : false;\n      data[\"allowsReassign\"] = \"false\";\n\n      for (var i = 0; i < dataCurrentStateLength; i++) {\n        if (data[\"currentState\"][i][\"idWorkItem\"] == idWorkitem) {\n          data[\"allowsReassign\"] = data[\"currentState\"][i][\"allowsReassign\"];\n        }\n      }\n\n      // edit original data, no show events in activities tab\n      var currentStateTypes = [];\n      var m = 0; // counter for new activities array\n      for (var j = 0; j < data[\"currentState\"].length; j++) {\n        if (data[\"currentState\"][j][\"isEvent\"] == \"false\" &&\n        data[\"currentState\"][j][\"assignToCurrentUser\"] == \"true\" &&\n        data[\"currentState\"][j][\"idWorkItem\"] != idWorkitem) {\n          currentStateTypes[m++] = data[\"currentState\"][j];\n        }\n      }\n\n      data[\"currentStateTypes\"] = currentStateTypes;\n      data[\"showActivities\"] = currentStateTypes.length >= 1 ? true : false;\n\n      return data;\n    });\n  },\n\n  /**\r\n      *  Get json from cases service\r\n      */\n  getCaseSummaryDataContent: function getCaseSummaryDataContent(options) {\n    var self = this;\n\n    return self.getCaseSummary(options).\n    then(function (data) {\n      // Completes data\n      data.taskState = self.icoTaskState;\n      data.process = data.process ? data.process : \"\";\n\n      if (data.createdBy) {\n        data.createdByName = data.createdBy.Name;\n        data.createdByUserName = data.createdBy.userName;\n        data.caseDescription = data.caseDescription == '' ? '' : data.caseDescription;\n        data.processPath = data.processPath.replace(/\\//g, ' > ') + data.process;\n        data.showWorkOnIt = true;\n      }\n\n      return data;\n    });\n  },\n\n  /*\r\n      *   Returns the data for the inbox grid view\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (params.inputtray === \"inbox\") return self._super(params);\n    return self.database.getCustomizedColumnsNewData(params).\n    then(function (response) {\n      return JSON.parse(response);\n    });\n  },\n\n  /*\r\n      *   Returns the recent process\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return self.database.getRecentProcesses(params);\n  },\n\n  /*\r\n      *   Start process in BizAgi\r\n      */\n  startProcess: function startProcess(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return $.when({\n      hasStartForm: false,\n      idProcess: params.idProcess,\n      displayName: params.displayName,\n      caseInfo: {} });\n\n  },\n\n  /**\r\n      * Get stakeholder shortCurts\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  getShortCuts: function getShortCuts(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return $.when([]);\n  },\n\n  /**\r\n      * Returns the available list of searches\r\n      * @returns {}\r\n      */\n  getSearchLists: function getSearchLists() {\n    var self = this;\n\n    if (self.online) return self._super();\n    return $.when([]);\n  },\n\n  /**\r\n      * Get the icon of a given collection\r\n      * @param params\r\n      */\n  getCollectionIcon: function getCollectionIcon(params) {\n    var self = this;\n    params = params || {};\n\n    if (self.online) return self._super(params);\n    return $.when([]);\n  },\n\n  /**\r\n      * Returns the recent process\r\n      * @param {} params\r\n      * @returns {}\r\n      */\n  getRecentOfflineProcesses: function getRecentOfflineProcesses(params) {\n    var self = this;\n    params = params || {};\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl('process-handler-getRecentProcesses'),\n      data: params,\n      dataType: 'json',\n      type: 'GET',\n      avoidLoader: true }).\n\n    then(function (data) {\n\n      var processes = data[\"processes\"] || [];\n      var recentProcess = { \"processes\": [] };\n\n      if (!bizagi.util.isObjectEmpty(processes)) {\n        var item;\n        var counter = -1;\n        while (item = processes[++counter]) {\n          if (item.hasOfflineForm) {\n            recentProcess.processes.push(item);\n          }\n        }\n      }\n\n      return recentProcess;\n    });\n  },\n\n  /*\r\n      * Retreives the process  from Hierarchy\r\n      *\r\n      */\n  getOfflineProcessesHierarchy: function getOfflineProcessesHierarchy() {\n    var self = this;\n    var data = {};\n    data['removeOnlineItems'] = 'true';\n    return $.ajax({\n      url: self.serviceLocator.getUrl('offline-getProcessTree'),\n      data: data,\n      dataType: 'json',\n      type: 'GET',\n      avoidLoader: true });\n\n  },\n\n  getOfflineTasks: function getOfflineTasks() {\n    var self = this;\n    var data = {};\n    data[\"pageSize\"] = self.maxOfflineCases;\n    data[\"page\"] = 1;\n\n    return $.ajax({\n      url: self.serviceLocator.getUrl(\"offline-tasks\"),\n      data: data,\n      dataType: 'json',\n      type: 'GET',\n      avoidLoader: true });\n\n  },\n\n\n  serializeOfflineCustomizedColumns: function serializeOfflineCustomizedColumns(headers, rows) {\n    var activities = [];\n    rows.forEach(function (row) {\n      var activityObject = {};\n      headers.forEach(function (header, headerIndex) {\n        if (header.fieldName) {\n          activityObject[header.fieldName] = row[headerIndex];\n        }\n      });\n      activities.push(activityObject);\n    });\n    return activities;\n  },\n\n  deserializeOfflineCustomizedColumns: function deserializeOfflineCustomizedColumns(headers, rows) {\n    var activities = [];\n    rows.forEach(function (rowObject, rowIndex) {\n      var activityRow = activities[rowIndex];\n      if (activityRow == undefined) {\n        activityRow = [];\n      }\n      headers.forEach(function (headerObject, headerIndex) {\n        activityRow[headerIndex] = rowObject[headerObject.fieldName];\n      });\n      activities[rowIndex] = activityRow;\n    });\n    return activities;\n  },\n\n  addEvalPropertyToOfflineHeaders: function addEvalPropertyToOfflineHeaders(headers) {\n    var onlineToOfflineMapping = {\n      \"taskstate\": \"*VAR*.workItems[0].State\",\n      \"wfclsdisplayname\": \"*VAR*.categoryName\",\n      \"currenttask\": \"*VAR*.workItems[0].TaskName\",\n      \"cascreationdate\": \"*VAR*.creationDate\",\n      \"wiestimatedsolutiondate\": \"*VAR*.endDate\",\n      \"idworkitem\": \"*VAR*.workItems[0].idWorkItem\",\n      \"taskid\": \"*VAR*.workItems[0].idTask\",\n      \"hassyncerror\": \"!bizagi.util.isEmpty(*VAR*.syncStatus)\",\n      \"syncerror\": \"bizagi.util.isEmpty(*VAR*.syncStatus) ? undefined : *VAR*.syncDetails\" };\n\n\n    return headers.map(function (currentHeader) {\n      if (onlineToOfflineMapping[currentHeader.fieldName]) {\n        currentHeader.eval = onlineToOfflineMapping[currentHeader.fieldName];\n        currentHeader.varSymbol = \"*VAR*\";\n      }\n      return currentHeader;\n    });\n  },\n\n  getOfflineSystemHeaders: function getOfflineSystemHeaders() {\n\n    var offlineHeaders = [\"isEdited\", \"isOpen\", \"syncStatus\", \"isDraft\",\n    \"syncDetails\", \"formsRenderVersion\", \"isOfflineForm\", \"offlineType\", \"hassyncerror\", \"syncerror\"];\n    return offlineHeaders.map(function (header) {\n      return {\n        displayName: header,\n        fieldName: header };\n\n    });\n  },\n\n  getCardViewCustomizedColumns: function getCardViewCustomizedColumns(params) {\n    var self = this;\n    var response = { headers: [], rows: [], currentPage: 1, totalPages: 1, totalRecords: 0 };\n\n    params.inputtray = params.inputtray || \"inbox\";\n    if (self.online && params.inputtray === \"inbox\") {\n\n      $.when(self.saveWorkInProgress()).then(function () {\n        self.fetchOfflineData();\n      }).fail(function () {\n        console.log('getCardViewCustomizedColumns => Error in saveWorkInProgress promise');\n      });\n\n      return self._super(params);\n    }\n\n    if (params.inputtray === \"inbox\") params.isOpen = true;else\n    {\n      params.idWfClass = -1;\n      params.isOpen = params.inputtray === \"drafts\";\n      delete params.sortData;\n    }\n\n    var headers;\n\n    var service = params.smartInboxId != null ? self.database.getSmartInboxCustomColumnsHeaders(params.smartInboxId) : self.database.getProcessCustomColumnsHeaders(params.idWfClass);\n    return service.then(function (headersResponse) {\n      headers = headersResponse.headers;\n      headers = headers.concat(self.getOfflineSystemHeaders());\n      headers = self.addEvalPropertyToOfflineHeaders(headers);\n      params.headers = headers;\n      params.customColumnsType = headersResponse.type;\n      return self.database.getCustomColumnsData(params);\n    }, function (error) {\n      self.defaultErrorHandler(error, \"OFFLINE: getCardViewCustomizedColumns => Error retrieving headers\");\n      console.warn();\n      return response;\n    }).\n    then(function (rows) {\n      response.headers = headers;\n\n      response.rows = self.deserializeOfflineCustomizedColumns(headers, rows);\n      response.pageSize = rows.length;\n      response.totalRecords = rows.length;\n      return response;\n    }, function (headersErr, rowsErr) {\n      self.defaultErrorHandler({ headersErr: headersErr, rowsErr: rowsErr }, \"OFFLINE: getCardViewCustomizedColumns => Error retrieving rows\");\n      console.warn();\n      return response;\n    });\n  },\n\n  downloadOfflineCustomizedColumns: function downloadOfflineCustomizedColumns() {\n    var self = this;\n    if (!this.online || !this.isOfflineFormsV2Supported) return;\n\n    //Only will be stored the process custom Columns. \n    //Application Custom Columns is out of Scope\n    var lastProcessInfo = bizagi.util.getLastProcessInboxProcessInfo();\n    var workflowId = -1;\n    var smartInboxId = null;\n\n    // If the server does not support custom columns the system columns should be \n    // stored to show the summary view\n    if (bizagi.util.validateFeatureSupport(\"offlineCustomizedColumns\") && lastProcessInfo && lastProcessInfo.idWorkflow) {\n      workflowId = lastProcessInfo.idWorkflow;\n    }\n    var getCustomColumnsParams = { pageSize: 100, page: 1, avoidLoader: true };\n    if (workflowId != -1) getCustomColumnsParams.idWfClass = workflowId;\n    if (lastProcessInfo.smartInboxId != -1) getCustomColumnsParams.smartInboxId = smartInboxId = lastProcessInfo.smartInboxId;\n\n    return this.getCardViewCustomizedColumns(getCustomColumnsParams).\n    then(function (response) {\n      var headers = response.headers;\n      var rows = response.rows;\n      if (!headers || !rows)\n      return $.Deferred().reject(\"Headers or rows are missing in the custom columns service response\").promise();\n\n      var updatesQueue = new bizagiQueue();\n      updatesQueue.add(self.database.saveProcessCustomColumnsHeaders(-1, self.filterSystemHeaders(headers)));\n      if (workflowId != -1) updatesQueue.add(self.database.saveProcessCustomColumnsHeaders(workflowId, headers));else\n      if (smartInboxId != null) updatesQueue.add(self.database.saveSmartInboxCustomColumnsHeaders(smartInboxId, headers));\n      var serializedActivities = self.serializeOfflineCustomizedColumns(headers, rows);\n      serializedActivities.forEach(function (activityCustomColumns) {\n        var caseId = activityCustomColumns.idcase;\n        var workitemId = activityCustomColumns.idworkitem;\n        var internalId = caseId + \"-\" + workitemId;\n        var updateCustomColumnsPromise;\n        if (workflowId != -1) updateCustomColumnsPromise = self.database.updateTaskWorkItemCustomColumnsByType(internalId, \"process\", activityCustomColumns);else\n        if (smartInboxId != null) updateCustomColumnsPromise = self.database.updateTaskWorkItemCustomColumnsByType(internalId, \"smartinbox\", activityCustomColumns, smartInboxId);\n        if (updateCustomColumnsPromise != null) updatesQueue.add(updateCustomColumnsPromise);\n      });\n\n      return updatesQueue.execute();\n    }).\n    fail(function (err) {\n      return self.defaultErrorHandler(err, \"Error downloading the customized columns.\");\n    });\n  },\n\n  getMobileOfflineActivities: function getMobileOfflineActivities(params) {\n    var self = this;\n    var casesListResponse;\n    return self.isActivityAlreadyDownloaded(params.idCase, params.idWorkitem).\n    then(function (isAlreadyDownloaded) {\n      if (isAlreadyDownloaded) return null;\n\n      bizagi.util.console.log(\"Force offline => Task is NOT already downloaded. Downloading...\");\n      var getCaseParams = {\n        radNumber: params.radNumber,\n        idWorkitem: params.idWorkitem || null };\n\n      return self.getMobileActivities(getCaseParams);\n    }).\n    then(function (casesListResponse) {\n      if (casesListResponse == null) return null;\n\n      var serverActivities = self.fetchWorker.serializeActivities(casesListResponse);\n      var offlineActivityId = params.idCase + \"-\" + params.idWorkitem;\n      var serverActivity = serverActivities[offlineActivityId];\n      if (serverActivity === undefined) {\n        return $.Deferred().reject({\n          type: \"error\",\n          message: \"Problem retrieving the activity from the server\" }).\n        promise();\n      }\n\n      var activityToSave = {};\n      serverActivity.isOnDemand = true;\n      activityToSave[offlineActivityId] = serverActivity;\n      return self.database.saveOfflineTasks(serverActivities);\n\n    }).then(function (response) {\n      if (response == null) return null;\n      return self.updateCustomColumns(params, casesListResponse);\n    });\n  },\n\n  updateCustomColumns: function updateCustomColumns(params, casesListResponse) {\n    var self = this;\n    if (bizagi.util.isEmpty(params.idWfClass)) return undefined;\n\n    var headers = casesListResponse.headers;\n    var rows = casesListResponse.rows;\n    var customColumnsActivites = self.serializeOfflineCustomizedColumns(headers, rows);\n    var updateCustomColumnsQueue = new bizagiQueue();\n\n    if (!bizagi.util.isEmpty(params.idWorkflow)) {\n      updateCustomColumnsQueue.add(self.database.saveProcessCustomColumnsHeaders(-1, self.filterSystemHeaders(headers)));\n      updateCustomColumnsQueue.add(self.database.saveProcessCustomColumnsHeaders(params.idWorkflow, headers));\n    }\n\n    customColumnsActivites.forEach(function (activityCustomColumns) {\n      var caseId = activityCustomColumns.idcase;\n      var workitemId = activityCustomColumns.idworkitem;\n      var internalId = caseId + \"-\" + workitemId;\n      var updateCustomColumsPromise = self.database.updateTaskWorkItemCustomColumnsByType(internalId, \"process\", activityCustomColumns);\n      updateCustomColumnsQueue.add(updateCustomColumsPromise);\n    });\n\n    return updateCustomColumnsQueue.execute();\n  },\n\n  downloadActivityOnDemand: function downloadActivityOnDemand(params) {\n    var self = this;\n\n    bizagi.loading.start();\n\n    return self.getMobileOfflineActivities(params).\n    then(function () {\n      return self.isTaskFormAlreadyDownloaded(params.idCase, params.idWorkitem);\n    }).\n    then(function (isFormAlreadyDownloaded) {\n\n      if (!isFormAlreadyDownloaded) return true;\n      if (!params.executeOfflineEntryPipeline) return false;\n\n      //If has entry pipeline the form should be downloaded again\n      return self.formService.verifyFormEntryPipeline(params);\n    }).\n    then(function (shouldDownloadForm) {\n      if (!shouldDownloadForm) return { wasFormDownloaded: false, hasEntryPipeline: false, wasPipelineExecuted: false };\n\n      return $.when(self.formService.downloadOfflineTaskForm({\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        executeOfflineEntryPipeline: params.executeOfflineEntryPipeline }));\n\n    }).\n    always(function () {\n      bizagi.loading.stop();\n    });\n  },\n\n  downloadStartFormOnDemand: function downloadStartFormOnDemand(idProcess) {\n    var self = this;\n    return self.isStartFormAlreadyDownloaded(idProcess).\n    then(function (isFormDownloaded) {\n      if (isFormDownloaded || self.online === false) return;\n\n      return self.formService.downloadOfflineStartForm({ idProcess: idProcess });\n    });\n  },\n\n  /*************************************************************************************************\r\n      *          UTIL METHODS\r\n      *************************************************************************************************/\n\n  showSyncMessage: function showSyncMessage(success, notAnError) {\n    var message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-successful\") ?\n    bizagi.localization.getResource(\"workportal-mobile-offline-sync-successful\") :\n    \"Synchronization successful\";\n    var type = \"success\";\n    if (!success) {\n      message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-fail\") ?\n      bizagi.localization.getResource(\"workportal-mobile-offline-sync-fail\") :\n      \"Synchronization failed\";\n      type = notAnError && !bizagi.util.isNativePluginSupported() ? \"\" : \"error\";\n    }\n    if (bizagi.util.isNativePluginSupported()) {\n      bizagiapp.synchronizationFinished(type);\n    } else\n    {\n      bizagi.util.showNotification({ text: message, type: type });\n    }\n  },\n\n  defaultErrorHandler: function defaultErrorHandler(error, message) {\n    if (_typeof(error) == \"object\")\n    bizagi.util.console.error(message, error);else\n\n    bizagi.util.console.error(message + \":\" + error);\n    return error;\n  },\n\n  createDefaultCategories: function createDefaultCategories(params, response, categories) {\n    var categories = {};\n    var allProcesses = bizagi.localization.getResource(\"workportal-widget-inbox-all-processes\");\n    var allCases = {\n      name: bizagi.localization.getResource(\"workportal-widget-inbox-all-cases\"),\n      path: \"\",\n      category: allProcesses,\n      isFavorite: params.onlyFavorites || false,\n      guidFavorite: \"\",\n      idworkflow: \"\",\n      guidWFClass: \"\",\n      count: 0 };\n\n\n    categories[allProcesses] = [];\n    categories[allProcesses].workflows = [];\n    categories[allProcesses].workflows.push(allCases);\n    if (response.workflows) {\n      $.each(response.workflows.workflow, function (_, workflow) {\n        // Creates the category if it doesn't exist\n        if (!categories[workflow.category]) {\n          categories[workflow.category] = [];\n          categories[workflow.category].workflows = [];\n        }\n\n        // Push the workflow\n        categories[workflow.category].workflows.push(workflow);\n\n        // Sum the cases count\n        allCases.count += Number(workflow.count);\n      });\n    }\n  },\n\n  isActivityAlreadyDownloaded: function isActivityAlreadyDownloaded(idCase, idWorkitem) {\n    return this.database.getTask(idCase + \"-\" + idWorkitem).\n    then(function () {\n      return true;\n    }, function () {\n      return $.Deferred().resolve(false).promise();\n    });\n  },\n\n  isTaskFormAlreadyDownloaded: function isTaskFormAlreadyDownloaded(idCase, idWorkitem) {\n    return this.database.getTaskForm({\n      idCase: idCase,\n      idWorkitem: idWorkitem }).\n\n    then(function () {\n      return true;\n    }, function () {\n      return $.Deferred().resolve(false).promise();\n    });\n  },\n\n  isStartFormAlreadyDownloaded: function isStartFormAlreadyDownloaded(idProcess) {\n    return this.database.getStartForm({\n      idProcess: idProcess }).\n\n    then(function () {\n      return true;\n    }, function () {\n      return $.Deferred().resolve(false).promise();\n    });\n  },\n\n  isValidRadNumber: function isValidRadNumber(radNumber, task) {\n    return typeof radNumber === \"undefined\" ||\n    radNumber.toString() === \"\" ||\n    radNumber.toString() === task[0] ||\n    radNumber == task[0] ||\n    radNumber.toString() == task.radNumber ||\n    radNumber == task.radNumber;\n  },\n\n  buildDefaultSystemHeaders: function buildDefaultSystemHeaders() {\n    return {\n      \"radnumber\": true,\n      \"wfclsdisplayname\": true,\n      \"cascreationdate\": true,\n      \"wiestimatedsolutiondate\": true,\n      \"cassolutiondate\": true };\n\n  },\n\n  filterSystemHeaders: function filterSystemHeaders(headers) {\n    var systemHeaders = [];\n    var self = this;\n    headers.forEach(function (header) {\n      if (self.isInboxHeaderASystemColumn(header.fieldName)) {\n        systemHeaders.push(header);\n      }\n    });\n    return systemHeaders;\n  },\n\n  updateSyncErrorsStatus: function updateSyncErrorsStatus() {\n    this.getSyncErrorsList().\n    then(function (errorsList) {\n      var errors = bizagi.util.isEmpty(errorsList) ? 0 : errorsList.length;\n      $(document).trigger(\"update-sync-errors-icon\", { errors: errors });\n    });\n  },\n  saveWorkInProgress: function saveWorkInProgress() {\n    var self = this;\n    var deferred = new $.Deferred();\n    if (self.activeForm !== undefined && self.activeForm.params && self.activeForm.params.offlineType === \"task\" && self.activeForm.params.isOfflineForm === true) {\n      document.activeElement.blur();\n      return self.activeForm.saveWorkInProgress();\n    } else\n    {\n      deferred.resolve();\n    }\n    return deferred.promise();\n  },\n\n  retrySyncSingleOfflineCaseNative: function retrySyncSingleOfflineCaseNative(infoCase) {\n    var self = this;\n\n    infoCase.isSingleSync = infoCase.isSingleSync || true;\n    infoCase.isRetry = infoCase.isRetry || true;\n\n    self.syncSingleOfflineCase(infoCase).\n    then(function () {\n      // Sucess\n      bizagi.util.showMobileToast({\n        type: \"success\",\n        message: bizagi.localization.getResource(\"workportal-offline-sync-success\") });\n\n    }).\n    fail(function (syncResponse) {\n      bizagi.util.showMobileToast({\n        type: \"error\",\n        message: bizagi.localization.getResource(\"workportal-offline-sync-failed\") });\n\n    }).\n    always(function () {\n      //Wait to persists the error in db before to refresh the view\n      setTimeout(function () {\n        // Update native view\n        self.getSyncErrorsListHandler();\n      }, 100);\n    });\n\n  },\n  /*************************************************************************************************\r\n      *          BRIDGE METHODS\r\n      *************************************************************************************************/\n\n  downloadOfflineTaskForm: function downloadOfflineTaskForm(params) {return this.formService.downloadOfflineTaskForm(params);},\n  downloadOfflineStartForm: function downloadOfflineStartForm(params) {return this.formService.downloadOfflineStartForm(params);},\n  syncOfflineStartCase: function syncOfflineStartCase(params) {return this.syncService.syncOfflineStartCase(params);},\n  syncOfflineTaskCase: function syncOfflineTaskCase(params) {return this.syncService.syncOfflineTaskCase(params);},\n\n  getInboxSyncErrors: function getInboxSyncErrors() {return this.database.getInboxSyncErrors();},\n  getSyncErrorsList: function getSyncErrorsList() {return this.database.getSyncErrorsList();},\n  getTaskSyncError: function getTaskSyncError(params) {return this.database.getTaskSyncError(params);} });","function _typeof(obj) {\"@babel/helpers - typeof\";if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {_typeof = function _typeof(obj) {return typeof obj;};} else {_typeof = function _typeof(obj) {return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;};}return _typeof(obj);} /**\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Name:   Bizagi diagnostics service\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Author: Bryan Alejandro Cubillos Prieto\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Date:   09/21/2020\r\n                                                                                                                                                                                                                                                                                                                                                                                *   Comments:\r\n                                                                                                                                                                                                                                                                                                                                                                                *   =>      This is a new service base for Bizagi diagnostics, required for centralized behavior\r\n                                                                                                                                                                                                                                                                                                                                                                                */\n\nbizagi.workportal.services.service.extend(\n\"bizagi.workportal.services.service\",\n{\n  /*************************************************************************************************\r\n   *          COMPONENT LOCAL DATA\r\n   *************************************************************************************************/\n  DIAGNOSTICS_COMPONENT_NAME: \"bizagi.workportal.services.service.diagnostics\",\n  DIAGNOSTICS_SYNC_AJAX_PARAMS: {\n    TYPE: \"POST\",\n    DATATYPE: \"json\" },\n\n  DIAGNOSTICS_PACKAGE_MAX_ERRORS: 15,\n  DIAGNOSTICS_PACKAGE_SYNC_INTERVAL: 60000,\n  DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB: 3,\n  DIAGNOSTICS_PACKAGE_MAX_RETRY: 3 },\n\n{\n  /*************************************************************************************************\r\n   *          CONSTRUCTOR\r\n   *************************************************************************************************/\n  init: function init(params) {\n    // Call base\n    var self = this;\n    self._super(params);\n\n    self.device = bizagi.util.detectDevice();\n\n    // flag\n    self.diagnosticsServiceEnabled = bizagi.util.isMobileErrorTracesEnabled();\n\n    if (self.diagnosticsServiceEnabled) {\n\n      // Behavior\n      self.configureDiagnosticsHandlers();\n\n      // set default variables\n      self.setDiagnosticsDefaultData();\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          LIFE CYCLE\r\n      *************************************************************************************************/\n  setDiagnosticsDefaultData: function setDiagnosticsDefaultData() {\n    var self = this;\n\n    self.lastSyncDatetime = null;\n    self.diagnosticstErrorsDb = self.getDiagnosticsDatabaseInstance();\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n  configureDiagnosticsHandlers: function configureDiagnosticsHandlers() {\n    var self = this;\n\n    // Create a interval every DIAGNOSTICS_PACKAGE_SYNC_INTERVAL seconds to call sync Diagnostics package error\n    setInterval(function () {\n      self.syncDiagnosticsError();\n    }, self.Class.DIAGNOSTICS_PACKAGE_SYNC_INTERVAL);\n  },\n\n  addDiagnosticsError: function addDiagnosticsError(error, message, source, line, stackTrace) {\n    var self = this;\n\n    var newError = self.createDiagnosticsErrorInstance(error, message, source, line, stackTrace);\n\n    if (newError) {\n      self.saveDiagnosticsErrorInDatabase(newError);\n    }\n  },\n\n  createDiagnosticsErrorInstance: function createDiagnosticsErrorInstance(error, message, source, line, stackTrace) {\n    var self = this;\n\n    if (self.validateDiagnosticsError(error)) {\n      return newError = {\n        error: error,\n        message: bizagi.util.escapeHtml(message),\n        source: source,\n        line: line,\n        stackTrace: stackTrace,\n        componentType: self.getCurrentDiagnosticsEventComponentType(),\n        queueEvents: self.getCurrentDiagnosticsEventsQueue(),\n        queueHTTP: self.getCurrentDiagnosticsHttpQueue(),\n        userAgent: window.navigator.userAgent,\n        when: bizagi.util.getCurrentDatetime(),\n        timestamp: bizagi.util.getCurrentDatetimestamp(),\n        retryCount: 0 };\n\n    } else {\n      console.log(\"ERROR: => Don't possible throw error (error is required) \", self.Class.DIAGNOSTICS_COMPONENT_NAME);\n\n      return null;\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE FUNCTIONS\r\n      *************************************************************************************************/\n  getCurrentDiagnosticsHttpQueue: function getCurrentDiagnosticsHttpQueue() {\n    return bizagi.services.ajax ? bizagi.services.ajax.mobileHttpQueue : undefined;\n  },\n\n  getCurrentDiagnosticsEventsQueue: function getCurrentDiagnosticsEventsQueue() {\n    var self = this;\n    return self.getDataservice() ? self.getDataservice().getQueueListEvents() : undefined;\n  },\n  getCurrentDiagnosticsEventComponentType: function getCurrentDiagnosticsEventComponentType() {\n    var self = this;\n    var listEvents = self.getDataservice() ? self.getDataservice().getQueueListEvents() : undefined;\n    var lastEvent = null;\n\n    if (listEvents.length > 0) {\n      lastEvent = listEvents[listEvents.length - 1];\n    }\n\n    return lastEvent ? lastEvent.componentType : undefined;\n  },\n\n  getDataservice: function getDataservice() {\n    return bizagiWorkportal.deviceFactory.workportal.dataService;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE DATABASE POUCH DB\r\n      *************************************************************************************************/\n  getDiagnosticsDatabaseInstance: function getDiagnosticsDatabaseInstance() {\n    return _typeof(bizagi.workportal.diagnostics.db) != undefined && !bizagi.util.isMashupContext() ? new bizagi.workportal.diagnostics.db() : undefined;\n  },\n\n  getDiagnosticsErrorInDatabase: function getDiagnosticsErrorInDatabase(errorId) {\n    var self = this;\n    return self.diagnosticstErrorsDb.getError(errorId);\n  },\n\n  saveDiagnosticsErrorInDatabase: function saveDiagnosticsErrorInDatabase(newError) {\n    var self = this;\n    return self.diagnosticstErrorsDb.saveError(newError.timestamp, newError);\n  },\n\n  deleteDiagnosticsErrorInDatabase: function deleteDiagnosticsErrorInDatabase(error) {\n    var self = this;\n    return self.diagnosticstErrorsDb.deleteError(error.timestamp);\n  },\n\n  deleteDiagnosticsErrorListInDatabase: function deleteDiagnosticsErrorListInDatabase(errorPackageList) {\n    var self = this;\n    var deletePromisesArray = [];\n    for (var i = 0; i < errorPackageList.length; i++) {\n      // Research Rest require name 'Message'\n      deletePromisesArray.push(self.deleteDiagnosticsErrorInDatabase(errorPackageList[i].Message));\n    }\n    return $.when.apply(deletePromisesArray);\n  },\n\n  updateOrDeleteDiagnosticsErrorInDatabase: function updateOrDeleteDiagnosticsErrorInDatabase(errorPackage) {\n    var self = this;\n\n    // Research Rest require name 'Message'\n    var updateError = errorPackage.Message;\n\n    if (updateError.retryCount >= self.Class.DIAGNOSTICS_PACKAGE_MAX_RETRY) {\n      return self.diagnosticstErrorsDb.deleteError(updateError.timestamp);\n    } else\n    {\n      updateError.retryCount = updateError.retryCount + 1;\n      return self.diagnosticstErrorsDb.saveError(updateError.timestamp, updateError);\n    }\n  },\n\n  updateOrDeleteDiagnosticsErrorListInDatabase: function updateOrDeleteDiagnosticsErrorListInDatabase(errorPackageList) {\n    var self = this;\n    var deletePromisesArray = [];\n    for (var i = 0; i < errorPackageList.length; i++) {\n      deletePromisesArray.push(self.updateOrDeleteDiagnosticsErrorInDatabase(errorPackageList[i]));\n    }\n    return $.when.apply(deletePromisesArray);\n  },\n\n  getCurrentDiagnosticsErrorList: function getCurrentDiagnosticsErrorList() {\n    var self = this;\n    return self.diagnosticstErrorsDb.getErrorsList(self.Class.DIAGNOSTICS_PACKAGE_MAX_ERRORS);\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE VALIDATIONS\r\n      *************************************************************************************************/\n  validateDiagnosticsError: function validateDiagnosticsError(error) {\n    var self = this;\n    var result = false;\n\n    if (error && self.diagnosticsServiceEnabled) {\n      result = true;\n    }\n\n    return result;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE SYNC\r\n      *************************************************************************************************/\n  syncDiagnosticsError: function syncDiagnosticsError() {\n    var self = this;\n\n    // Clean error list\n    self.getCurrentDiagnosticsErrorList().\n    then(function (currentErrorList) {\n      if (currentErrorList.length > 0) {\n        // 1st => Convert diagnostics error list to array (contains 10 errors)\n        var errorPackage = self.getDiagnosticsPackageErrors(currentErrorList);\n        // 2nd => Send error package []\n        self.sendDiagnosticsErrorPackage(errorPackage);\n      }\n    });\n  },\n\n  getDiagnosticsSystemErrorURL: function getDiagnosticsSystemErrorURL() {\n    var self = this;\n    return self.serviceLocator.getUrl(\"diagnostics-sync-system-error\");\n    //return self.control ? self.serviceLocator.getUrl(\"diagnostics-sync-system-error\") : \"http://dev-franciscomb/BizagiLog/api/ErrorLogs/Import2\";\n  },\n\n  getDiagnosticsPackageErrors: function getDiagnosticsPackageErrors(errorsList) {\n    var self = this;\n    var packageSize = 0;\n    var packageErrors = [];\n\n    for (var i = 0; i < errorsList.length && i < self.Class.DIAGNOSTICS_PACKAGE_MAX_ERRORS && packageSize < self.Class.DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB; i++) {\n\n      var currentError = errorsList[i];\n\n      var systemErrorInstance = {\n        DateTime: currentError.when,\n        Username: bizagi.currentUser.user,\n        Source: self.device,\n        Title: currentError.message,\n        Message: currentError // JSON => for security errors in workportal\n      };\n\n      var requestSize = bizagi.util.getSizeJsonObjectInMegaBytes(systemErrorInstance);\n      if (packageSize + requestSize < self.Class.DIAGNOSTICS_PACKAGE_MAX_SIZE_REQUEST_MB || packageErrors.length == 0) {\n        // Only push error when don't exceed limit size\n        packageErrors.push(systemErrorInstance);\n        // Current package size\n        packageSize = packageSize + requestSize;\n      }\n    }\n\n    return packageErrors;\n  },\n\n  sendDiagnosticsErrorPackage: function sendDiagnosticsErrorPackage(errorPackage) {\n    var self = this;\n    var dataServiceInstance = self.getDataservice();\n\n    // This is a hack for sync system errors size\n    if (dataServiceInstance && dataServiceInstance.online) {\n      var syncSystemErrorPromise = $.ajax({\n        url: self.getDiagnosticsSystemErrorURL(),\n        data: JSON.stringify(errorPackage),\n        dataType: self.Class.DIAGNOSTICS_SYNC_AJAX_PARAMS.DATATYPE,\n        type: self.Class.DIAGNOSTICS_SYNC_AJAX_PARAMS.TYPE,\n        contentType: \"application/json\",\n        avoidLoader: true });\n\n\n      $.when(syncSystemErrorPromise).\n      then(function (response) {\n        console.log('sync system error was sended <Respose>: ', response, ' <error_package>: ', errorPackage);\n        return self.deleteDiagnosticsErrorListInDatabase(errorPackage);\n      }).\n      fail(function (errorRest) {\n        console.log('sync system error was NOT sended <error_in_rest>: ', errorRest, ' <error_package>: ', errorPackage);\n        return self.updateOrDeleteDiagnosticsErrorListInDatabase(errorPackage);\n      });\n    } else\n    {\n      console.log('Error in size request => ,', self.Class.DIAGNOSTICS_COMPONENT_NAME, ' Network status => ', dataServiceInstance.online);\n    }\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\nbizagi.workportal.services.db.extend(\"bizagi.workportal.services.db\", {\n  // STATIC METHODS\n},\n{\n  // INSTANCE METHODS\n  /**\r\n   * \r\n   * @param {*} params \r\n   */\n  getTaskSyncError: function getTaskSyncError(params) {\n    var offlineId = params.idCase + \"-\" + params.idWorkitem;\n    return this.getTask(offlineId).\n    then(function (taskObject) {\n      if (!bizagi.util.isEmpty(taskObject) && !bizagi.util.isEmpty(taskObject.syncDetails)) {\n        return $.Deferred().resolve(taskObject.syncDetails).promise();\n      }\n      return $.Deferred().resolve(undefined).promise();\n    },\n    function () {\n      //Error - 404\n      return $.Deferred().resolve(undefined).promise();\n    }).\n\n    then(function (syncError) {\n      if (params.deferred) {\n        params.deferred.resolve(syncError);\n      }\n      return syncError;\n    });\n  },\n\n  getInboxSyncErrors: function getInboxSyncErrors() {\n    return this.dbActivities.allDocs({ include_docs: true }).toJqueryPromise().\n    then(function (response) {\n      var casesMap = {};\n      var casesList = $.grep(response.rows, function (item) {\n        return !bizagi.util.isEmpty(item.doc.syncStatus) && !bizagi.util.isEmpty(item.doc.syncDetails);\n      });\n\n      casesList.forEach(function (item) {\n        var doc = item.doc;\n        casesMap[item.id] = doc.syncDetails;\n      });\n      return casesMap;\n    }).\n    fail(function (err) {\n      bizagi.util.console.error(\"Error getting inbox sync errors\", err);\n      return err;\n    });\n  },\n\n  /**\r\n      * Returns all the cases with sync errors\r\n      */\n  getSyncErrorsList: function getSyncErrorsList() {\n    var errors = [];\n    var self = this;\n\n    return self.dbStartData.allDocs({\n      include_docs: true,\n      attachments: false }).\n    toJqueryPromise().\n    then(function (startCasesResponse) {\n      var startErrors = $.grep(startCasesResponse.rows, function (item) {\n        return !bizagi.util.isEmpty(item.doc.syncStatus) && !bizagi.util.isEmpty(item.doc.syncDetails);\n      });\n      errors = errors.concat(startErrors.map(function (item) {\n        item = item.doc;\n        item.offlineType = \"start\";\n        return self.serializeError(item);\n      }));\n      return self.dbActivities.allDocs({\n        include_docs: true,\n        attachments: false }).\n      toJqueryPromise();\n    }).\n    then(function (tasksCasesResponse) {\n      var tasksErrors = $.grep(tasksCasesResponse.rows, function (item) {\n        return !bizagi.util.isEmpty(item.doc.syncStatus) && !bizagi.util.isEmpty(item.doc.syncDetails);\n      });\n      errors = errors.concat(tasksErrors.map(function (item) {\n        item = item.doc;\n        item.offlineType = \"task\";\n        return self.serializeError(item);\n      }));\n      return errors;\n    }).\n    fail(function (err) {\n      bizagi.log(\"Error loading data before syncronization\");\n      return err;\n    });\n  },\n\n  /**\r\n      * Serialize the error in order to unify the response between tables\r\n      * @param {} item The start case or activity to serialize\r\n      */\n  serializeError: function serializeError(item) {\n    return {\n      radnumber: item.radNumber,\n      idcase: item.idCase,\n      idworkitem: item.workItems[0].idWorkItem,\n      errortype: item.syncDetails.type,\n      synctimestamp: item.syncDetails.timestamp,\n      activity: item.offlineType === \"task\" ? item.workItems[0].TaskName : undefined,\n      activityduedate: item.offlineType === \"task\" ? item.endDate : undefined,\n      process: item.process,\n      offlinetype: item.offlineType === \"task\" ? \"task\" : \"start\",\n      isdraft: !(item.offlineType === \"task\"),\n      syncerror: item.syncDetails,\n      state: item.offlineType === \"task\" ? item.state : undefined };\n\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n$.Class.extend(\"bizagi.workportal.services.pullWorker\", {}, {\n  init: function init(params) {\n    var self = this;\n    var queryString = bizagi.readQueryString();\n\n    self.services = params;\n    self.database = params.database;\n\n    var querydisable = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n    self.disabledb = querydisable;\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  pull: function pull() {\n    var self = this;\n    if (self.disabledb) {\n      return false;\n    }\n\n\n    var getTasksBeforePushPromise = self.services.callServiceWithNetworkRetries(self.services, self.services.getOfflineTasks, [], 5, 2000);\n    return $.when(getTasksBeforePushPromise).\n    then(function () {\n      return self.syncOfflineCases();\n    }, function (getOfflineTasksError) {\n      bizagi.util.console.log(\"Error in getOfflineTasks before to push cases\", getOfflineTasksError);\n      //Resolve the promise with sucess=true in order to don't show error message\n      return $.Deferred().resolve(true).promise();\n    });\n\n\n  },\n\n  /**\r\n      * This function send to the server the offline cases created\r\n      * @param {} argument \r\n      * @returns {} \r\n      */\n  syncOfflineCases: function syncOfflineCases(argument) {\n    var self = this;\n    if (typeof self.database !== \"undefined\") {\n      self.synchronizing = self.synchronizing || false;\n\n      if (!self.synchronizing) {\n        self.synchronizing = true;\n        self.pushInProgressPromise = new $.Deferred();\n        var syncCasesQueue = new bizagiQueue();\n        var syncStarts = self.syncOfflineStartCases(syncCasesQueue);\n        var syncTasks = self.syncOfflineTaskCases(syncCasesQueue);\n\n        $.when(syncStarts, syncTasks).\n        then(function (startToSync, tasksToSync) {\n          if (tasksToSync && tasksToSync.count > 0) {\n            var syncInProgressParams = {\n              type: \"push-tasks-started\",\n              tasks: tasksToSync.tasks || {} };\n\n            $(document).trigger(\"offline-notify-form-sync-event\", syncInProgressParams);\n          }\n          return syncCasesQueue.execute();\n        }).\n        then(function () {\n          setTimeout(function () {\n            self.synchronizing = false;\n            self.pushInProgressPromise.resolve(true);\n          }, 1000);\n        }).\n        fail(function (error) {\n          setTimeout(function () {\n            console.log(\"Error pushing cases to server with errors\", error);\n            self.synchronizing = false;\n            $(document).trigger(\"offline-notify-form-sync-event\", { type: \"push-tasks-error\", message: self.parseSyncError(error) });\n            self.pushInProgressPromise.reject(error);\n          }, 1000);\n        });\n      }\n    }\n\n    return self.pushInProgressPromise.promise();\n  },\n\n  parseSyncError: function parseSyncError(err) {\n    if (err.message) return err.message;\n    if (err.length && err.length > 0 && err[err.length - 1].result && err[err.length - 1].result.messages.length && err[err.length - 1].result.messages.length > 0) return err[err.length - 1].result.messages[0];\n    return \"Unknown error\";\n  },\n\n  syncSingleOfflineTaskCase: function syncSingleOfflineTaskCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n    params.isSingleSync = true;\n    $.when(self.database.getTaskData(params)).\n    then(function (taskData) {\n      var syncCaseParams = {\n        idCase: params.idCase,\n        idWorkitem: params.idWorkitem,\n        data: taskData.data || {},\n        type: \"task\",\n        id: params.idCase + \"-\" + params.idWorkitem,\n        syncStatus: \"started\",\n        isSingleSync: params.isSingleSync,\n        isRetry: params.isRetry === true };\n\n      return self.generateSyncCasePromise(syncCaseParams);\n    }).\n    then(function (pushResult) {\n      var downloadFormAgainPromise = new $.Deferred();\n      var shouldDownloadFormAgain = false;\n\n      if (pushResult && !pushResult.containsNext) {\n        if (pushResult && pushResult.DataChangesetVersion != undefined) {\n          $.when(self.database.getTaskForm(params)).\n          then(function (localTaskForm) {\n            localTaskForm = localTaskForm.form;\n            if (localTaskForm.DataChangesetVersion != undefined && pushResult.DataChangesetVersion > localTaskForm.DataChangesetVersion) {\n              shouldDownloadFormAgain = true;\n              pushResult.shouldRefresh = true;\n            }\n          }).\n          fail(function (error) {\n            shouldDownloadFormAgain = true;\n          }).\n          always(function () {\n            downloadFormAgainPromise.resolve(shouldDownloadFormAgain, pushResult);\n          });\n        } else\n        {\n          shouldDownloadFormAgain = true;\n          downloadFormAgainPromise.resolve(shouldDownloadFormAgain, pushResult);\n        }\n      } else\n      {\n        downloadFormAgainPromise.resolve(shouldDownloadFormAgain, pushResult);\n      }\n      return downloadFormAgainPromise.promise();\n    }).\n    then(function (shouldDownloadFormAgain, pushResult) {\n      if (shouldDownloadFormAgain) {\n        return $.when(self.services.downloadOfflineTaskForm(params)).\n        then(function (downloadResult) {\n          return pushResult;\n        });\n      } else\n      {\n        return pushResult;\n      }\n    }).\n    then(function (pushResult) {\n      def.resolve(pushResult);\n    }).\n    fail(function (syncTaskError) {\n      if (params.isRetry !== true) {\n        def.reject(syncTaskError);\n      } else\n      {\n        syncTaskError = self.services.renderDataService.parseServiceError(arguments);\n        var internalSyncError = self.services.syncService.buildSyncErrorObject(syncTaskError);\n        var errorResponse = {\n          _internalSyncError: internalSyncError,\n          message: internalSyncError != undefined && internalSyncError.message ? internalSyncError.message : undefined };\n\n        $.extend(errorResponse, syncTaskError);\n        def.reject(errorResponse);\n      }\n    });\n    return def.promise();\n  },\n\n  syncSingleOfflineStartCase: function syncSingleOfflineStartCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.database.getCase(params.idCase)).\n    then(function (newCase) {\n      var syncCaseParams = {\n        idCase: newCase.idCase,\n        data: newCase.data || {},\n        idProcess: newCase.idWorkFlow,\n        type: \"start\",\n        id: newCase.idCase,\n        syncStatus: \"started\",\n        isRetry: params.isRetry === true };\n\n      return self.generateSyncCasePromise(syncCaseParams);\n    }).\n    then(function (syncResponse) {\n      def.resolve(syncResponse);\n    }).\n    fail(function (syncCaseError) {\n      syncCaseError = self.services.renderDataService.parseServiceError(arguments);\n      var internalSyncError = self.services.syncService.buildSyncErrorObject(syncCaseError);\n      var errorResponse = {\n        _internalSyncError: internalSyncError,\n        message: internalSyncError != undefined && internalSyncError.message ? internalSyncError.message : undefined };\n\n      $.extend(errorResponse, syncCaseError);\n      def.reject(errorResponse);\n    });\n    return def.promise();\n  },\n\n  syncOfflineStartCases: function syncOfflineStartCases(synchCasesQueue) {\n    var self = this;\n    var def = new $.Deferred();\n    $.when(self.database.getOutboxCases()).\n    done(function (response) {\n      for (var i = 0; i < response.rows.length; i++) {\n        var newCase = response.rows[i].value;\n\n        if (newCase.syncStatus) {\n          continue;\n        }\n\n        var syncCaseParams = {\n          idCase: newCase.idCase,\n          data: newCase.data || {},\n          idProcess: newCase.idWorkFlow,\n          type: \"start\",\n          id: newCase.idCase,\n          syncStatus: \"started\" };\n\n\n        synchCasesQueue.add(self.generateSyncCasePromise(syncCaseParams));\n      }\n      def.resolve({ \"count\": response.rows.length });\n    }).\n    fail(function (err) {\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n\n  syncOfflineTaskCases: function syncOfflineTaskCases(synchCasesQueue) {\n    var def = new $.Deferred();\n    var self = this;\n    var syncStatusCriteria = \"none\";\n    self.database.getOutboxTaskCasesFilteredBySyncStatus(syncStatusCriteria, true).done(\n    function (responses) {\n      var tasks = {};\n      for (var i = 0; i < responses.length; i++) {\n        var caseData = responses[i].doc;\n        var itemId = responses[i].id;\n        var id = itemId.split('-');\n        var syncCaseParams = {\n          idCase: id[0],\n          idWorkitem: id[1],\n          data: caseData.data || {},\n          type: \"task\",\n          id: itemId,\n          syncStatus: \"started\" };\n\n        tasks[itemId] = true;\n        synchCasesQueue.add(self.generateSyncCasePromise(syncCaseParams));\n      }\n      def.resolve({ \"tasks\": tasks, \"count\": responses.length });\n    }).\n\n    fail(function (err) {\n      def.reject(err);\n    });\n    return def.promise();\n  },\n\n\n  generateSyncCasePromise: function generateSyncCasePromise(syncCaseParams) {\n    var self = this;\n    if (syncCaseParams.type === \"start\" || syncCaseParams.data && (syncCaseParams.data.h_action ||\n    syncCaseParams.data.h_actions || syncCaseParams.data.retry_h_actions)) {\n\n      return self.database.updateCaseSyncStatus(syncCaseParams).\n      then(function () {\n        var syncPromise;\n        if (syncCaseParams.type == \"start\")\n        syncPromise = self.services.syncOfflineStartCase(syncCaseParams);else\n\n        syncPromise = self.services.syncOfflineTaskCase(syncCaseParams);\n        return syncPromise;\n      });\n    } else\n    {\n      //The h_action was not specified.\n      bizagi.util.console.log(\"This case will not be synchronized. No actions found\", syncCaseParams);\n      return $.Deferred().resolve(\"This case will not be synchronized. No actions found\").promise();\n    }\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\n\nbizagi.workportal.services.db.old.extend(\"bizagi.workportal.services.db.old\", {}, {\n\n  /**\r\n                                                                                     * This method create a new case in the db to offline status\r\n                                                                                     * @param {} params \r\n                                                                                     * @returns {} promise\r\n                                                                                     */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    var idWfClass = params.idWfClass,\n    id = new Date().toISOString(),\n    def = new $.Deferred();\n\n    var offlineCase = {\n      _id: id,\n      idWfClass: idWfClass.toString(),\n      idWorkFlow: idWfClass.toString(),\n      idCase: id,\n      isFavorite: false,\n      globalId: self.globalId,\n      createdBy: {\n        Name: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n        userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\" },\n\n      creationDate: new Date(),\n      process: params.process || \"Offline\",\n      categoryName: params.process || params.categoryName || \"Offline\",\n      displayName: params.displayName || \"Offline\",\n      radNumber: id,\n      // closed: false,\n      isOfflineForm: true,\n      formsRenderVersion: 2,\n      syncronized: false,\n      isOpen: true,\n      workItems: [\n      {\n        idWorkItem: Math.guid(),\n        idTask: Math.guid(),\n        idCase: id,\n        colorState: \"Green\",\n        State: \"Green\",\n        TaskName: params.process || \"Offline\" }] };\n\n\n\n\n    self.dbCases.put(offlineCase, function callback(err, result) {\n      if (!err) {\n        def.resolve(offlineCase);\n      } else {\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Delete case\r\n      * @param {} params \r\n      * @returns {} promise \r\n      */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err) {\n        self.dbCases.remove(doc, function (error, response) {\n          if (!error) {\n            def.resolve(response);\n          } else {\n            bizagi.log(\"Error erasing case\");\n            def.reject(err);\n          }\n        });\n\n      } else {\n        bizagi.log(\"Error, the case do not exist\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this,\n    def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err) {\n        def.resolve(doc);\n      } else {\n\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the categories as the services if exists in the database\r\n      * @param {} data \r\n      * @returns {} promise\r\n      */\n  getCategories: function getCategories(data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (!data.enableOfflineForm) {\n      def.resolve({});\n    }\n\n    self.dbProcessHierarchy.get(self.globalId, function (err, doc) {\n      if (!err) {\n        self.categories = doc.doc;\n\n        if (data.idApp || data.idCategory) {\n          var groupCategory = getGroup(self.categories, data);\n          def.resolve({\n            category: groupCategory,\n            totalApps: data.idApp ? groupCategory.length : 0 });\n\n        } else {\n          var tempCategories = self.categories;\n          while (tempCategories.length == 1 && (\n          tempCategories[0].categories || tempCategories[0].subCategories)) {\n            tempCategories = getGroup(\n            tempCategories,\n            tempCategories[0].appId ? { idApp: tempCategories[0].appId } :\n            { idCategory: tempCategories[0].idCategory });\n\n          }\n\n          def.resolve({\n            category: tempCategories,\n            totalApps: tempCategories[0] && tempCategories[0].appId ? tempCategories.length : 0 });\n\n        }\n      } else {\n        def.reject(\"could not extract this document\");\n      }\n    });\n\n    return def.promise();\n\n    /**\r\n                           * Get the group for new cases similar to service \r\n                           * @param {} categories \r\n                           * @param {} data \r\n                           * @returns {} \r\n                           */\n    function getGroup(categories, data) {\n      for (var i = 0, len = categories.length; i < len; i++) {\n        if (categories[i].appId && categories[i].appId == data.idApp) {\n          return categories[i].categories;\n        }\n        if (categories[i].idCategory && categories[i].idCategory == data.idCategory) {\n          return categories[i].subCategories;\n        } else {\n          if (categories[i].categories) {\n            var cat = getGroup(categories[i].categories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n\n          if (categories[i].subCategories) {\n            var cat = getGroup(categories[i].subCategories, data);\n            if (cat) {\n              return cat;\n            }\n          }\n        }\n      }\n    }\n  },\n\n  /**\r\n      * This method return all the open cases for the user authenticated from de DB\r\n      * @returns {} promise\r\n      */\n  getAllOpenCases: function getAllOpenCases() {\n    var self = this;\n    var def = new $.Deferred();\n\n    function map(doc) {\n      if (doc.closed === false && doc.createdBy.userName === \"admon\") {\n        emit(doc, null);\n      }\n    }\n\n    self.dbCases.query({\n      map: map },\n    {\n      reduce: false },\n    function (err, response) {\n      if (!err) {\n        def.resolve(response);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get case by id\r\n      * @param {} idCase \r\n      * @returns {} \r\n      */\n  getCase: function getCase(idCase) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(idCase, function (err, doc) {\n      if (!err) {\n        def.resolve(doc);\n      } else {\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    if (params.radnumber || params.radNumber) {\n      params[\"radNumber\"] = params.radnumber ? params.radnumber : params.radNumber;\n    }\n\n    if (params.idcase || params.idCase) {\n      params[\"radNumber\"] = params.idcase ? params.idcase : params.idCase;\n    }\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.globalId, doc);\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber)) {\n            var localCase = {\n              id: resp.rows[i].id,\n              idWFClass: resp.rows[i].idWFClass,\n              idWorkFlow: resp.rows[i].id,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isOfflineForm: true,\n              fields: [\n              {\n                Value: resp.rows[i].value.process,\n                DisplayName: resp.rows[i].value.process,\n                DataType: \"VarChar\",\n                isRadNumber: false },\n              {\n                Value: resp.rows[i].value.creationDate,\n                DisplayName: \"Process creation date\",\n                DataType: \"DateTime\",\n                isRadNumber: false }] };\n\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local data base\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n  getAllProcesses: function getAllProcesses(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    if (typeof params.inputtray === \"undefined\") {\n      params.inputtray = true;\n    }\n\n    // params.inputtry: draft | outbox | inbox disable\n    var response = {\n      \"workflows\": {\n        \"taskstate\": \"\",\n        \"workflow\": [] } };\n\n\n\n    //Reduce and rereduce functions search in http://docs.couchdb.org/en/latest/ddocs.html#view-functions\n    var queryFun = {\n      map: function map(doc) {\n        //Trae los documentos del usuario segun el filtro de all, o si estan en favorites etc\n        if (doc.idWfClass && doc.globalId) {\n          emit({\n            idWf: doc.idWfClass,\n            gId: doc.globalId,\n            isOpen: doc.isOpen.toString() },\n          1);\n        }\n      },\n      reduce: \"_count\" };\n\n\n    self.dbProcessHierarchy.get(self.globalId, function (err, doc) {\n      if (!err) {\n\n        self.dbCases.query(queryFun, {\n          reduce: true },\n        function (error, resp) {\n          if (!error) {\n            for (var i = 0, len = resp.total_rows; i < len; i++) {\n              if (resp.rows[i].key.gId == self.globalId && resp.rows[i].key.isOpen == params.inputtray.toString()) {\n                // Revisar si es necesario agregar aqui el parametro\n                var cat = self.getHierarchyObjects(doc, \"idCategory\", resp.rows[i].key.idWf);\n                response.isOpen = params.inputtray;\n                response.workflows.workflow.push({\n                  category: \"Offline Procesess\",\n                  name: cat[0] ? cat[0].categoryName : \"\",\n                  idworkflow: resp.rows[i].key.idWf,\n                  count: resp.rows[i].value,\n                  isFavorite: false });\n\n              }\n            };\n            def.resolve(JSON.stringify(response));\n          } else {\n            def.reject(\"error\");\n          }\n        });\n      } else {\n        def.reject(\"error\");\n      }\n    });\n    return def.promise();\n  },\n\n  getOutboxCases: function getOutboxCases() {\n    // body\n    var self = this;\n    var def = new $.Deferred();\n\n    var queryFun = {\n      map: function map(doc) {\n        // Get the user documents according to filter all, or if its are in favorites etc.\n        if (!doc.isOpen) {\n          //  emit({ idWfClass: doc.idWfClass, isOpen: doc.isOpen.toString() }, doc);\n          emit(doc.globalId, doc);\n        }\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n\n    function (err, doc) {\n      if (!err) {\n        def.resolve(doc);\n      } else {\n        bizagi.log(\"Error loading data before syncronization\");\n        def.reject(err);\n      }\n    });\n    return def.promise();\n  },\n\n  /**\r\n      * This method return the cases created offline by idWorkflow\r\n      * @param {} params \r\n      * @returns {}  Returns a promise\r\n      *  Struct: [\r\n      *   idCase, idWorkItem, idTask,\r\n      *   dueDate, processName, activityName,\r\n      *   customzedColumns: [key, value],\r\n      *   isOfflineForm, isOpen\r\n      * ]\r\n      */\n  getCasesList: function getCasesList(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"page\": 1,\n      \"totalPages\": 1,\n      \"elements\": [] };\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.globalId, doc);\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          resp.rows[i].value.radNumber.toString().indexOf(params.radNumber.toString()) != -1)) {\n\n            var localCase = [\n            resp.rows[i].value.idCase,\n            resp.rows[i].value.workItems[0][\"idWorkItem\"][0] || \"\",\n            resp.rows[i].value.workItems[0][\"idTask\"][0] || \"\",\n            resp.rows[i].value.creationDate,\n            resp.rows[i].value.categoryName,\n            resp.rows[i].value.displayName,\n            [\n            [\"Case No\", resp.rows[i].value.idCase],\n            [\"Process\", resp.rows[i].value.process],\n            [\"Process creation date\", bizagi.util.formatDateTime(resp.rows[i].value.creationDate)]],\n\n            resp.rows[i].value.isOfflineForm,\n            resp.rows[i].value.isOpen];\n\n\n            cases.elements.push(localCase);\n          }\n        }\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n    return def.promise();\n  },\n\n  /*\r\n     *   This method return the cases created offline by idWorkflow\r\n     *   Returns a promise\r\n     */\n  getCustomizedColumnsNewData: function getCustomizedColumnsNewData(params) {\n    var self = this;\n    var def = new $.Deferred();\n    var cases = {\n      \"cases\": {\n        \"rows\": [],\n        \"totalPages\": 1,\n        \"page\": 1,\n        \"lstIdCases\": [] } };\n\n\n\n    var isOpen = params.inputtray === \"true\";\n\n    var queryFun = {\n      map: function map(doc) {\n        emit(doc.globalId, doc);\n      } };\n\n\n    self.dbCases.query(queryFun, {\n      reduce: false,\n      key: self.globalId },\n    function (error, resp) {\n      if (!error) {\n        for (var i = 0, len = resp.total_rows; i < len; i++) {\n          if (isOpen === resp.rows[i].value.isOpen && (\n          typeof params.radNumber === \"undefined\" || params.radNumber.toString() === \"\" ||\n          params.radNumber.toString() === resp.rows[i].value.radNumber)) {\n            var localCase = {\n              id: resp.rows[i].value.idCase,\n              idWFClass: resp.rows[i].value.idWfClass,\n              idWorkFlow: resp.rows[i].value.idWorkFlow,\n              taskState: \"\",\n              isFavorite: resp.rows[i].value.isFavorite,\n              guidFavorite: \"\",\n              isOpen: resp.rows[i].value.isOpen,\n              isAborted: false,\n              isOfflineForm: true,\n              fields: [\n              resp.rows[i].value.idCase,\n              resp.rows[i].value.process,\n              {\n                \"workitems\": resp.rows[i].value.workItems },\n\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate),\n              \"\",\n              bizagi.util.formatDateTime(resp.rows[i].value.creationDate)] };\n\n\n            cases.cases.rows.push(localCase);\n            cases.cases.lstIdCases.push(resp.rows[i].id);\n          }\n        }\n\n        // Update counter\n        cases.cases.totalPages = cases.cases.page = cases.cases.rows.length > 0 ? 1 : 0;\n\n        def.resolve(JSON.stringify(cases));\n      } else {\n        bizagi.log(\"Error loading cases from local database\");\n        def.reject(\"Error loading cases from local database\");\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Get recent processes\r\n      * @param {} params \r\n      * @returns {} promise\r\n      */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    var deferred = new $.Deferred();\n    var recent = { \"processes\": [] };\n\n    if (!self.recentProcesses) {\n      self.dbProcessRecent.get(self.globalId, function (error, doc) {\n        if (!error) {\n          self.recentProcesses = doc.doc;\n          deferred.resolve(self.recentProcesses);\n        } else {\n          bizagi.log(\"Could not extract this document\");\n          deferred.reject(error);\n        }\n      });\n    } else {\n      deferred.resolve(self.recentProcesses);\n    }\n\n    return deferred.promise();\n  } });","/*\r\n*   Name: BizAgi Database Plugin\r\n*   Author: oscaro\r\n*   Comments:\r\n*   -   This script creates a plugin to handler oll db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\nbizagi.workportal.services.db.old.extend(\"bizagi.workportal.services.db.old\", {}, {\n\n  /**\r\n                                                                                     * This method return the form for a new case to offline status\r\n                                                                                     * @param {} idWFClass\r\n                                                                                     * @returns {} Returns a promise\r\n                                                                                     */\n  getFormData: function getFormData(idWFClass) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbForms.get(idWFClass + \"-\" + idWFClass + \"-\" + self.globalId, function (err, doc) {\n      if (!err) {\n        if (typeof doc.form !== \"undefined\") {\n          setTimeout(function () {\n            def.resolve({ form: doc.form, type: \"form\" });\n          }, 300);\n        } else {\n          var responseText = {\n            errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n            message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n          def.reject(JSON.stringify(responseText));\n        }\n      } else {\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * This method merge the form and the data to result form\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  mergeForm: function mergeForm(doc, form) {\n\n    var self = this;\n    var def = new $.Deferred();\n\n    $.when(form).done(function (form) {\n      if (!doc.data) {\n        def.resolve(form);\n      } else {var\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        fillForm = function fillForm(element, data) {\n          if (element.length && element.length > 0) {\n            for (var i = 0, len = element.length; i < len; i++) {\n              fillForm(element[i], data);\n            }\n          } else {\n            if (element.container) {\n              fillForm(element.container.elements, data);\n            } else {\n              // If it case is in outbox or closed, make all renders in the form not editable\n              if (!doc.isOpen) {\n                element.render.properties.editable = false;\n              }\n\n              if (element.render.properties.xpath == data.key) {\n                if (element.render.properties.type === \"grid\") {\n                  self.setRenderGridValues(element.render);\n                }\n                self.setRenderValues(element.render.properties, data.value);\n              }\n\n            }\n          }\n        }; // If it case is in outbox or closed, hide buttons in the form\n        if (!doc.isOpen) {form.form.buttons = [];if (Object.keys(doc.data).length === 0) {fillForm(form.form.elements, { key: \"read-only-form\", value: \"\" });}}for (prop in doc.data) {fillForm(form.form.elements, { key: prop, value: doc.data[prop] });}\n        def.resolve(form);\n      }\n    }).fail(function (cause) {\n      if (!cause.responseText)\n      var responseText = {\n        errorType: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form\"),\n        message: bizagi.localization.getResource(\"workportal-offline-error-nonexisting-form-message\") };\n\n\n      cause.responseText = JSON.stringify(responseText);\n\n      def.reject(cause);\n    });\n\n    return def.promise();\n  },\n\n  /**\r\n      * Set render Grid values\r\n      * @param {} render\r\n      * @returns {}\r\n      */\n  setRenderGridValues: function setRenderGridValues(render) {\n    render.properties.data.columns = [];\n    for (var i = 0, length = render.elements.length; i < length; i++) {\n      render.properties.data.columns.push(render.elements[i].render.properties.xpath);\n    }\n  },\n\n  /**\r\n      * This function sets the type of each xpath\r\n      * @param {} doc\r\n      * @param {} form\r\n      * @returns {}\r\n      */\n  setDataType: function setDataType(doc, form) {\n\n  },\n\n  /**\r\n      *  This method return the categories like the services if exists in the database\r\n      * @param {} params\r\n      * @param {} data\r\n      * @returns {} Returns a promise\r\n      */\n  setRenderValues: function setRenderValues(params, data) {\n    var type = params.type;\n\n    if (!type) type = \"label\";\n\n    var typeGroupBasic = [\"text\", \"label\", \"number\", \"money\", \"date\", \"boolean\", \"geolocation\", \"hidden\", \"upload\"];\n    var typeGroupCombo = [\"combo\", \"cascadingCombo\", \"radio\", \"list\"];\n\n    if (typeGroupBasic.indexOf(type) !== -1) {\n      params.value = data.value;\n      return;\n    }\n\n    if (typeGroupCombo.indexOf(type) !== -1) {\n      for (var i = 0, len = params.data.length; i < len; i++) {\n        if (params.data[i].id == data.value) {\n          params.value = [{ id: data.value, value: params.data[i].value }];\n        }\n      }\n\n      return;\n    }\n\n    if (type === \"search\") {\n      for (var j = 0, lengthData = params.data.length; j < lengthData; j++) {\n        if (params.data[j].id == data.value.id) {\n          params.value = data.value;\n        }\n      }\n      return;\n    }\n\n    if (type === \"image\") {\n      params.value = data;\n      return;\n    }\n\n    if (type === \"grid\") {\n      params.data.records = data.value.length;\n      params.data.total = 1;\n      params.data.page = 1;\n\n      var lengthColumns = params.data.columns.length;\n      var tmpEditAndVisible = [];\n      var lengthRows = data.value.length;\n\n      for (var row = 0; row < lengthRows; row++) {\n        // Add random value\n        var idRow = bizagi.util.randomNumber();\n\n        var tmpElement = [];\n        var tempRow = [];\n\n        tmpElement[tmpElement.length] = idRow;\n\n        for (var col = 0; col < lengthColumns; col++) {\n          var index = typeof data.value[row][col] !== \"undefined\" ? params.data.columns.indexOf(data.value[row][col].xpath) : -1;\n\n          if (index != -1) {\n            tempRow[index] = data.value[row][col];\n          }\n\n          tempRow[col] = typeof tempRow[col] === \"undefined\" ? {} : tempRow[col];\n          tmpElement[tmpElement.length] = \"true\";\n        }\n\n        params.data.rows.push($.merge([idRow], tempRow));\n        tmpEditAndVisible[tmpEditAndVisible.length] = tmpElement;\n      }\n\n      params.data.editable = tmpEditAndVisible;\n      params.data.visible = tmpEditAndVisible;\n\n      return;\n    }\n\n    // No type supported\n    try {\n      params.value = data.value;\n    } catch (e) {\n    }\n\n    bizagi.log(type + \" not supported in render factory\", data, \"error\");\n    return null;\n  },\n\n  /**\r\n      * This method simulate a summary response\r\n      * @param {} params\r\n      * @returns {} Returns a promise\r\n      */\n  getSummary: function getSummary(params) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err)\n      def.resolve($.extend(doc, {\n        processPath: \"/\",\n        currentState: doc.workItems,\n        countAssigness: 0,\n        countEvents: 0,\n        isOpen: doc.isOpen.toString(),\n        countSubProcesses: 0 }));else\n\n\n      def.reject(err);\n    });\n\n    return def.promise();\n  },\n\n  /*\r\n     *   This method save the form info in the DB\r\n     *   Returns a promise\r\n     */\n  saveFormInfo: function saveFormInfo(params, data) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.dbCases.get(params.idCase, function (err, doc) {\n      if (!err) {\n        self.mergeDataDocument(data, doc, self.getFormData(doc.idWfClass.toString())).\n        done(function (resp) {\n\n          doc = self.mergeData(data, doc, resp);\n\n          self.dbCases.put(doc, function (error, response) {\n            if (!error)\n            def.resolve(response);else\n\n            def.reject(error);\n          });\n        });\n\n      } else {\n        def.reject(err);\n      }\n    });\n\n    return def.promise();\n  },\n\n  mergeDataDocument: function mergeDataDocument(data, doc, form) {\n    var defer = new $.Deferred();\n    var response = {};\n\n    $.when(form).done(function (resp) {\n\n      for (prop in data) {\n        if (prop != \"h_action\") {\n          response[prop] = {};\n          response[prop].value = data[prop];\n          fillForm(resp.form.elements, {\n            key: prop,\n            value: data[prop] });\n\n        }\n      }\n\n      function fillForm(element, datafill) {\n        if (element.length && element.length > 0) {\n          for (var i = 0, len = element.length; i < len; i++) {\n            fillForm(element[i], datafill);\n          }\n        } else {\n          if (element.container) {\n            fillForm(element.container.elements, datafill);\n          } else {\n            if (element.render.properties.xpath == datafill.key) {\n              response[datafill.key].DataType = element.render.properties.dataType || \"\";\n              response[datafill.key].type = element.render.properties.type || \"\";\n\n              // Remove empty object of the Collection\n              if (!bizagi.util.isEmpty(response[datafill.key])) {\n                var lengthRows = response[datafill.key].value.length;\n\n                for (var row = 0; row < lengthRows; row++) {\n                  if (!bizagi.util.isEmpty(response[datafill.key].value[row])) {\n\n                    if (response[datafill.key].type === \"image\") {\n                      var url = response[datafill.key].value[row] || \"\";\n\n                      response[datafill.key].value = url.replace(/^data:.*;base64,/, \"\");\n                    } else {\n                      var tempDataColumn = [];\n                      var lengthCols = response[datafill.key].value[row].length;\n\n                      for (var col = 0; col < lengthCols; col++) {\n                        if (!bizagi.util.isEmpty(response[datafill.key].value[row][col])) {\n                          tempDataColumn.push(response[datafill.key].value[row][col]);\n                        }\n                      }\n\n                      response[datafill.key].value[row] = tempDataColumn;\n                    }\n                  }\n                }\n              }\n            }\n\n          }\n        }\n      }\n\n      defer.resolve(response);\n    });\n\n    return defer.promise();\n  },\n\n  mergeData: function mergeData(data, doc, resp) {\n\n    if (data.h_action == \"next\") {\n      doc.isOpen = false;\n    }\n\n    doc.data = doc.data || {};\n\n    for (var i in resp) {\n\n      var assigned = false;\n\n      for (var j in doc.data) {\n\n        if (i == j) {\n\n          if (bizagi.util.isEmpty(resp[i]) || bizagi.util.isEmpty(resp[i].value)) {\n            delete doc.data[j];\n            assigned = true;\n          } else {\n            doc.data[j] = resp[i];\n            assigned = true;\n          }\n        }\n      }\n\n      if (!assigned) {\n        doc.data[i] = resp[i];\n      }\n    }\n\n    return doc;\n\n  },\n\n  nativeSaveFormInfo: function nativeSaveFormInfo(data, doc, form) {\n    var self = this;\n    var def = new $.Deferred();\n\n    self.mergeDataDocument(data, doc, form).\n    done(function (resp) {\n      doc = self.mergeData(data, doc, resp);\n      def.resolve(doc);\n    });\n\n    return def.promise();\n  } });","/*\r\n*   Name: Bizagi Database Plugin\r\n*   Author: Bizagi Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handler all db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n$.Class.extend(\"bizagi.workportal.services.pullWorker.old\", {}, {\n  init: function init(params) {\n    var self = this;\n    var queryString = bizagi.readQueryString();\n\n    self.services = params;\n    self.database = params.database;\n\n    var querydisable = queryString && queryString[\"disabledb\"] ? eval(queryString[\"disabledb\"]) : false;\n    self.disabledb = querydisable;\n\n    if (!self.disabledb) {\n      self.dbForms = new PouchDB(\"DataRenderForms\");\n      self.dbCases = new PouchDB(\"DataRenderCases\");\n      self.dbProcessHierarchy = new PouchDB(\"DataProcessesHierarchy\");\n      self.dbProcessRecent = new PouchDB(\"DataProcessesRecent\");\n    }\n\n    self.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    BIZAGI_USER.toLowerCase() + \"-\" + BIZAGI_PROXY_PREFIX.\n    toLowerCase() + \"-\" + BIZAGI_DOMAIN.toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n  },\n\n  pull: function pull() {\n    var self = this;\n\n    if (self.disabledb) {\n      return false;\n    }\n\n    return $.when(self.syncOfflineCases()).\n    done(function () {\n      return true;\n    });\n  },\n\n  /**\r\n      * This function send to the server the offline cases created\r\n      * @param {} argument \r\n      * @returns {} \r\n      */\n  syncOfflineCases: function syncOfflineCases(argument) {\n    var self = this;\n\n    if (typeof self.database !== \"undefined\") {\n      self.synchronizing = self.synchronizing || false;\n\n      if (!self.synchronizing) {\n        self.synchronizing = true;\n        return self.database.getOutboxCases().done(function (response) {\n          var array_cases = [];\n          for (var i = 0; i < response.total_rows; i++) {\n            var obj = response.rows[i].value;\n            var objToSend = [];\n            for (var item in obj.data) {\n              if (item != \"h_action\") {\n                objToSend.push({\n                  \"domain\": typeof BIZAGI_DOMAIN !== \"undefined\" ? BIZAGI_DOMAIN : \"domain\",\n                  \"user\": typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n                  \"xpath\": item,\n                  \"value\": self.processDataValues(obj.data[item].value, obj.data[item].type),\n                  \"DataType\": obj.data[item].DataType,\n                  \"type\": obj.data[item].type });\n\n              }\n            }\n\n            obj = $.extend(obj, { \"objToSend\": objToSend });\n\n            // idWfClass\n            array_cases.push(\n            self.services.syncOfflineCases(obj).pipe(\n            function (rta) {\n              var formData = decodeURIComponent(this.data).split('&');\n              for (var i = formData.length - 1; i >= 0; i--) {\n                var pivot = formData[i].split(\"=\");\n                if (pivot[0] == \"idCase\") {\n                  return self.database.deleteCase({\n                    idCase: pivot[1] });\n\n                }\n              }\n              // When it returns \"yes\" then remove the case of database\n            }, function (fail) {\n              bizagi.log(fail);\n            }));\n\n\n          }\n\n          return $.when.apply($, array_cases).pipe(function () {\n            // Show message to successfully synchronization\n            self.synchronizing = false;\n            return true;\n          });\n        });\n      }\n    }\n  },\n\n  processDataValues: function processDataValues(data, fileType) {\n    var self = this;\n    if ($.type(data) == \"array\" && fileType == \"upload\") {\n\n      for (var i = 0; i < data.length; i++) {\n        data[i] = data[i].filter(function (element) {\n          return element[\"xpath\"] != \"mimeType\";\n        });\n      }\n\n      return data;\n    }\n\n    if ($.type(data) == \"object\") {\n      // For search\n      if (data.hasOwnProperty(\"id\")) {\n        data = data.id;\n      }\n    }\n\n    if (fileType == \"grid\") {\n      for (var rowPos = 0; rowPos < data.length; rowPos++) {\n        var row = data[rowPos];\n        for (var cellPos = 0; cellPos < row.length; cellPos++) {\n          var cell = row[cellPos];\n          cell.value = self.processDataValues(cell.value);\n        }\n      }\n    }\n\n    return data;\n  } });","/*\r\n*   Name: BizAgi Work Portal Service Context Factory\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This script will define the endpoints to be used based on the given context\r\n*/\n\n$.Class.extend(\"bizagi.workportal.services.context\", {}, {\n  /* \r\n                                                           *   Constructor\r\n                                                           */\n  init: function init(params) {\n    this.context = params.context;\n    this.endPoints = bizagi.workportal.services.getEndPoints(params);\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n  },\n\n  /*\r\n     *   Returns the given url for a specified service\r\n     */\n  getUrl: function getUrl(service) {\n    if (typeof this.endPoints[service] === 'undefined') {\n      bizagi.log(\"Url not found\", \"No endpoint defined for: \" + service);\n    }\n    return this.endPoints[service];\n  },\n\n  setProxyPrefix: function setProxyPrefix(params) {\n    this.proxyPrefix = !bizagi.util.isEmpty(params.proxyPrefix) ? params.proxyPrefix : \"\";\n    this.endPoints = bizagi.workportal.services.getEndPoints(params);\n  } });","/*\r\n*   Name: BizAgi Rendering Services\r\n*   Author: Diego Parra (based on Edward Morales version)\r\n*   Comments:\r\n*   -   This class will provide a facade to access to workportal REST services\r\n*/\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {}, {\n  /* \r\n                                                                                      *   Constructor\r\n                                                                                      */\n  init: function init(params) {\n    // Call base\n    var self = this;\n\n    if (params && typeof params.oldOfflineServicesAlreadyEnabled != \"undefined\") {\n      params.oldOfflineServicesAlreadyEnabled = !bizagi.util.isOfflineFormsV2Supported();\n    }\n\n    self._super(params);\n\n    // Create instance of database services\n    if (!bizagi.util.isOfflineFormsV2Supported()) {\n      if (typeof bizagi.workportal.services.db.old !== \"undefined\") {\n        self.database = new bizagi.workportal.services.db.old();\n      }\n      self.enableOfflineEvents();\n    }\n  },\n\n  enableOfflineEvents: function enableOfflineEvents() {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      self._super();\n    } else\n    {\n      if (bizagi.util.isTabletDevice()) {\n        if (typeof navigator.connection != \"undefined\") {\n          if (typeof Connection !== \"undefined\" && (\n          navigator.connection.type == Connection.NONE || navigator.connection.type == \"unknown\")) {\n            self.online = false;\n          } else\n          {\n            self.online = true;\n          }\n        } else\n        {\n          var queryString = bizagi.readQueryString();\n          var queryoffline = queryString && queryString[\"online\"] ? eval(queryString[\"online\"]) : true;\n          self.online = queryoffline;\n        }\n\n        $(document).off(\"online.services\");\n        $(document).on(\"online.services\", function () {\n          self.online = true;\n          bizagi.log(\"online.services\");\n          self.returnOnlineStatus();\n        });\n\n        $(document).off(\"offline.services\");\n        $(document).on(\"offline.services\", function () {\n          bizagi.log(\"offline.services\");\n          self.online = false;\n        });\n\n      }\n\n      // Execute this trigger in render on next event        \n      $(document).off(\"tryPushData.offline\");\n      $(document).on(\"tryPushData.offline\", function (e) {\n        if (self.online) {\n          self.pushOfflineData();\n        }\n      });\n    }\n  },\n\n  returnOnlineStatus: function returnOnlineStatus() {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      this._super();\n    } else\n    {\n      var self = this;\n      $.when(self.logoutUser()).always(function () {\n        $.when(self.authenticatedUser()).always(function () {\n          $.when(self.pushOfflineData()).always(function (pushStatus) {\n            self.fetchOfflineData(pushStatus);\n          });\n        });\n      });\n    }\n  },\n\n  /*\r\n     * Get all data from server : new case structure, forms data\r\n     */\n  fetchOfflineData: function fetchOfflineData(v2Param) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      this._super(v2Param);\n    } else\n    if (bizagi.util.hasOfflineFormsEnabled()) {\n      var synObject = new bizagi.workportal.services.fetchWorker.old(this);\n      var message = \"\";\n\n      $.when(synObject.fetch()).done(function (data) {\n        bizagi.log(\"Sync Completed\");\n        if (bizagi.util.isTabletDevice()) {\n          message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-successful\") ?\n          bizagi.localization.getResource(\"workportal-mobile-offline-sync-successful\") :\n          \"Successful Synchronization\";\n\n          bizagi.util.showNotification({ text: message, type: \"success\" }); // Localizar texto\n        }\n      }).fail(function (data) {\n        bizagi.log(\"Sync Failed\");\n\n        if (bizagi.util.isTabletDevice()) {\n          if (data !== 0) {\n            message = bizagi.util.isValidResource(\"workportal-mobile-offline-sync-fail\") ?\n            bizagi.localization.getResource(\"workportal-mobile-offline-sync-fail\") :\n            \"Failed Synchronization\";\n            bizagi.util.showNotification({ text: message, type: \"error\" });\n          }\n        }\n      });\n    }\n  },\n\n  /*\r\n     * put all data to server : new case structure, forms data\r\n     */\n  pushOfflineData: function pushOfflineData() {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super();\n    } else\n    if (bizagi.util.hasOfflineFormsEnabled()) {\n      var self = this;\n      var pullObject = new bizagi.workportal.services.pullWorker.old(this);\n      return $.when(pullObject.pull()).\n      then(function (data) {\n        bizagi.log(\"Offline cases syncronized, all data sended\");\n      }, function (cause) {\n        bizagi.log(\"Error syncronizing cases\");\n      });\n    }\n  },\n\n  /*\r\n      * this function send to the server the offline cases created\r\n      */\n  syncOfflineCases: function syncOfflineCases(params) {\n    var self = this;\n    return $.ajax({\n      url: self.serviceLocator.getUrl('offline-sendForm'),\n      data: {\n        idCase: params.idCase,\n        idWFClass: params.idWfClass,\n        awCaseCreationContext: JSON.stringify(params.objToSend),\n        idWorkflow: params.idWfClass },\n\n      type: 'POST',\n      dataType: 'json',\n      serviceType: 'LOAD' });\n\n  },\n\n  /*\r\n     * Retreives Form structure + Form data\r\n     *\r\n     */\n  processesHierarchyTofetchForms: function processesHierarchyTofetchForms(params) {\n    var self = this;\n    var data = {};\n    data['idChangeSet'] = params.changeSet;\n    return $.ajax({\n      url: self.serviceLocator.getUrl('offline-getForms'),\n      data: data,\n      dataType: 'json' });\n\n  },\n\n  /*\r\n     *   Gets the current working user\r\n     */\n  getCurrentUser: function getCurrentUser(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(params);\n    } else\n    {\n      var self = this;\n\n      if (self.online) {\n        return self._super(params);\n      } else\n      {\n        var defer = new $.Deferred();\n\n        // Call ajax and returns promise\n        // save this response in the local storage and get when offline\n        var data = {\n          idUser: 1,\n          user: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n          userName: typeof BIZAGI_USER !== \"undefined\" ? BIZAGI_USER : \"admon\",\n          domain: typeof BIZAGI_DOMAIN !== \"undefined\" ? BIZAGI_DOMAIN : \"domain\",\n          delegateUserName: \"\",\n          idDelegateUser: -1,\n          groupSeparator: \",\",\n          language: \"en-US\",\n          decimalSeparator: \".\",\n          decimalDigits: \"2\",\n          symbol: \"$\",\n          ShortDateFormat: \"M/d/yyyy\",\n          TimeFormat: \"h:mm tt\",\n          LongDateFormat: \"dddd, MMMM d, yyyy\",\n          twoDigitYearMax: 2029,\n          twoDigitYearMaxDelta: 13,\n          uploadMaxFileSize: \"1048576\",\n          isMultiOrganization: \"false\",\n          associatedStakeholders: [],\n          sUserProperties: [] };\n\n\n        defer.resolve(data);\n\n        return defer.promise();\n      }\n    }\n  },\n\n  /*\r\n     *   Return all the available processes in bizagi\r\n     */\n  getAllProcesses: function getAllProcesses(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(params);\n    } else\n    {\n      var self = this;\n      params.inputtray = params.inputtray || \"inbox\";\n      if (params.inputtray == \"inbox\") {\n        return self._super(params);\n      } else\n      {\n        return $.when(self.database.getAllProcesses(params)).pipe(function (response) {\n          response = JSON.parse(response);\n          // Aggrupate workflows by categories\n          if (!!params.skipAggrupate)\n          return response;\n          var responseData = {};\n          var categories = {};\n          var allProcesses = bizagi.localization.getResource(\"workportal-widget-inbox-all-processes\");\n          var allCases = {\n            name: bizagi.localization.getResource(\"workportal-widget-inbox-all-cases\"),\n            path: \"\",\n            category: allProcesses,\n            isFavorite: params.onlyFavorites || false,\n            guidFavorite: \"\",\n            idworkflow: \"\",\n            guidWFClass: \"\",\n            count: 0 };\n\n\n          // Create a default category\n          categories[allProcesses] = [];\n          categories[allProcesses].workflows = [];\n          categories[allProcesses].workflows.push(allCases);\n          if (response.workflows) {\n            $.each(response.workflows.workflow, function (i, workflow) {\n              // Creates the category if it doesn't exist\n              if (!categories[workflow.category]) {\n                categories[workflow.category] = [];\n                categories[workflow.category].workflows = [];\n              }\n\n              // Push the workflow\n              categories[workflow.category].workflows.push(workflow);\n\n              // Sum the cases count                        \n              allCases.count += Number(workflow.count);\n            });\n          }\n\n          // Build result array once grouped\n          responseData.categories = [];\n          for (key in categories) {\n            responseData.categories.push({\n              name: key,\n              workflows: categories[key].workflows });\n\n          }\n          return responseData;\n        });\n\n      }\n    }\n  },\n  /*\r\n     *   Returns all the cases for the current user filtered by a workflow\r\n     */\n  getCasesByWorkflow: function getCasesByWorkflow(params) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(params);\n    } else\n    {\n      params.inputtray = params.inputtray || \"inbox\";\n\n      if (params.inputtray === \"inbox\") {\n        if (self.online) {\n          return self._super(params);\n        } else\n        {\n          var deferred = new $.Deferred();\n\n          var cases = {\n            \"rows\": [],\n            \"totalPages\": 0,\n            \"page\": 1,\n            \"lstIdCases\": [] };\n\n\n          deferred.resolve(cases);\n          return deferred.promise();\n        }\n      } else\n      {\n        var defer = new $.Deferred();\n        $.when(self.database.getCustomizedColumnsData(params)).pipe(function (response) {\n          response = JSON.parse(response);\n          $.each(response.cases.rows, function (key, value) {\n            var newFieldsValue = [];\n\n            //  Set id of case to radnumber\n            response.cases.rows[key][\"radnumber\"] = value.id;\n            $.each(value.fields, function (fieldsKey, fieldsValue) {\n              // when delete element from fields array, each function lose key value\n              if (fieldsValue != undefined) {\n                // Radnumber\n                try {\n                  if (fieldsValue.isRadNumber != undefined && fieldsValue.isRadNumber == \"true\") {\n                    response.cases.rows[key][\"radnumber\"] = fieldsValue.Value;\n                  } else if (fieldsValue.workitems != undefined) {\n                    response.cases.rows[key][\"workitems\"] = fieldsValue.workitems;\n                  } else {\n                    newFieldsValue.push(fieldsValue);\n                  }\n                } catch (e) {\n                }\n              }\n            });\n\n            // Update Fields \n            response.cases.rows[key]['fields'] = newFieldsValue;\n          });\n          defer.resolve(response.cases);\n        });\n        return defer.promise();\n      }\n    }\n  },\n  /*\r\n     *  Get Menu Authorization\r\n     */\n  getMenuAuthorization: function getMenuAuthorization() {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super();\n    } else\n    {\n      var self = this;\n\n      if (self.online) {\n        return self._super();\n      } else {\n        // Call ajax and returns promise\n        var defer = new $.Deferred();\n        var data = {\n          \"permissions\": [\n          { \"Cases\": [\"NewCase\", \"Pending\", \"Closed\", \"Search\"] },\n          {\n            \"AnalysisReports\": [\n            \"BAMProcess\", \"BAMTask\", \"AnalyticsProcess\", \"AnalyticsTask\", \"AnalyticsSensor\",\n            \"AnalysisQueries\", \"BAMResourceMonitor\"] },\n\n          {\n            \"Admin\": [\n            \"UserAdmin\", \"Licenses\", \"EntityAdmin\", \"CaseAdmin\", \"AlarmAdmin\", \"EncryptionAdmin\",\n            \"MobileUpdatesAdmin\", \"AsynchronousWorkitemRetries\", \"UserPendingRequests\",\n            \"AuthenticationLogQuery\", \"BusinessPolicies\", \"Profiles\", \"UserDefaultAssignation\",\n            \"GRDimensionAdmin\", \"ThemeBuilder\"] },\n\n          { \"CurrentUserAdministration\": [\"CurrentUser\"] }, { \"LogOut\": [] }, { \"Search\": [] },\n          { \"SmartFolders\": [] }, { \"CustomFolders\": [] }, { \"BizagiQueries\": [] }, { \"AnalysisQueries\": [] },\n          { \"StateLog\": [] }, { \"PrintableVersion\": [] }] };\n\n\n\n        defer.resolve(data);\n\n        return defer.promise();\n      }\n    }\n  },\n  /*\r\n     *   Gets the inbox summary for the current logged user\r\n     *   Returns a promise of the data being retrieved\r\n     */\n  getInboxSummary: function getInboxSummary(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super();\n    } else\n    {\n      var self = this;\n      var enableDefaultMethod = self.online;\n      if (params && (params.inputtray == \"false\" || params.inputtray == \"true\")) {\n        enableDefaultMethod = false;\n      }\n      if (enableDefaultMethod) {\n        return self._super(params);\n      } else {\n        // Call ajax and returns promise\n        var defer = new $.Deferred();\n        $.when('{\"inboxSummary\":{\"Red\":7,\"Yellow\":0,\"Green\":0,\"Black\":0,\"All\":7}}').pipe(function (response) {\n          var data = JSON.parse(response);\n          defer.resolve(data[\"inboxSummary\"]);\n        });\n        return defer.promise();\n      }\n    }\n  },\n  /*\r\n     *   Returns the available categories filtered by a parent category\r\n     *   If not parent category is sent, it will return the base categories\r\n     */\n  getCategories: function getCategories(params) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(params);\n    } else\n    {\n      if (self.online) {\n        return self._super(params);\n      } else\n      {\n        // Define data\n        params = params || {};\n        var data = {};\n\n        // Required params\n        if (params.idCategory)\n        data[\"idCategory\"] = params.idCategory;\n        if (params.idApp)\n        data[\"idApp\"] = params.idApp;\n\n        data[\"enableOfflineForm\"] = params.enableOfflineForm || false;\n\n\n        data[\"groupByApp\"] = params.groupByApp || false;\n\n        // Call ajax and returns promise\n        return self.database.getCategories(data);\n      }\n    }\n  },\n\n  /* \r\n     * CREATE NEW CASES\r\n     */\n  createNewCase: function createNewCase(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      return self.database.createNewCase(params);\n    }\n  },\n\n  getWorkitems: function getWorkitems(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      if (bizagi.util.isNativePluginSupported() && typeof bizagiapp.getCase !== \"undefined\") {\n        return self.getNativeWorkItems(params);\n      } else\n      {\n        return self.database.getWorkitems(params);\n      }\n    }\n  },\n\n  getNativeWorkItems: function getNativeWorkItems(params) {\n    var defer = new $.Deferred();\n\n    bizagiapp.getCase(params.idCase, function (response) {\n\n      var workItems = JSON.parse(response);\n\n      defer.resolve(workItems);\n\n    }, function (response) {\n      defer.reject(response);\n    });\n\n    return defer.promise();\n  },\n\n  getCaseSummary: function getCaseSummary(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      return self.database.getSummary(params);\n    }\n  },\n\n  /*\r\n     *   Delete offline cases created localy\r\n     *   return a promise\r\n     */\n  deleteCase: function deleteCase(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(params);\n    } else\n    {\n      return self.database.deleteCase(params);\n    }\n  },\n\n  /*\r\n     *   Get subprocesses\r\n     *   return a promise\r\n     */\n  getCaseSubprocesses: function getCaseSubprocesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n      defer.resolve({ subProcesses: [] });\n      return defer.promise();\n    }\n  },\n\n  /**\r\n     * This service get all overrides keys within configuration project\r\n     *\r\n     * @return {json}\r\n     */\n  getOverrides: function getOverrides() {\n    return {};\n  },\n\n  /**\r\n      * Return all the available cases in bizagi and thinking for mobile response\r\n      * @param {} params: inputtray:  inbox | outbox (false) | drafts (true)\r\n      * @returns {} \r\n      */\n  getCasesListBeta: function getCasesListBeta(params) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(params);\n    } else\n    {\n      var self = this;\n      params = params || {};\n\n      params.inputtray = params.inputtray || \"inbox\";\n\n      if (params.inputtray === \"inbox\" || params.inputtray == \"outbox-finished\") {\n        if (self.online && params.inputtray === \"inbox\") {\n          return self._super(params);\n        } else {\n          var deferred = new $.Deferred();\n\n          var response = { \"page\": 1, \"totalPages\": 1, \"elements\": [] };\n          deferred.resolve(response);\n\n          return deferred.promise();\n        }\n      } else\n      {\n        var defer = new $.Deferred();\n        $.when(self.database.getCasesList(params)).\n        pipe(function (response) {\n          response = JSON.parse(response);\n\n          var taskFeedData = self.getTaskFeedData(response);\n\n          defer.resolve(taskFeedData);\n        });\n\n        return defer.promise();\n      }\n    }\n  },\n\n  getMobileCasesList: function getMobileCasesList(params) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported() || params.inputtray === \"inbox\") {\n      return self._super(params);\n    } else\n    {\n      return getCasesListBeta(params);\n    }\n  },\n\n  /*\r\n     * Customize Columns\r\n     */\n  getTaskFeedData: function getTaskFeedData(response) {\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return this._super(response);\n    } else\n    {\n      var overdue = bizagi.localization.getResource(\"workportal-taskfeed-overdue\");\n      var today = bizagi.localization.getResource(\"workportal-taskfeed-today\");\n      var tomorrow = bizagi.localization.getResource(\"workportal-taskfeed-tomorrow\");\n      var upcoming = bizagi.localization.getResource(\"workportal-taskfeed-upcomming\");\n\n      var groupedData = {\n        elements: [],\n        page: response.page,\n        totalPages: response.totalPages,\n        advanceSearch: false };\n\n\n      var actualDate = new Date();\n      var actualMonth = actualDate.getMonth();\n      var actualDay = actualDate.getDate();\n      var actualYear = actualDate.getFullYear();\n\n      for (var counter = 0; response.elements.length > counter; counter++) {\n        var tmpElement = response.elements[counter];\n        var status = {};\n\n        var originalEndDate = tmpElement[3];\n\n        if (tmpElement[3] !== \"\") {\n          var tmpdate = new Date(tmpElement[3]);\n          var tmpDay = tmpdate.getDate();\n          var tmpMonth = tmpdate.getMonth();\n          var tmpYear = tmpdate.getFullYear();\n          var dateDiff = new Date(tmpYear, tmpMonth, tmpDay, 0, 0, 0) -\n          new Date(actualYear, actualMonth, actualDay, 0, 0, 0);\n\n          if (dateDiff < 0) {\n            tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]),\n            \"MMMM dd | hh:mm tt\");\n            status = { group: \"1|\" + overdue, state: \"red\", type: \"overdue\", icon: \"overdue\" };\n          } else {\n            if (actualMonth === tmpMonth && actualDay === tmpDay) {\n              tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n\n              // Define if the case is overdue\n              if (tmpdate.getTime() < actualDate.getTime()) {\n                status = {\n                  group: \"2|\" + today + \", \" +\n                  bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"),\n                  state: \"red\",\n                  type: \"today\",\n                  icon: \"overdue\" };\n\n              } else {\n                status = {\n                  group: \"2|\" + today + \", \" +\n                  bizagi.util.dateFormatter.formatDate(actualDate, \"MMMM dd\"),\n                  state: \"yellow\",\n                  type: \"today\",\n                  icon: \"ontime\" };\n\n              }\n            } else if (actualMonth === tmpMonth && actualDay + 1 === tmpDay) {\n              tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"hh:mm tt\");\n              status = {\n                group: \"3|\" + tomorrow + \", \" +\n                bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd\"),\n                state: \"yellow\",\n                type: \"tomorrow\",\n                icon: \"ontime\" };\n\n            } else {\n              tmpElement[3] = bizagi.util.dateFormatter.formatDate(new Date(tmpElement[3]), \"MMMM dd | hh:mm tt\");\n              status = { group: \"4|\" + upcoming, state: \"green\", type: \"upcoming\", icon: \"upcoming\" };\n            }\n          }\n        } else {\n          tmpElement[3] = \"--\";\n          status = { group: \"1|\" + overdue, state: \"red\", type: \"overdue\", icon: \"overdue\" };\n        }\n\n        groupedData.elements.push($.extend({}, tmpElement, status,\n        { \"endDate\": originalEndDate, \"idworkitem\": tmpElement[1] }));\n      }\n\n      return groupedData;\n    }\n  },\n\n  /*\r\n     * Render Details\r\n     * @param idWorkitem\r\n     */\n  summaryCaseDetails: function summaryCaseDetails(options) {\n    var self = this;\n    var params = options || {};\n\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (bizagi.util.isOfflineFormsV2Supported() || !params.isOfflineForm) {\n      return self._super(params);\n    } else {\n      var def = $.Deferred();\n      var idWorkitem = options[\"idWorkitem\"] || 0;\n\n      $.when(self.getCaseSummaryDataContent(options)).\n      done(function (data) {\n\n        data.currentState = data.currentState || [];\n        var dataCurrentStateLength = data.currentState.length;\n\n        // Show or hide tabs\n        data[\"showEvents\"] = data[\"countEvents\"] >= 1 ? true : false;\n        data[\"showParentProcess\"] = data[\"idParentCase\"] >= 1 ? true : false;\n        data[\"parentProcess\"] = {\n          'displayName': data[\"parentDisplayName\"],\n          'idCase': data[\"idParentCase\"] };\n\n\n        data[\"isClosed\"] = data[\"isOpen\"] == \"true\" ? false : true;\n        data[\"showAssignees\"] = data[\"countAssigness\"] >= 1 ? true : false;\n        data[\"showSubProcess\"] = data[\"countSubProcesses\"] >= 1 ? true : false;\n        data[\"showForm\"] = data[\"hasGlobalForm\"] == \"true\" ? true : false;\n        data[\"allowsReassign\"] = \"false\";\n\n        for (var i = 0; i < dataCurrentStateLength; i++) {\n          if (data[\"currentState\"][i][\"idWorkItem\"] == idWorkitem) {\n            data[\"allowsReassign\"] = data[\"currentState\"][i][\"allowsReassign\"];\n          }\n        }\n\n        // edit original data, no show events in activities tab\n        var currentStateTypes = [];\n        var m = 0; // counter for new activities array\n        for (var j = 0; j < data[\"currentState\"].length; j++) {\n          if (data[\"currentState\"][j][\"isEvent\"] == \"false\" &&\n          data[\"currentState\"][j][\"assignToCurrentUser\"] == \"true\" &&\n          data[\"currentState\"][j][\"idWorkItem\"] != idWorkitem) {\n            currentStateTypes[m++] = data[\"currentState\"][j];\n          }\n        }\n\n        data[\"currentStateTypes\"] = currentStateTypes;\n        data[\"showActivities\"] = currentStateTypes.length >= 1 ? true : false;\n\n        def.resolve(data);\n      });\n\n      return def.promise();\n    }\n  },\n\n  /**\r\n     *  Get json from cases service\r\n     */\n  getCaseSummaryDataContent: function getCaseSummaryDataContent(options) {\n    var self = this;\n    if (bizagi.util.isOfflineFormsV2Supported()) {\n      return self._super(options);\n    } else\n    {\n      var promise = new $.Deferred();\n\n      $.when(self.getCaseSummary(options)).\n      done(function (data) {\n        // Completes data\n        data.taskState = self.icoTaskState;\n        data.process = data.process ? data.process : \"\";\n\n        if (data.createdBy) {\n          data.createdByName = data.createdBy.Name;\n          data.createdByUserName = data.createdBy.userName;\n          data.caseDescription = data.caseDescription == '' ? '' : data.caseDescription;\n          data.processPath = data.processPath.replace(/\\//g, ' > ') + data.process;\n          data.showWorkOnIt = true;\n        }\n\n        promise.resolve(data);\n      });\n      return promise.promise();\n    }\n  },\n\n  /*\r\n     *   Returns the data for the inbox grid view\r\n     */\n  getCustomizedColumnsData: function getCustomizedColumnsData(params) {\n    var self = this;\n\n    params.inputtray = params.inputtray || \"inbox\";\n\n    if (bizagi.util.isOfflineFormsV2Supported() || params.inputtray === \"inbox\") {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n\n      $.when(self.database.getCustomizedColumnsNewData(params)).\n      pipe(function (response) {\n        defer.resolve(JSON.parse(response));\n      });\n\n      return defer.promise();\n    }\n  },\n  /*\r\n     *   Returns the recent process\r\n     */\n  getRecentProcesses: function getRecentProcesses(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      return self.database.getRecentProcesses(params);\n    }\n  },\n\n  /*\r\n     *   Start process in BizAgi\r\n     */\n  startProcess: function startProcess(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n\n      var data = {\n        hasStartForm: false,\n        idProcess: params.idProcess,\n        displayName: params.displayName,\n        caseInfo: {} };\n\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  },\n\n  /**\r\n      * Get stakeholder shortCurts\r\n      * @param {} params \r\n      * @returns {} \r\n      */\n  getShortCuts: function getShortCuts(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n      var data = [];\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  },\n\n  /**\r\n      * Returns the available list of searches\r\n      * @returns {} \r\n      */\n  getSearchLists: function getSearchLists() {\n    var self = this;\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super();\n    } else\n    {\n      var defer = new $.Deferred();\n      var data = [];\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  },\n\n  /**\r\n      * Get the icon of a given collection\r\n      * @param params\r\n      */\n  getCollectionIcon: function getCollectionIcon(params) {\n    var self = this;\n    params = params || {};\n\n    if (bizagi.util.isOfflineFormsV2Supported() || self.online) {\n      return self._super(params);\n    } else\n    {\n      var defer = new $.Deferred();\n      var data = [];\n      defer.resolve(data);\n\n      return defer.promise();\n    }\n  } });","/*\r\n*   Name: BizAgi Diagnostisc Dabase Plugin\r\n*   Author: Mobile Team\r\n*   Comments:\r\n*   -   This script creates a plugin to handle Mobile diagnostics db functionalities\r\n*   -   Pre-requisite pouchDB\r\n*/\n\nbizagi.workportal.diagnostics = bizagi.workportal.diagnostics || {};\n$.Class.extend(\"bizagi.workportal.diagnostics.db\", {}, {\n  /**\r\n                                                          * Constructor\r\n                                                          */\n  init: function init() {\n    this.globalId = typeof BIZAGI_USER != \"undefined\" ?\n    (\"\" + BIZAGI_USER + \"-\" + BIZAGI_PROXY_PREFIX + \"-\" + BIZAGI_DOMAIN).toLowerCase() :\n    \"admon\" + \"-\" + \"http://localhost/bizagiR100x\" + \"-\" + \"domain\";\n    this.createDatabases();\n  },\n\n  /**\r\n      * Create all the tables required\r\n      */\n  createDatabases: function createDatabases() {\n    var globalIdHash = this.globalId.hashCode();\n    this.dbErrors = new PouchDB(\"Diag_Errors_\" + globalIdHash, { auto_compaction: true });\n  },\n\n  /**\r\n      * Destroy all databases\r\n      * Returns a promise that is resolved when all databases were successfully destroyed\r\n      */\n  deleteDatabases: function deleteDatabases() {\n    var deferred = $.Deferred();\n    var databases = [\n    this.dbErrors];\n\n\n    var deletedDatabasesCount = 0;\n    var destroyCallback = function destroyCallback(err, info) {\n      if (err) {\n        deferred.reject(err);\n      } else\n      {\n        deletedDatabasesCount++;\n        if (deletedDatabasesCount == databases.length) {\n          deferred.resolve();\n        }\n      }\n    };\n\n    databases.forEach(function (currentDatabase) {\n      currentDatabase.destroy(destroyCallback);\n    });\n    return deferred.promise();\n  },\n\n  /**\r\n      * Destroy an recreate empty tables\r\n      */\n  restartDatabases: function restartDatabases() {\n    var self;\n    return self.deleteDatabases().\n    always(function () {\n      self.createDatabases();\n    });\n  } });","/**\r\n * Extension for bizagi.workportal.diagnostics.db\r\n * All the functionalities related with diagnostics errors in db\r\n */\n\nbizagi.workportal.diagnostics.db.extend(\"bizagi.workportal.diagnostics.db\", {}, {\n\n  /**\r\n                                                                                   * Save an error with their correct id\r\n                                                                                   * @param {*} id \r\n                                                                                   * @param {*} error \r\n                                                                                   */\n  saveError: function saveError(id, error) {\n    try {\n      error = JSON.parse(JSON.stringify(error));\n      error._id = \"\" + id;\n      return bizagi.util.db.saveDocument(this.dbErrors, error);\n    }\n    catch (e) {\n      bizagi.util.console.error(this.Class.fullName + \": Error parsing the error object\", e, error);\n    }\n\n  },\n\n  /**\r\n      * Get an error by their id\r\n      * @param {} id \r\n      */\n  getError: function getError(id) {\n    return bizagi.util.db.getDocument(this.dbErrors, \"\" + id);\n  },\n\n  getErrorsList: function getErrorsList(maxErrors) {\n    var getErrorsQuery = {\n      map: function map(error) {\n        if (error.timestamp) {\n          emit(error.timestamp);\n        }\n      } };\n\n\n    var queryArgs = {\n      include_docs: true,\n      limit: maxErrors,\n      conflicts: false,\n      descending: false };\n\n\n    return bizagi.util.db.executeQuery(this.dbErrors, getErrorsQuery, queryArgs).\n    then(function (queryRes) {\n      return queryRes.rows.map(function (row) {\n        if (row.doc) {\n          delete row.doc._id;\n          delete row.doc._rev;\n        }\n        return row.doc;\n      });\n    });\n  },\n\n  /**\r\n      * Delete an error by their id\r\n      * @param {*} id \r\n      */\n  deleteError: function deleteError(id) {\n    return bizagi.util.db.deleteDocument(this.dbErrors, \"\" + id);\n  } });","/**\r\n *   Name:   Bizagi diagnostics service\r\n *   Author: Bryan Alejandro Cubillos Prieto\r\n *   Date:   09/21/2020\r\n *   Comments:\r\n *   =>      This is a new service for Bizagi diagnostics observer, required for centralized behavior\r\n */\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {\n\n  /*************************************************************************************************\r\n                                                                                   *          COMPONENT LOCAL DATA\r\n                                                                                   *************************************************************************************************/\n  DIAGNOSTICS_OBSERVER_COMPONENT_NAME: 'bizagi.workportal.services.service.diagnostics.observer',\n  DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED: document.body,\n  DIAGNOSTICS_OBSERVER_MAX_EVENTS_IN_QUEUE: 10,\n  DIAGNOSTICS_OBSERVER_MAX_PATH_EVENT: 5,\n  DIAGNOSTICS_OBSERVER_OBSERVER_OPTIONS: {\n    attributes: true,\n    childList: true,\n    characterData: true,\n    subtree: true },\n\n  DIAGNOSTICS_OBSERVER_MAX_SIZE_HTML_EVENT_MB: 1,\n  DIAGNOSTICS_OBSERVER_COMPONENT_TYPES: {\n    FORM: 'form',\n    DISCUSSIONS: 'discussions',\n    ACTION_SHEET: 'action-sheet',\n    FILES: 'files',\n    MAIN_MENU: 'main-menu',\n    SUMMARY_CASE: 'summary-case' } },\n\n{\n  /*************************************************************************************************\r\n   *          CONSTRUCTOR\r\n   *************************************************************************************************/\n  init: function init(params) {\n\n    // Call base\n    var self = this;\n    self._super(params);\n\n    // flag\n    self.diagnosticsServiceEnabled = bizagi.util.isMobileErrorTracesEnabled();\n\n    if (self.diagnosticsServiceEnabled) {\n\n      // set default variables\n      self.setDiagnosticsObserverDefaultData();\n\n      // Behavior\n      self.configureDiagnosticsObserverHandlers();\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          LIFE CYCLE\r\n      *************************************************************************************************/\n  setDiagnosticsObserverDefaultData: function setDiagnosticsObserverDefaultData() {\n    var self = this;\n    self.diagnosticsObserverEventsQueue = [];\n    self.MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n  configureDiagnosticsObserverHandlers: function configureDiagnosticsObserverHandlers() {\n    var self = this;\n\n    // Is required to get the first avents before DOM is ready\n    self.setTouchEndObserver();\n\n    // Observer\n    self.eventsObserver();\n  },\n\n  setTouchEndObserver: function setTouchEndObserver() {\n    var self = this;\n    window.ontouchend = null;\n    window.ontouchend = function (element) {\n      self.addDiagnosticsObsercerEvent(self.getEventObject(element));\n    };\n  },\n\n  eventsObserver: function eventsObserver() {\n    var self = this;\n\n    $(self.Class.DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED).ready(function () {\n      var observer = new self.MutationObserver(function () {\n        self.setTouchEndObserver();\n      });\n      observer.observe(self.Class.DIAGNOSTICS_OBSERVER_ELEMENT_OBSERVED, self.Class.DIAGNOSTICS_OBSERVER_OBSERVER_OPTIONS);\n    });\n  },\n\n  getQueueListEvents: function getQueueListEvents() {\n    var self = this;\n    return self.diagnosticsObserverEventsQueue;\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE FUNCTIONS\r\n      *************************************************************************************************/\n  getEventObject: function getEventObject(element) {\n    var self = this;\n    return {\n      type: element.type,\n      componentType: element.composedPath ? self.getDiagnosticsElementComponentType(element.composedPath()) : undefined,\n      dateTime: bizagi.util.getCurrentDatetime(),\n      srcElement: element.composedPath ? self.getDiagnosticsElementPath(element.composedPath()) : undefined };\n\n  },\n\n  addDiagnosticsObsercerEvent: function addDiagnosticsObsercerEvent(element) {\n    var self = this;\n    if (self.diagnosticsObserverEventsQueue.length >= self.Class.DIAGNOSTICS_OBSERVER_MAX_EVENTS_IN_QUEUE) {\n      self.diagnosticsObserverEventsQueue.shift();\n    }\n    self.diagnosticsObserverEventsQueue.push(element);\n  },\n\n  getDataservice: function getDataservice() {\n    return bizagiWorkportal.deviceFactory.workportal.dataService;\n  },\n\n  getDiagnosticsElementPath: function getDiagnosticsElementPath(sourcePath) {\n    var self = this;\n    var pathList = [];\n\n    for (j = 0; j < sourcePath.length && j < self.Class.DIAGNOSTICS_OBSERVER_MAX_PATH_EVENT; j++) {\n\n      var parent = $(sourcePath[j]);\n\n      var parentProperties = {\n        id: parent.prop(\"id\"),\n        \"class\": parent.prop(\"class\"),\n        text: parent.prop(\"innerText\") };\n\n\n      pathList.push(parentProperties);\n    }\n\n    // This is a hack for size html events\n    var sizeEventHtml = bizagi.util.getSizeJsonObjectInMegaBytes(pathList);\n\n    return sizeEventHtml < self.Class.DIAGNOSTICS_OBSERVER_MAX_SIZE_HTML_EVENT_MB ? pathList : [];\n  },\n\n  getDiagnosticsElementComponentType: function getDiagnosticsElementComponentType(sourcePath) {\n    var self = this;\n    var validateElement = self.validateDiagnosticsIfContainsElement;\n\n    for (j = 0; j < sourcePath.length; j++) {\n      var parent = $(sourcePath[j]);\n\n      var type = self.getDiagnosticsElementComponentTypeByClass(parent);\n      if (type) {\n        return type;\n      }\n\n      type = self.getDiagnosticsElementComponentTypeById(parent);\n      if (type) {\n        return type;\n      }\n\n      if (self.validateDiagnosticsKendoView(parent) && validateElement('>div.km-content', parent)) {\n        if (validateElement('>div.km-content >div.bz-form', parent)) {\n          return self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FORM;\n        } else if (validateElement('>div.km-content div.bz-wp-box-discussion', parent) || validateElement('>div.km-content div.ui-bz-wp-discussions-box-main', parent)) {\n          return self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.DISCUSSIONS;\n        } else if (validateElement('>div.km-content div.bz-wp-box-files', parent)) {\n          return self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FILES;\n        }\n      }\n    }\n\n    return bizagi.util.getLastProcessInboxInputTray();\n  },\n\n  getDiagnosticsElementComponentTypeByClass: function getDiagnosticsElementComponentTypeByClass(parent) {\n    var self = this;\n    var type = undefined;\n\n    if (parent.hasClass(\"bz-form\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FORM;\n    } else if (parent.hasClass(\"summary-case\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.SUMMARY_CASE;\n    } else if (parent.hasClass(\"bz-action-sheet\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.ACTION_SHEET;\n    } else if (parent.hasClass(\"bz-wp-box-discussion\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.DISCUSSIONS;\n    } else if (parent.hasClass(\"bz-wp-box-files\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.FILES;\n    } else if (parent.hasClass(\"menu-content\")) {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.MAIN_MENU;\n    }\n    return type;\n  },\n\n  getDiagnosticsElementComponentTypeById: function getDiagnosticsElementComponentTypeById(parent) {\n    var self = this;\n    var type = undefined;\n\n    if (parent.attr('id') == 'summary-case') {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.SUMMARY_CASE;\n    } else if (parent.attr('id') == 'menu-content') {\n      type = self.Class.DIAGNOSTICS_OBSERVER_COMPONENT_TYPES.MAIN_MENU;\n    }\n    return type;\n  },\n\n  validateDiagnosticsKendoView: function validateDiagnosticsKendoView(parent) {\n    return parent.hasClass(\"km-view\") && parent.attr(\"data-role\") == 'view';\n  },\n\n  validateDiagnosticsIfContainsElement: function validateDiagnosticsIfContainsElement(element, parent) {\n    return $(element, parent).length > 0;\n  } });","/**\r\n *   Name:   Bizagi diagnostics service\r\n *   Author: Bryan Alejandro Cubillos Prieto\r\n *   Date:   09/25/2020\r\n *   Comments:\r\n *   =>      This is a new service base for Bizagi diagnostics, required for centralized behavior\r\n */\n\nbizagi.workportal.services.service.extend(\"bizagi.workportal.services.service\", {\n\n  /*************************************************************************************************\r\n                                                                                   *          COMPONENT LOCAL DATA\r\n                                                                                   *************************************************************************************************/\n  DIAGNOSTICS_COMPONENT_NAME: 'bizagi.workportal.services.service.diagnostics.error.observer',\n  DIAGNOSTICS_WAIT_APPLICATION_STARTED: 45000 },\n{\n\n  /*************************************************************************************************\r\n   *          CONSTRUCTOR\r\n   *************************************************************************************************/\n  init: function init(params) {\n\n    // Call base\n    var self = this;\n    self._super(params);\n\n    // flag\n    self.diagnosticsServiceEnabled = bizagi.util.isMobileErrorTracesEnabled();\n    if (self.diagnosticsServiceEnabled) {\n\n      // Behavior\n      self.configureDiagnosticsErrorObserverHandlers();\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE METHODS\r\n      *************************************************************************************************/\n  configureDiagnosticsErrorObserverHandlers: function configureDiagnosticsErrorObserverHandlers() {\n    var self = this;\n\n    // for catch any error in jQuery\n    window.onerror = function (message, source, line, col, error) {\n      self.sendDiagnosticsError(error, message, source, line);\n    };\n\n    // for read any error in ajax\n    setTimeout(function () {\n      self.getErrorsInAjaxImplementation();\n    }, self.Class.DIAGNOSTICS_WAIT_APPLICATION_STARTED);\n  },\n\n  sendDiagnosticsError: function sendDiagnosticsError(error, message, source, line) {\n    var self = this;\n    var dataserviceInstance = self.getDataservice();\n\n    // for collect all error when application don't already start\n    if (dataserviceInstance && dataserviceInstance.diagnosticstErrorsDb != undefined) {\n      dataserviceInstance.addDiagnosticsError(error, message, source, line);\n    }\n  },\n\n  /*************************************************************************************************\r\n      *          SERVICE FUNCTIONS\r\n      *************************************************************************************************/\n  getDataservice: function getDataservice() {\n    return bizagiWorkportal.deviceFactory.workportal.dataService;\n  },\n\n  getJqueryAjax: function getJqueryAjax() {\n    return bizagi.services.ajax;\n  },\n\n  getErrorsInAjaxImplementation: function getErrorsInAjaxImplementation() {\n    var self = this;\n    var ajaxInstance = self.getJqueryAjax();\n\n    if (ajaxInstance && ajaxInstance.mobileHttpErrorsQueue && ajaxInstance.mobileHttpErrorsQueue.length > 0) {\n      for (var i = 0; i < ajaxInstance.mobileHttpErrorsQueue.length; i++) {\n        self.sendDiagnosticsError(ajaxInstance.mobileHttpErrorsQueue[i]);\n      }\n    }\n  } });"]}